 say N.

	  To compile this driver as a module, choose M here: the
	  module will be called pmic8xxx-pwrkey.

config INPUT_SPARCSPKR
	tristate "SPARC Speaker support"
	depends on PCI && SPARC64
	help
	  Say Y here if you want the standard Speaker on Sparc PCI systems
	  to be used for bells and whistles.

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called sparcspkr.

config INPUT_M68K_BEEP
	tristate "M68k Beeper support"
	depends on M68K

config INPUT_MAX77693_HAPTIC
	tristate "MAXIM MAX77693 haptic controller support"
	depends on MFD_MAX77693 && PWM
	select INPUT_FF_MEMLESS
	help
	  This option enables support for the haptic controller on
	  MAXIM MAX77693 chip.

	  To compile this driver as module, choose M here: the
	  module will be called max77693-haptic.

config INPUT_MAX77843_HAPTIC
    tristate "MAXIM MAX77843 haptic controller support"
    depends on MFD_MAX77843 && REGULATOR
    select INPUT_FF_MEMLESS
    help
      This option enables support for the haptic controller on
      MAXIM MAX77843 chip. The driver supports ff-memless interface
      from input framework.

      To compile this driver as module, choose M here: the
      module will be called max77843-haptic.

config INPUT_MAX8925_ONKEY
	tristate "MAX8925 ONKEY support"
	depends on MFD_MAX8925
	help
	  Support the ONKEY of MAX8925 PMICs as an input device
	  reporting power button status.

	  To compile this driver as a module, choose M here: the module
	  will be called max8925_onkey.

config INPUT_MAX8997_HAPTIC
	tristate "MAXIM MAX8997 haptic controller support"
	depends on PWM && MFD_MAX8997
	select INPUT_FF_MEMLESS
	help
	  This option enables device driver support for the haptic controller
	  on MAXIM MAX8997 chip. This driver supports ff-memless interface
	  from input framework.

	  To compile this driver as module, choose M here: the
	  module will be called max8997-haptic.

config INPUT_MC13783_PWRBUTTON
	tristate "MC13783 ON buttons"
	depends on MFD_MC13XXX
	help
	  Support the ON buttons of MC13783 PMIC as an input device
	  reporting power button status.

	  To compile this driver as a module, choose M here: the module
	  will be called mc13783-pwrbutton.

config INPUT_MMA8450
	tristate "MMA8450 - Freescale's 3-Axis, 8/12-bit Digital Accelerometer"
	depends on I2C
	select INPUT_POLLDEV
	help
	  Say Y here if you want to support Freescale's MMA8450 Accelerometer
	  through I2C interface.

	  To compile this driver as a module, choose M here: the
	  module will be called mma8450.

config INPUT_MPU3050
	tristate "MPU3050 Triaxial gyroscope sensor"
	depends on I2C
	help
	  Say Y here if you want to support InvenSense MPU3050
	  connected via an I2C bus.

	  To compile this driver as a module, choose M here: the
	  module will be called mpu3050.

config INPUT_APANEL
	tristate "Fujitsu Lifebook Application Panel buttons"
	depends on X86 && I2C && LEDS_CLASS
	select INPUT_POLLDEV
	select CHECK_SIGNATURE
	help
	 Say Y here for support of the Application Panel buttons, used on
	 Fujitsu Lifebook. These are attached to the mainboard through
	 an SMBus interface managed by the I2C Intel ICH (i801) driver,
	 which you should also build for this kernel.

	 To compile this driver as a module, choose M here: the module will
	 be called apanel.

config INPUT_GP2A
	tristate "Sharp GP2AP002A00F I2C Proximity/Opto sensor driver"
	depends on I2C
	depends on GPIOLIB
	help
	  Say Y here if you have a Sharp GP2AP002A00F proximity/als combo-chip
	  hooked to an I2C bus.

	  To compile this driver as a module, choose M here: the
	  module will be called gp2ap002a00f.

config INPUT_GPIO_BEEPER
	tristate "Generic GPIO Beeper support"
	depends on GPIOLIB
	help
	  Say Y here if you have a beeper connected to a GPIO pin.

	  To compile this driver as a module, choose M here: the
	  module will be called gpio-beeper.

config INPUT_GPIO_TILT_POLLED
	tristate "Polled GPIO tilt switch"
	depends on GPIOLIB
	select INPUT_POLLDEV
	help
	  This driver implements support for tilt switches connected
	  to GPIO pins that are not capable of generating interrupts.

	  The list of gpios to use and the mapping of their states
	  to specific angles is done via platform data.

	  To compile this driver as a module, choose M here: the
	  module will be called gpio_tilt_polled.

config INPUT_IXP4XX_BEEPER
	tristate "IXP4XX Beeper support"
	depends on ARCH_IXP4XX
	help
	  If you say yes here, you can connect a beeper to the
	  ixp4xx gpio pins. This is used by the LinkSys NSLU2.

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called ixp4xx-beeper.

config INPUT_COBALT_BTNS
	tristate "Cobalt button interface"
	depends on MIPS_COBALT
	select INPUT_POLLDEV
	help
	  Say Y here if you want to support MIPS Cobalt button interface.

	  To compile this driver as a module, choose M here: the
	  module will be called cobalt_btns.

config INPUT_WISTRON_BTNS
	tristate "x86 Wistron laptop button interface"
	depends on X86_32
	select INPUT_POLLDEV
	select INPUT_SPARSEKMAP
	select NEW_LEDS
	select LEDS_CLASS
	select CHECK_SIGNATURE
	help
	  Say Y here for support of Wistron laptop button interfaces, used on
	  laptops of various brands, including Acer and Fujitsu-Siemens. If
	  available, mail and wifi LEDs will be controllable via /sys/class/leds.

	  To compile this driver as a module, choose M here: the module will
	  be called wistron_btns.

config INPUT_ATLAS_BTNS
	tristate "x86 Atlas button interface"
	depends on X86 && ACPI
	help
	  Say Y here for support of Atlas wallmount touchscreen buttons.
	  The events will show up as scancodes F1 through F9 via evdev.

	  To compile this driver as a module, choose M here: the module will
	  be called atlas_btns.

config INPUT_ATI_REMOTE2
	tristate "ATI / Philips USB RF remote control"
	depends on USB_ARCH_HAS_HCD
	select USB
	help
	  Say Y here if you want to use an ATI or Philips USB RF remote control.
	  These are RF remotes with USB receivers.
	  ATI Remote Wonder II comes with some ATI's All-In-Wonder video cards
	  and is also available as a separate product.
	  This driver provides mouse pointer, left and right mouse buttons,
	  and maps all the other remote buttons to keypress events.

	  To compile this driver as a module, choose M here: the module will be
	  called ati_remote2.

config INPUT_KEYSPAN_REMOTE
	tristate "Keyspan DMR USB remote control"
	depends on USB_ARCH_HAS_HCD
	select USB
	help
	  Say Y here if you want to use a Keyspan DMR USB remote control.
	  Currently only the UIA-11 type of receiver has been tested.  The tag
	  on the receiver that connects to the USB port should have a P/N that
	  will tell you what type of DMR you have.  The UIA-10 type is not
	  supported at this time.  This driver maps all buttons to keypress
	  events.

	  To compile this driver as a module, choose M here: the module will
	  be called keyspan_remote.

config INPUT_KXTJ9
	tristate "Kionix KXTJ9 tri-axis digital accelerometer"
	depends on I2C
	help
	  Say Y here to enable support for the Kionix KXTJ9 digital tri-axis
	  accelerometer.

	  To compile this driver as a module, choose M here: the module will
	  be called kxtj9.

config INPUT_KXTJ9_POLLED_MODE
	bool "Enable polling mode support"
	depends on INPUT_KXTJ9
	select INPUT_POLLDEV
	help
	  Say Y here if you need accelerometer to work in polling mode.

config INPUT_POWERMATE
	tristate "Griffin PowerMate and Contour Jog support"
	depends on USB_ARCH_HAS_HCD
	select USB
	help
	  Say Y here if you want to use Griffin PowerMate or Contour Jog devices.
	  These are aluminum dials which can measure clockwise and anticlockwise
	  rotation.  The dial also acts as a pushbutton.  The base contains an LED
	  which can be instructed to pulse or to switch to a particular intensity.

	  You can download userspace tools from
	  <http://sowerbutts.com/powermate/>.

	  To compile this driver as a module, choose M here: the
	  module will be called powermate.

config INPUT_YEALINK
	tristate "Yealink usb-p1k voip phone"
	depends on USB_ARCH_HAS_HCD
	select USB
	help
	  Say Y here if you want to enable keyboard and LCD functions of the
	  Yealink usb-p1k usb phones. The audio part is enabled by the generic
	  usb sound driver, so you might want to enable that as well.

	  For information about how to use these additional functions, see
	  <file:Documentation/input/yealink.txt>.

	  To compile this driver as a module, choose M here: the module will be
	  called yealink.

config INPUT_CM109
	tristate "C-Media CM109 USB I/O Controller"
	depends on USB_ARCH_HAS_HCD
	select USB
	help
	  Say Y here if you want to enable keyboard and buzzer functions of the
	  C-Media CM109 usb phones. The audio part is enabled by the generic
	  usb sound driver, so you might want to enable that as well.

	  To compile this driver as a module, choose M here: the module will be
	  called cm109.

config INPUT_REGULATOR_HAPTIC
	tristate "Regulator haptics support"
	depends on REGULATOR
	select INPUT_FF_MEMLESS
	help
	  This option enables device driver support for the haptic controlled
	  by a regulator. This driver supports ff-memless interface
	  from input framework.

	  To compile this driver as a module, choose M here: the
	  module will be called regulator-haptic.

config INPUT_RETU_PWRBUTTON
	tristate "Retu Power button Driver"
	depends on MFD_RETU
	help
	  Say Y here if you want to enable power key reporting via the
	  Retu chips found in Nokia Internet Tablets (770, N800, N810).

	  To compile this driver as a module, choose M here. The module will
	  be called retu-pwrbutton.

config INPUT_TPS65218_PWRBUTTON
	tristate "TPS65218 Power button driver"
	depends on MFD_TPS65218
	help
	  Say Y here if you want to enable power buttong reporting for
	  the TPS65218 Power Management IC device.

	  To compile this driver as a module, choose M here. The module will
	  be called tps65218-pwrbutton.

config INPUT_AXP20X_PEK
	tristate "X-Powers AXP20X power button driver"
	depends on MFD_AXP20X
	help
	  Say Y here if you want to enable power key reporting via the
	  AXP20X PMIC.

	  To compile this driver as a module, choose M here. The module will
	  be called axp20x-pek.


config INPUT_TWL4030_PWRBUTTON
	tristate "TWL4030 Power button Driver"
	depends on TWL4030_CORE
	help
	  Say Y here if you want to enable power key reporting via the
	  TWL4030 family of chips.

	  To compile this driver as a module, choose M here. The module will
	  be called twl4030_pwrbutton.

config INPUT_TWL4030_VIBRA
	tristate "Support for TWL4030 Vibrator"
	depends on TWL4030_CORE
	select MFD_TWL4030_AUDIO
	select INPUT_FF_MEMLESS
	help
	  This option enables support for TWL4030 Vibrator Driver.

	  To compile this driver as a module, choose M here. The module will
	  be called twl4030_vibra.

config INPUT_TWL6040_VIBRA
	tristate "Support for TWL6040 Vibrator"
	depends on TWL6040_CORE
	select INPUT_FF_MEMLESS
	help
	  This option enables support for TWL6040 Vibrator Driver.

	  To compile this driver as a module, choose M here. The module will
	  be called twl6040_vibra.

config INPUT_UINPUT
	tristate "User level driver support"
	help
	  Say Y here if you want to support user level drivers for input
	  subsystem accessible under char device 10:223 - /dev/input/uinput.

	  To compile this driver as a module, choose M here: the
	  module will be called uinput.

config INPUT_SGI_BTNS
	tristate "SGI Indy/O2 volume button interface"
	depends on SGI_IP22 || SGI_IP32
	select INPUT_POLLDEV
	help
	  Say Y here if you want to support SGI Indy/O2 volume button interface.

	  To compile this driver as a module, choose M here: the
	  module will be called sgi_btns.

config HP_SDC_RTC
	tristate "HP SDC Real Time Clock"
	depends on (GSC || HP300) && SERIO
	select HP_SDC
	help
	  Say Y here if you want to support the built-in real time clock
	  of the HP SDC controller.

config INPUT_PALMAS_PWRBUTTON
	tristate "Palmas Power button Driver"
	depends on MFD_PALMAS
	help
	  Say Y here if you want to enable power key reporting via the
	  Palmas family of PMICs.

	  To compile this driver as a module, choose M here. The module will
	  be called palmas_pwrbutton.

config INPUT_PCF50633_PMU
	tristate "PCF50633 PMU events"
	depends on MFD_PCF50633
	help
	 Say Y to include support for delivering  PMU events via  input
	 layer on NXP PCF50633.

config INPUT_PCF8574
	tristate "PCF8574 Keypad input device"
	depends on I2C
	help
	  Say Y here if you want to support a keypad connected via I2C
	  with a PCF8574.

	  To compile this driver as a module, choose M here: the
	  module will be called pcf8574_keypad.

config INPUT_PWM_BEEPER
	tristate "PWM beeper support"
	depends on PWM
	help
	  Say Y here to get support for PWM based beeper devices.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the module will be
	  called pwm-beeper.

config INPUT_GPIO_ROTARY_ENCODER
	tristate "Rotary encoders connected to GPIO pins"
	depends on GPIOLIB
	help
	  Say Y here to add support for rotary encoders connected to GPIO lines.
	  Check file:Documentation/input/rotary-encoder.txt for more
	  information.

	  To compile this driver as a module, choose M here: the
	  module will be called rotary_encoder.

config INPUT_RB532_BUTTON
	tristate "Mikrotik Routerboard 532 button interface"
	depends on MIKROTIK_RB532
	depends on GPIOLIB
	select INPUT_POLLDEV
	help
	  Say Y here if you want support for the S1 button built into
	  Mikrotik's Routerboard 532.

	  To compile this driver as a module, choose M here: the
	  module will be called rb532_button.

config INPUT_DA9052_ONKEY
	tristate "Dialog DA9052/DA9053 Onkey"
	depends on PMIC_DA9052
	help
	  Support the ONKEY of Dialog DA9052 PMICs as an input device
	  reporting power button status.

	  To compile this driver as a module, choose M here: the
	  module will be called da9052_onkey.

config INPUT_DA9055_ONKEY
	tristate "Dialog Semiconductor DA9055 ONKEY"
	depends on MFD_DA9055
	help
	  Support the ONKEY of DA9055 PMICs as an input device
	  reporting power button status.

	  To compile this driver as a module, choose M here: the module
	  will be called da9055_onkey.

config INPUT_DM355EVM
	tristate "TI DaVinci DM355 EVM Keypad and IR Remote"
	depends on MFD_DM355EVM_MSP
	select INPUT_SPARSEKMAP
	help
	  Supports the pushbuttons and IR remote used with
	  the DM355 EVM board.

	  To compile this driver as a module, choose M here: the
	  module will be called dm355evm_keys.

config INPUT_BFIN_ROTARY
	tristate "Blackfin Rotary support"
	depends on BF54x || BF52x
	help
	  Say Y here if you want to use the Blackfin Rotary.

	  To compile this driver as a module, choose M here: the
	  module will be called bfin-rotary.

config INPUT_WM831X_ON
	tristate "WM831X ON pin"
	depends on MFD_WM831X
	help
	  Support the ON pin of WM831X PMICs as an input device
	  reporting power button status.

	  To compile this driver as a module, choose M here: the module
	  will be called wm831x_on.

config INPUT_PCAP
	tristate "Motorola EZX PCAP misc input events"
	depends on EZX_PCAP
	help
	  Say Y here if you want to use Power key and Headphone button
	  on Motorola EZX phones.

	  To compile this driver as a module, choose M here: the
	  module will be called pcap_keys.

config INPUT_ADXL34X
	tristate "Analog Devices ADXL34x Three-Axis Digital Accelerometer"
	default n
	help
	  Say Y here if you have a Accelerometer interface using the
	  ADXL345/6 controller, and your board-specific initialization
	  code includes that in its table of devices.

	  This driver can use either I2C or SPI communication to the
	  ADXL345/6 controller.  Select the appropriate method for
	  your system.

	  If unsure, say N (but it's safe to say "Y").

	  To compile this driver as a module, choose M here: the
	  module will be called adxl34x.

config INPUT_ADXL34X_I2C
	tristate "support I2C bus connection"
	depends on INPUT_ADXL34X && I2C
	default y
	help
	  Say Y here if you have ADXL345/6 hooked to an I2C bus.

	  To compile this driver as a module, choose M here: the
	  module will be called adxl34x-i2c.

config INPUT_ADXL34X_SPI
	tristate "support SPI bus connection"
	depends on INPUT_ADXL34X && SPI
	default y
	help
	  Say Y here if you have ADXL345/6 hooked to a SPI bus.

	  To compile this driver as a module, choose M here: the
	  module will be called adxl34x-spi.

config INPUT_IMS_PCU
	tristate "IMS Passenger Control Unit driver"
	depends on USB
	depends on LEDS_CLASS
	help
	  Say Y here if you have system with IMS Rave Passenger Control Unit.

	  To compile this driver as a module, choose M here: the module will be
	  called ims_pcu.

config INPUT_CMA3000
	tristate "VTI CMA3000 Tri-axis accelerometer"
	help
	  Say Y here if you want to use VTI CMA3000_D0x Accelerometer
	  driver

	  This driver currently only supports I2C interface to the
	  controller. Also select the I2C method.

	  If unsure, say N

	  To compile this driver as a module, choose M here: the
	  module will be called cma3000_d0x.

config INPUT_CMA3000_I2C
	tristate "Support I2C bus connection"
	depends on INPUT_CMA3000 && I2C
	help
	  Say Y here if you want to use VTI CMA3000_D0x Accelerometer
	  through I2C interface.

	  To compile this driver as a module, choose M here: the
	  module will be called cma3000_d0x_i2c.

config INPUT_XEN_KBDDEV_FRONTEND
	tristate "Xen virtual keyboard and mouse support"
	depends on XEN
	default y
	select XEN_XENBUS_FRONTEND
	help
	  This driver implements the front-end of the Xen virtual
	  keyboard and mouse device driver.  It communicates with a back-end
	  in another domain.

	  To compile this driver as a module, choose M here: the
	  module will be called xen-kbdfront.

config INPUT_SIRFSOC_ONKEY
	bool "CSR SiRFSoC power on/off/suspend key support"
	depends on ARCH_SIRF && OF
	default y
	help
	  Say Y here if you want to support for the SiRFSoC power on/off/suspend key
	  in Linux, after you press the onkey, system will suspend.

	  If unsure, say N.

config INPUT_IDEAPAD_SLIDEBAR
	tristate "IdeaPad Laptop Slidebar"
	depends on INPUT
	depends on SERIO_I8042
	help
	  Say Y here if you have an IdeaPad laptop with a slidebar.

	  To compile this driver as a module, choose M here: the
	  module will be called ideapad_slidebar.

config INPUT_SOC_BUTTON_ARRAY
	tristate "Windows-compatible SoC Button Array"
	depends on KEYBOARD_GPIO
	help
	  Say Y here if you have a SoC-based tablet that originally
	  runs Windows 8.

	  To compile this driver as a module, choose M here: the
	  module will be called soc_button_array.

config INPUT_DRV260X_HAPTICS
	tristate "TI DRV260X haptics support"
	depends on INPUT && I2C && GPIOLIB
	select INPUT_FF_MEMLESS
	select REGMAP_I2C
	help
	  Say Y to enable support for the TI DRV260X haptics driver.

	  To compile this driver as a module, choose M here: the
	  module will be called drv260x-haptics.

config INPUT_DRV2667_HAPTICS
	tristate "TI DRV2667 haptics support"
	depends on INPUT && I2C
	select INPUT_FF_MEMLESS
	select REGMAP_I2C
	help
	  Say Y to enable support for the TI DRV2667 haptics driver.

	  To compile this driver as a module, choose M here: the
	  module will be called drv260x-haptics.

endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #
# Makefile for the input misc drivers.
#

# Each configuration option enables a list of files.

obj-$(CONFIG_INPUT_88PM860X_ONKEY)	+= 88pm860x_onkey.o
obj-$(CONFIG_INPUT_88PM80X_ONKEY)	+= 88pm80x_onkey.o
obj-$(CONFIG_INPUT_AB8500_PONKEY)	+= ab8500-ponkey.o
obj-$(CONFIG_INPUT_AD714X)		+= ad714x.o
obj-$(CONFIG_INPUT_AD714X_I2C)		+= ad714x-i2c.o
obj-$(CONFIG_INPUT_AD714X_SPI)		+= ad714x-spi.o
obj-$(CONFIG_INPUT_ADXL34X)		+= adxl34x.o
obj-$(CONFIG_INPUT_ADXL34X_I2C)		+= adxl34x-i2c.o
obj-$(CONFIG_INPUT_ADXL34X_SPI)		+= adxl34x-spi.o
obj-$(CONFIG_INPUT_APANEL)		+= apanel.o
obj-$(CONFIG_INPUT_ARIZONA_HAPTICS)	+= arizona-haptics.o
obj-$(CONFIG_INPUT_ATI_REMOTE2)		+= ati_remote2.o
obj-$(CONFIG_INPUT_ATLAS_BTNS)		+= atlas_btns.o
obj-$(CONFIG_INPUT_BFIN_ROTARY)		+= bfin_rotary.o
obj-$(CONFIG_INPUT_BMA150)		+= bma150.o
obj-$(CONFIG_INPUT_CM109)		+= cm109.o
obj-$(CONFIG_INPUT_CMA3000)		+= cma3000_d0x.o
obj-$(CONFIG_INPUT_CMA3000_I2C)		+= cma3000_d0x_i2c.o
obj-$(CONFIG_INPUT_COBALT_BTNS)		+= cobalt_btns.o
obj-$(CONFIG_INPUT_DA9052_ONKEY)	+= da9052_onkey.o
obj-$(CONFIG_INPUT_DA9055_ONKEY)	+= da9055_onkey.o
obj-$(CONFIG_INPUT_DM355EVM)		+= dm355evm_keys.o
obj-$(CONFIG_INPUT_E3X0_BUTTON)		+= e3x0-button.o
obj-$(CONFIG_INPUT_DRV260X_HAPTICS)	+= drv260x.o
obj-$(CONFIG_INPUT_DRV2667_HAPTICS)	+= drv2667.o
obj-$(CONFIG_INPUT_GP2A)		+= gp2ap002a00f.o
obj-$(CONFIG_INPUT_GPIO_BEEPER)		+= gpio-beeper.o
obj-$(CONFIG_INPUT_GPIO_TILT_POLLED)	+= gpio_tilt_polled.o
obj-$(CONFIG_HP_SDC_RTC)		+= hp_sdc_rtc.o
obj-$(CONFIG_INPUT_IMS_PCU)		+= ims-pcu.o
obj-$(CONFIG_INPUT_IXP4XX_BEEPER)	+= ixp4xx-beeper.o
obj-$(CONFIG_INPUT_KEYSPAN_REMOTE)	+= keyspan_remote.o
obj-$(CONFIG_INPUT_KXTJ9)		+= kxtj9.o
obj-$(CONFIG_INPUT_M68K_BEEP)		+= m68kspkr.o
obj-$(CONFIG_INPUT_MAX77693_HAPTIC)	+= max77693-haptic.o
obj-$(CONFIG_INPUT_MAX77843_HAPTIC)	+= max77843-haptic.o
obj-$(CONFIG_INPUT_MAX8925_ONKEY)	+= max8925_onkey.o
obj-$(CONFIG_INPUT_MAX8997_HAPTIC)	+= max8997_haptic.o
obj-$(CONFIG_INPUT_MC13783_PWRBUTTON)	+= mc13783-pwrbutton.o
obj-$(CONFIG_INPUT_MMA8450)		+= mma8450.o
obj-$(CONFIG_INPUT_MPU3050)		+= mpu3050.o
obj-$(CONFIG_INPUT_PALMAS_PWRBUTTON)	+= palmas-pwrbutton.o
obj-$(CONFIG_INPUT_PCAP)		+= pcap_keys.o
obj-$(CONFIG_INPUT_PCF50633_PMU)	+= pcf50633-input.o
obj-$(CONFIG_INPUT_PCF8574)		+= pcf8574_keypad.o
obj-$(CONFIG_INPUT_PCSPKR)		+= pcspkr.o
obj-$(CONFIG_INPUT_PM8941_PWRKEY)	+= pm8941-pwrkey.o
obj-$(CONFIG_INPUT_PM8XXX_VIBRATOR)	+= pm8xxx-vibrator.o
obj-$(CONFIG_INPUT_PMIC8XXX_PWRKEY)	+= pmic8xxx-pwrkey.o
obj-$(CONFIG_INPUT_POWERMATE)		+= powermate.o
obj-$(CONFIG_INPUT_PWM_BEEPER)		+= pwm-beeper.o
obj-$(CONFIG_INPUT_RB532_BUTTON)	+= rb532_button.o
obj-$(CONFIG_INPUT_REGULATOR_HAPTIC)	+= regulator-haptic.o
obj-$(CONFIG_INPUT_RETU_PWRBUTTON)	+= retu-pwrbutton.o
obj-$(CONFIG_INPUT_AXP20X_PEK)		+= axp20x-pek.o
obj-$(CONFIG_INPUT_GPIO_ROTARY_ENCODER)	+= rotary_encoder.o
obj-$(CONFIG_INPUT_SGI_BTNS)		+= sgi_btns.o
obj-$(CONFIG_INPUT_SIRFSOC_ONKEY)	+= sirfsoc-onkey.o
obj-$(CONFIG_INPUT_SOC_BUTTON_ARRAY)	+= soc_button_array.o
obj-$(CONFIG_INPUT_SPARCSPKR)		+= sparcspkr.o
obj-$(CONFIG_INPUT_TPS65218_PWRBUTTON)	+= tps65218-pwrbutton.o
obj-$(CONFIG_INPUT_TWL4030_PWRBUTTON)	+= twl4030-pwrbutton.o
obj-$(CONFIG_INPUT_TWL4030_VIBRA)	+= twl4030-vibra.o
obj-$(CONFIG_INPUT_TWL6040_VIBRA)	+= twl6040-vibra.o
obj-$(CONFIG_INPUT_UINPUT)		+= uinput.o
obj-$(CONFIG_INPUT_WISTRON_BTNS)	+= wistron_btns.o
obj-$(CONFIG_INPUT_WM831X_ON)		+= wm831x-on.o
obj-$(CONFIG_INPUT_XEN_KBDDEV_FRONTEND)	+= xen-kbdfront.o
obj-$(CONFIG_INPUT_YEALINK)		+= yealink.o
obj-$(CONFIG_INPUT_IDEAPAD_SLIDEBAR)	+= ideapad_slidebar.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #
# Makefile for the input core drivers.
#

# Each configuration option enables a list of files.

obj-$(CONFIG_KEYBOARD_ADP5520)		+= adp5520-keys.o
obj-$(CONFIG_KEYBOARD_ADP5588)		+= adp5588-keys.o
obj-$(CONFIG_KEYBOARD_ADP5589)		+= adp5589-keys.o
obj-$(CONFIG_KEYBOARD_AMIGA)		+= amikbd.o
obj-$(CONFIG_KEYBOARD_ATARI)		+= atakbd.o
obj-$(CONFIG_KEYBOARD_ATKBD)		+= atkbd.o
obj-$(CONFIG_KEYBOARD_BCM)		+= bcm-keypad.o
obj-$(CONFIG_KEYBOARD_BFIN)		+= bf54x-keys.o
obj-$(CONFIG_KEYBOARD_CAP11XX)		+= cap11xx.o
obj-$(CONFIG_KEYBOARD_CLPS711X)		+= clps711x-keypad.o
obj-$(CONFIG_KEYBOARD_CROS_EC)		+= cros_ec_keyb.o
obj-$(CONFIG_KEYBOARD_DAVINCI)		+= davinci_keyscan.o
obj-$(CONFIG_KEYBOARD_EP93XX)		+= ep93xx_keypad.o
obj-$(CONFIG_KEYBOARD_GOLDFISH_EVENTS)	+= goldfish_events.o
obj-$(CONFIG_KEYBOARD_GPIO)		+= gpio_keys.o
obj-$(CONFIG_KEYBOARD_GPIO_POLLED)	+= gpio_keys_polled.o
obj-$(CONFIG_KEYBOARD_TCA6416)		+= tca6416-keypad.o
obj-$(CONFIG_KEYBOARD_TCA8418)		+= tca8418_keypad.o
obj-$(CONFIG_KEYBOARD_HIL)		+= hil_kbd.o
obj-$(CONFIG_KEYBOARD_HIL_OLD)		+= hilkbd.o
obj-$(CONFIG_KEYBOARD_IPAQ_MICRO)	+= ipaq-micro-keys.o
obj-$(CONFIG_KEYBOARD_IMX)		+= imx_keypad.o
obj-$(CONFIG_KEYBOARD_HP6XX)		+= jornada680_kbd.o
obj-$(CONFIG_KEYBOARD_HP7XX)		+= jornada720_kbd.o
obj-$(CONFIG_KEYBOARD_LKKBD)		+= lkkbd.o
obj-$(CONFIG_KEYBOARD_LM8323)		+= lm8323.o
obj-$(CONFIG_KEYBOARD_LM8333)		+= lm8333.o
obj-$(CONFIG_KEYBOARD_LOCOMO)		+= locomokbd.o
obj-$(CONFIG_KEYBOARD_LPC32XX)		+= lpc32xx-keys.o
obj-$(CONFIG_KEYBOARD_MAPLE)		+= maple_keyb.o
obj-$(CONFIG_KEYBOARD_MATRIX)		+= matrix_keypad.o
obj-$(CONFIG_KEYBOARD_MAX7359)		+= max7359_keypad.o
obj-$(CONFIG_KEYBOARD_MCS)		+= mcs_touchkey.o
obj-$(CONFIG_KEYBOARD_MPR121)		+= mpr121_touchkey.o
obj-$(CONFIG_KEYBOARD_NEWTON)		+= newtonkbd.o
obj-$(CONFIG_KEYBOARD_NOMADIK)		+= nomadik-ske-keypad.o
obj-$(CONFIG_KEYBOARD_NSPIRE)		+= nspire-keypad.o
obj-$(CONFIG_KEYBOARD_OMAP)		+= omap-keypad.o
obj-$(CONFIG_KEYBOARD_OMAP4)		+= omap4-keypad.o
obj-$(CONFIG_KEYBOARD_OPENCORES)	+= opencores-kbd.o
obj-$(CONFIG_KEYBOARD_PMIC8XXX)		+= pmic8xxx-keypad.o
obj-$(CONFIG_KEYBOARD_PXA27x)		+= pxa27x_keypad.o
obj-$(CONFIG_KEYBOARD_PXA930_ROTARY)	+= pxa930_rotary.o
obj-$(CONFIG_KEYBOARD_QT1070)           += qt1070.o
obj-$(CONFIG_KEYBOARD_QT2160)		+= qt2160.o
obj-$(CONFIG_KEYBOARD_SAMSUNG)		+= samsung-keypad.o
obj-$(CONFIG_KEYBOARD_SH_KEYSC)		+= sh_keysc.o
obj-$(CONFIG_KEYBOARD_SPEAR)		+= spear-keyboard.o
obj-$(CONFIG_KEYBOARD_STMPE)		+= stmpe-keypad.o
obj-$(CONFIG_KEYBOARD_STOWAWAY)		+= stowaway.o
obj-$(CONFIG_KEYBOARD_ST_KEYSCAN)	+= st-keyscan.o
obj-$(CONFIG_KEYBOARD_SUN4I_LRADC)	+= sun4i-lradc-keys.o
obj-$(CONFIG_KEYBOARD_SUNKBD)		+= sunkbd.o
obj-$(CONFIG_KEYBOARD_TC3589X)		+= tc3589x-keypad.o
obj-$(CONFIG_KEYBOARD_TEGRA)		+= tegra-kbc.o
obj-$(CONFIG_KEYBOARD_TWL4030)		+= twl4030_keypad.o
obj-$(CONFIG_KEYBOARD_XTKBD)		+= xtkbd.o
obj-$(CONFIG_KEYBOARD_W90P910)		+= w90p910_keypad.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       #
# Input device configuration
#

menu "Input device support"
	depends on !UML

config INPUT
	tristate "Generic input layer (needed for keyboard, mouse, ...)" if EXPERT
	default y
	help
	  Say Y here if you have any input device (mouse, keyboard, tablet,
	  joystick, steering wheel ...) connected to your system and want
	  it to be available to applications. This includes standard PS/2
	  keyboard and mouse.

	  Say N here if you have a headless (no monitor, no keyboard) system.

	  More information is available: <file:Documentation/input/input.txt>

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called input.

if INPUT

config INPUT_FF_MEMLESS
	tristate "Support for memoryless force-feedback devices"
	help
	  Say Y here if you have memoryless force-feedback input device
	  such as Logitech WingMan Force 3D, ThrustMaster FireStorm Dual
	  Power 2, or similar. You will also need to enable hardware-specific
	  driver.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called ff-memless.

config INPUT_POLLDEV
	tristate "Polled input device skeleton"
	help
	  Say Y here if you are using a driver for an input
	  device that periodically polls hardware state. This
	  option is only useful for out-of-tree drivers since
	  in-tree drivers select it automatically.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called input-polldev.

config INPUT_SPARSEKMAP
	tristate "Sparse keymap support library"
	help
	  Say Y here if you are using a driver for an input
	  device that uses sparse keymap. This option is only
	  useful for out-of-tree drivers since in-tree drivers
	  select it automatically.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called sparse-keymap.

config INPUT_MATRIXKMAP
	tristate "Matrix keymap support library"
	help
	  Say Y here if you are using a driver for an input
	  device that uses matrix keymap. This option is only
	  useful for out-of-tree drivers since in-tree drivers
	  select it automatically.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called matrix-keymap.

comment "Userland interfaces"

config INPUT_MOUSEDEV
	tristate "Mouse interface"
	default y
	help
	  Say Y here if you want your mouse to be accessible as char devices
	  13:32+ - /dev/input/mouseX and 13:63 - /dev/input/mice as an
	  emulated IntelliMouse Explorer PS/2 mouse. That way, all user space
	  programs (including SVGAlib, GPM and X) will be able to use your
	  mouse.

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called mousedev.

config INPUT_MOUSEDEV_PSAUX
	bool "Provide legacy /dev/psaux device"
	default y
	depends on INPUT_MOUSEDEV
	help
	  Say Y here if you want your mouse also be accessible as char device
	  10:1 - /dev/psaux. The data available through /dev/psaux is exactly
	  the same as the data from /dev/input/mice.

	  If unsure, say Y.


config INPUT_MOUSEDEV_SCREEN_X
	int "Horizontal screen resolution"
	depends on INPUT_MOUSEDEV
	default "1024"
	help
	  If you're using a digitizer, or a graphic tablet, and want to use
	  it as a mouse then the mousedev driver needs to know the X window
	  screen resolution you are using to correctly scale the data. If
	  you're not using a digitizer, this value is ignored.

config INPUT_MOUSEDEV_SCREEN_Y
	int "Vertical screen resolution"
	depends on INPUT_MOUSEDEV
	default "768"
	help
	  If you're using a digitizer, or a graphic tablet, and want to use
	  it as a mouse then the mousedev driver needs to know the X window
	  screen resolution you are using to correctly scale the data. If
	  you're not using a digitizer, this value is ignored.

config INPUT_JOYDEV
	tristate "Joystick interface"
	help
	  Say Y here if you want your joystick or gamepad to be
	  accessible as char device 13:0+ - /dev/input/jsX device.

	  If unsure, say Y.

	  More information is available: <file:Documentation/input/joystick.txt>

	  To compile this driver as a module, choose M here: the
	  module will be called joydev.

config INPUT_EVDEV
	tristate "Event interface"
	help
	  Say Y here if you want your input device events be accessible
	  under char device 13:64+ - /dev/input/eventX in a generic way.

	  To compile this driver as a module, choose M here: the
	  module will be called evdev.

config INPUT_EVBUG
	tristate "Event debugging"
	help
	  Say Y here if you have a problem with the input subsystem and
	  want all events (keypresses, mouse movements), to be output to
	  the system log. While this is useful for debugging, it's also
	  a security threat - your keypresses include your passwords, of
	  course.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called evbug.

config INPUT_APMPOWER
	tristate "Input Power Event -> APM Bridge" if EXPERT
	depends on INPUT && APM_EMULATION
	help
	  Say Y here if you want suspend key events to trigger a user
	  requested suspend through APM. This is useful on embedded
	  systems where such behaviour is desired without userspace
	  interaction. If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called apm-power.

comment "Input Device Drivers"

source "drivers/input/keyboard/Kconfig"

source "drivers/input/mouse/Kconfig"

source "drivers/input/joystick/Kconfig"

source "drivers/input/tablet/Kconfig"

source "drivers/input/touchscreen/Kconfig"

source "drivers/input/misc/Kconfig"

endif

menu "Hardware I/O ports"

source "drivers/input/serio/Kconfig"

source "drivers/input/gameport/Kconfig"

endmenu

endmenu

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #
# Input core configuration
#
menuconfig INPUT_KEYBOARD
	bool "Keyboards"
	default y
	help
	  Say Y here, and a list of supported keyboards will be displayed.
	  This option doesn't affect the kernel.

	  If unsure, say Y.

if INPUT_KEYBOARD

config KEYBOARD_ADP5520
	tristate "Keypad Support for ADP5520 PMIC"
	depends on PMIC_ADP5520
	help
	  This option enables support for the keypad scan matrix
	  on Analog Devices ADP5520 PMICs.

	  To compile this driver as a module, choose M here: the module will
	  be called adp5520-keys.

config KEYBOARD_ADP5588
	tristate "ADP5588/87 I2C QWERTY Keypad and IO Expander"
	depends on I2C
	help
	  Say Y here if you want to use a ADP5588/87 attached to your
	  system I2C bus.

	  To compile this driver as a module, choose M here: the
	  module will be called adp5588-keys.

config KEYBOARD_ADP5589
	tristate "ADP5585/ADP5589 I2C QWERTY Keypad and IO Expander"
	depends on I2C
	help
	  Say Y here if you want to use a ADP5585/ADP5589 attached to your
	  system I2C bus.

	  To compile this driver as a module, choose M here: the
	  module will be called adp5589-keys.

config KEYBOARD_AMIGA
	tristate "Amiga keyboard"
	depends on AMIGA
	help
	  Say Y here if you are running Linux on any AMIGA and have a keyboard
	  attached.

	  To compile this driver as a module, choose M here: the
	  module will be called amikbd.

config ATARI_KBD_CORE
	bool

config KEYBOARD_ATARI
	tristate "Atari keyboard"
	depends on ATARI
	select ATARI_KBD_CORE
	help
	  Say Y here if you are running Linux on any Atari and have a keyboard
	  attached.

	  To compile this driver as a module, choose M here: the
	  module will be called atakbd.

config KEYBOARD_ATKBD
	tristate "AT keyboard"
	default y
	select SERIO
	select SERIO_LIBPS2
	select SERIO_I8042 if ARCH_MIGHT_HAVE_PC_SERIO
	select SERIO_GSCPS2 if GSC
	help
	  Say Y here if you want to use a standard AT or PS/2 keyboard. Usually
	  you'll need this, unless you have a different type keyboard (USB, ADB
	  or other). This also works for AT and PS/2 keyboards connected over a
	  PS/2 to serial converter.

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called atkbd.

config KEYBOARD_ATKBD_HP_KEYCODES
	bool "Use HP keyboard scancodes"
	depends on PARISC && KEYBOARD_ATKBD
	default y
	help
	  Say Y here if you have a PA-RISC machine and want to use an AT or
	  PS/2 keyboard, and your keyboard uses keycodes that are specific to
	  PA-RISC keyboards.

	  Say N if you use a standard keyboard.

config KEYBOARD_ATKBD_RDI_KEYCODES
	bool "Use PrecisionBook keyboard scancodes"
	depends on KEYBOARD_ATKBD_HP_KEYCODES
	default n
	help
	  If you have an RDI PrecisionBook, say Y here if you want to use its
	  built-in keyboard (as opposed to an external keyboard).

	  The PrecisionBook has five keys that conflict with those used by most
	  AT and PS/2 keyboards. These are as follows:

	    PrecisionBook    Standard AT or PS/2

	    F1               F12
	    Left Ctrl        Left Alt
	    Caps Lock        Left Ctrl
	    Right Ctrl       Caps Lock
	    Left             102nd key (the key to the right of Left Shift)

	  If you say N here, and use the PrecisionBook keyboard, then each key
	  in the left-hand column will be interpreted as the corresponding key
	  in the right-hand column.

	  If you say Y here, and use an external keyboard, then each key in the
	  right-hand column will be interpreted as the key shown in the
	  left-hand column.

config KEYBOARD_QT1070
       tristate "Atmel AT42QT1070 Touch Sensor Chip"
       depends on I2C
       help
         Say Y here if you want to use Atmel AT42QT1070 QTouch
         Sensor chip as input device.

         To compile this driver as a module, choose M here:
         the module will be called qt1070

config KEYBOARD_QT2160
	tristate "Atmel AT42QT2160 Touch Sensor Chip"
	depends on I2C
	help
	  If you say yes here you get support for Atmel AT42QT2160 Touch
	  Sensor chip as a keyboard input.

	  This driver can also be built as a module. If so, the module
	  will be called qt2160.

config KEYBOARD_BFIN
	tristate "Blackfin BF54x keypad support"
	depends on (BF54x && !BF544)
	help
	  Say Y here if you want to use the BF54x keypad.

	  To compile this driver as a module, choose M here: the
	  module will be called bf54x-keys.

config KEYBOARD_CLPS711X
	tristate "CLPS711X Keypad support"
	depends on OF_GPIO && (ARCH_CLPS711X || COMPILE_TEST)
	select INPUT_MATRIXKMAP
	select INPUT_POLLDEV
	help
	  Say Y here to enable the matrix keypad on the Cirrus Logic
	  CLPS711X CPUs.

	  To compile this driver as a module, choose M here: the
	  module will be called clps711x-keypad.

config KEYBOARD_LKKBD
	tristate "DECstation/VAXstation LK201/LK401 keyboard"
	select SERIO
	help
	  Say Y here if you want to use a LK201 or LK401 style serial
	  keyboard. This keyboard is also useable on PCs if you attach
	  it with the inputattach program. The connector pinout is
	  described within lkkbd.c.

	  To compile this driver as a module, choose M here: the
	  module will be called lkkbd.

config KEYBOARD_EP93XX
	tristate "EP93xx Matrix Keypad support"
	depends on ARCH_EP93XX
	select INPUT_MATRIXKMAP
	help
	  Say Y here to enable the matrix keypad on the Cirrus EP93XX.

	  To compile this driver as a module, choose M here: the
	  module will be called ep93xx_keypad.

config KEYBOARD_GPIO
	tristate "GPIO Buttons"
	depends on GPIOLIB
	help
	  This driver implements support for buttons connected
	  to GPIO pins of various CPUs (and some other chips).

	  Say Y here if your device has buttons connected
	  directly to such GPIO pins.  Your board-specific
	  setup logic must also provide a platform device,
	  with configuration data saying which GPIOs are used.

	  To compile this driver as a module, choose M here: the
	  module will be called gpio_keys.

config KEYBOARD_GPIO_POLLED
	tristate "Polled GPIO buttons"
	depends on GPIOLIB
	select INPUT_POLLDEV
	help
	  This driver implements support for buttons connected
	  to GPIO pins that are not capable of generating interrupts.

	  Say Y here if your device has buttons connected
	  directly to such GPIO pins.  Your board-specific
	  setup logic must also provide a platform device,
	  with configuration data saying which GPIOs are used.

	  To compile this driver as a module, choose M here: the
	  module will be called gpio_keys_polled.

config KEYBOARD_TCA6416
	tristate "TCA6416/TCA6408A Keypad Support"
	depends on I2C
	help
	  This driver implements basic keypad functionality
	  for keys connected through TCA6416/TCA6408A IO expanders.

	  Say Y here if your device has keys connected to
	  TCA6416/TCA6408A IO expander. Your board-specific setup logic
	  must also provide pin-mask details(of which TCA6416 pins
	  are used for keypad).

	  If enabled the entire TCA6416 device will be managed through
	  this driver.

	  To compile this driver as a module, choose M here: the
	  module will be called tca6416_keypad.

config KEYBOARD_TCA8418
	tristate "TCA8418 Keypad Support"
	depends on I2C
	select INPUT_MATRIXKMAP
	help
	  This driver implements basic keypad functionality
	  for keys connected through TCA8418 keypad decoder.

	  Say Y here if your device has keys connected to
	  TCA8418 keypad decoder.

	  If enabled the complete TCA8418 device will be managed through
	  this driver.

	  To compile this driver as a module, choose M here: the
	  module will be called tca8418_keypad.

config KEYBOARD_MATRIX
	tristate "GPIO driven matrix keypad support"
	depends on GPIOLIB
	select INPUT_MATRIXKMAP
	help
	  Enable support for GPIO driven matrix keypad.

	  To compile this driver as a module, choose M here: the
	  module will be called matrix_keypad.

config KEYBOARD_HIL_OLD
	tristate "HP HIL keyboard support (simple driver)"
	depends on GSC || HP300
	default y
	help
	  The "Human Interface Loop" is a older, 8-channel USB-like
	  controller used in several Hewlett Packard models. This driver
	  was adapted from the one written for m68k/hp300, and implements
	  support for a keyboard attached to the HIL port, but not for
	  any other types of HIL input devices like mice or tablets.
	  However, it has been thoroughly tested and is stable.

	  If you want full HIL support including support for multiple
	  keyboards, mice, and tablets, you have to enable the
	  "HP System Device Controller i8042 Support" in the input/serio
	  submenu.

config KEYBOARD_HIL
	tristate "HP HIL keyboard/pointer support"
	depends on GSC || HP300
	default y
	select HP_SDC
	select HIL_MLC
	select SERIO
	help
	  The "Human Interface Loop" is a older, 8-channel USB-like
	  controller used in several Hewlett Packard models.
	  This driver implements support for HIL-keyboards and pointing
	  devices (mice, tablets, touchscreens) attached
	  to your machine, so normally you should say Y here.

config KEYBOARD_HP6XX
	tristate "HP Jornada 6xx keyboard"
	depends on SH_HP6XX
	select INPUT_POLLDEV
	help
	  Say Y here if you have a HP Jornada 620/660/680/690 and want to
	  support the built-in keyboard.

	  To compile this driver as a module, choose M here: the
	  module will be called jornada680_kbd.

config KEYBOARD_HP7XX
	tristate "HP Jornada 7xx keyboard"
	depends on SA1100_JORNADA720_SSP && SA1100_SSP
	help
	  Say Y here if you have a HP Jornada 710/720/728 and want to
	  support the built-in keyboard.

	  To compile this driver as a module, choose M here: the
	  module will be called jornada720_kbd.

config KEYBOARD_LM8323
	tristate "LM8323 keypad chip"
	depends on I2C
	depends on LEDS_CLASS
	help
	  If you say yes here you get support for the National Semiconductor
	  LM8323 keypad controller.

	  To compile this driver as a module, choose M here: the
	  module will be called lm8323.

config KEYBOARD_LM8333
	tristate "LM8333 keypad chip"
	depends on I2C
	select INPUT_MATRIXKMAP
	help
	  If you say yes here you get support for the National Semiconductor
	  LM8333 keypad controller.

	  To compile this driver as a module, choose M here: the
	  module will be called lm8333.

config KEYBOARD_LOCOMO
	tristate "LoCoMo Keyboard Support"
	depends on SHARP_LOCOMO
	help
	  Say Y here if you are running Linux on a Sharp Zaurus Collie or Poodle based PDA

	  To compile this driver as a module, choose M here: the
	  module will be called locomokbd.

config KEYBOARD_LPC32XX
	tristate "LPC32XX matrix key scanner support"
	depends on ARCH_LPC32XX && OF
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use NXP LPC32XX SoC key scanner interface,
	  connected to a key matrix.

	  To compile this driver as a module, choose M here: the
	  module will be called lpc32xx-keys.

config KEYBOARD_MAPLE
	tristate "Maple bus keyboard"
	depends on SH_DREAMCAST && MAPLE
	help
	  Say Y here if you have a Dreamcast console running Linux and have
	  a keyboard attached to its Maple bus.

	  To compile this driver as a module, choose M here: the
	  module will be called maple_keyb.

config KEYBOARD_MAX7359
	tristate "Maxim MAX7359 Key Switch Controller"
	depends on I2C
	help
	  If you say yes here you get support for the Maxim MAX7359 Key
	  Switch Controller chip. This providers microprocessors with
	  management of up to 64 key switches

	  To compile this driver as a module, choose M here: the
	  module will be called max7359_keypad.

config KEYBOARD_MCS
	tristate "MELFAS MCS Touchkey"
	depends on I2C
	help
	  Say Y here if you have the MELFAS MCS5000/5080 touchkey controller
	  chip in your system.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called mcs_touchkey.

config KEYBOARD_MPR121
	tristate "Freescale MPR121 Touchkey"
	depends on I2C
	help
	  Say Y here if you have Freescale MPR121 touchkey controller
	  chip in your system.

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called mpr121_touchkey.

config KEYBOARD_IMX
	tristate "IMX keypad support"
	depends on ARCH_MXC
	select INPUT_MATRIXKMAP
	help
	  Enable support for IMX keypad port.

	  To compile this driver as a module, choose M here: the
	  module will be called imx_keypad.

config KEYBOARD_NEWTON
	tristate "Newton keyboard"
	select SERIO
	help
	  Say Y here if you have a Newton keyboard on a serial port.

	  To compile this driver as a module, choose M here: the
	  module will be called newtonkbd.

config KEYBOARD_NOMADIK
	tristate "ST-Ericsson Nomadik SKE keyboard"
	depends on (ARCH_NOMADIK || ARCH_U8500)
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use a keypad provided on the SKE controller
	  used on the Ux500 and Nomadik platforms

	  To compile this driver as a module, choose M here: the
	  module will be called nmk-ske-keypad.

config KEYBOARD_NSPIRE
	tristate "TI-NSPIRE built-in keyboard"
	depends on ARCH_NSPIRE && OF
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use the built-in keypad on TI-NSPIRE.

	  To compile this driver as a module, choose M here: the
	  module will be called nspire-keypad.

config KEYBOARD_TEGRA
	tristate "NVIDIA Tegra internal matrix keyboard controller support"
	depends on ARCH_TEGRA && OF
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use a matrix keyboard connected directly
	  to the internal keyboard controller on Tegra SoCs.

	  To compile this driver as a module, choose M here: the
	  module will be called tegra-kbc.

config KEYBOARD_OPENCORES
	tristate "OpenCores Keyboard Controller"
	depends on HAS_IOMEM
	help
	  Say Y here if you want to use the OpenCores Keyboard Controller
	  http://www.opencores.org/project,keyboardcontroller

	  To compile this driver as a module, choose M here; the
	  module will be called opencores-kbd.

config KEYBOARD_PXA27x
	tristate "PXA27x/PXA3xx keypad support"
	depends on PXA27x || PXA3xx || ARCH_MMP
	select INPUT_MATRIXKMAP
	help
	  Enable support for PXA27x/PXA3xx keypad controller.

	  To compile this driver as a module, choose M here: the
	  module will be called pxa27x_keypad.

config KEYBOARD_PXA930_ROTARY
	tristate "PXA930/PXA935 Enhanced Rotary Controller Support"
	depends on CPU_PXA930 || CPU_PXA935
	help
	  Enable support for PXA930/PXA935 Enhanced Rotary Controller.

	  To compile this driver as a module, choose M here: the
	  module will be called pxa930_rotary.

config KEYBOARD_PMIC8XXX
	tristate "Qualcomm PMIC8XXX keypad support"
	depends on MFD_PM8XXX
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to enable the driver for the PMIC8XXX
	  keypad provided as a reference design from Qualcomm. This is intended
	  to support upto 18x8 matrix based keypad design.

	  To compile this driver as a module, choose M here: the module will
	  be called pmic8xxx-keypad.

config KEYBOARD_SAMSUNG
	tristate "Samsung keypad support"
	depends on HAVE_CLK
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use the keypad on your Samsung mobile
	  device.

	  To compile this driver as a module, choose M here: the
	  module will be called samsung-keypad.

config KEYBOARD_GOLDFISH_EVENTS
	depends on GOLDFISH
	tristate "Generic Input Event device for Goldfish"
	help
	  Say Y here to get an input event device for the Goldfish virtual
	  device emulator.

	  To compile this driver as a module, choose M here: the
	  module will be called goldfish-events.

config KEYBOARD_STOWAWAY
	tristate "Stowaway keyboard"
	select SERIO
	help
	  Say Y here if you have a Stowaway keyboard on a serial port.
	  Stowaway compatible keyboards like Dicota Input-PDA keyboard
	  are also supported by this driver.

	  To compile this driver as a module, choose M here: the
	  module will be called stowaway.

config KEYBOARD_ST_KEYSCAN
	tristate "STMicroelectronics keyscan support"
	depends on ARCH_STI || COMPILE_TEST
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use a keypad attached to the keyscan block
	  on some STMicroelectronics SoC devices.

	  To compile this driver as a module, choose M here: the
	  module will be called st-keyscan.

config KEYBOARD_SUNKBD
	tristate "Sun Type 4 and Type 5 keyboard"
	select SERIO
	help
	  Say Y here if you want to use a Sun Type 4 or Type 5 keyboard,
	  connected either to the Sun keyboard connector or to an serial
	  (RS-232) port via a simple adapter.

	  To compile this driver as a module, choose M here: the
	  module will be called sunkbd.

config KEYBOARD_SH_KEYSC
	tristate "SuperH KEYSC keypad support"
	depends on SUPERH || ARCH_SHMOBILE || COMPILE_TEST
	help
	  Say Y here if you want to use a keypad attached to the KEYSC block
	  on SuperH processors such as sh7722 and sh7343.

	  To compile this driver as a module, choose M here: the
	  module will be called sh_keysc.

config KEYBOARD_STMPE
	tristate "STMPE keypad support"
	depends on MFD_STMPE
	depends on OF
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use the keypad controller on STMPE I/O
	  expanders.

	  To compile this driver as a module, choose M here: the module will be
	  called stmpe-keypad.

config KEYBOARD_SUN4I_LRADC
	tristate "Allwinner sun4i low res adc attached tablet keys support"
	depends on ARCH_SUNXI
	help
	  This selects support for the Allwinner low res adc attached tablet
	  keys found on Allwinner sunxi SoCs.

	  To compile this driver as a module, choose M here: the
	  module will be called sun4i-lradc-keys.

config KEYBOARD_DAVINCI
	tristate "TI DaVinci Key Scan"
	depends on ARCH_DAVINCI_DM365
	help
	  Say Y to enable keypad module support for the TI DaVinci
	  platforms (DM365).

	  To compile this driver as a module, choose M here: the
	  module will be called davinci_keyscan.

config KEYBOARD_IPAQ_MICRO
	tristate "Buttons on Micro SoC (iPaq h3100,h3600,h3700)"
	depends on MFD_IPAQ_MICRO
	help
	  Say Y to enable support for the buttons attached to
	  Micro peripheral controller on iPAQ h3100/h3600/h3700

	  To compile this driver as a module, choose M here: the
	  module will be called ipaq-micro-keys.

config KEYBOARD_OMAP
	tristate "TI OMAP keypad support"
	depends on ARCH_OMAP1
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use the OMAP keypad.

	  To compile this driver as a module, choose M here: the
	  module will be called omap-keypad.

config KEYBOARD_OMAP4
	tristate "TI OMAP4+ keypad support"
	depends on OF || ARCH_OMAP2PLUS
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use the OMAP4+ keypad.

	  To compile this driver as a module, choose M here: the
	  module will be called omap4-keypad.

config KEYBOARD_SPEAR
	tristate "ST SPEAR keyboard support"
	depends on PLAT_SPEAR
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use the SPEAR keyboard.

	  To compile this driver as a module, choose M here: the
	  module will be called spear-keboard.

config KEYBOARD_TC3589X
	tristate "TC3589X Keypad support"
	depends on MFD_TC3589X
	select INPUT_MATRIXKMAP
	help
	  Say Y here if you want to use the keypad controller on
	  TC35892/3 I/O expander.

	  To compile this driver as a module, choose M here: the
	  module will be called tc3589x-keypad.

config KEYBOARD_TWL4030
	tristate "TI TWL4030/TWL5030/TPS659x0 keypad support"
	depends on TWL4030_CORE
	select INPUT_MATRIXKMAP
	help
	  Say Y here if your board use the keypad controller on
	  TWL4030 family chips.  It's safe to say enable this
	  even on boards that don't use the keypad controller.

	  To compile this driver as a module, choose M here: the
	  module will be called twl4030_keypad.

config KEYBOARD_XTKBD
	tristate "XT keyboard"
	select SERIO
	help
	  Say Y here if you want to use the old IBM PC/XT keyboard (or
	  compatible) on your system. This is only possible with a
	  parallel port keyboard adapter, you cannot connect it to the
	  keyboard port on a PC that runs Linux.

	  To compile this driver as a module, choose M here: the
	  module will be called xtkbd.

config KEYBOARD_W90P910
	tristate "W90P910 Matrix Keypad support"
	depends on ARCH_W90X900
	select INPUT_MATRIXKMAP
	help
	  Say Y here to enable the matrix keypad on evaluation board
	  based on W90P910.

	  To compile this driver as a module, choose M here: the
	  module will be called w90p910_keypad.

config KEYBOARD_CROS_EC
	tristate "ChromeOS EC keyboard"
	select INPUT_MATRIXKMAP
	depends on MFD_CROS_EC
	help
	  Say Y here to enable the matrix keyboard used by ChromeOS devices
	  and implemented on the ChromeOS EC. You must enable one bus option
	  (MFD_CROS_EC_I2C or MFD_CROS_EC_SPI) to use this.

	  To compile this driver as a module, choose M here: the
	  module will be called cros_ec_keyb.

config KEYBOARD_CAP11XX
	tristate "Microchip CAP11XX based touch sensors"
	depends on OF && I2C
	select REGMAP_I2C
	help
	  Say Y here to enable the CAP11XX touch sensor driver.

	  To compile this driver as a module, choose M here: the
	  module will be called cap11xx.

config KEYBOARD_BCM
	tristate "Broadcom keypad driver"
	depends on OF && HAVE_CLK
	select INPUT_MATRIXKMAP
	default ARCH_BCM_CYGNUS
	help
	  Say Y here if you want to use Broadcom keypad.

	  To compile this driver as a module, choose M here: the
	  module will be called bcm-keypad.

endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 #
# Makefile for the input core drivers.
#

# Each configuration option enables a list of files.

obj-$(CONFIG_INPUT)		+= input-core.o
input-core-y := input.o input-compat.o input-mt.o ff-core.o

obj-$(CONFIG_INPUT_FF_MEMLESS)	+= ff-memless.o
obj-$(CONFIG_INPUT_POLLDEV)	+= input-polldev.o
obj-$(CONFIG_INPUT_SPARSEKMAP)	+= sparse-keymap.o
obj-$(CONFIG_INPUT_MATRIXKMAP)	+= matrix-keymap.o

obj-$(CONFIG_INPUT_MOUSEDEV)	+= mousedev.o
obj-$(CONFIG_INPUT_JOYDEV)	+= joydev.o
obj-$(CONFIG_INPUT_EVDEV)	+= evdev.o
obj-$(CONFIG_INPUT_EVBUG)	+= evbug.o

obj-$(CONFIG_INPUT_KEYBOARD)	+= keyboard/
obj-$(CONFIG_INPUT_MOUSE)	+= mouse/
obj-$(CONFIG_INPUT_JOYSTICK)	+= joystick/
obj-$(CONFIG_INPUT_TABLET)	+= tablet/
obj-$(CONFIG_INPUT_TOUCHSCREEN)	+= touchscreen/
obj-$(CONFIG_INPUT_MISC)	+= misc/

obj-$(CONFIG_INPUT_APMPOWER)	+= apm-power.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               #
# Input core configuration
#
config SERIO
	tristate "Serial I/O support"
	default y
	help
	  Say Yes here if you have any input device that uses serial I/O to
	  communicate with the system. This includes the
	  		* standard AT keyboard and PS/2 mouse *
	  as well as serial mice, Sun keyboards, some joysticks and 6dof
	  devices and more.

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called serio.

config ARCH_MIGHT_HAVE_PC_SERIO
	bool
	help
	  Select this config option from the architecture Kconfig if
	  the architecture might use a PC serio device (i8042) to
	  communicate with keyboard, mouse, etc.

if SERIO

config SERIO_I8042
	tristate "i8042 PC Keyboard controller"
	default y
	depends on ARCH_MIGHT_HAVE_PC_SERIO
	help
	  i8042 is the chip over which the standard AT keyboard and PS/2
	  mouse are connected to the computer. If you use these devices,
	  you'll need to say Y here.

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called i8042.

config SERIO_SERPORT
	tristate "Serial port line discipline"
	default y
	depends on TTY
	help
	  Say Y here if you plan to use an input device (mouse, joystick,
	  tablet, 6dof) that communicates over the RS232 serial (COM) port.

	  More information is available: <file:Documentation/input/input.txt>

	  If unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called serport.

config SERIO_CT82C710
	tristate "ct82c710 Aux port controller"
	depends on X86
	help
	  Say Y here if you have a Texas Instruments TravelMate notebook
	  equipped with the ct82c710 chip and want to use a mouse connected
	  to the "QuickPort".

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called ct82c710.

config SERIO_Q40KBD
	tristate "Q40 keyboard controller"
	depends on Q40

config SERIO_PARKBD
	tristate "Parallel port keyboard adapter"
	depends on PARPORT
	help
	  Say Y here if you built a simple parallel port adapter to attach
	  an additional AT keyboard, XT keyboard or PS/2 mouse.

	  More information is available: <file:Documentation/input/input.txt>

	  If unsure, say N.

	  To compile this driver as a module, choose M here: the
	  module will be called parkbd.

config SERIO_RPCKBD
	tristate "Acorn RiscPC keyboard controller"
	depends on ARCH_ACORN
	default y
	help
	  Say Y here if you have the Acorn RiscPC and want to use an AT
	  keyboard connected to its keyboard controller.

	  To compile this driver as a module, choose M here: the
	  module will be called rpckbd.

config SERIO_AT32PSIF
	tristate "AVR32 PSIF PS/2 keyboard and mouse controller"
	depends on AVR32
	help
	  Say Y here if you want to use the PSIF peripheral on AVR32 devices
	  and connect a PS/2 keyboard and/or mouse to it.

	  To compile this driver as a module, choose M here: the module will
	  be called at32psif.

config SERIO_AMBAKMI
	tristate "AMBA KMI keyboard controller"
	depends on ARM_AMBA

config SERIO_SA1111
	tristate "Intel SA1111 keyboard controller"
	depends on SA1111

config SERIO_GSCPS2
	tristate "HP GSC PS/2 keyboard and PS/2 mouse controller"
	depends on GSC
	default y
	help
	  This driver provides support for the PS/2 ports on PA-RISC machines
	  over which HP PS/2 keyboards and PS/2 mice may be connected.
	  If you use these devices, you'll need to say Y here.

	  It's safe to enable this driver, so if unsure, say Y.

	  To compile this driver as a module, choose M here: the
	  module will be called gscps2.

config HP_SDC
	tristate "HP System Device Controller i8042 Support"
	depends on (GSC || HP300) && SERIO
	default y
	help
	  This option enables support for the "System Device
	  Controller", an i8042 carrying microcode to manage a
	  few miscellaneous devices on some Hewlett Packard systems.
	  The SDC itself contains a 10ms resolution timer/clock capable
	  of delivering interrupts on a periodic and one-shot basis.
	  The SDC may also be connected to a battery-backed real-time
	  clock, a basic audio waveform generator, and an HP-HIL Master
	  Link Controller serving up to seven input devices.

	  By itself this option is rather useless, but enabling it will
	  enable selection of drivers for the abovementioned devices.
	  It is, however, incompatible with the old, reliable HIL keyboard
	  driver, and the new HIL driver is experimental, so if you plan
	  to use a HIL keyboard as your primary keyboard, you may wish
	  to keep using that driver until the new HIL drivers have had
	  more testing.

config HIL_MLC
	tristate "HIL MLC Support (needed for HIL input devices)"
	depends on HP_SDC

config SERIO_PCIPS2
	tristate "PCI PS/2 keyboard and PS/2 mouse controller"
	depends on PCI
	help
	  Say Y here if you have a Mobility Docking station with PS/2
	  keyboard and mice ports.

	  To compile this driver as a module, choose M here: the
	  module will be called pcips2.

config SERIO_MACEPS2
	tristate "SGI O2 MACE PS/2 controller"
	depends on SGI_IP32
	help
	  Say Y here if you have SGI O2 workstation and want to use its
	  PS/2 ports.

	  To compile this driver as a module, choose M here: the
	  module will be called maceps2.

config SERIO_LIBPS2
	tristate "PS/2 driver library"
	depends on SERIO_I8042 || SERIO_I8042=n
	help
	  Say Y here if you are using a driver for device connected
	  to a PS/2 port, such as PS/2 mouse or standard AT keyboard.

	  To compile this driver as a module, choose M here: the
	  module will be called libps2.

config SERIO_RAW
	tristate "Raw access to serio ports"
	help
	  Say Y here if you want to have raw access to serio ports, such as
	  AUX ports on i8042 keyboard controller. Each serio port that is
	  bound to this driver will be accessible via a char device with
	  major 10 and dynamically allocated minor. The driver will try
	  allocating minor 1 (that historically corresponds to /dev/psaux)
	  first. To bind this driver to a serio port use sysfs interface:

	      echo -n "serio_raw" > /sys/bus/serio/devices/serioX/drvctl

	  To compile this driver as a module, choose M here: the
	  module will be called serio_raw.

config SERIO_XILINX_XPS_PS2
	tristate "Xilinx XPS PS/2 Controller Support"
	depends on PPC || MICROBLAZE
	help
	  This driver supports XPS PS/2 IP from the Xilinx EDK on
	  PowerPC platform.

	  To compile this driver as a module, choose M here: the
	  module will be called xilinx_ps2.

config SERIO_ALTERA_PS2
	tristate "Altera UP PS/2 controller"
	depends on HAS_IOMEM
	help
	  Say Y here if you have Altera University Program PS/2 ports.

	  To compile this driver as a module, choose M here: the
	  module will be called altera_ps2.

config SERIO_AMS_DELTA
	tristate "Amstrad Delta (E3) mailboard support"
	depends on MACH_AMS_DELTA
	default y
	---help---
	  Say Y here if you have an E3 and want to use its mailboard,
	  or any standard AT keyboard connected to the mailboard port.

	  When used for the E3 mailboard, a non-standard key table
	  must be loaded from userspace, possibly using udev extras
	  provided keymap helper utility.

	  To compile this driver as a module, choose M here;
	  the module will be called ams_delta_serio.

config SERIO_PS2MULT
	tristate "TQC PS/2 multiplexer"
	help
	  Say Y here if you have the PS/2 line multiplexer like the one
	  present on TQC boards.

	  To compile this driver as a module, choose M here: the
	  module will be called ps2mult.

config SERIO_ARC_PS2
	tristate "ARC PS/2 support"
	help
	  Say Y here if you have an ARC FPGA platform with a PS/2
	  controller in it.

	  To compile this driver as a module, choose M here; the module
	  will be called arc_ps2.

config SERIO_APBPS2
	tristate "GRLIB APBPS2 PS/2 keyboard/mouse controller"
	depends on OF
	help
	  Say Y here if you want support for GRLIB APBPS2 peripherals used
	  to connect to PS/2 keyboard and/or mouse.

	  To compile this driver as a module, choose M here: the module will
	  be called apbps2.

config SERIO_OLPC_APSP
	tristate "OLPC AP-SP input support"
	depends on OLPC || COMPILE_TEST
	help
	  Say Y here if you want support for the keyboard and touchpad included
	  in the OLPC XO-1.75 and XO-4 laptops.

	  To compile this driver as a module, choose M here: the module will
	  be called olpc_apsp.

config HYPERV_KEYBOARD
	tristate "Microsoft Synthetic Keyboard driver"
	depends on HYPERV
	default HYPERV
	help
	  Select this option to enable the Hyper-V Keyboard driver.

	  To compile this driver as a module, choose M here: the module will
	  be called hyperv_keyboard.

config SERIO_SUN4I_PS2
	tristate "Allwinner A10 PS/2 controller support"
	depends on ARCH_SUNXI || COMPILE_TEST
	help
	  This selects support for the PS/2 Host Controller on
	  Allwinner A10.

	  To compile this driver as a module, choose M here: the
	  module will be called sun4i-ps2.

endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #
# Makefile for the input core drivers.
#

# Each configuration option enables a list of files.

obj-$(CONFIG_SERIO)		+= serio.o
obj-$(CONFIG_SERIO_I8042)	+= i8042.o
obj-$(CONFIG_SERIO_PARKBD)	+= parkbd.o
obj-$(CONFIG_SERIO_SERPORT)	+= serport.o
obj-$(CONFIG_SERIO_CT82C710)	+= ct82c710.o
obj-$(CONFIG_SERIO_RPCKBD)	+= rpckbd.o
obj-$(CONFIG_SERIO_SA1111)	+= sa1111ps2.o
obj-$(CONFIG_SERIO_AMBAKMI)	+= ambakmi.o
obj-$(CONFIG_SERIO_AT32PSIF)	+= at32psif.o
obj-$(CONFIG_SERIO_Q40KBD)	+= q40kbd.o
obj-$(CONFIG_SERIO_GSCPS2)	+= gscps2.o
obj-$(CONFIG_HP_SDC)		+= hp_sdc.o
obj-$(CONFIG_HIL_MLC)		+= hp_sdc_mlc.o hil_mlc.o
obj-$(CONFIG_SERIO_PCIPS2)	+= pcips2.o
obj-$(CONFIG_SERIO_PS2MULT)	+= ps2mult.o
obj-$(CONFIG_SERIO_MACEPS2)	+= maceps2.o
obj-$(CONFIG_SERIO_LIBPS2)	+= libps2.o
obj-$(CONFIG_SERIO_RAW)		+= serio_raw.o
obj-$(CONFIG_SERIO_AMS_DELTA)	+= ams_delta_serio.o
obj-$(CONFIG_SERIO_XILINX_XPS_PS2)	+= xilinx_ps2.o
obj-$(CONFIG_SERIO_ALTERA_PS2)	+= altera_ps2.o
obj-$(CONFIG_SERIO_ARC_PS2)	+= arc_ps2.o
obj-$(CONFIG_SERIO_APBPS2)	+= apbps2.o
obj-$(CONFIG_SERIO_OLPC_APSP)	+= olpc_apsp.o
obj-$(CONFIG_HYPERV_KEYBOARD)	+= hyperv-keyboard.o
obj-$(CONFIG_SERIO_SUN4I_PS2)	+= sun4i-ps2.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              config VHOST_NET
	tristate "Host kernel accelerator for virtio net"
	depends on NET && EVENTFD && (TUN || !TUN) && (MACVTAP || !MACVTAP)
	select VHOST
	select VHOST_RING
	---help---
	  This kernel module can be loaded in host kernel to accelerate
	  guest networking with virtio_net. Not to be confused with virtio_net
	  module itself which needs to be loaded in guest kernel.

	  To compile this driver as a module, choose M here: the module will
	  be called vhost_net.

config VHOST_SCSI
	tristate "VHOST_SCSI TCM fabric driver"
	depends on TARGET_CORE && EVENTFD && m
	select VHOST
	select VHOST_RING
	default n
	---help---
	Say M here to enable the vhost_scsi TCM fabric module
	for use with virtio-scsi guests

config VHOST_RING
	tristate
	---help---
	  This option is selected by any driver which needs to access
	  the host side of a virtio ring.

config VHOST
	tristate
	---help---
	  This option is selected by any driver which needs to access
	  the core of vhost.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               #
# Makefile for the Linux kernel device drivers.
#
# 15 Sep 2000, Christoph Hellwig <hch@infradead.org>
# Rewritten to use lists instead of if-statements.
#

obj-y				+= irqchip/
obj-y				+= bus/

obj-$(CONFIG_GENERIC_PHY)	+= phy/

# GPIO must come after pinctrl as gpios may need to mux pins etc
obj-y				+= pinctrl/
obj-y				+= gpio/
obj-y				+= pwm/
obj-$(CONFIG_PCI)		+= pci/
obj-$(CONFIG_PARISC)		+= parisc/
obj-$(CONFIG_RAPIDIO)		+= rapidio/
obj-y				+= video/
obj-y				+= idle/

# IPMI must come before ACPI in order to provide IPMI opregion support
obj-$(CONFIG_IPMI_HANDLER)	+= char/ipmi/

obj-$(CONFIG_ACPI)		+= acpi/
obj-$(CONFIG_SFI)		+= sfi/
# PnP must come after ACPI since it will eventually need to check if acpi
# was used and do nothing if so
obj-$(CONFIG_PNP)		+= pnp/
obj-y				+= amba/
# Many drivers will want to use DMA so this has to be made available
# really early.
obj-$(CONFIG_DMADEVICES)	+= dma/

# SOC specific infrastructure drivers.
obj-y				+= soc/

obj-$(CONFIG_VIRTIO)		+= virtio/
obj-$(CONFIG_XEN)		+= xen/

# regulators early, since some subsystems rely on them to initialize
obj-$(CONFIG_REGULATOR)		+= regulator/

# reset controllers early, since gpu drivers might rely on them to initialize
obj-$(CONFIG_RESET_CONTROLLER)	+= reset/

# tty/ comes before char/ so that the VT console is the boot-time
# default.
obj-y				+= tty/
obj-y				+= char/

# iommu/ comes before gpu as gpu are using iommu controllers
obj-$(CONFIG_IOMMU_SUPPORT)	+= iommu/

# gpu/ comes after char for AGP vs DRM startup and after iommu
obj-y				+= gpu/

obj-$(CONFIG_CONNECTOR)		+= connector/

# i810fb and intelfb depend on char/agp/
obj-$(CONFIG_FB_I810)           += video/fbdev/i810/
obj-$(CONFIG_FB_INTEL)          += video/fbdev/intelfb/

obj-$(CONFIG_PARPORT)		+= parport/
obj-y				+= base/ block/ misc/ mfd/ nfc/
obj-$(CONFIG_DMA_SHARED_BUFFER) += dma-buf/
obj-$(CONFIG_NUBUS)		+= nubus/
obj-y				+= macintosh/
obj-$(CONFIG_IDE)		+= ide/
obj-$(CONFIG_SCSI)		+= scsi/
obj-$(CONFIG_ATA)		+= ata/
obj-$(CONFIG_TARGET_CORE)	+= target/
obj-$(CONFIG_MTD)		+= mtd/
obj-$(CONFIG_SPI)		+= spi/
obj-$(CONFIG_SPMI)		+= spmi/
obj-y				+= hsi/
obj-y				+= net/
obj-$(CONFIG_ATM)		+= atm/
obj-$(CONFIG_FUSION)		+= message/
obj-y				+= firewire/
obj-$(CONFIG_UIO)		+= uio/
obj-$(CONFIG_VFIO)		+= vfio/
obj-y				+= cdrom/
obj-y				+= auxdisplay/
obj-$(CONFIG_PCCARD)		+= pcmcia/
obj-$(CONFIG_DIO)		+= dio/
obj-$(CONFIG_SBUS)		+= sbus/
obj-$(CONFIG_ZORRO)		+= zorro/
obj-$(CONFIG_ATA_OVER_ETH)	+= block/aoe/
obj-$(CONFIG_PARIDE) 		+= block/paride/
obj-$(CONFIG_TC)		+= tc/
obj-$(CONFIG_UWB)		+= uwb/
obj-$(CONFIG_USB_PHY)		+= usb/
obj-$(CONFIG_USB)		+= usb/
obj-$(CONFIG_PCI)		+= usb/
obj-$(CONFIG_USB_GADGET)	+= usb/
obj-$(CONFIG_SERIO)		+= input/serio/
obj-$(CONFIG_GAMEPORT)		+= input/gameport/
obj-$(CONFIG_INPUT)		+= input/
obj-$(CONFIG_I2O)		+= message/
obj-$(CONFIG_RTC_LIB)		+= rtc/
obj-y				+= i2c/ media/
obj-$(CONFIG_PPS)		+= pps/
obj-$(CONFIG_PTP_1588_CLOCK)	+= ptp/
obj-$(CONFIG_W1)		+= w1/
obj-$(CONFIG_POWER_SUPPLY)	+= power/
obj-$(CONFIG_HWMON)		+= hwmon/
obj-$(CONFIG_THERMAL)		+= thermal/
obj-$(CONFIG_WATCHDOG)		+= watchdog/
obj-$(CONFIG_MD)		+= md/
obj-$(CONFIG_BT)		+= bluetooth/
obj-$(CONFIG_ACCESSIBILITY)	+= accessibility/
obj-$(CONFIG_ISDN)		+= isdn/
obj-$(CONFIG_EDAC)		+= edac/
obj-$(CONFIG_EISA)		+= eisa/
obj-y				+= lguest/
obj-$(CONFIG_CPU_FREQ)		+= cpufreq/
obj-$(CONFIG_CPU_IDLE)		+= cpuidle/
obj-y				+= mmc/
obj-$(CONFIG_MEMSTICK)		+= memstick/
obj-y				+= leds/
obj-$(CONFIG_INFINIBAND)	+= infiniband/
obj-$(CONFIG_SGI_SN)		+= sn/
obj-y				+= firmware/
obj-$(CONFIG_CRYPTO)		+= crypto/
obj-$(CONFIG_SUPERH)		+= sh/
obj-$(CONFIG_ARCH_SHMOBILE)	+= sh/
ifndef CONFIG_ARCH_USES_GETTIMEOFFSET
obj-y				+= clocksource/
endif
obj-$(CONFIG_DCA)		+= dca/
obj-$(CONFIG_HID)		+= hid/
obj-$(CONFIG_PPC_PS3)		+= ps3/
obj-$(CONFIG_OF)		+= of/
obj-$(CONFIG_SSB)		+= ssb/
obj-$(CONFIG_BCMA)		+= bcma/
obj-$(CONFIG_VHOST_RING)	+= vhost/
obj-$(CONFIG_VLYNQ)		+= vlynq/
obj-$(CONFIG_STAGING)		+= staging/
obj-y				+= platform/
#common clk code
obj-y				+= clk/

obj-$(CONFIG_MAILBOX)		+= mailbox/
obj-$(CONFIG_HWSPINLOCK)	+= hwspinlock/
obj-$(CONFIG_REMOTEPROC)	+= remoteproc/
obj-$(CONFIG_RPMSG)		+= rpmsg/

# Virtualization drivers
obj-$(CONFIG_VIRT_DRIVERS)	+= virt/
obj-$(CONFIG_HYPERV)		+= hv/

obj-$(CONFIG_PM_DEVFREQ)	+= devfreq/
obj-$(CONFIG_EXTCON)		+= extcon/
obj-$(CONFIG_MEMORY)		+= memory/
obj-$(CONFIG_IIO)		+= iio/
obj-$(CONFIG_VME_BUS)		+= vme/
obj-$(CONFIG_IPACK_BUS)		+= ipack/
obj-$(CONFIG_NTB)		+= ntb/
obj-$(CONFIG_FMC)		+= fmc/
obj-$(CONFIG_POWERCAP)		+= powercap/
obj-$(CONFIG_MCB)		+= mcb/
obj-$(CONFIG_RAS)		+= ras/
obj-$(CONFIG_THUNDERBOLT)	+= thunderbolt/
obj-$(CONFIG_CORESIGHT)		+= hwtracing/coresight/
obj-$(CONFIG_ANDROID)		+= android/

obj-$(CONFIG_XENOMAI) += xenomai/
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         obj-$(CONFIG_VHOST_NET) += vhost_net.o
vhost_net-y := net.o

obj-$(CONFIG_VHOST_SCSI) += vhost_scsi.o
vhost_scsi-y := scsi.o

obj-$(CONFIG_VHOST_RING) += vringh.o
obj-$(CONFIG_VHOST)	+= vhost.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              #
# humidity sensor drivers
#
menu "Humidity sensors"

config DHT11
	tristate "DHT11 (and compatible sensors) driver"
	depends on GPIOLIB
	help
	  This driver supports reading data via a single interrupt
	  generating GPIO line. Currently tested are DHT11 and DHT22.
	  Other sensors should work as well as long as they speak the
	  same protocol.

config SI7005
	tristate "SI7005 relative humidity and temperature sensor"
	depends on I2C
	help
	  Say yes here to build support for the Silabs Si7005 relative
	  humidity and temperature sensor.

	  To compile this driver as a module, choose M here: the module
	  will be called si7005.

config SI7020
	tristate "Si7013/20/21 Relative Humidity and Temperature Sensors"
	depends on I2C
	help
	  Say yes here to build support for the Silicon Labs Si7013/20/21
	  Relative Humidity and Temperature Sensors.

	  To compile this driver as a module, choose M here: the module
	  will be called si7020.

endmenu
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     #
# Makefile for IIO humidity sensor drivers
#

obj-$(CONFIG_DHT11) += dht11.o
obj-$(CONFIG_SI7005) += si7005.o
obj-$(CONFIG_SI7020) += si7020.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               #
# Makefile for industrial I/O DAC drivers
#

# When adding new entries keep the list in alphabetical order
obj-$(CONFIG_AD5360) += ad5360.o
obj-$(CONFIG_AD5380) += ad5380.o
obj-$(CONFIG_AD5421) += ad5421.o
obj-$(CONFIG_AD5624R_SPI) += ad5624r_spi.o
obj-$(CONFIG_AD5064) += ad5064.o
obj-$(CONFIG_AD5504) += ad5504.o
obj-$(CONFIG_AD5446) += ad5446.o
obj-$(CONFIG_AD5449) += ad5449.o
obj-$(CONFIG_AD5755) += ad5755.o
obj-$(CONFIG_AD5764) += ad5764.o
obj-$(CONFIG_AD5791) += ad5791.o
obj-$(CONFIG_AD5686) += ad5686.o
obj-$(CONFIG_AD7303) += ad7303.o
obj-$(CONFIG_MAX517) += max517.o
obj-$(CONFIG_MAX5821) += max5821.o
obj-$(CONFIG_MCP4725) += mcp4725.o
obj-$(CONFIG_MCP4922) += mcp4922.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  #
# DAC drivers
#
# When adding new entries keep the list in alphabetical order

menu "Digital to analog converters"

config AD5064
	tristate "Analog Devices AD5064 and similar multi-channel DAC driver"
	depends on (SPI_MASTER && I2C!=m) || I2C
	help
	  Say yes here to build support for Analog Devices AD5024, AD5025, AD5044,
	  AD5045, AD5064, AD5064-1, AD5065, AD5628, AD5629R, AD5648, AD5666, AD5668,
	  AD5669R Digital to Analog Converter.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5064.

config AD5360
	tristate "Analog Devices AD5360/61/62/63/70/71/73 DAC driver"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD5360, AD5361,
	  AD5362, AD5363, AD5370, AD5371, AD5373 multi-channel
	  Digital to Analog Converters (DAC).

	  To compile this driver as module choose M here: the module will be called
	  ad5360.

config AD5380
	tristate "Analog Devices AD5380/81/82/83/84/90/91/92 DAC driver"
	depends on (SPI_MASTER && I2C!=m) || I2C
	select REGMAP_I2C if I2C
	select REGMAP_SPI if SPI_MASTER
	help
	  Say yes here to build support for Analog Devices AD5380, AD5381,
	  AD5382, AD5383, AD5384, AD5390, AD5391, AD5392 multi-channel
	  Digital to Analog Converters (DAC).

	  To compile this driver as module choose M here: the module will be called
	  ad5380.

config AD5421
	tristate "Analog Devices AD5421 DAC driver"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD5421 loop-powered
	  digital-to-analog convertors (DAC).

	  To compile this driver as module choose M here: the module will be called
	  ad5421.

config AD5446
	tristate "Analog Devices AD5446 and similar single channel DACs driver"
	depends on (SPI_MASTER && I2C!=m) || I2C
	help
	  Say yes here to build support for Analog Devices AD5300, AD5301, AD5310,
	  AD5311, AD5320, AD5321, AD5444, AD5446, AD5450, AD5451, AD5452, AD5453,
	  AD5512A, AD5541A, AD5542A, AD5543, AD5553, AD5601, AD5602, AD5611, AD5612,
	  AD5620, AD5621, AD5622, AD5640, AD5641, AD5660, AD5662 DACs.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5446.

config AD5449
	tristate "Analog Devices AD5449 and similar DACs driver"
	depends on SPI_MASTER
	help
	  Say yes here to build support for Analog Devices AD5415, AD5426, AD5429,
	  AD5432, AD5439, AD5443, AD5449 Digital to Analog Converters.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5449.

config AD5504
	tristate "Analog Devices AD5504/AD5501 DAC SPI driver"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD5504, AD5501,
	  High Voltage Digital to Analog Converter.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5504.

config AD5624R_SPI
	tristate "Analog Devices AD5624/44/64R DAC spi driver"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD5624R, AD5644R and
	  AD5664R converters (DAC). This driver uses the common SPI interface.

config AD5686
	tristate "Analog Devices AD5686R/AD5685R/AD5684R DAC SPI driver"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD5686R, AD5685R,
	  AD5684R, AD5791 Voltage Output Digital to
	  Analog Converter.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5686.

config AD5755
	tristate "Analog Devices AD5755/AD5755-1/AD5757/AD5735/AD5737 DAC driver"
	depends on SPI_MASTER
	help
	  Say yes here to build support for Analog Devices AD5755, AD5755-1,
	  AD5757, AD5735, AD5737 quad channel Digital to
	  Analog Converter.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5755.

config AD5764
	tristate "Analog Devices AD5764/64R/44/44R DAC driver"
	depends on SPI_MASTER
	help
	  Say yes here to build support for Analog Devices AD5764, AD5764R, AD5744,
	  AD5744R Digital to Analog Converter.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5764.

config AD5791
	tristate "Analog Devices AD5760/AD5780/AD5781/AD5790/AD5791 DAC SPI driver"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD5760, AD5780,
	  AD5781, AD5790, AD5791 High Resolution Voltage Output Digital to
	  Analog Converter.

	  To compile this driver as a module, choose M here: the
	  module will be called ad5791.

config AD7303
	tristate "Analog Devices AD7303 DAC driver"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD7303 Digital to Analog
	  Converters (DAC).

	  To compile this driver as module choose M here: the module will be called
	  ad7303.

config MAX517
	tristate "Maxim MAX517/518/519/520/521 DAC driver"
	depends on I2C
	help
	  If you say yes here you get support for the following Maxim chips
	  (I2C 8-Bit DACs with rail-to-rail outputs):
	  MAX517 - Single channel, single reference
	  MAX518 - Dual channel, ref=Vdd
	  MAX519 - Dual channel, dual reference
	  MAX520 - Quad channel, quad reference
	  MAX521 - Octal channel, independent ref for ch0-3, shared ref for ch4-7

	  This driver can also be built as a module.  If so, the module
	  will be called max517.

config MAX5821
	tristate "Maxim MAX5821 DAC driver"
	depends on I2C
	depends on OF
	help
	  Say yes here to build support for Maxim MAX5821
	  10 bits DAC.

config MCP4725
	tristate "MCP4725 DAC driver"
	depends on I2C
	---help---
	  Say Y here if you want to build a driver for the Microchip
	  MCP 4725 12-bit digital-to-analog converter (DAC) with I2C
	  interface.

	  To compile this driver as a module, choose M here: the module
	  will be called mcp4725.

config MCP4922
	tristate "MCP4902, MCP4912, MCP4922 DAC driver"
	depends on SPI
	help
	  Say yes here to build the driver for the Microchip MCP4902
	  MCP4912, and MCP4922 DAC devices.

	  To compile this driver as a module, choose M here: the module
	  will be called mcp4922.

endmenu
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #
# Frequency
#	Direct Digital Synthesis drivers (DDS)
#	Clock Distribution device drivers
#	Phase-Locked Loop (PLL) frequency synthesizers
#
# When adding new entries keep the list in alphabetical order

menu "Frequency Synthesizers DDS/PLL"

menu "Clock Generator/Distribution"

config AD9523
	tristate "Analog Devices AD9523 Low Jitter Clock Generator"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices AD9523 Low Jitter
	  Clock Generator. The driver provides direct access via sysfs.

	  To compile this driver as a module, choose M here: the
	  module will be called ad9523.

endmenu

#
# Phase-Locked Loop (PLL) frequency synthesizers
#

menu "Phase-Locked Loop (PLL) frequency synthesizers"

config ADF4350
	tristate "Analog Devices ADF4350/ADF4351 Wideband Synthesizers"
	depends on SPI
	help
	  Say yes here to build support for Analog Devices  ADF4350/ADF4351
	  Wideband Synthesizers. The driver provides direct access via sysfs.

	  To compile this driver as a module, choose M here: the
	  module will be called adf4350.

endmenu
endmenu
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #
# Makefile iio/frequency
#

# When adding new entries keep the list in alphabetical order
obj-$(CONFIG_AD9523) += ad9523.o
obj-$(CONFIG_ADF4350) += adf4350.o
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                include ../scripts/Makefile.include

# The default target of this Makefile is...
all:

include config/utilities.mak

# Define V to have a more verbose compile.
#
# Define VF to have a more verbose feature check output.
#
# Define O to save output files in a separate directory.
#
# Define ARCH as name of target architecture if you want cross-builds.
#
# Define CROSS_COMPILE as prefix name of compiler if you want cross-builds.
#
# Define NO_LIBPERL to disable perl script extension.
#
# Define NO_LIBPYTHON to disable python script extension.
#
# Define PYTHON to point to the python binary if the default
# `python' is not correct; for example: PYTHON=python2
#
# Define PYTHON_CONFIG to point to the python-config binary if
# the default `$(PYTHON)-config' is not correct.
#
# Define ASCIIDOC8 if you want to format documentation with AsciiDoc 8
#
# Define DOCBOOK_XSL_172 if you want to format man pages with DocBook XSL v1.72.
#
# Define LDFLAGS=-static to build a static binary.
#
# Define EXTRA_CFLAGS=-m64 or EXTRA_CFLAGS=-m32 as appropriate for cross-builds.
#
# Define NO_DWARF if you do not want debug-info analysis feature at all.
#
# Define WERROR=0 to disable treating any warnings as errors.
#
# Define NO_NEWT if you do not want TUI support. (deprecated)
#
# Define NO_SLANG if you do not want TUI support.
#
# Define NO_GTK2 if you do not want GTK+ GUI support.
#
# Define NO_DEMANGLE if you do not want C++ symbol demangling.
#
# Define NO_LIBELF if you do not want libelf dependency (e.g. cross-builds)
#
# Define NO_LIBUNWIND if you do not want libunwind dependency for dwarf
# backtrace post unwind.
#
# Define NO_BACKTRACE if you do not want stack backtrace debug feature
#
# Define NO_LIBNUMA if you do not want numa perf benchmark
#
# Define NO_LIBAUDIT if you do not want libaudit support
#
# Define NO_LIBBIONIC if you do not want bionic support
#
# Define NO_LIBDW_DWARF_UNWIND if you do not want libdw support
# for dwarf backtrace post unwind.
#
# Define NO_PERF_READ_VDSO32 if you do not want to build perf-read-vdso32
# for reading the 32-bit compatibility VDSO in 64-bit mode
#
# Define NO_PERF_READ_VDSOX32 if you do not want to build perf-read-vdsox32
# for reading the x32 mode 32-bit compatibility VDSO in 64-bit mode
#
# Define NO_ZLIB if you do not want to support compressed kernel modules
#
# Define LIBBABELTRACE if you DO want libbabeltrace support
# for CTF data format.
#
# Define NO_LZMA if you do not want to support compressed (xz) kernel modules

ifeq ($(srctree),)
srctree := $(patsubst %/,%,$(dir $(shell pwd)))
srctree := $(patsubst %/,%,$(dir $(srctree)))
#$(info Determined 'srctree' to be $(srctree))
endif

ifneq ($(objtree),)
#$(info Determined 'objtree' to be $(objtree))
endif

ifneq ($(OUTPUT),)
#$(info Determined 'OUTPUT' to be $(OUTPUT))
# Adding $(OUTPUT) as a directory to look for source files,
# because use generated output files as sources dependency
# for flex/bison parsers.
VPATH += $(OUTPUT)
export VPATH
endif

ifeq ($(V),1)
  Q =
else
  Q = @
endif

# Do not use make's built-in rules
# (this improves performance and avoids hard-to-debug behaviour);
MAKEFLAGS += -r

$(OUTPUT)PERF-VERSION-FILE: ../../.git/HEAD
	$(Q)$(SHELL_PATH) util/PERF-VERSION-GEN $(OUTPUT)
	$(Q)touch $(OUTPUT)PERF-VERSION-FILE

CC = $(CROSS_COMPILE)gcc
LD = $(CROSS_COMPILE)ld
AR = $(CROSS_COMPILE)ar
PKG_CONFIG = $(CROSS_COMPILE)pkg-config

RM      = rm -f
LN      = ln -f
MKDIR   = mkdir
FIND    = find
INSTALL = install
FLEX    = flex
BISON   = bison
STRIP   = strip

LIB_DIR          = $(srctree)/tools/lib/api/
TRACE_EVENT_DIR = $(srctree)/tools/lib/traceevent/

# include config/Makefile by default and rule out
# non-config cases
config := 1

NON_CONFIG_TARGETS := clean TAGS tags cscope help

ifdef MAKECMDGOALS
ifeq ($(filter-out $(NON_CONFIG_TARGETS),$(MAKECMDGOALS)),)
  config := 0
endif
endif

ifeq ($(config),1)
include config/Makefile
endif

export prefix bindir sharedir sysconfdir DESTDIR

# sparse is architecture-neutral, which means that we need to tell it
# explicitly what architecture to check for. Fix this up for yours..
SPARSE_FLAGS = -D__BIG_ENDIAN__ -D__powerpc__

# Guard against environment variables
PYRF_OBJS =
SCRIPT_SH =

SCRIPT_SH += perf-archive.sh
SCRIPT_SH += perf-with-kcore.sh

grep-libs = $(filter -l%,$(1))
strip-libs = $(filter-out -l%,$(1))

ifneq ($(OUTPUT),)
  TE_PATH=$(OUTPUT)
ifneq ($(subdir),)
  LIB_PATH=$(OUTPUT)/../lib/api/
else
  LIB_PATH=$(OUTPUT)
endif
else
  TE_PATH=$(TRACE_EVENT_DIR)
  LIB_PATH=$(LIB_DIR)
endif

LIBTRACEEVENT = $(TE_PATH)libtraceevent.a
export LIBTRACEEVENT

LIBAPI = $(LIB_PATH)libapi.a
export LIBAPI

# python extension build directories
PYTHON_EXTBUILD     := $(OUTPUT)python_ext_build/
PYTHON_EXTBUILD_LIB := $(PYTHON_EXTBUILD)lib/
PYTHON_EXTBUILD_TMP := $(PYTHON_EXTBUILD)tmp/
export PYTHON_EXTBUILD_LIB PYTHON_EXTBUILD_TMP

python-clean := $(call QUIET_CLEAN, python) $(RM) -r $(PYTHON_EXTBUILD) $(OUTPUT)python/perf.so

PYTHON_EXT_SRCS := $(shell grep -v ^\# util/python-ext-sources)
PYTHON_EXT_DEPS := util/python-ext-sources util/setup.py $(LIBTRACEEVENT) $(LIBAPI)

$(OUTPUT)python/perf.so: $(PYTHON_EXT_SRCS) $(PYTHON_EXT_DEPS)
	$(QUIET_GEN)CFLAGS='$(CFLAGS)' $(PYTHON_WORD) util/setup.py \
	  --quiet build_ext; \
	mkdir -p $(OUTPUT)python && \
	cp $(PYTHON_EXTBUILD_LIB)perf.so $(OUTPUT)python/
#
# No Perl scripts right now:
#

SCRIPTS = $(patsubst %.sh,%,$(SCRIPT_SH))

PROGRAMS += $(OUTPUT)perf

ifndef NO_PERF_READ_VDSO32
PROGRAMS += $(OUTPUT)perf-read-vdso32
endif

ifndef NO_PERF_READ_VDSOX32
PROGRAMS += $(OUTPUT)perf-read-vdsox32
endif

# what 'all' will build and 'install' will install, in perfexecdir
ALL_PROGRAMS = $(PROGRAMS) $(SCRIPTS)

# what 'all' will build but not install in perfexecdir
OTHER_PROGRAMS = $(OUTPUT)perf

# Set paths to tools early so that they can be used for version tests.
ifndef SHELL_PATH
  SHELL_PATH = /bin/sh
endif
ifndef PERL_PATH
  PERL_PATH = /usr/bin/perl
endif

export PERL_PATH

LIB_FILE=$(OUTPUT)libperf.a

PERFLIBS = $(LIB_FILE) $(LIBAPI) $(LIBTRACEEVENT)

# We choose to avoid "if .. else if .. else .. endif endif"
# because maintaining the nesting to match is a pain.  If
# we had "elif" things would have been much nicer...

-include arch/$(ARCH)/Makefile

ifneq ($(OUTPUT),)
  CFLAGS += -I$(OUTPUT)
endif

ifndef NO_GTK2
  ALL_PROGRAMS += $(OUTPUT)libperf-gtk.so
  GTK_IN := $(OUTPUT)gtk-in.o

install-gtk: $(OUTPUT)libperf-gtk.so
	$(call QUIET_INSTALL, 'GTK UI') \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(libdir_SQ)'; \
		$(INSTALL) $(OUTPUT)libperf-gtk.so '$(DESTDIR_SQ)$(libdir_SQ)'
endif

ifdef ASCIIDOC8
  export ASCIIDOC8
endif

LIBS = -Wl,--whole-archive $(PERFLIBS) -Wl,--no-whole-archive -Wl,--start-group $(EXTLIBS) -Wl,--end-group

export INSTALL SHELL_PATH

### Build rules

SHELL = $(SHELL_PATH)

all: shell_compatibility_test $(ALL_PROGRAMS) $(LANG_BINDINGS) $(OTHER_PROGRAMS)

please_set_SHELL_PATH_to_a_more_modern_shell:
	$(Q)$$(:)

shell_compatibility_test: please_set_SHELL_PATH_to_a_more_modern_shell

strip: $(PROGRAMS) $(OUTPUT)perf
	$(STRIP) $(STRIP_OPTS) $(PROGRAMS) $(OUTPUT)perf

PERF_IN := $(OUTPUT)perf-in.o

export srctree OUTPUT RM CC LD AR CFLAGS V BISON FLEX
build := -f $(srctree)/tools/build/Makefile.build dir=. obj

$(PERF_IN): $(OUTPUT)PERF-VERSION-FILE $(OUTPUT)common-cmds.h FORCE
	$(Q)$(MAKE) $(build)=perf

$(OUTPUT)perf: $(PERFLIBS) $(PERF_IN)
	$(QUIET_LINK)$(CC) $(CFLAGS) $(LDFLAGS) $(PERF_IN) $(LIBS) -o $@

$(GTK_IN): FORCE
	$(Q)$(MAKE) $(build)=gtk

$(OUTPUT)libperf-gtk.so: $(GTK_IN) $(PERFLIBS)
	$(QUIET_LINK)$(CC) -o $@ -shared $(LDFLAGS) $(filter %.o,$^) $(GTK_LIBS)

$(OUTPUT)common-cmds.h: util/generate-cmdlist.sh command-list.txt

$(OUTPUT)common-cmds.h: $(wildcard Documentation/perf-*.txt)
	$(QUIET_GEN). util/generate-cmdlist.sh > $@+ && mv $@+ $@

$(SCRIPTS) : % : %.sh
	$(QUIET_GEN)$(INSTALL) '$@.sh' '$(OUTPUT)$@'

# These can record PERF_VERSION
perf.spec $(SCRIPTS) \
	: $(OUTPUT)PERF-VERSION-FILE

.SUFFIXES:

#
# If a target does not match any of the later rules then prefix it by $(OUTPUT)
# This makes targets like 'make O=/tmp/perf perf.o' work in a natural way.
#
ifneq ($(OUTPUT),)
%.o: $(OUTPUT)%.o
	@echo "    # Redirected target $@ => $(OUTPUT)$@"
util/%.o: $(OUTPUT)util/%.o
	@echo "    # Redirected target $@ => $(OUTPUT)$@"
bench/%.o: $(OUTPUT)bench/%.o
	@echo "    # Redirected target $@ => $(OUTPUT)$@"
tests/%.o: $(OUTPUT)tests/%.o
	@echo "    # Redirected target $@ => $(OUTPUT)$@"
endif

# These two need to be here so that when O= is not used they take precedence
# over the general rule for .o

# get relative building directory (to $(OUTPUT))
# and '.' if it's $(OUTPUT) itself
__build-dir = $(subst $(OUTPUT),,$(dir $@))
build-dir   = $(if $(__build-dir),$(__build-dir),.)

single_dep: $(OUTPUT)PERF-VERSION-FILE $(OUTPUT)common-cmds.h

$(OUTPUT)%.o: %.c single_dep FORCE
	$(Q)$(MAKE) -f $(srctree)/tools/build/Makefile.build dir=$(build-dir) $@

$(OUTPUT)%.i: %.c single_dep FORCE
	$(Q)$(MAKE) -f $(srctree)/tools/build/Makefile.build dir=$(build-dir) $@

$(OUTPUT)%.s: %.c single_dep FORCE
	$(Q)$(MAKE) -f $(srctree)/tools/build/Makefile.build dir=$(build-dir) $@

$(OUTPUT)%-bison.o: %.c single_dep FORCE
	$(Q)$(MAKE) -f $(srctree)/tools/build/Makefile.build dir=$(build-dir) $@

$(OUTPUT)%-flex.o: %.c single_dep FORCE
	$(Q)$(MAKE) -f $(srctree)/tools/build/Makefile.build dir=$(build-dir) $@

$(OUTPUT)%.o: %.S single_dep FORCE
	$(Q)$(MAKE) -f $(srctree)/tools/build/Makefile.build dir=$(build-dir) $@

$(OUTPUT)%.i: %.S single_dep FORCE
	$(Q)$(MAKE) -f $(srctree)/tools/build/Makefile.build dir=$(build-dir) $@

$(OUTPUT)perf-%: %.o $(PERFLIBS)
	$(QUIET_LINK)$(CC) $(CFLAGS) -o $@ $(LDFLAGS) $(filter %.o,$^) $(LIBS)

ifndef NO_PERF_READ_VDSO32
$(OUTPUT)perf-read-vdso32: perf-read-vdso.c util/find-vdso-map.c
	$(QUIET_CC)$(CC) -m32 $(filter -static,$(LDFLAGS)) -Wall -Werror -o $@ perf-read-vdso.c
endif

ifndef NO_PERF_READ_VDSOX32
$(OUTPUT)perf-read-vdsox32: perf-read-vdso.c util/find-vdso-map.c
	$(QUIET_CC)$(CC) -mx32 $(filter -static,$(LDFLAGS)) -Wall -Werror -o $@ perf-read-vdso.c
endif

$(patsubst perf-%,%.o,$(PROGRAMS)): $(wildcard */*.h)

LIBPERF_IN := $(OUTPUT)libperf-in.o

$(LIBPERF_IN): FORCE
	$(Q)$(MAKE) $(build)=libperf

$(LIB_FILE): $(LIBPERF_IN)
	$(QUIET_AR)$(RM) $@ && $(AR) rcs $@ $(LIBPERF_IN) $(LIB_OBJS)

LIBTRACEEVENT_FLAGS += plugin_dir=$(plugindir_SQ)

$(LIBTRACEEVENT): FORCE
	$(Q)$(MAKE) -C $(TRACE_EVENT_DIR) $(LIBTRACEEVENT_FLAGS) O=$(OUTPUT) $(OUTPUT)libtraceevent.a plugins

$(LIBTRACEEVENT)-clean:
	$(call QUIET_CLEAN, libtraceevent)
	$(Q)$(MAKE) -C $(TRACE_EVENT_DIR) O=$(OUTPUT) clean >/dev/null

install-traceevent-plugins: $(LIBTRACEEVENT)
	$(Q)$(MAKE) -C $(TRACE_EVENT_DIR) $(LIBTRACEEVENT_FLAGS) O=$(OUTPUT) install_plugins

$(LIBAPI): FORCE
	$(Q)$(MAKE) -C $(LIB_DIR) O=$(OUTPUT) $(OUTPUT)libapi.a

$(LIBAPI)-clean:
	$(call QUIET_CLEAN, libapi)
	$(Q)$(MAKE) -C $(LIB_DIR) O=$(OUTPUT) clean >/dev/null

help:
	@echo 'Perf make targets:'
	@echo '  doc		- make *all* documentation (see below)'
	@echo '  man		- make manpage documentation (access with man <foo>)'
	@echo '  html		- make html documentation'
	@echo '  info		- make GNU info documentation (access with info <foo>)'
	@echo '  pdf		- make pdf documentation'
	@echo '  TAGS		- use etags to make tag information for source browsing'
	@echo '  tags		- use ctags to make tag information for source browsing'
	@echo '  cscope	- use cscope to make interactive browsing database'
	@echo ''
	@echo 'Perf install targets:'
	@echo '  NOTE: documentation build requires asciidoc, xmlto packages to be installed'
	@echo '  HINT: use "prefix" or "DESTDIR" to install to a particular'
	@echo '        path like "make prefix=/usr/local install install-doc"'
	@echo '  install	- install compiled binaries'
	@echo '  install-doc	- install *all* documentation'
	@echo '  install-man	- install manpage documentation'
	@echo '  install-html	- install html documentation'
	@echo '  install-info	- install GNU info documentation'
	@echo '  install-pdf	- install pdf documentation'
	@echo ''
	@echo '  quick-install-doc	- alias for quick-install-man'
	@echo '  quick-install-man	- install the documentation quickly'
	@echo '  quick-install-html	- install the html documentation quickly'
	@echo ''
	@echo 'Perf maintainer targets:'
	@echo '  clean			- clean all binary objects and build output'


DOC_TARGETS := doc man html info pdf

INSTALL_DOC_TARGETS := $(patsubst %,install-%,$(DOC_TARGETS)) try-install-man
INSTALL_DOC_TARGETS += quick-install-doc quick-install-man quick-install-html

# 'make doc' should call 'make -C Documentation all'
$(DOC_TARGETS):
	$(QUIET_SUBDIR0)Documentation $(QUIET_SUBDIR1) $(@:doc=all)

TAG_FOLDERS= . ../lib/traceevent ../lib/api ../lib/symbol
TAG_FILES= ../../include/uapi/linux/perf_event.h

TAGS:
	$(QUIET_GEN)$(RM) TAGS; \
	$(FIND) $(TAG_FOLDERS) -name '*.[hcS]' -print | xargs etags -a $(TAG_FILES)

tags:
	$(QUIET_GEN)$(RM) tags; \
	$(FIND) $(TAG_FOLDERS) -name '*.[hcS]' -print | xargs ctags -a $(TAG_FILES)

cscope:
	$(QUIET_GEN)$(RM) cscope*; \
	$(FIND) $(TAG_FOLDERS) -name '*.[hcS]' -print | xargs cscope -b $(TAG_FILES)

### Testing rules

# GNU make supports exporting all variables by "export" without parameters.
# However, the environment gets quite big, and some programs have problems
# with that.

check: $(OUTPUT)common-cmds.h
	if sparse; \
	then \
		for i in *.c */*.c; \
		do \
			sparse $(CFLAGS) $(SPARSE_FLAGS) $$i || exit; \
		done; \
	else \
		exit 1; \
	fi

### Installation rules

install-gtk:

install-bin: all install-gtk
	$(call QUIET_INSTALL, binaries) \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(bindir_SQ)'; \
		$(INSTALL) $(OUTPUT)perf '$(DESTDIR_SQ)$(bindir_SQ)'; \
		$(LN) '$(DESTDIR_SQ)$(bindir_SQ)/perf' '$(DESTDIR_SQ)$(bindir_SQ)/trace'
ifndef NO_PERF_READ_VDSO32
	$(call QUIET_INSTALL, perf-read-vdso32) \
		$(INSTALL) $(OUTPUT)perf-read-vdso32 '$(DESTDIR_SQ)$(bindir_SQ)';
endif
ifndef NO_PERF_READ_VDSOX32
	$(call QUIET_INSTALL, perf-read-vdsox32) \
		$(INSTALL) $(OUTPUT)perf-read-vdsox32 '$(DESTDIR_SQ)$(bindir_SQ)';
endif
	$(call QUIET_INSTALL, libexec) \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(perfexec_instdir_SQ)'
	$(call QUIET_INSTALL, perf-archive) \
		$(INSTALL) $(OUTPUT)perf-archive -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)'
	$(call QUIET_INSTALL, perf-with-kcore) \
		$(INSTALL) $(OUTPUT)perf-with-kcore -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)'
ifndef NO_LIBPERL
	$(call QUIET_INSTALL, perl-scripts) \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/perl/Perf-Trace-Util/lib/Perf/Trace'; \
		$(INSTALL) scripts/perl/Perf-Trace-Util/lib/Perf/Trace/* -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/perl/Perf-Trace-Util/lib/Perf/Trace'; \
		$(INSTALL) scripts/perl/*.pl -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/perl'; \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/perl/bin'; \
		$(INSTALL) scripts/perl/bin/* -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/perl/bin'
endif
ifndef NO_LIBPYTHON
	$(call QUIET_INSTALL, python-scripts) \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/python/Perf-Trace-Util/lib/Perf/Trace'; \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/python/bin'; \
		$(INSTALL) scripts/python/Perf-Trace-Util/lib/Perf/Trace/* -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/python/Perf-Trace-Util/lib/Perf/Trace'; \
		$(INSTALL) scripts/python/*.py -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/python'; \
		$(INSTALL) scripts/python/bin/* -t '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/scripts/python/bin'
endif
	$(call QUIET_INSTALL, perf_completion-script) \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(sysconfdir_SQ)/bash_completion.d'; \
		$(INSTALL) perf-completion.sh '$(DESTDIR_SQ)$(sysconfdir_SQ)/bash_completion.d/perf'
	$(call QUIET_INSTALL, tests) \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/tests'; \
		$(INSTALL) tests/attr.py '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/tests'; \
		$(INSTALL) -d -m 755 '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/tests/attr'; \
		$(INSTALL) tests/attr/* '$(DESTDIR_SQ)$(perfexec_instdir_SQ)/tests/attr'

install: install-bin try-install-man install-traceevent-plugins

install-python_ext:
	$(PYTHON_WORD) util/setup.py --quiet install --root='/$(DESTDIR_SQ)'

# 'make install-doc' should call 'make -C Documentation install'
$(INSTALL_DOC_TARGETS):
	$(QUIET_SUBDIR0)Documentation $(QUIET_SUBDIR1) $(@:-doc=)

### Cleaning rules

#
# This is here, not in config/Makefile, because config/Makefile does
# not get included for the clean target:
#
config-clean:
	$(call QUIET_CLEAN, config)
	$(Q)$(MAKE) -C $(srctree)/tools/build/feature/ clean >/dev/null

clean: $(LIBTRACEEVENT)-clean $(LIBAPI)-clean config-clean
	$(call QUIET_CLEAN, core-objs)  $(RM) $(LIB_FILE) $(OUTPUT)perf-archive $(OUTPUT)perf-with-kcore $(LANG_BINDINGS)
	$(Q)find . -name '*.o' -delete -o -name '\.*.cmd' -delete -o -name '\.*.d' -delete
	$(Q)$(RM) .config-detected
	$(call QUIET_CLEAN, core-progs) $(RM) $(ALL_PROGRAMS) perf perf-read-vdso32 perf-read-vdsox32
	$(call QUIET_CLEAN, core-gen)   $(RM)  *.spec *.pyc *.pyo */*.pyc */*.pyo $(OUTPUT)common-cmds.h TAGS tags cscope* $(OUTPUT)PERF-VERSION-FILE $(OUTPUT)FEATURE-DUMP $(OUTPUT)util/*-bison* $(OUTPUT)util/*-flex*
	$(QUIET_SUBDIR0)Documentation $(QUIET_SUBDIR1) clean
	$(python-clean)

#
# Trick: if ../../.git does not exist - we are building out of tree for example,
# then force version regeneration:
#
ifeq ($(wildcard ../../.git/HEAD),)
    GIT-HEAD-PHONY = ../../.git/HEAD
else
    GIT-HEAD-PHONY =
endif

FORCE:

.PHONY: all install clean config-clean strip install-gtk
.PHONY: shell_compatibility_test please_set_SHELL_PATH_to_a_more_modern_shell
.PHONY: $(GIT-HEAD-PHONY) TAGS tags cscope FORCE single_dep

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           include ../../scripts/Makefile.include
include ../config/utilities.mak

MAN1_TXT= \
	$(filter-out $(addsuffix .txt, $(ARTICLES) $(SP_ARTICLES)), \
		$(wildcard perf-*.txt)) \
	perf.txt
MAN5_TXT=
MAN7_TXT=

MAN_TXT = $(MAN1_TXT) $(MAN5_TXT) $(MAN7_TXT)
_MAN_XML=$(patsubst %.txt,%.xml,$(MAN_TXT))
_MAN_HTML=$(patsubst %.txt,%.html,$(MAN_TXT))

MAN_XML=$(addprefix $(OUTPUT),$(_MAN_XML))
MAN_HTML=$(addprefix $(OUTPUT),$(_MAN_HTML))

ARTICLES =
# with their own formatting rules.
SP_ARTICLES =
API_DOCS = $(patsubst %.txt,%,$(filter-out technical/api-index-skel.txt technical/api-index.txt, $(wildcard technical/api-*.txt)))
SP_ARTICLES += $(API_DOCS)
SP_ARTICLES += technical/api-index

_DOC_HTML = $(_MAN_HTML)
_DOC_HTML+=$(patsubst %,%.html,$(ARTICLES) $(SP_ARTICLES))
DOC_HTML=$(addprefix $(OUTPUT),$(_DOC_HTML))

_DOC_MAN1=$(patsubst %.txt,%.1,$(MAN1_TXT))
_DOC_MAN5=$(patsubst %.txt,%.5,$(MAN5_TXT))
_DOC_MAN7=$(patsubst %.txt,%.7,$(MAN7_TXT))

DOC_MAN1=$(addprefix $(OUTPUT),$(_DOC_MAN1))
DOC_MAN5=$(addprefix $(OUTPUT),$(_DOC_MAN5))
DOC_MAN7=$(addprefix $(OUTPUT),$(_DOC_MAN7))

# Make the path relative to DESTDIR, not prefix
ifndef DESTDIR
prefix?=$(HOME)
endif
bindir?=$(prefix)/bin
htmldir?=$(prefix)/share/doc/perf-doc
pdfdir?=$(prefix)/share/doc/perf-doc
mandir?=$(prefix)/share/man
man1dir=$(mandir)/man1
man5dir=$(mandir)/man5
man7dir=$(mandir)/man7

ASCIIDOC=asciidoc
ASCIIDOC_EXTRA = --unsafe
MANPAGE_XSL = manpage-normal.xsl
XMLTO_EXTRA =
INSTALL?=install
RM ?= rm -f
DOC_REF = origin/man
HTML_REF = origin/html

infodir?=$(prefix)/share/info
MAKEINFO=makeinfo
INSTALL_INFO=install-info
DOCBOOK2X_TEXI=docbook2x-texi
DBLATEX=dblatex
XMLTO=xmlto
ifndef PERL_PATH
	PERL_PATH = /usr/bin/perl
endif

-include ../config.mak.autogen
-include ../config.mak

_tmp_tool_path := $(call get-executable,$(ASCIIDOC))
ifeq ($(_tmp_tool_path),)
	missing_tools = $(ASCIIDOC)
endif

_tmp_tool_path := $(call get-executable,$(XMLTO))
ifeq ($(_tmp_tool_path),)
	missing_tools += $(XMLTO)
endif

#
# For asciidoc ...
#	-7.1.2,	no extra settings are needed.
#	8.0-,	set ASCIIDOC8.
#

#
# For docbook-xsl ...
#	-1.68.1,	set ASCIIDOC_NO_ROFF? (based on changelog from 1.73.0)
#	1.69.0,		no extra settings are needed?
#	1.69.1-1.71.0,	set DOCBOOK_SUPPRESS_SP?
#	1.71.1,		no extra settings are needed?
#	1.72.0,		set DOCBOOK_XSL_172.
#	1.73.0-,	set ASCIIDOC_NO_ROFF
#

#
# If you had been using DOCBOOK_XSL_172 in an attempt to get rid
# of 'the ".ft C" problem' in your generated manpages, and you
# instead ended up with weird characters around callouts, try
# using ASCIIDOC_NO_ROFF instead (it works fine with ASCIIDOC8).
#

ifdef ASCIIDOC8
ASCIIDOC_EXTRA += -a asciidoc7compatible
endif
ifdef DOCBOOK_XSL_172
ASCIIDOC_EXTRA += -a perf-asciidoc-no-roff
MANPAGE_XSL = manpage-1.72.xsl
else
	ifdef ASCIIDOC_NO_ROFF
	# docbook-xsl after 1.72 needs the regular XSL, but will not
	# pass-thru raw roff codes from asciidoc.conf, so turn them off.
	ASCIIDOC_EXTRA += -a perf-asciidoc-no-roff
	endif
endif
ifdef MAN_BOLD_LITERAL
XMLTO_EXTRA += -m manpage-bold-literal.xsl
endif
ifdef DOCBOOK_SUPPRESS_SP
XMLTO_EXTRA += -m manpage-suppress-sp.xsl
endif

SHELL_PATH ?= $(SHELL)
# Shell quote;
SHELL_PATH_SQ = $(subst ','\'',$(SHELL_PATH))

#
# Please note that there is a minor bug in asciidoc.
# The version after 6.0.3 _will_ include the patch found here:
#   http://marc.theaimsgroup.com/?l=perf&m=111558757202243&w=2
#
# Until that version is released you may have to apply the patch
# yourself - yes, all 6 characters of it!
#

QUIET_SUBDIR0  = +$(MAKE) -C # space to separate -C and subdir
QUIET_SUBDIR1  =

ifneq ($(findstring $(MAKEFLAGS),w),w)
PRINT_DIR = --no-print-directory
else # "make -w"
NO_SUBDIR = :
endif

ifneq ($(findstring $(MAKEFLAGS),s),s)
ifneq ($(V),1)
	QUIET_ASCIIDOC	= @echo '  ASCIIDOC '$@;
	QUIET_XMLTO	= @echo '  XMLTO    '$@;
	QUIET_DB2TEXI	= @echo '  DB2TEXI  '$@;
	QUIET_MAKEINFO	= @echo '  MAKEINFO '$@;
	QUIET_DBLATEX	= @echo '  DBLATEX  '$@;
	QUIET_XSLTPROC	= @echo '  XSLTPROC '$@;
	QUIET_GEN	= @echo '  GEN      '$@;
	QUIET_STDERR	= 2> /dev/null
	QUIET_SUBDIR0	= +@subdir=
	QUIET_SUBDIR1	= ;$(NO_SUBDIR) \
			   echo '  SUBDIR   ' $$subdir; \
			  $(MAKE) $(PRINT_DIR) -C $$subdir
	export V
endif
endif

all: html man

html: $(DOC_HTML)

$(DOC_HTML) $(DOC_MAN1) $(DOC_MAN5) $(DOC_MAN7): asciidoc.conf

man: man1 man5 man7
man1: $(DOC_MAN1)
man5: $(DOC_MAN5)
man7: $(DOC_MAN7)

info: $(OUTPUT)perf.info $(OUTPUT)perfman.info

pdf: $(OUTPUT)user-manual.pdf

install: install-man

check-man-tools:
ifdef missing_tools
	$(error "You need to install $(missing_tools) for man pages")
endif

do-install-man: man
	$(call QUIET_INSTALL, Documentation-man) \
		$(INSTALL) -d -m 755 $(DESTDIR)$(man1dir); \
#		$(INSTALL) -d -m 755 $(DESTDIR)$(man5dir); \
#		$(INSTALL) -d -m 755 $(DESTDIR)$(man7dir); \
		$(INSTALL) -m 644 $(DOC_MAN1) $(DESTDIR)$(man1dir); \
#		$(INSTALL) -m 644 $(DOC_MAN5) $(DESTDIR)$(man5dir); \
#		$(INSTALL) -m 644 $(DOC_MAN7) $(DESTDIR)$(man7dir)

install-man: check-man-tools man

ifdef missing_tools
  DO_INSTALL_MAN = $(warning Please install $(missing_tools) to have the man pages installed)
else
  DO_INSTALL_MAN = do-install-man
endif

try-install-man: $(DO_INSTALL_MAN)

install-info: info
	$(call QUIET_INSTALL, Documentation-info) \
		$(INSTALL) -d -m 755 $(DESTDIR)$(infodir); \
		$(INSTALL) -m 644 $(OUTPUT)perf.info $(OUTPUT)perfman.info $(DESTDIR)$(infodir); \
	if test -r $(DESTDIR)$(infodir)/dir; then \
		$(INSTALL_INFO) --info-dir=$(DESTDIR)$(infodir) perf.info ;\
		$(INSTALL_INFO) --info-dir=$(DESTDIR)$(infodir) perfman.info ;\
	else \
	  echo "No directory found in $(DESTDIR)$(infodir)" >&2 ; \
	fi

install-pdf: pdf
	$(call QUIET_INSTALL, Documentation-pdf) \
		$(INSTALL) -d -m 755 $(DESTDIR)$(pdfdir); \
		$(INSTALL) -m 644 $(OUTPUT)user-manual.pdf $(DESTDIR)$(pdfdir)

#install-html: html
#	'$(SHELL_PATH_SQ)' ./install-webdoc.sh $(DESTDIR)$(htmldir)


#
# Determine "include::" file references in asciidoc files.
#
$(OUTPUT)doc.dep : $(wildcard *.txt) build-docdep.perl
	$(QUIET_GEN)$(RM) $@+ $@ && \
	$(PERL_PATH) ./build-docdep.perl >$@+ $(QUIET_STDERR) && \
	mv $@+ $@

-include $(OUPTUT)doc.dep

_cmds_txt = cmds-ancillaryinterrogators.txt \
	cmds-ancillarymanipulators.txt \
	cmds-mainporcelain.txt \
	cmds-plumbinginterrogators.txt \
	cmds-plumbingmanipulators.txt \
	cmds-synchingrepositories.txt \
	cmds-synchelpers.txt \
	cmds-purehelpers.txt \
	cmds-foreignscminterface.txt
cmds_txt=$(addprefix $(OUTPUT),$(_cmds_txt))

$(cmds_txt): $(OUTPUT)cmd-list.made

$(OUTPUT)cmd-list.made: cmd-list.perl ../command-list.txt $(MAN1_TXT)
	$(QUIET_GEN)$(RM) $@ && \
	$(PERL_PATH) ./cmd-list.perl ../command-list.txt $(QUIET_STDERR) && \
	date >$@

CLEAN_FILES =									\
	$(MAN_XML) $(addsuffix +,$(MAN_XML))					\
	$(MAN_HTML) $(addsuffix +,$(MAN_HTML))					\
	$(DOC_HTML) $(DOC_MAN1) $(DOC_MAN5) $(DOC_MAN7)				\
	$(OUTPUT)*.texi $(OUTPUT)*.texi+ $(OUTPUT)*.texi++			\
	$(OUTPUT)perf.info $(OUTPUT)perfman.info				\
	$(OUTPUT)howto-index.txt $(OUTPUT)howto/*.html $(OUTPUT)doc.dep		\
	$(OUTPUT)technical/api-*.html $(OUTPUT)technical/api-index.txt		\
	$(cmds_txt) $(OUTPUT)*.made
clean:
	$(call QUIET_CLEAN, Documentation) $(RM) $(CLEAN_FILES)

$(MAN_HTML): $(OUTPUT)%.html : %.txt
	$(QUIET_ASCIIDOC)$(RM) $@+ $@ && \
	$(ASCIIDOC) -b xhtml11 -d manpage -f asciidoc.conf \
		$(ASCIIDOC_EXTRA) -aperf_version=$(PERF_VERSION) -o $@+ $< && \
	mv $@+ $@

$(OUTPUT)%.1 $(OUTPUT)%.5 $(OUTPUT)%.7 : $(OUTPUT)%.xml
	$(QUIET_XMLTO)$(RM) $@ && \
	$(XMLTO) -o $(OUTPUT). -m $(MANPAGE_XSL) $(XMLTO_EXTRA) man $<

$(OUTPUT)%.xml : %.txt
	$(QUIET_ASCIIDOC)$(RM) $@+ $@ && \
	$(ASCIIDOC) -b docbook -d manpage -f asciidoc.conf \
		$(ASCIIDOC_EXTRA) -aperf_version=$(PERF_VERSION) -o $@+ $< && \
	mv $@+ $@

XSLT = docbook.xsl
XSLTOPTS = --xinclude --stringparam html.stylesheet docbook-xsl.css

$(OUTPUT)user-manual.html: $(OUTPUT)user-manual.xml
	$(QUIET_XSLTPROC)xsltproc $(XSLTOPTS) -o $@ $(XSLT) $<

$(OUTPUT)perf.info: $(OUTPUT)user-manual.texi
	$(QUIET_MAKEINFO)$(MAKEINFO) --no-split -o $@ $(OUTPUT)user-manual.texi

$(OUTPUT)user-manual.texi: $(OUTPUT)user-manual.xml
	$(QUIET_DB2TEXI)$(RM) $@+ $@ && \
	$(DOCBOOK2X_TEXI) $(OUTPUT)user-manual.xml --encoding=UTF-8 --to-stdout >$@++ && \
	$(PERL_PATH) fix-texi.perl <$@++ >$@+ && \
	rm $@++ && \
	mv $@+ $@

$(OUTPUT)user-manual.pdf: $(OUTPUT)user-manual.xml
	$(QUIET_DBLATEX)$(RM) $@+ $@ && \
	$(DBLATEX) -o $@+ -p /etc/asciidoc/dblatex/asciidoc-dblatex.xsl -s /etc/asciidoc/dblatex/asciidoc-dblatex.sty $< && \
	mv $@+ $@

$(OUTPUT)perfman.texi: $(MAN_XML) cat-texi.perl
	$(QUIET_DB2TEXI)$(RM) $@+ $@ && \
	($(foreach xml,$(MAN_XML),$(DOCBOOK2X_TEXI) --encoding=UTF-8 \
		--to-stdout $(xml) &&) true) > $@++ && \
	$(PERL_PATH) cat-texi.perl $@ <$@++ >$@+ && \
	rm $@++ && \
	mv $@+ $@

$(OUTPUT)perfman.info: $(OUTPUT)perfman.texi
	$(QUIET_MAKEINFO)$(MAKEINFO) --no-split --no-validate $*.texi

$(patsubst %.txt,%.texi,$(MAN_TXT)): %.texi : %.xml
	$(QUIET_DB2TEXI)$(RM) $@+ $@ && \
	$(DOCBOOK2X_TEXI) --to-stdout $*.xml >$@+ && \
	mv $@+ $@

howto-index.txt: howto-index.sh $(wildcard howto/*.txt)
	$(QUIET_GEN)$(RM) $@+ $@ && \
	'$(SHELL_PATH_SQ)' ./howto-index.sh $(wildcard howto/*.txt) >$@+ && \
	mv $@+ $@

$(patsubst %,%.html,$(ARTICLES)) : %.html : %.txt
	$(QUIET_ASCIIDOC)$(ASCIIDOC) -b xhtml11 $*.txt

WEBDOC_DEST = /pub/software/tools/perf/docs

$(patsubst %.txt,%.html,$(wildcard howto/*.txt)): %.html : %.txt
	$(QUIET_ASCIIDOC)$(RM) $@+ $@ && \
	sed -e '1,/^$$/d' $< | $(ASCIIDOC) -b xhtml11 - >$@+ && \
	mv $@+ $@

# UNIMPLEMENTED
#install-webdoc : html
#	'$(SHELL_PATH_SQ)' ./install-webdoc.sh $(WEBDOC_DEST)

# quick-install: quick-install-man

# quick-install-man:
#	'$(SHELL_PATH_SQ)' ./install-doc-quick.sh $(DOC_REF) $(DESTDIR)$(mandir)

#quick-install-html:
#	'$(SHELL_PATH_SQ)' ./install-doc-quick.sh $(HTML_REF) $(DESTDIR)$(htmldir)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          #
# This is a simple wrapper Makefile that calls the main Makefile.perf
# with a -j option to do parallel builds
#
# If you want to invoke the perf build in some non-standard way then
# you can use the 'make -f Makefile.perf' method to invoke it.
#

#
# Clear out the built-in rules GNU make defines by default (such as .o targets),
# so that we pass through all targets to Makefile.perf:
#
.SUFFIXES:

#
# We don't want to pass along options like -j:
#
unexport MAKEFLAGS

#
# Do a parallel build with multiple jobs, based on the number of CPUs online
# in this system: 'make -j8' on a 8-CPU system, etc.
#
# (To override it, run 'make JOBS=1' and similar.)
#
ifeq ($(JOBS),)
  JOBS := $(shell (getconf _NPROCESSORS_ONLN || egrep -c '^processor|^CPU[0-9]' /proc/cpuinfo) 2>/dev/null)
  ifeq ($(JOBS),0)
    JOBS := 1
  endif
endif

#
# Only pass canonical directory names as the output directory:
#
ifneq ($(O),)
  FULL_O := $(shell readlink -f $(O) || echo $(O))
endif

#
# Only accept the 'DEBUG' variable from the command line:
#
ifeq ("$(origin DEBUG)", "command line")
  ifeq ($(DEBUG),)
    override DEBUG = 0
  else
    SET_DEBUG = "DEBUG=$(DEBUG)"
  endif
else
  override DEBUG = 0
endif

define print_msg
  @printf '  BUILD:   Doing '\''make \033[33m-j'$(JOBS)'\033[m'\'' parallel build\n'
endef

define make
  @$(MAKE) -f Makefile.perf --no-print-directory -j$(JOBS) O=$(FULL_O) $(SET_DEBUG) $@
endef

#
# Needed if no target specified:
# (Except for tags and TAGS targets. The reason is that the
# Makefile does not treat tags/TAGS as targets but as files
# and thus won't rebuilt them once they are in place.)
#
all tags TAGS:
	$(print_msg)
	$(make)

#
# The clean target is not really parallel, don't print the jobs info:
#
clean:
	$(make)

#
# The build-test target is not really parallel, don't print the jobs info:
#
build-test:
	@$(MAKE) -f tests/make --no-print-directory

#
# All other targets get passed through:
#
%:
	$(print_msg)
	$(make)

.PHONY: tags TAGS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   #!/usr/bin/perl -w
# (c) 2009, Tom Zanussi <tzanussi@gmail.com>
# Licensed under the terms of the GNU GPL License version 2

# Display avg/min/max wakeup latency

# The common_* event handler fields are the most useful fields common to
# all events.  They don't necessarily correspond to the 'common_*' fields
# in the status files.  Those fields not available as handler params can
# be retrieved via script functions of the form get_common_*().

use 5.010000;
use strict;
use warnings;

use lib "$ENV{'PERF_EXEC_PATH'}/scripts/perl/Perf-Trace-Util/lib";
use lib "./Perf-Trace-Util/lib";
use Perf::Trace::Core;
use Perf::Trace::Util;

my %last_wakeup;

my $max_wakeup_latency;
my $min_wakeup_latency;
my $total_wakeup_latency = 0;
my $total_wakeups = 0;

sub sched::sched_switch
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$prev_comm, $prev_pid, $prev_prio, $prev_state, $next_comm, $next_pid,
	$next_prio) = @_;

    my $wakeup_ts = $last_wakeup{$common_cpu}{ts};
    if ($wakeup_ts) {
	my $switch_ts = nsecs($common_secs, $common_nsecs);
	my $wakeup_latency = $switch_ts - $wakeup_ts;
	if ($wakeup_latency > $max_wakeup_latency) {
	    $max_wakeup_latency = $wakeup_latency;
	}
	if ($wakeup_latency < $min_wakeup_latency) {
	    $min_wakeup_latency = $wakeup_latency;
	}
	$total_wakeup_latency += $wakeup_latency;
	$total_wakeups++;
    }
    $last_wakeup{$common_cpu}{ts} = 0;
}

sub sched::sched_wakeup
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$comm, $pid, $prio, $success, $target_cpu) = @_;

    $last_wakeup{$target_cpu}{ts} = nsecs($common_secs, $common_nsecs);
}

sub trace_begin
{
    $min_wakeup_latency = 1000000000;
    $max_wakeup_latency = 0;
}

sub trace_end
{
    printf("wakeup_latency stats:\n\n");
    print "total_wakeups: $total_wakeups\n";
    if ($total_wakeups) {
	printf("avg_wakeup_latency (ns): %u\n",
	       avg($total_wakeup_latency, $total_wakeups));
    } else {
	printf("avg_wakeup_latency (ns): N/A\n");
    }
    printf("min_wakeup_latency (ns): %u\n", $min_wakeup_latency);
    printf("max_wakeup_latency (ns): %u\n", $max_wakeup_latency);

    print_unhandled();
}

my %unhandled;

sub print_unhandled
{
    if ((scalar keys %unhandled) == 0) {
	return;
    }

    print "\nunhandled events:\n\n";

    printf("%-40s  %10s\n", "event", "count");
    printf("%-40s  %10s\n", "----------------------------------------",
	   "-----------");

    foreach my $event_name (keys %unhandled) {
	printf("%-40s  %10d\n", $event_name, $unhandled{$event_name});
    }
}

sub trace_unhandled
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm) = @_;

    $unhandled{$event_name}++;
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #!/usr/bin/perl -w
# (c) 2010, Tom Zanussi <tzanussi@gmail.com>
# Licensed under the terms of the GNU GPL License version 2

# read/write top
#
# Periodically displays system-wide r/w call activity, broken down by
# pid.  If an [interval] arg is specified, the display will be
# refreshed every [interval] seconds.  The default interval is 3
# seconds.

use 5.010000;
use strict;
use warnings;

use lib "$ENV{'PERF_EXEC_PATH'}/scripts/perl/Perf-Trace-Util/lib";
use lib "./Perf-Trace-Util/lib";
use Perf::Trace::Core;
use Perf::Trace::Util;
use POSIX qw/SIGALRM SA_RESTART/;

my $default_interval = 3;
my $nlines = 20;
my $print_thread;
my $print_pending = 0;

my %reads;
my %writes;

my $interval = shift;
if (!$interval) {
    $interval = $default_interval;
}

sub syscalls::sys_exit_read
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $ret) = @_;

    print_check();

    if ($ret > 0) {
	$reads{$common_pid}{bytes_read} += $ret;
    } else {
	if (!defined ($reads{$common_pid}{bytes_read})) {
	    $reads{$common_pid}{bytes_read} = 0;
	}
	$reads{$common_pid}{errors}{$ret}++;
    }
}

sub syscalls::sys_enter_read
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $fd, $buf, $count) = @_;

    print_check();

    $reads{$common_pid}{bytes_requested} += $count;
    $reads{$common_pid}{total_reads}++;
    $reads{$common_pid}{comm} = $common_comm;
}

sub syscalls::sys_exit_write
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $ret) = @_;

    print_check();

    if ($ret <= 0) {
	$writes{$common_pid}{errors}{$ret}++;
    }
}

sub syscalls::sys_enter_write
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $fd, $buf, $count) = @_;

    print_check();

    $writes{$common_pid}{bytes_written} += $count;
    $writes{$common_pid}{total_writes}++;
    $writes{$common_pid}{comm} = $common_comm;
}

sub trace_begin
{
    my $sa = POSIX::SigAction->new(\&set_print_pending);
    $sa->flags(SA_RESTART);
    $sa->safe(1);
    POSIX::sigaction(SIGALRM, $sa) or die "Can't set SIGALRM handler: $!\n";
    alarm 1;
}

sub trace_end
{
    print_unhandled();
    print_totals();
}

sub print_check()
{
    if ($print_pending == 1) {
	$print_pending = 0;
	print_totals();
    }
}

sub set_print_pending()
{
    $print_pending = 1;
    alarm $interval;
}

sub print_totals
{
    my $count;

    $count = 0;

    clear_term();

    printf("\nread counts by pid:\n\n");

    printf("%6s  %20s  %10s  %10s  %10s\n", "pid", "comm",
	   "# reads", "bytes_req", "bytes_read");
    printf("%6s  %-20s  %10s  %10s  %10s\n", "------", "--------------------",
	   "----------", "----------", "----------");

    foreach my $pid (sort { ($reads{$b}{bytes_read} || 0) <=>
			       ($reads{$a}{bytes_read} || 0) } keys %reads) {
	my $comm = $reads{$pid}{comm} || "";
	my $total_reads = $reads{$pid}{total_reads} || 0;
	my $bytes_requested = $reads{$pid}{bytes_requested} || 0;
	my $bytes_read = $reads{$pid}{bytes_read} || 0;

	printf("%6s  %-20s  %10s  %10s  %10s\n", $pid, $comm,
	       $total_reads, $bytes_requested, $bytes_read);

	if (++$count == $nlines) {
	    last;
	}
    }

    $count = 0;

    printf("\nwrite counts by pid:\n\n");

    printf("%6s  %20s  %10s  %13s\n", "pid", "comm",
	   "# writes", "bytes_written");
    printf("%6s  %-20s  %10s  %13s\n", "------", "--------------------",
	   "----------", "-------------");

    foreach my $pid (sort { ($writes{$b}{bytes_written} || 0) <=>
			($writes{$a}{bytes_written} || 0)} keys %writes) {
	my $comm = $writes{$pid}{comm} || "";
	my $total_writes = $writes{$pid}{total_writes} || 0;
	my $bytes_written = $writes{$pid}{bytes_written} || 0;

	printf("%6s  %-20s  %10s  %13s\n", $pid, $comm,
	       $total_writes, $bytes_written);

	if (++$count == $nlines) {
	    last;
	}
    }

    %reads = ();
    %writes = ();
}

my %unhandled;

sub print_unhandled
{
    if ((scalar keys %unhandled) == 0) {
	return;
    }

    print "\nunhandled events:\n\n";

    printf("%-40s  %10s\n", "event", "count");
    printf("%-40s  %10s\n", "----------------------------------------",
	   "-----------");

    foreach my $event_name (keys %unhandled) {
	printf("%-40s  %10d\n", $event_name, $unhandled{$event_name});
    }
}

sub trace_unhandled
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm) = @_;

    $unhandled{$event_name}++;
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      use 5.010000;
use ExtUtils::MakeMaker;
# See lib/ExtUtils/MakeMaker.pm for details of how to influence
# the contents of the Makefile that is written.
WriteMakefile(
    NAME              => 'Perf::Trace::Context',
    VERSION_FROM      => 'lib/Perf/Trace/Context.pm', # finds $VERSION
    PREREQ_PM         => {}, # e.g., Module::Name => 1.1
    ($] >= 5.005 ?     ## Add these new keywords supported since 5.005
      (ABSTRACT_FROM  => 'lib/Perf/Trace/Context.pm', # retrieve abstract from module
       AUTHOR         => 'Tom Zanussi <tzanussi@gmail.com>') : ()),
    LIBS              => [''], # e.g., '-lm'
    DEFINE            => '-I ../..', # e.g., '-DHAVE_SOMETHING'
    INC               => '-I.', # e.g., '-I. -I/usr/include/other'
	# Un-comment this if you add C files to link with later:
    OBJECT            => 'Context.o', # link all the C files too
);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          #!/usr/bin/perl -w
# (c) 2009, Tom Zanussi <tzanussi@gmail.com>
# Licensed under the terms of the GNU GPL License version 2

# Display r/w activity for files read/written to for a given program

# The common_* event handler fields are the most useful fields common to
# all events.  They don't necessarily correspond to the 'common_*' fields
# in the status files.  Those fields not available as handler params can
# be retrieved via script functions of the form get_common_*().

use 5.010000;
use strict;
use warnings;

use lib "$ENV{'PERF_EXEC_PATH'}/scripts/perl/Perf-Trace-Util/lib";
use lib "./Perf-Trace-Util/lib";
use Perf::Trace::Core;
use Perf::Trace::Util;

my $usage = "perf script -s rw-by-file.pl <comm>\n";

my $for_comm = shift or die $usage;

my %reads;
my %writes;

sub syscalls::sys_enter_read
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm, $nr, $fd, $buf, $count) = @_;

    if ($common_comm eq $for_comm) {
	$reads{$fd}{bytes_requested} += $count;
	$reads{$fd}{total_reads}++;
    }
}

sub syscalls::sys_enter_write
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm, $nr, $fd, $buf, $count) = @_;

    if ($common_comm eq $for_comm) {
	$writes{$fd}{bytes_written} += $count;
	$writes{$fd}{total_writes}++;
    }
}

sub trace_end
{
    printf("file read counts for $for_comm:\n\n");

    printf("%6s  %10s  %10s\n", "fd", "# reads", "bytes_requested");
    printf("%6s  %10s  %10s\n", "------", "----------", "-----------");

    foreach my $fd (sort {$reads{$b}{bytes_requested} <=>
			      $reads{$a}{bytes_requested}} keys %reads) {
	my $total_reads = $reads{$fd}{total_reads};
	my $bytes_requested = $reads{$fd}{bytes_requested};
	printf("%6u  %10u  %10u\n", $fd, $total_reads, $bytes_requested);
    }

    printf("\nfile write counts for $for_comm:\n\n");

    printf("%6s  %10s  %10s\n", "fd", "# writes", "bytes_written");
    printf("%6s  %10s  %10s\n", "------", "----------", "-----------");

    foreach my $fd (sort {$writes{$b}{bytes_written} <=>
			      $writes{$a}{bytes_written}} keys %writes) {
	my $total_writes = $writes{$fd}{total_writes};
	my $bytes_written = $writes{$fd}{bytes_written};
	printf("%6u  %10u  %10u\n", $fd, $total_writes, $bytes_written);
    }

    print_unhandled();
}

my %unhandled;

sub print_unhandled
{
    if ((scalar keys %unhandled) == 0) {
	return;
    }

    print "\nunhandled events:\n\n";

    printf("%-40s  %10s\n", "event", "count");
    printf("%-40s  %10s\n", "----------------------------------------",
	   "-----------");

    foreach my $event_name (keys %unhandled) {
	printf("%-40s  %10d\n", $event_name, $unhandled{$event_name});
    }
}

sub trace_unhandled
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm) = @_;

    $unhandled{$event_name}++;
}


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               #!/usr/bin/perl -w
# (c) 2009, Tom Zanussi <tzanussi@gmail.com>
# Licensed under the terms of the GNU GPL License version 2

# Display r/w activity for all processes

# The common_* event handler fields are the most useful fields common to
# all events.  They don't necessarily correspond to the 'common_*' fields
# in the status files.  Those fields not available as handler params can
# be retrieved via script functions of the form get_common_*().

use 5.010000;
use strict;
use warnings;

use lib "$ENV{'PERF_EXEC_PATH'}/scripts/perl/Perf-Trace-Util/lib";
use lib "./Perf-Trace-Util/lib";
use Perf::Trace::Core;
use Perf::Trace::Util;

my %reads;
my %writes;

sub syscalls::sys_exit_read
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $ret) = @_;

    if ($ret > 0) {
	$reads{$common_pid}{bytes_read} += $ret;
    } else {
	if (!defined ($reads{$common_pid}{bytes_read})) {
	    $reads{$common_pid}{bytes_read} = 0;
	}
	$reads{$common_pid}{errors}{$ret}++;
    }
}

sub syscalls::sys_enter_read
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $fd, $buf, $count) = @_;

    $reads{$common_pid}{bytes_requested} += $count;
    $reads{$common_pid}{total_reads}++;
    $reads{$common_pid}{comm} = $common_comm;
}

sub syscalls::sys_exit_write
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $ret) = @_;

    if ($ret <= 0) {
	$writes{$common_pid}{errors}{$ret}++;
    }
}

sub syscalls::sys_enter_write
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm,
	$nr, $fd, $buf, $count) = @_;

    $writes{$common_pid}{bytes_written} += $count;
    $writes{$common_pid}{total_writes}++;
    $writes{$common_pid}{comm} = $common_comm;
}

sub trace_end
{
    printf("read counts by pid:\n\n");

    printf("%6s  %20s  %10s  %10s  %10s\n", "pid", "comm",
	   "# reads", "bytes_requested", "bytes_read");
    printf("%6s  %-20s  %10s  %10s  %10s\n", "------", "--------------------",
	   "-----------", "----------", "----------");

    foreach my $pid (sort { ($reads{$b}{bytes_read} || 0) <=>
				($reads{$a}{bytes_read} || 0) } keys %reads) {
	my $comm = $reads{$pid}{comm} || "";
	my $total_reads = $reads{$pid}{total_reads} || 0;
	my $bytes_requested = $reads{$pid}{bytes_requested} || 0;
	my $bytes_read = $reads{$pid}{bytes_read} || 0;

	printf("%6s  %-20s  %10s  %10s  %10s\n", $pid, $comm,
	       $total_reads, $bytes_requested, $bytes_read);
    }

    printf("\nfailed reads by pid:\n\n");

    printf("%6s  %20s  %6s  %10s\n", "pid", "comm", "error #", "# errors");
    printf("%6s  %20s  %6s  %10s\n", "------", "--------------------",
	   "------", "----------");

    my @errcounts = ();

    foreach my $pid (keys %reads) {
	foreach my $error (keys %{$reads{$pid}{errors}}) {
	    my $comm = $reads{$pid}{comm} || "";
	    my $errcount = $reads{$pid}{errors}{$error} || 0;
	    push @errcounts, [$pid, $comm, $error, $errcount];
	}
    }

    @errcounts = sort { $b->[3] <=> $a->[3] } @errcounts;

    for my $i (0 .. $#errcounts) {
	printf("%6d  %-20s  %6d  %10s\n", $errcounts[$i][0],
	       $errcounts[$i][1], $errcounts[$i][2], $errcounts[$i][3]);
    }

    printf("\nwrite counts by pid:\n\n");

    printf("%6s  %20s  %10s  %10s\n", "pid", "comm",
	   "# writes", "bytes_written");
    printf("%6s  %-20s  %10s  %10s\n", "------", "--------------------",
	   "-----------", "----------");

    foreach my $pid (sort { ($writes{$b}{bytes_written} || 0) <=>
			($writes{$a}{bytes_written} || 0)} keys %writes) {
	my $comm = $writes{$pid}{comm} || "";
	my $total_writes = $writes{$pid}{total_writes} || 0;
	my $bytes_written = $writes{$pid}{bytes_written} || 0;

	printf("%6s  %-20s  %10s  %10s\n", $pid, $comm,
	       $total_writes, $bytes_written);
    }

    printf("\nfailed writes by pid:\n\n");

    printf("%6s  %20s  %6s  %10s\n", "pid", "comm", "error #", "# errors");
    printf("%6s  %20s  %6s  %10s\n", "------", "--------------------",
	   "------", "----------");

    @errcounts = ();

    foreach my $pid (keys %writes) {
	foreach my $error (keys %{$writes{$pid}{errors}}) {
	    my $comm = $writes{$pid}{comm} || "";
	    my $errcount = $writes{$pid}{errors}{$error} || 0;
	    push @errcounts, [$pid, $comm, $error, $errcount];
	}
    }

    @errcounts = sort { $b->[3] <=> $a->[3] } @errcounts;

    for my $i (0 .. $#errcounts) {
	printf("%6d  %-20s  %6d  %10s\n", $errcounts[$i][0],
	       $errcounts[$i][1], $errcounts[$i][2], $errcounts[$i][3]);
    }

    print_unhandled();
}

my %unhandled;

sub print_unhandled
{
    if ((scalar keys %unhandled) == 0) {
	return;
    }

    print "\nunhandled events:\n\n";

    printf("%-40s  %10s\n", "event", "count");
    printf("%-40s  %10s\n", "----------------------------------------",
	   "-----------");

    foreach my $event_name (keys %unhandled) {
	printf("%-40s  %10d\n", $event_name, $unhandled{$event_name});
    }
}

sub trace_unhandled
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm) = @_;

    $unhandled{$event_name}++;
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # perf script event handlers, generated by perf script -g perl
# (c) 2009, Tom Zanussi <tzanussi@gmail.com>
# Licensed under the terms of the GNU GPL License version 2

# This script tests basic functionality such as flag and symbol
# strings, common_xxx() calls back into perf, begin, end, unhandled
# events, etc.  Basically, if this script runs successfully and
# displays expected results, perl scripting support should be ok.

use lib "$ENV{'PERF_EXEC_PATH'}/scripts/perl/Perf-Trace-Util/lib";
use lib "./Perf-Trace-Util/lib";
use Perf::Trace::Core;
use Perf::Trace::Context;
use Perf::Trace::Util;

sub trace_begin
{
    print "trace_begin\n";
}

sub trace_end
{
    print "trace_end\n";

    print_unhandled();
}

sub irq::softirq_entry
{
	my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	    $common_pid, $common_comm,
	    $vec) = @_;

	print_header($event_name, $common_cpu, $common_secs, $common_nsecs,
		     $common_pid, $common_comm);

	print_uncommon($context);

	printf("vec=%s\n",
	       symbol_str("irq::softirq_entry", "vec", $vec));
}

sub kmem::kmalloc
{
	my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	    $common_pid, $common_comm,
	    $call_site, $ptr, $bytes_req, $bytes_alloc,
	    $gfp_flags) = @_;

	print_header($event_name, $common_cpu, $common_secs, $common_nsecs,
		     $common_pid, $common_comm);

	print_uncommon($context);

	printf("call_site=%p, ptr=%p, bytes_req=%u, bytes_alloc=%u, ".
	       "gfp_flags=%s\n",
	       $call_site, $ptr, $bytes_req, $bytes_alloc,

	       flag_str("kmem::kmalloc", "gfp_flags", $gfp_flags));
}

# print trace fields not included in handler args
sub print_uncommon
{
    my ($context) = @_;

    printf("common_preempt_count=%d, common_flags=%s, common_lock_depth=%d, ",
	   common_pc($context), trace_flag_str(common_flags($context)),
	   common_lock_depth($context));

}

my %unhandled;

sub print_unhandled
{
    if ((scalar keys %unhandled) == 0) {
	return;
    }

    print "\nunhandled events:\n\n";

    printf("%-40s  %10s\n", "event", "count");
    printf("%-40s  %10s\n", "----------------------------------------",
	   "-----------");

    foreach my $event_name (keys %unhandled) {
	printf("%-40s  %10d\n", $event_name, $unhandled{$event_name});
    }
}

sub trace_unhandled
{
    my ($event_name, $context, $common_cpu, $common_secs, $common_nsecs,
	$common_pid, $common_comm) = @_;

    $unhandled{$event_name}++;
}

sub print_header
{
	my ($event_name, $cpu, $secs, $nsecs, $pid, $comm) = @_;

	printf("%-20s %5u %05u.%09u %8u %-20s ",
	       $event_name, $cpu, $secs, $nsecs, $pid, $comm);
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ifndef NO_DWARF
PERF_HAVE_DWARF_REGS := 1
endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ifndef NO_DWARF
PERF_HAVE_DWARF_REGS := 1
endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ifndef NO_DWARF
PERF_HAVE_DWARF_REGS := 1
endif
HAVE_KVM_STAT_SUPPORT := 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ifndef NO_DWARF
PERF_HAVE_DWARF_REGS := 1
endif
HAVE_KVM_STAT_SUPPORT := 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ifndef NO_DWARF
PERF_HAVE_DWARF_REGS := 1
endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ifndef NO_DWARF
PERF_HAVE_DWARF_REGS := 1
endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ifndef NO_DWARF
PERF_HAVE_DWARF_REGS := 1
endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                # This creates the demonstration utility "lguest" which runs a Linux guest.
CFLAGS:=-m32 -Wall -Wmissing-declarations -Wmissing-prototypes -O3 -U_FORTIFY_SOURCE -Iinclude

all: lguest

include/linux/virtio_types.h: ../../include/uapi/linux/virtio_types.h
	mkdir -p include/linux 2>&1 || true
	ln -sf ../../../../include/uapi/linux/virtio_types.h $@

lguest: include/linux/virtio_types.h

clean:
	rm -f lguest
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       #!/usr/bin/perl

open (IN,"ktest.pl");
while (<IN>) {
    # hashes are now used
    if (/\$opt\{"?([A-Z].*?)(\[.*\])?"?\}/ ||
	/^\s*"?([A-Z].*?)"?\s*=>\s*/ ||
	/set_test_option\("(.*?)"/) {
	$opt{$1} = 1;
    }
}
close IN;

open (IN, "sample.conf");
while (<IN>) {
    if (/^\s*#?\s*([A-Z]\S*)\s*=/) {
	$samp{$1} = 1;
    }
}
close IN;

foreach $opt (keys %opt) {
    if (!defined($samp{$opt})) {
	print "opt = $opt\n";
    }
}

foreach $samp (keys %samp) {
    if (!defined($opt{$samp})) {
	print "samp = $samp\n";
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    # Makefile for user memory selftests

# No binaries, but make sure arg-less "make" doesn't trigger "run_tests"
all:

TEST_PROGS := test_user_copy.sh

include ../lib.mk
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        CC = $(CROSS_COMPILE)gcc
BUILD_FLAGS = -DKTEST
CFLAGS += -O3 -Wl,-no-as-needed -Wall $(BUILD_FLAGS)
LDFLAGS += -lrt -lpthread

# these are all "safe" tests that don't modify
# system time or require escalated privledges
TEST_PROGS = posix_timers nanosleep nsleep-lat set-timer-lat mqueue-lat \
	     inconsistency-check raw_skew threadtest rtctest

TEST_PROGS_EXTENDED = alarmtimer-suspend valid-adjtimex change_skew \
		      skew_consistency clocksource-switch leap-a-day \
		      leapcrash set-tai set-2038

bins = $(TEST_PROGS) $(TEST_PROGS_EXTENDED)

all: ${bins}

include ../lib.mk

# these tests require escalated privledges
# and may modify the system time or trigger
# other behavior like suspend
run_destructive_tests: run_tests
	./alarmtimer-suspend
	./valid-adjtimex
	./change_skew
	./skew_consistency
	./clocksource-switch
	./leap-a-day -s -i 10
	./leapcrash
	./set-tai
	./set-2038

clean:
	rm -f ${bins}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         CFLAGS = -Wall

test_objs = open-unlink create-read

all: $(test_objs)

TEST_PROGS := efivarfs.sh
TEST_FILES := $(test_objs)

include ../lib.mk

clean:
	rm -f $(test_objs)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CFLAGS = -O2

all:
	$(CC) $(CFLAGS) mq_open_tests.c -o mq_open_tests -lrt
	$(CC) $(CFLAGS) -o mq_perf_tests mq_perf_tests.c -lrt -lpthread -lpopt

include ../lib.mk

override define RUN_TESTS
	@./mq_open_tests /test1 || echo "selftests: mq_open_tests [FAIL]"
	@./mq_perf_tests || echo "selftests: mq_perf_tests [FAIL]"
endef

TEST_PROGS := mq_open_tests mq_perf_tests

override define EMIT_TESTS
	echo "./mq_open_tests /test1 || echo \"selftests: mq_open_tests [FAIL]\""
	echo "./mq_perf_tests || echo \"selftests: mq_perf_tests [FAIL]\""
endef

clean:
	rm -f mq_open_tests mq_perf_tests
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CFLAGS += -I../../../../usr/include/

all: kcmp_test

TEST_PROGS := kcmp_test

include ../lib.mk

clean:
	$(RM) kcmp_test kcmp-test-file
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       # DNS management tool
#
# Copyright (C) Amitay Isaacs 2011-2012
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

import samba.getopt as options
from struct import pack
from socket import inet_ntoa
from socket import inet_ntop
from socket import AF_INET
from socket import AF_INET6
import shlex

from samba.netcmd import (
    Command,
    CommandError,
    Option,
    SuperCommand,
    )
from samba.dcerpc import dnsp, dnsserver


def dns_connect(server, lp, creds):
    if server.lower() == 'localhost':
        server = '127.0.0.1'
    binding_str = "ncacn_ip_tcp:%s[sign]" % server
    dns_conn = dnsserver.dnsserver(binding_str, lp, creds)
    return dns_conn


def bool_string(flag):
    if flag == 0:
        ret = 'FALSE'
    elif flag == 1:
        ret = 'TRUE'
    else:
        ret = 'UNKNOWN (0x%x)' % flag
    return ret


def enum_string(module, enum_defs, value):
    ret = None
    for e in enum_defs:
        if value == getattr(module, e):
            ret = e
            break
    if not ret:
        ret = 'UNKNOWN (0x%x)' % value
    return ret


def bitmap_string(module, bitmap_defs, value):
    ret = ''
    for b in bitmap_defs:
        if value & getattr(module, b):
            ret += '%s ' % b
    if not ret:
        ret = 'NONE'
    return ret


def boot_method_string(boot_method):
    enum_defs = [ 'DNS_BOOT_METHOD_UNINITIALIZED', 'DNS_BOOT_METHOD_FILE',
                    'DNS_BOOT_METHOD_REGISTRY', 'DNS_BOOT_METHOD_DIRECTORY' ]
    return enum_string(dnsserver, enum_defs, boot_method)


def name_check_flag_string(check_flag):
    enum_defs = [ 'DNS_ALLOW_RFC_NAMES_ONLY', 'DNS_ALLOW_NONRFC_NAMES',
                    'DNS_ALLOW_MULTIBYTE_NAMES', 'DNS_ALLOW_ALL_NAMES' ]
    return enum_string(dnsserver, enum_defs, check_flag)


def zone_type_string(zone_type):
    enum_defs = [ 'DNS_ZONE_TYPE_CACHE', 'DNS_ZONE_TYPE_PRIMARY',
                    'DNS_ZONE_TYPE_SECONDARY', 'DNS_ZONE_TYPE_STUB',
                    'DNS_ZONE_TYPE_FORWARDER', 'DNS_ZONE_TYPE_SECONDARY_CACHE' ]
    return enum_string(dnsp, enum_defs, zone_type)


def zone_update_string(zone_update):
    enum_defs = [ 'DNS_ZONE_UPDATE_OFF', 'DNS_ZONE_UPDATE_UNSECURE',
                    'DNS_ZONE_UPDATE_SECURE' ]
    return enum_string(dnsp, enum_defs, zone_update)


def zone_secondary_security_string(security):
    enum_defs = [ 'DNS_ZONE_SECSECURE_NO_SECURITY', 'DNS_ZONE_SECSECURE_NS_ONLY',
                    'DNS_ZONE_SECSECURE_LIST_ONLY', 'DNS_ZONE_SECSECURE_NO_XFER' ]
    return enum_string(dnsserver, enum_defs, security)


def zone_notify_level_string(notify_level):
    enum_defs = [ 'DNS_ZONE_NOTIFY_OFF', 'DNS_ZONE_NOTIFY_ALL_SECONDARIES',
                    'DNS_ZONE_NOTIFY_LIST_ONLY' ]
    return enum_string(dnsserver, enum_defs, notify_level)


def dp_flags_string(dp_flags):
    bitmap_defs = [ 'DNS_DP_AUTOCREATED', 'DNS_DP_LEGACY', 'DNS_DP_DOMAIN_DEFAULT',
                'DNS_DP_FOREST_DEFAULT', 'DNS_DP_ENLISTED', 'DNS_DP_DELETED' ]
    return bitmap_string(dnsserver, bitmap_defs, dp_flags)


def zone_flags_string(flags):
    bitmap_defs = [ 'DNS_RPC_ZONE_PAUSED', 'DNS_RPC_ZONE_SHUTDOWN',
                    'DNS_RPC_ZONE_REVERSE', 'DNS_RPC_ZONE_AUTOCREATED',
                    'DNS_RPC_ZONE_DSINTEGRATED', 'DNS_RPC_ZONE_AGING',
                    'DNS_RPC_ZONE_UPDATE_UNSECURE', 'DNS_RPC_ZONE_UPDATE_SECURE',
                    'DNS_RPC_ZONE_READONLY']
    return bitmap_string(dnsserver, bitmap_defs, flags)


def ip4_array_string(array):
    ret = []
    if not array:
        return ret
    for i in xrange(array.AddrCount):
        addr = inet_ntop(AF_INET, pack('I', array.AddrArray[i]))
        ret.append(addr)
    return ret


def dns_addr_array_string(array):
    ret = []
    if not array:
        return ret
    for i in xrange(array.AddrCount):
        if array.AddrArray[i].MaxSa[0] == 0x02:
            x = "".join([chr(b) for b in array.AddrArray[i].MaxSa])[4:8]
            addr = inet_ntop(AF_INET, x)
        elif array.AddrArray[i].MaxSa[0] == 0x17:
            x = "".join([chr(b) for b in array.AddrArray[i].MaxSa])[8:24]
            addr = inet_ntop(AF_INET6, x)
        else:
            addr = 'UNKNOWN'
        ret.append(addr)
    return ret


def dns_type_flag(rec_type):
    rtype = rec_type.upper()
    if rtype == 'A':
        record_type = dnsp.DNS_TYPE_A
    elif rtype == 'AAAA':
        record_type = dnsp.DNS_TYPE_AAAA
    elif rtype == 'PTR':
        record_type = dnsp.DNS_TYPE_PTR
    elif rtype == 'NS':
        record_type = dnsp.DNS_TYPE_NS
    elif rtype == 'CNAME':
        record_type = dnsp.DNS_TYPE_CNAME
    elif rtype == 'SOA':
        record_type = dnsp.DNS_TYPE_SOA
    elif rtype == 'MX':
        record_type = dnsp.DNS_TYPE_MX
    elif rtype == 'SRV':
        record_type = dnsp.DNS_TYPE_SRV
    elif rtype == 'TXT':
        record_type = dnsp.DNS_TYPE_TXT
    elif rtype == 'ALL':
        record_type = dnsp.DNS_TYPE_ALL
    else:
        raise CommandError('Unknown type of DNS record %s' % rec_type)
    return record_type


def dns_client_version(cli_version):
    version = cli_version.upper()
    if version == 'W2K':
        client_version = dnsserver.DNS_CLIENT_VERSION_W2K
    elif version == 'DOTNET':
        client_version = dnsserver.DNS_CLIENT_VERSION_DOTNET
    elif version == 'LONGHORN':
        client_version = dnsserver.DNS_CLIENT_VERSION_LONGHORN
    else:
        raise CommandError('Unknown client version %s' % cli_version)
    return client_version


def print_serverinfo(outf, typeid, serverinfo):
    outf.write('  dwVersion                   : 0x%x\n' % serverinfo.dwVersion)
    outf.write('  fBootMethod                 : %s\n' % boot_method_string(serverinfo.fBootMethod))
    outf.write('  fAdminConfigured            : %s\n' % bool_string(serverinfo.fAdminConfigured))
    outf.write('  fAllowUpdate                : %s\n' % bool_string(serverinfo.fAllowUpdate))
    outf.write('  fDsAvailable                : %s\n' % bool_string(serverinfo.fDsAvailable))
    outf.write('  pszServerName               : %s\n' % serverinfo.pszServerName)
    outf.write('  pszDsContainer              : %s\n' % serverinfo.pszDsContainer)

    if typeid != dnsserver.DNSSRV_TYPEID_SERVER_INFO:
        outf.write('  aipServerAddrs              : %s\n' %
                    ip4_array_string(serverinfo.aipServerAddrs))
        outf.write('  aipListenAddrs              : %s\n' %
                    ip4_array_string(serverinfo.aipListenAddrs))
        outf.write('  aipForwarders               : %s\n' %
                    ip4_array_string(serverinfo.aipForwarders))
    else:
        outf.write('  aipServerAddrs              : %s\n' %
                    dns_addr_array_string(serverinfo.aipServerAddrs))
        outf.write('  aipListenAddrs              : %s\n' %
                    dns_addr_array_string(serverinfo.aipListenAddrs))
        outf.write('  aipForwarders               : %s\n' %
                    dns_addr_array_string(serverinfo.aipForwarders))

    outf.write('  dwLogLevel                  : %d\n' % serverinfo.dwLogLevel)
    outf.write('  dwDebugLevel                : %d\n' % serverinfo.dwDebugLevel)
    outf.write('  dwForwardTimeout            : %d\n' % serverinfo.dwForwardTimeout)
    outf.write('  dwRpcPrototol               : 0x%x\n' % serverinfo.dwRpcProtocol)
    outf.write('  dwNameCheckFlag             : %s\n' % name_check_flag_string(serverinfo.dwNameCheckFlag))
    outf.write('  cAddressAnswerLimit         : %d\n' % serverinfo.cAddressAnswerLimit)
    outf.write('  dwRecursionRetry            : %d\n' % serverinfo.dwRecursionRetry)
    outf.write('  dwRecursionTimeout          : %d\n' % serverinfo.dwRecursionTimeout)
    outf.write('  dwMaxCacheTtl               : %d\n' % serverinfo.dwMaxCacheTtl)
    outf.write('  dwDsPollingInterval         : %d\n' % serverinfo.dwDsPollingInterval)
    outf.write('  dwScavengingInterval        : %d\n' % serverinfo.dwScavengingInterval)
    outf.write('  dwDefaultRefreshInterval    : %d\n' % serverinfo.dwDefaultRefreshInterval)
    outf.write('  dwDefaultNoRefreshInterval  : %d\n' % serverinfo.dwDefaultNoRefreshInterval)
    outf.write('  fAutoReverseZones           : %s\n' % bool_string(serverinfo.fAutoReverseZones))
    outf.write('  fAutoCacheUpdate            : %s\n' % bool_string(serverinfo.fAutoCacheUpdate))
    outf.write('  fRecurseAfterForwarding     : %s\n' % bool_string(serverinfo.fRecurseAfterForwarding))
    outf.write('  fForwardDelegations         : %s\n' % bool_string(serverinfo.fForwardDelegations))
    outf.write('  fNoRecursion                : %s\n' % bool_string(serverinfo.fNoRecursion))
    outf.write('  fSecureResponses            : %s\n' % bool_string(serverinfo.fSecureResponses))
    outf.write('  fRoundRobin                 : %s\n' % bool_string(serverinfo.fRoundRobin))
    outf.write('  fLocalNetPriority           : %s\n' % bool_string(serverinfo.fLocalNetPriority))
    outf.write('  fBindSecondaries            : %s\n' % bool_string(serverinfo.fBindSecondaries))
    outf.write('  fWriteAuthorityNs           : %s\n' % bool_string(serverinfo.fWriteAuthorityNs))
    outf.write('  fStrictFileParsing          : %s\n' % bool_string(serverinfo.fStrictFileParsing))
    outf.write('  fLooseWildcarding           : %s\n' % bool_string(serverinfo.fLooseWildcarding))
    outf.write('  fDefaultAgingState          : %s\n' % bool_string(serverinfo.fDefaultAgingState))

    if typeid != dnsserver.DNSSRV_TYPEID_SERVER_INFO_W2K:
        outf.write('  dwRpcStructureVersion       : 0x%x\n' % serverinfo.dwRpcStructureVersion)
        outf.write('  aipLogFilter                : %s\n' % dns_addr_array_string(serverinfo.aipLogFilter))
        outf.write('  pwszLogFilePath             : %s\n' % serverinfo.pwszLogFilePath)
        outf.write('  pszDomainName               : %s\n' % serverinfo.pszDomainName)
        outf.write('  pszForestName               : %s\n' % serverinfo.pszForestName)
        outf.write('  pszDomainDirectoryPartition : %s\n' % serverinfo.pszDomainDirectoryPartition)
        outf.write('  pszForestDirectoryPartition : %s\n' % serverinfo.pszForestDirectoryPartition)

        outf.write('  dwLocalNetPriorityNetMask   : 0x%x\n' % serverinfo.dwLocalNetPriorityNetMask)
        outf.write('  dwLastScavengeTime          : %d\n' % serverinfo.dwLastScavengeTime)
        outf.write('  dwEventLogLevel             : %d\n' % serverinfo.dwEventLogLevel)
        outf.write('  dwLogFileMaxSize            : %d\n' % serverinfo.dwLogFileMaxSize)
        outf.write('  dwDsForestVersion           : %d\n' % serverinfo.dwDsForestVersion)
        outf.write('  dwDsDomainVersion           : %d\n' % serverinfo.dwDsDomainVersion)
        outf.write('  dwDsDsaVersion              : %d\n' % serverinfo.dwDsDsaVersion)

    if typeid == dnsserver.DNSSRV_TYPEID_SERVER_INFO:
        outf.write('  fReadOnlyDC                 : %s\n' % bool_string(serverinfo.fReadOnlyDC))


def print_zoneinfo(outf, typeid, zoneinfo):
    outf.write('  pszZoneName                 : %s\n' % zoneinfo.pszZoneName)
    outf.write('  dwZoneType                  : %s\n' % zone_type_string(zoneinfo.dwZoneType))
    outf.write('  fReverse                    : %s\n' % bool_string(zoneinfo.fReverse))
    outf.write('  fAllowUpdate                : %s\n' % zone_update_string(zoneinfo.fAllowUpdate))
    outf.write('  fPaused                     : %s\n' % bool_string(zoneinfo.fPaused))
    outf.write('  fShutdown                   : %s\n' % bool_string(zoneinfo.fShutdown))
    outf.write('  fAutoCreated                : %s\n' % bool_string(zoneinfo.fAutoCreated))
    outf.write('  fUseDatabase                : %s\n' % bool_string(zoneinfo.fUseDatabase))
    outf.write('  pszDataFile                 : %s\n' % zoneinfo.pszDataFile)
    if typeid != dnsserver.DNSSRV_TYPEID_ZONE_INFO:
        outf.write('  aipMasters                  : %s\n' %
                    ip4_array_string(zoneinfo.aipMasters))
    else:
        outf.write('  aipMasters                  : %s\n' %
                    dns_addr_array_string(zoneinfo.aipMasters))
    outf.write('  fSecureSecondaries          : %s\n' % zone_secondary_security_string(zoneinfo.fSecureSecondaries))
    outf.write('  fNotifyLevel                : %s\n' % zone_notify_level_string(zoneinfo.fNotifyLevel))
    if typeid != dnsserver.DNSSRV_TYPEID_ZONE_INFO:
        outf.write('  aipSecondaries              : %s\n' %
                    ip4_array_string(zoneinfo.aipSecondaries))
        outf.write('  aipNotify                   : %s\n' %
                    ip4_array_string(zoneinfo.aipNotify))
    else:
        outf.write('  aipSecondaries              : %s\n' %
                    dns_addr_array_string(zoneinfo.aipSecondaries))
        outf.write('  aipNotify                   : %s\n' %
                    dns_addr_array_string(zoneinfo.aipNotify))
    outf.write('  fUseWins                    : %s\n' % bool_string(zoneinfo.fUseWins))
    outf.write('  fUseNbstat                  : %s\n' % bool_string(zoneinfo.fUseNbstat))
    outf.write('  fAging                      : %s\n' % bool_string(zoneinfo.fAging))
    outf.write('  dwNoRefreshInterval         : %d\n' % zoneinfo.dwNoRefreshInterval)
    outf.write('  dwRefreshInterval           : %d\n' % zoneinfo.dwRefreshInterval)
    outf.write('  dwAvailForScavengeTime      : %d\n' % zoneinfo.dwAvailForScavengeTime)
    if typeid != dnsserver.DNSSRV_TYPEID_ZONE_INFO:
        outf.write('  aipScavengeServers          : %s\n' %
                    ip4_array_string(zoneinfo.aipScavengeServers))
    else:
        outf.write('  aipScavengeServers          : %s\n' %
                    dns_addr_array_string(zoneinfo.aipScavengeServers))

    if typeid != dnsserver.DNSSRV_TYPEID_ZONE_INFO_W2K:
        outf.write('  dwRpcStructureVersion       : 0x%x\n' % zoneinfo.dwRpcStructureVersion)
        outf.write('  dwForwarderTimeout          : %d\n' % zoneinfo.dwForwarderTimeout)
        outf.write('  fForwarderSlave             : %d\n' % zoneinfo.fForwarderSlave)
        if typeid != dnsserver.DNSSRV_TYPEID_ZONE_INFO:
            outf.write('  aipLocalMasters             : %s\n' %
                        ip4_array_string(zoneinfo.aipLocalMasters))
        else:
            outf.write('  aipLocalMasters             : %s\n' %
                        dns_addr_array_string(zoneinfo.aipLocalMasters))
        outf.write('  dwDpFlags                   : %s\n' % dp_flags_string(zoneinfo.dwDpFlags))
        outf.write('  pszDpFqdn                   : %s\n' % zoneinfo.pszDpFqdn)
        outf.write('  pwszZoneDn                  : %s\n' % zoneinfo.pwszZoneDn)
        outf.write('  dwLastSuccessfulSoaCheck    : %d\n' % zoneinfo.dwLastSuccessfulSoaCheck)
        outf.write('  dwLastSuccessfulXfr         : %d\n' % zoneinfo.dwLastSuccessfulXfr)

    if typeid == dnsserver.DNSSRV_TYPEID_ZONE_INFO:
        outf.write('  fQueuedForBackgroundLoad    : %s\n' % bool_string(zoneinfo.fQueuedForBackgroundLoad))
        outf.write('  fBackgroundLoadInProgress   : %s\n' % bool_string(zoneinfo.fBackgroundLoadInProgress))
        outf.write('  fReadOnlyZone               : %s\n' % bool_string(zoneinfo.fReadOnlyZone))
        outf.write('  dwLastXfrAttempt            : %d\n' % zoneinfo.dwLastXfrAttempt)
        outf.write('  dwLastXfrResult             : %d\n' % zoneinfo.dwLastXfrResult)


def print_zone(outf, typeid, zone):
    outf.write('  pszZoneName                 : %s\n' % zone.pszZoneName)
    outf.write('  Flags                       : %s\n' % zone_flags_string(zone.Flags))
    outf.write('  ZoneType                    : %s\n' % zone_type_string(zone.ZoneType))
    outf.write('  Version                     : %s\n' % zone.Version)

    if typeid != dnsserver.DNSSRV_TYPEID_ZONE_W2K:
        outf.write('  dwDpFlags                   : %s\n' % dp_flags_string(zone.dwDpFlags))
        outf.write('  pszDpFqdn                   : %s\n' % zone.pszDpFqdn)


def print_enumzones(outf, typeid, zones):
    outf.write('  %d zone(s) found\n' % zones.dwZoneCount)
    for zone in zones.ZoneArray:
        outf.write('\n')
        print_zone(outf, typeid, zone)


def print_dns_record(outf, rec):
    if rec.wType == dnsp.DNS_TYPE_A:
        mesg = 'A: %s' % (rec.data)
    elif rec.wType == dnsp.DNS_TYPE_AAAA:
        mesg = 'AAAA: %s' % (rec.data)
    elif rec.wType == dnsp.DNS_TYPE_PTR:
        mesg = 'PTR: %s' % (rec.data.str)
    elif rec.wType == dnsp.DNS_TYPE_NS:
        mesg = 'NS: %s' % (rec.data.str)
    elif rec.wType == dnsp.DNS_TYPE_CNAME:
        mesg = 'CNAME: %s' % (rec.data.str)
    elif rec.wType == dnsp.DNS_TYPE_SOA:
        mesg = 'SOA: serial=%d, refresh=%d, retry=%d, expire=%d, minttl=%d, ns=%s, email=%s' % (
                    rec.data.dwSerialNo,
                    rec.data.dwRefresh,
                    rec.data.dwRetry,
                    rec.data.dwExpire,
                    rec.data.dwMinimumTtl,
                    rec.data.NamePrimaryServer.str,
                    rec.data.ZoneAdministratorEmail.str)
    elif rec.wType == dnsp.DNS_TYPE_MX:
        mesg = 'MX: %s (%d)' % (rec.data.nameExchange.str, rec.data.wPreference)
    elif rec.wType == dnsp.DNS_TYPE_SRV:
        mesg = 'SRV: %s (%d, %d, %d)' % (rec.data.nameTarget.str, rec.data.wPort,
                                         rec.data.wPriority, rec.data.wWeight)
    elif rec.wType == dnsp.DNS_TYPE_TXT:
        slist = ['"%s"' % name.str for name in rec.data.str]
        mesg = 'TXT: %s' % ','.join(slist)
    else:
        mesg = 'Unknown: '
    outf.write('    %s (flags=%x, serial=%d, ttl=%d)\n' % (
                mesg, rec.dwFlags, rec.dwSerial, rec.dwTtlSeconds))


def print_dnsrecords(outf, records):
    for rec in records.rec:
        outf.write('  Name=%s, Records=%d, Children=%d\n' % (
                    rec.dnsNodeName.str,
                    rec.wRecordCount,
                    rec.dwChildCount))
        for dns_rec in rec.records:
                print_dns_record(outf, dns_rec)


#
# Always create a copy of strings when creating DNS_RPC_RECORDs
# to overcome the bug in pidl generated python bindings.
#

class ARecord(dnsserver.DNS_RPC_RECORD):
    def __init__(self, ip_addr, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE,
                    node_flag=0):
        super(ARecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_A
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._ip_addr = ip_addr[:]
        self.data = self._ip_addr


class AAAARecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, ip6_addr, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE,
                    node_flag=0):
        super(AAAARecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_AAAA
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._ip6_addr = ip6_addr[:]
        self.data = self._ip6_addr


class PTRRecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, ptr, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE,
                 node_flag=0):
        super(PTRRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_PTR
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._ptr = ptr[:]
        ptr_name = dnsserver.DNS_RPC_NAME()
        ptr_name.str = self._ptr
        ptr_name.len = len(ptr)
        self.data = ptr_name


class CNameRecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, cname, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE,
                    node_flag=0):
        super(CNameRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_CNAME
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._cname = cname[:]
        cname_name = dnsserver.DNS_RPC_NAME()
        cname_name.str = self._cname
        cname_name.len = len(cname)
        self.data = cname_name


class NSRecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, dns_server, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE,
                    node_flag=0):
        super(NSRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_NS
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._dns_server = dns_server[:]
        ns = dnsserver.DNS_RPC_NAME()
        ns.str = self._dns_server
        ns.len = len(dns_server)
        self.data = ns


class MXRecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, mail_server, preference, serial=1, ttl=900,
                 rank=dnsp.DNS_RANK_ZONE, node_flag=0):
        super(MXRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_MX
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._mail_server = mail_server[:]
        mx = dnsserver.DNS_RPC_RECORD_NAME_PREFERENCE()
        mx.wPreference = preference
        mx.nameExchange.str = self._mail_server
        mx.nameExchange.len = len(mail_server)
        self.data = mx


class SOARecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, mname, rname, serial=1, refresh=900, retry=600,
                 expire=86400, minimum=3600, ttl=3600, rank=dnsp.DNS_RANK_ZONE,
                 node_flag=dnsp.DNS_RPC_FLAG_AUTH_ZONE_ROOT):
        super(SOARecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_SOA
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._mname = mname[:]
        self._rname = rname[:]
        soa = dnsserver.DNS_RPC_RECORD_SOA()
        soa.dwSerialNo = serial
        soa.dwRefresh = refresh
        soa.dwRetry = retry
        soa.dwExpire = expire
        soa.dwMinimumTtl = minimum
        soa.NamePrimaryServer.str = self._mname
        soa.NamePrimaryServer.len = len(mname)
        soa.ZoneAdministratorEmail.str = self._rname
        soa.ZoneAdministratorEmail.len = len(rname)
        self.data = soa


class SRVRecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, target, port, priority=0, weight=100, serial=1, ttl=900,
                rank=dnsp.DNS_RANK_ZONE, node_flag=0):
        super(SRVRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_SRV
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._target = target[:]
        srv = dnsserver.DNS_RPC_RECORD_SRV()
        srv.wPriority = priority
        srv.wWeight = weight
        srv.wPort = port
        srv.nameTarget.str = self._target
        srv.nameTarget.len = len(target)
        self.data = srv


class TXTRecord(dnsserver.DNS_RPC_RECORD):

    def __init__(self, slist, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE,
                node_flag=0):
        super(TXTRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_TXT
        self.dwFlags = rank | node_flag
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self._slist = []
        for s in slist:
            self._slist.append(s[:])
        names = []
        for s in self._slist:
            name = dnsserver.DNS_RPC_NAME()
            name.str = s
            name.len = len(s)
            names.append(name)
        txt = dnsserver.DNS_RPC_RECORD_STRING()
        txt.count = len(slist)
        txt.str = names
        self.data = txt


# Convert data into a dns record
def data_to_dns_record(record_type, data):
    if record_type == dnsp.DNS_TYPE_A:
        rec = ARecord(data)
    elif record_type == dnsp.DNS_TYPE_AAAA:
        rec = AAAARecord(data)
    elif record_type == dnsp.DNS_TYPE_PTR:
        rec = PTRRecord(data)
    elif record_type == dnsp.DNS_TYPE_CNAME:
        rec = CNameRecord(data)
    elif record_type == dnsp.DNS_TYPE_NS:
        rec = NSRecord(data)
    elif record_type == dnsp.DNS_TYPE_MX:
        tmp = data.split(' ')
        if len(tmp) != 2:
            raise CommandError('Data requires 2 elements - mail_server, preference')
        mail_server = tmp[0]
        preference = int(tmp[1])
        rec = MXRecord(mail_server, preference)
    elif record_type == dnsp.DNS_TYPE_SRV:
        tmp = data.split(' ')
        if len(tmp) != 4:
            raise CommandError('Data requires 4 elements - server, port, priority, weight')
        server = tmp[0]
        port = int(tmp[1])
        priority = int(tmp[2])
        weight = int(tmp[3])
        rec = SRVRecord(server, port, priority=priority, weight=weight)
    elif record_type == dnsp.DNS_TYPE_SOA:
        tmp = data.split(' ')
        if len(tmp) != 7:
            raise CommandError('Data requires 7 elements - nameserver, email, serial, '
                               'refresh, retry, expire, minimumttl')
        nameserver = tmp[0]
        email = tmp[1]
        serial = int(tmp[2])
        refresh = int(tmp[3])
        retry = int(tmp[4])
        expire = int(tmp[5])
        minimum = int(tmp[6])
        rec = SOARecord(nameserver, email, serial=serial, refresh=refresh,
                        retry=retry, expire=expire, minimum=minimum)
    elif record_type == dnsp.DNS_TYPE_TXT:
        slist = shlex.split(data)
        rec = TXTRecord(slist)
    else:
        raise CommandError('Unsupported record type')
    return rec


# Match dns name (of type DNS_RPC_NAME)
def dns_name_equal(n1, n2):
    return n1.str.rstrip('.').lower() == n2.str.rstrip('.').lower()


# Match a dns record with specified data
def dns_record_match(dns_conn, server, zone, name, record_type, data):
    urec = data_to_dns_record(record_type, data)

    select_flags = dnsserver.DNS_RPC_VIEW_AUTHORITY_DATA

    try:
        buflen, res = dns_conn.DnssrvEnumRecords2(
            dnsserver.DNS_CLIENT_VERSION_LONGHORN, 0, server, zone, name, None,
            record_type, select_flags, None, None)
    except RuntimeError, e:
        return None

    if not res or res.count == 0:
        return None

    rec_match = None
    for rec in res.rec[0].records:
        if rec.wType != record_type:
            continue

        found = False
        if record_type == dnsp.DNS_TYPE_A:
            if rec.data == urec.data:
                found = True
        elif record_type == dnsp.DNS_TYPE_AAAA:
            if rec.data == urec.data:
                found = True
        elif record_type == dnsp.DNS_TYPE_PTR:
            if dns_name_equal(rec.data, urec.data):
                found = True
        elif record_type == dnsp.DNS_TYPE_CNAME:
            if dns_name_equal(rec.data, urec.data):
                found = True
        elif record_type == dnsp.DNS_TYPE_NS:
            if dns_name_equal(rec.data, urec.data):
                found = True
        elif record_type == dnsp.DNS_TYPE_MX:
            if dns_name_equal(rec.data.nameExchange, urec.data.nameExchange) and \
               rec.data.wPreference == urec.data.wPreference:
                found = True
        elif record_type == dnsp.DNS_TYPE_SRV:
            if rec.data.wPriority == urec.data.wPriority and \
               rec.data.wWeight == urec.data.wWeight and \
               rec.data.wPort == urec.data.wPort and \
               dns_name_equal(rec.data.nameTarget, urec.data.nameTarget):
                found = True
        elif record_type == dnsp.DNS_TYPE_SOA:
            if rec.data.dwSerialNo == urec.data.dwSerialNo and \
               rec.data.dwRefresh == urec.data.dwRefresh and \
               rec.data.dwRetry == urec.data.dwRetry and \
               rec.data.dwExpire == urec.data.dwExpire and \
               rec.data.dwMinimumTtl == urec.data.dwMinimumTtl and \
               dns_name_equal(rec.data.NamePrimaryServer,
                              urec.data.NamePrimaryServer) and \
               dns_name_equal(rec.data.ZoneAdministratorEmail,
                              urec.data.ZoneAdministratorEmail):
                found = True
        elif record_type == dnsp.DNS_TYPE_TXT:
            if rec.data.count == urec.data.count:
                found = True
                for i in xrange(rec.data.count):
                    found = found and \
                            (rec.data.str[i].str == urec.data.str[i].str)

        if found:
            rec_match = rec
            break

    return rec_match


class cmd_serverinfo(Command):
    """Query for Server information."""

    synopsis = '%prog <server> [options]'

    takes_args = [ 'server' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    takes_options = [
        Option('--client-version', help='Client Version',
                default='longhorn', metavar='w2k|dotnet|longhorn',
                choices=['w2k','dotnet','longhorn'], dest='cli_ver'),
    ]

    def run(self, server, cli_ver, sambaopts=None, credopts=None,
            versionopts=None):
        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        client_version = dns_client_version(cli_ver)

        typeid, res = dns_conn.DnssrvQuery2(client_version, 0, server,
                                            None, 'ServerInfo')
        print_serverinfo(self.outf, typeid, res)


class cmd_zoneinfo(Command):
    """Query for zone information."""

    synopsis = '%prog <server> <zone> [options]'

    takes_args = [ 'server', 'zone' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    takes_options = [
        Option('--client-version', help='Client Version',
                default='longhorn', metavar='w2k|dotnet|longhorn',
                choices=['w2k','dotnet','longhorn'], dest='cli_ver'),
    ]

    def run(self, server, zone, cli_ver, sambaopts=None, credopts=None,
            versionopts=None):
        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        client_version = dns_client_version(cli_ver)

        typeid, res = dns_conn.DnssrvQuery2(client_version, 0, server, zone,
                                            'ZoneInfo')
        print_zoneinfo(self.outf, typeid, res)


class cmd_zonelist(Command):
    """Query for zones."""

    synopsis = '%prog <server> [options]'

    takes_args = [ 'server' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    takes_options = [
        Option('--client-version', help='Client Version',
                default='longhorn', metavar='w2k|dotnet|longhorn',
                choices=['w2k','dotnet','longhorn'], dest='cli_ver'),
        Option('--primary', help='List primary zones (default)',
                action='store_true', dest='primary'),
        Option('--secondary', help='List secondary zones',
                action='store_true', dest='secondary'),
        Option('--cache', help='List cached zones',
                action='store_true', dest='cache'),
        Option('--auto', help='List automatically created zones',
                action='store_true', dest='auto'),
        Option('--forward', help='List forward zones',
                action='store_true', dest='forward'),
        Option('--reverse', help='List reverse zones',
                action='store_true', dest='reverse'),
        Option('--ds', help='List directory integrated zones',
                action='store_true', dest='ds'),
        Option('--non-ds', help='List non-directory zones',
                action='store_true', dest='nonds')
    ]

    def run(self, server, cli_ver, primary=False, secondary=False, cache=False,
                auto=False, forward=False, reverse=False, ds=False, nonds=False,
                sambaopts=None, credopts=None, versionopts=None):
        request_filter = 0

        if primary:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_PRIMARY
        if secondary:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_SECONDARY
        if cache:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_CACHE
        if auto:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_AUTO
        if forward:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_FORWARD
        if reverse:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_REVERSE
        if ds:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_DS
        if nonds:
            request_filter |= dnsserver.DNS_ZONE_REQUEST_NON_DS

        if request_filter == 0:
            request_filter = dnsserver.DNS_ZONE_REQUEST_PRIMARY

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        client_version = dns_client_version(cli_ver)

        typeid, res = dns_conn.DnssrvComplexOperation2(client_version,
                                                        0, server, None,
                                                        'EnumZones',
                                                        dnsserver.DNSSRV_TYPEID_DWORD,
                                                        request_filter)

        if client_version == dnsserver.DNS_CLIENT_VERSION_W2K:
            typeid = dnsserver.DNSSRV_TYPEID_ZONE_W2K
        else:
            typeid = dnsserver.DNSSRV_TYPEID_ZONE
        print_enumzones(self.outf, typeid, res)


class cmd_zonecreate(Command):
    """Create a zone."""

    synopsis = '%prog <server> <zone> [options]'

    takes_args = [ 'server', 'zone' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    takes_options = [
        Option('--client-version', help='Client Version',
                default='longhorn', metavar='w2k|dotnet|longhorn',
                choices=['w2k','dotnet','longhorn'], dest='cli_ver')
    ]

    def run(self, server, zone, cli_ver, sambaopts=None, credopts=None,
            versionopts=None):

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        zone = zone.lower()

        client_version = dns_client_version(cli_ver)
        if client_version == dnsserver.DNS_CLIENT_VERSION_W2K:
            typeid = dnsserver.DNSSRV_TYPEID_ZONE_CREATE_W2K
            zone_create_info = dnsserver.DNS_RPC_ZONE_CREATE_INFO_W2K()
            zone_create_info.pszZoneName = zone
            zone_create_info.dwZoneType = dnsp.DNS_ZONE_TYPE_PRIMARY
            zone_create_info.fAging = 0
            zone_create_info.fDsIntegrated = 1
            zone_create_info.fLoadExisting = 1
        elif client_version == dnsserver.DNS_CLIENT_VERSION_DOTNET:
            typeid = dnsserver.DNSSRV_TYPEID_ZONE_CREATE_DOTNET
            zone_create_info = dnsserver.DNS_RPC_ZONE_CREATE_INFO_DOTNET()
            zone_create_info.pszZoneName = zone
            zone_create_info.dwZoneType = dnsp.DNS_ZONE_TYPE_PRIMARY
            zone_create_info.fAging = 0
            zone_create_info.fDsIntegrated = 1
            zone_create_info.fLoadExisting = 1
            zone_create_info.dwDpFlags = dnsserver.DNS_DP_DOMAIN_DEFAULT
        else:
            typeid = dnsserver.DNSSRV_TYPEID_ZONE_CREATE
            zone_create_info = dnsserver.DNS_RPC_ZONE_CREATE_INFO_LONGHORN()
            zone_create_info.pszZoneName = zone
            zone_create_info.dwZoneType = dnsp.DNS_ZONE_TYPE_PRIMARY
            zone_create_info.fAging = 0
            zone_create_info.fDsIntegrated = 1
            zone_create_info.fLoadExisting = 1
            zone_create_info.dwDpFlags = dnsserver.DNS_DP_DOMAIN_DEFAULT

        res = dns_conn.DnssrvOperation2(client_version, 0, server, None,
                                        0, 'ZoneCreate', typeid,
                                        zone_create_info)

        typeid = dnsserver.DNSSRV_TYPEID_NAME_AND_PARAM
        name_and_param = dnsserver.DNS_RPC_NAME_AND_PARAM()
        name_and_param.pszNodeName = 'AllowUpdate'
        name_and_param.dwParam = dnsp.DNS_ZONE_UPDATE_SECURE

        res = dns_conn.DnssrvOperation2(client_version, 0, server, zone,
                                        0, 'ResetDwordProperty', typeid,
                                        name_and_param)
        self.outf.write('Zone %s created successfully\n' % zone)


class cmd_zonedelete(Command):
    """Delete a zone."""

    synopsis = '%prog <server> <zone> [options]'

    takes_args = [ 'server', 'zone' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    def run(self, server, zone, sambaopts=None, credopts=None,
            versionopts=None):

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        zone = zone.lower()
        res = dns_conn.DnssrvOperation2(dnsserver.DNS_CLIENT_VERSION_LONGHORN,
                                        0, server, zone, 0, 'DeleteZoneFromDs',
                                        dnsserver.DNSSRV_TYPEID_NULL,
                                        None)
        self.outf.write('Zone %s delete successfully\n' % zone)


class cmd_query(Command):
    """Query a name."""

    synopsis = '%prog <server> <zone> <name> <A|AAAA|CNAME|MX|NS|SOA|SRV|TXT|ALL> [options]'

    takes_args = [ 'server', 'zone', 'name', 'rtype' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    takes_options = [
        Option('--authority', help='Search authoritative records (default)',
                action='store_true', dest='authority'),
        Option('--cache', help='Search cached records',
                action='store_true', dest='cache'),
        Option('--glue', help='Search glue records',
                action='store_true', dest='glue'),
        Option('--root', help='Search root hints',
                action='store_true', dest='root'),
        Option('--additional', help='List additional records',
                action='store_true', dest='additional'),
        Option('--no-children', help='Do not list children',
                action='store_true', dest='no_children'),
        Option('--only-children', help='List only children',
                action='store_true', dest='only_children')
    ]

    def run(self, server, zone, name, rtype, authority=False, cache=False,
            glue=False, root=False, additional=False, no_children=False,
            only_children=False, sambaopts=None, credopts=None,
            versionopts=None):
        record_type = dns_type_flag(rtype)

        if name.find('*') != -1:
            raise CommandError('Wildcard searches not supported. To dump entire zone use "@"')

        select_flags = 0
        if authority:
            select_flags |= dnsserver.DNS_RPC_VIEW_AUTHORITY_DATA
        if cache:
            select_flags |= dnsserver.DNS_RPC_VIEW_CACHE_DATA
        if glue:
            select_flags |= dnsserver.DNS_RPC_VIEW_GLUE_DATA
        if root:
            select_flags |= dnsserver.DNS_RPC_VIEW_ROOT_HINT_DATA
        if additional:
            select_flags |= dnsserver.DNS_RPC_VIEW_ADDITIONAL_DATA
        if no_children:
            select_flags |= dnsserver.DNS_RPC_VIEW_NO_CHILDREN
        if only_children:
            select_flags |= dnsserver.DNS_RPC_VIEW_ONLY_CHILDREN

        if select_flags == 0:
            select_flags = dnsserver.DNS_RPC_VIEW_AUTHORITY_DATA

        if select_flags == dnsserver.DNS_RPC_VIEW_ADDITIONAL_DATA:
            self.outf.write('Specify either --authority or --root along with --additional.\n')
            self.outf.write('Assuming --authority.\n')
            select_flags |= dnsserver.DNS_RPC_VIEW_AUTHORITY_DATA

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        buflen, res = dns_conn.DnssrvEnumRecords2(
                dnsserver.DNS_CLIENT_VERSION_LONGHORN, 0, server, zone, name,
                None, record_type, select_flags, None, None)
        print_dnsrecords(self.outf, res)


class cmd_roothints(Command):
    """Query root hints."""

    synopsis = '%prog <server> [<name>] [options]'

    takes_args = [ 'server', 'name?' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    def run(self, server, name='.', sambaopts=None, credopts=None,
            versionopts=None):
        record_type = dnsp.DNS_TYPE_NS
        select_flags = (dnsserver.DNS_RPC_VIEW_ROOT_HINT_DATA |
                        dnsserver.DNS_RPC_VIEW_ADDITIONAL_DATA)

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        buflen, res = dns_conn.DnssrvEnumRecords2(
            dnsserver.DNS_CLIENT_VERSION_LONGHORN, 0, server, '..RootHints',
            name, None, record_type, select_flags, None, None)
        print_dnsrecords(self.outf, res)


class cmd_add_record(Command):
    """Add a DNS record

       For each type data contents are as follows:
         A      ipv4_address_string
         AAAA   ipv6_address_string
         PTR    fqdn_string
         CNAME  fqdn_string
         NS     fqdn_string
         MX     "fqdn_string preference"
         SRV    "fqdn_string port priority weight"
         TXT    "'string1' 'string2' ..."
    """

    synopsis = '%prog <server> <zone> <name> <A|AAAA|PTR|CNAME|NS|MX|SRV|TXT> <data>'

    takes_args = [ 'server', 'zone', 'name', 'rtype', 'data' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    def run(self, server, zone, name, rtype, data, sambaopts=None,
            credopts=None, versionopts=None):

        if rtype.upper() not in ('A','AAAA','PTR','CNAME','NS','MX','SRV','TXT'):
            raise CommandError('Adding record of type %s is not supported' % rtype)

        record_type = dns_type_flag(rtype)
        rec = data_to_dns_record(record_type, data)

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        rec_match = dns_record_match(dns_conn, server, zone, name, record_type,
                data)
        if rec_match is not None:
            raise CommandError('Record already exists')

        add_rec_buf = dnsserver.DNS_RPC_RECORD_BUF()
        add_rec_buf.rec = rec

        dns_conn.DnssrvUpdateRecord2(dnsserver.DNS_CLIENT_VERSION_LONGHORN,
                                     0, server, zone, name, add_rec_buf, None)
        self.outf.write('Record added successfully\n')


class cmd_update_record(Command):
    """Update a DNS record

       For each type data contents are as follows:
         A      ipv4_address_string
         AAAA   ipv6_address_string
         PTR    fqdn_string
         CNAME  fqdn_string
         NS     fqdn_string
         MX     "fqdn_string preference"
         SOA    "fqdn_dns fqdn_email serial refresh retry expire minimumttl"
         SRV    "fqdn_string port priority weight"
         TXT    "'string1' 'string2' ..."
    """

    synopsis = '%prog <server> <zone> <name> <A|AAAA|PTR|CNAME|NS|MX|SOA|SRV|TXT> <olddata> <newdata>'

    takes_args = [ 'server', 'zone', 'name', 'rtype', 'olddata', 'newdata' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    def run(self, server, zone, name, rtype, olddata, newdata,
                sambaopts=None, credopts=None, versionopts=None):

        if rtype.upper() not in ('A','AAAA','PTR','CNAME','NS','MX','SOA','SRV','TXT'):
            raise CommandError('Updating record of type %s is not supported' % rtype)

        record_type = dns_type_flag(rtype)
        rec = data_to_dns_record(record_type, newdata)

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        rec_match = dns_record_match(dns_conn, server, zone, name, record_type,
                olddata)
        if not rec_match:
            raise CommandError('Record does not exist')

        # Copy properties from existing record to new record
        rec.dwFlags = rec_match.dwFlags
        rec.dwSerial = rec_match.dwSerial
        rec.dwTtlSeconds = rec_match.dwTtlSeconds
        rec.dwTimeStamp = rec_match.dwTimeStamp

        add_rec_buf = dnsserver.DNS_RPC_RECORD_BUF()
        add_rec_buf.rec = rec

        del_rec_buf = dnsserver.DNS_RPC_RECORD_BUF()
        del_rec_buf.rec = rec_match

        dns_conn.DnssrvUpdateRecord2(dnsserver.DNS_CLIENT_VERSION_LONGHORN,
                                        0,
                                        server,
                                        zone,
                                        name,
                                        add_rec_buf,
                                        del_rec_buf)
        self.outf.write('Record updated successfully\n')


class cmd_delete_record(Command):
    """Delete a DNS record

       For each type data contents are as follows:
         A      ipv4_address_string
         AAAA   ipv6_address_string
         PTR    fqdn_string
         CNAME  fqdn_string
         NS     fqdn_string
         MX     "fqdn_string preference"
         SRV    "fqdn_string port priority weight"
         TXT    "'string1' 'string2' ..."
    """

    synopsis = '%prog <server> <zone> <name> <A|AAAA|PTR|CNAME|NS|MX|SRV|TXT> <data>'

    takes_args = [ 'server', 'zone', 'name', 'rtype', 'data' ]

    takes_optiongroups = {
        "sambaopts": options.SambaOptions,
        "versionopts": options.VersionOptions,
        "credopts": options.CredentialsOptions,
    }

    def run(self, server, zone, name, rtype, data, sambaopts=None, credopts=None, versionopts=None):

        if rtype.upper() not in ('A','AAAA','PTR','CNAME','NS','MX','SRV','TXT'):
            raise CommandError('Deleting record of type %s is not supported' % rtype)

        record_type = dns_type_flag(rtype)

        self.lp = sambaopts.get_loadparm()
        self.creds = credopts.get_credentials(self.lp)
        dns_conn = dns_connect(server, self.lp, self.creds)

        rec_match = dns_record_match(dns_conn, server, zone, name, record_type, data)
        if not rec_match:
            raise CommandError('Record does not exist')

        del_rec_buf = dnsserver.DNS_RPC_RECORD_BUF()
        del_rec_buf.rec = rec_match

        dns_conn.DnssrvUpdateRecord2(dnsserver.DNS_CLIENT_VERSION_LONGHORN,
                                        0,
                                        server,
                                        zone,
                                        name,
                                        None,
                                        del_rec_buf)
        self.outf.write('Record deleted successfully\n')


class cmd_dns(SuperCommand):
    """Domain Name Service (DNS) management."""

    subcommands = {}
    subcommands['serverinfo'] = cmd_serverinfo()
    subcommands['zoneinfo'] = cmd_zoneinfo()
    subcommands['zonelist'] = cmd_zonelist()
    subcommands['zonecreate'] = cmd_zonecreate()
    subcommands['zonedelete'] = cmd_zonedelete()
    subcommands['query'] = cmd_query()
    subcommands['roothints'] = cmd_roothints()
    subcommands['add'] = cmd_add_record()
    subcommands['update'] = cmd_update_record()
    subcommands['delete'] = cmd_delete_record()
                                                                                                                                                                                                                                                                                                                                                                                                                     # Unix SMB/CIFS implementation.
# backend code for provisioning DNS for a Samba4 server
#
# Copyright (C) Kai Blin <kai@samba.org> 2011
# Copyright (C) Amitay Isaacs <amitay@gmail.com> 2011
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

"""DNS-related provisioning"""

import os
import uuid
import shutil
import time
import ldb
from base64 import b64encode
import subprocess
import samba
from samba.tdb_util import tdb_copy
from samba.ndr import ndr_pack, ndr_unpack
from samba import setup_file
from samba.dcerpc import dnsp, misc, security
from samba.dsdb import (
    DS_DOMAIN_FUNCTION_2000,
    DS_DOMAIN_FUNCTION_2003,
    DS_DOMAIN_FUNCTION_2008_R2
    )
from samba.descriptor import (
    get_domain_descriptor,
    get_domain_delete_protected1_descriptor,
    get_domain_delete_protected2_descriptor,
    get_dns_partition_descriptor,
    get_dns_forest_microsoft_dns_descriptor,
    get_dns_domain_microsoft_dns_descriptor
    )
from samba.provision.common import (
    setup_path,
    setup_add_ldif,
    setup_modify_ldif,
    setup_ldb,
    FILL_FULL,
    FILL_SUBDOMAIN,
    FILL_NT4SYNC,
    FILL_DRS,
    )


def get_domainguid(samdb, domaindn):
    res = samdb.search(base=domaindn, scope=ldb.SCOPE_BASE, attrs=["objectGUID"])
    domainguid =  str(ndr_unpack(misc.GUID, res[0]["objectGUID"][0]))
    return domainguid


def get_dnsadmins_sid(samdb, domaindn):
    res = samdb.search(base="CN=DnsAdmins,CN=Users,%s" % domaindn, scope=ldb.SCOPE_BASE,
                       attrs=["objectSid"])
    dnsadmins_sid = ndr_unpack(security.dom_sid, res[0]["objectSid"][0])
    return dnsadmins_sid


class ARecord(dnsp.DnssrvRpcRecord):

    def __init__(self, ip_addr, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE):
        super(ARecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_A
        self.rank = rank
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self.data = ip_addr


class AAAARecord(dnsp.DnssrvRpcRecord):

    def __init__(self, ip6_addr, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE):
        super(AAAARecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_AAAA
        self.rank = rank
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self.data = ip6_addr


class CNameRecord(dnsp.DnssrvRpcRecord):

    def __init__(self, cname, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE):
        super(CNameRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_CNAME
        self.rank = rank
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self.data = cname


class NSRecord(dnsp.DnssrvRpcRecord):

    def __init__(self, dns_server, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE):
        super(NSRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_NS
        self.rank = rank
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        self.data = dns_server


class SOARecord(dnsp.DnssrvRpcRecord):

    def __init__(self, mname, rname, serial=1, refresh=900, retry=600,
                 expire=86400, minimum=3600, ttl=3600, rank=dnsp.DNS_RANK_ZONE):
        super(SOARecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_SOA
        self.rank = rank
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        soa = dnsp.soa()
        soa.serial = serial
        soa.refresh = refresh
        soa.retry = retry
        soa.expire = expire
        soa.mname = mname
        soa.rname = rname
        soa.minimum = minimum
        self.data = soa


class SRVRecord(dnsp.DnssrvRpcRecord):

    def __init__(self, target, port, priority=0, weight=100, serial=1, ttl=900,
                rank=dnsp.DNS_RANK_ZONE):
        super(SRVRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_SRV
        self.rank = rank
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        srv = dnsp.srv()
        srv.nameTarget = target
        srv.wPort = port
        srv.wPriority = priority
        srv.wWeight = weight
        self.data = srv


class TXTRecord(dnsp.DnssrvRpcRecord):

    def __init__(self, slist, serial=1, ttl=900, rank=dnsp.DNS_RANK_ZONE):
        super(TXTRecord, self).__init__()
        self.wType = dnsp.DNS_TYPE_TXT
        self.rank = rank
        self.dwSerial = serial
        self.dwTtlSeconds = ttl
        stringlist = dnsp.string_list()
        stringlist.count = len(slist)
        stringlist.str = slist
        self.data = stringlist


class TypeProperty(dnsp.DnsProperty):

    def __init__(self, zone_type=dnsp.DNS_ZONE_TYPE_PRIMARY):
        super(TypeProperty, self).__init__()
        self.wDataLength = 1
        self.version = 1
        self.id = dnsp.DSPROPERTY_ZONE_TYPE
        self.data = zone_type


class AllowUpdateProperty(dnsp.DnsProperty):

    def __init__(self, allow_update=dnsp.DNS_ZONE_UPDATE_SECURE):
        super(AllowUpdateProperty, self).__init__()
        self.wDataLength = 1
        self.version = 1
        self.id = dnsp.DSPROPERTY_ZONE_ALLOW_UPDATE
        self.data = allow_update


class SecureTimeProperty(dnsp.DnsProperty):

    def __init__(self, secure_time=0):
        super(SecureTimeProperty, self).__init__()
        self.wDataLength = 1
        self.version = 1
        self.id = dnsp.DSPROPERTY_ZONE_SECURE_TIME
        self.data = secure_time


class NorefreshIntervalProperty(dnsp.DnsProperty):

    def __init__(self, norefresh_interval=0):
        super(NorefreshIntervalProperty, self).__init__()
        self.wDataLength = 1
        self.version = 1
        self.id = dnsp.DSPROPERTY_ZONE_NOREFRESH_INTERVAL
        self.data = norefresh_interval


class RefreshIntervalProperty(dnsp.DnsProperty):

    def __init__(self, refresh_interval=0):
        super(RefreshIntervalProperty, self).__init__()
        self.wDataLength = 1
        self.version = 1
        self.id = dnsp.DSPROPERTY_ZONE_REFRESH_INTERVAL
        self.data = refresh_interval


class AgingStateProperty(dnsp.DnsProperty):

    def __init__(self, aging_enabled=0):
        super(AgingStateProperty, self).__init__()
        self.wDataLength = 1
        self.version = 1
        self.id = dnsp.DSPROPERTY_ZONE_AGING_STATE
        self.data = aging_enabled


class AgingEnabledTimeProperty(dnsp.DnsProperty):

    def __init__(self, next_cycle_hours=0):
        super(AgingEnabledTimeProperty, self).__init__()
        self.wDataLength = 1
        self.version = 1;
        self.id = dnsp.DSPROPERTY_ZONE_AGING_ENABLED_TIME
        self.data = next_cycle_hours


def setup_dns_partitions(samdb, domainsid, domaindn, forestdn, configdn,
                         serverdn, fill_level):
    domainzone_dn = "DC=DomainDnsZones,%s" % domaindn
    forestzone_dn = "DC=ForestDnsZones,%s" % forestdn
    descriptor = get_dns_partition_descriptor(domainsid)

    setup_add_ldif(samdb, setup_path("provision_dnszones_partitions.ldif"), {
        "ZONE_DN": domainzone_dn,
        "SECDESC"      : b64encode(descriptor)
        })
    if fill_level != FILL_SUBDOMAIN:
        setup_add_ldif(samdb, setup_path("provision_dnszones_partitions.ldif"), {
            "ZONE_DN": forestzone_dn,
            "SECDESC"      : b64encode(descriptor)
        })

    domainzone_guid = get_domainguid(samdb, domainzone_dn)
    domainzone_guid = str(uuid.uuid4())
    domainzone_dns = ldb.Dn(samdb, domainzone_dn).canonical_ex_str().strip()

    protected1_desc = get_domain_delete_protected1_descriptor(domainsid)
    protected2_desc = get_domain_delete_protected2_descriptor(domainsid)
    setup_add_ldif(samdb, setup_path("provision_dnszones_add.ldif"), {
        "ZONE_DN": domainzone_dn,
        "ZONE_GUID": domainzone_guid,
        "ZONE_DNS": domainzone_dns,
        "CONFIGDN": configdn,
        "SERVERDN": serverdn,
        "LOSTANDFOUND_DESCRIPTOR": b64encode(protected2_desc),
        "INFRASTRUCTURE_DESCRIPTOR": b64encode(protected1_desc),
        })
    setup_modify_ldif(samdb, setup_path("provision_dnszones_modify.ldif"), {
        "CONFIGDN": configdn,
        "SERVERDN": serverdn,
        "ZONE_DN": domainzone_dn,
    })

    if fill_level != FILL_SUBDOMAIN:
        forestzone_guid = get_domainguid(samdb, forestzone_dn)
        forestzone_guid = str(uuid.uuid4())
        forestzone_dns = ldb.Dn(samdb, forestzone_dn).canonical_ex_str().strip()

        setup_add_ldif(samdb, setup_path("provision_dnszones_add.ldif"), {
            "ZONE_DN": forestzone_dn,
            "ZONE_GUID": forestzone_guid,
            "ZONE_DNS": forestzone_dns,
            "CONFIGDN": configdn,
            "SERVERDN": serverdn,
            "LOSTANDFOUND_DESCRIPTOR": b64encode(protected2_desc),
            "INFRASTRUCTURE_DESCRIPTOR": b64encode(protected1_desc),
        })
        setup_modify_ldif(samdb, setup_path("provision_dnszones_modify.ldif"), {
            "CONFIGDN": configdn,
            "SERVERDN": serverdn,
            "ZONE_DN": forestzone_dn,
        })


def add_dns_accounts(samdb, domaindn):
    setup_add_ldif(samdb, setup_path("provision_dns_accounts_add.ldif"), {
        "DOMAINDN": domaindn,
        })


def add_dns_container(samdb, domaindn, prefix, domain_sid, dnsadmins_sid, forest=False):
    name_map = {'DnsAdmins': str(dnsadmins_sid)}
    if forest is True:
        sd_val = get_dns_forest_microsoft_dns_descriptor(domain_sid,
                                                         name_map=name_map)
    else:
        sd_val = get_dns_domain_microsoft_dns_descriptor(domain_sid,
                                                         name_map=name_map)
    # CN=MicrosoftDNS,<PREFIX>,<DOMAINDN>
    msg = ldb.Message(ldb.Dn(samdb, "CN=MicrosoftDNS,%s,%s" % (prefix, domaindn)))
    msg["objectClass"] = ["top", "container"]
    msg["nTSecurityDescriptor"] = ldb.MessageElement(sd_val, ldb.FLAG_MOD_ADD,
        "nTSecurityDescriptor")
    samdb.add(msg)


def add_rootservers(samdb, domaindn, prefix):
    rootservers = {}
    rootservers["a.root-servers.net"] = "198.41.0.4"
    rootservers["b.root-servers.net"] = "192.228.79.201"
    rootservers["c.root-servers.net"] = "192.33.4.12"
    rootservers["d.root-servers.net"] = "128.8.10.90"
    rootservers["e.root-servers.net"] = "192.203.230.10"
    rootservers["f.root-servers.net"] = "192.5.5.241"
    rootservers["g.root-servers.net"] = "192.112.36.4"
    rootservers["h.root-servers.net"] = "128.63.2.53"
    rootservers["i.root-servers.net"] = "192.36.148.17"
    rootservers["j.root-servers.net"] = "192.58.128.30"
    rootservers["k.root-servers.net"] = "193.0.14.129"
    rootservers["l.root-servers.net"] = "199.7.83.42"
    rootservers["m.root-servers.net"] = "202.12.27.33"

    rootservers_v6 = {}
    rootservers_v6["a.root-servers.net"] = "2001:503:ba3e::2:30"
    rootservers_v6["f.root-servers.net"] = "2001:500:2f::f"
    rootservers_v6["h.root-servers.net"] = "2001:500:1::803f:235"
    rootservers_v6["j.root-servers.net"] = "2001:503:c27::2:30"
    rootservers_v6["k.root-servers.net"] = "2001:7fd::1"
    rootservers_v6["m.root-servers.net"] = "2001:dc3::35"

    container_dn = "DC=RootDNSServers,CN=MicrosoftDNS,%s,%s" % (prefix, domaindn)

    # Add DC=RootDNSServers,CN=MicrosoftDNS,<PREFIX>,<DOMAINDN>
    msg = ldb.Message(ldb.Dn(samdb, container_dn))
    props = []
    props.append(ndr_pack(TypeProperty(zone_type=dnsp.DNS_ZONE_TYPE_CACHE)))
    props.append(ndr_pack(AllowUpdateProperty(allow_update=dnsp.DNS_ZONE_UPDATE_OFF)))
    props.append(ndr_pack(SecureTimeProperty()))
    props.append(ndr_pack(NorefreshIntervalProperty()))
    props.append(ndr_pack(RefreshIntervalProperty()))
    props.append(ndr_pack(AgingStateProperty()))
    props.append(ndr_pack(AgingEnabledTimeProperty()))
    msg["objectClass"] = ["top", "dnsZone"]
    msg["cn"] = ldb.MessageElement("Zone", ldb.FLAG_MOD_ADD, "cn")
    msg["dNSProperty"] = ldb.MessageElement(props, ldb.FLAG_MOD_ADD, "dNSProperty")
    samdb.add(msg)

    # Add DC=@,DC=RootDNSServers,CN=MicrosoftDNS,<PREFIX>,<DOMAINDN>
    record = []
    for rserver in rootservers:
        record.append(ndr_pack(NSRecord(rserver, serial=0, ttl=0, rank=dnsp.DNS_RANK_ROOT_HINT)))

    msg = ldb.Message(ldb.Dn(samdb, "DC=@,%s" % container_dn))
    msg["objectClass"] = ["top", "dnsNode"]
    msg["dnsRecord"] = ldb.MessageElement(record, ldb.FLAG_MOD_ADD, "dnsRecord")
    samdb.add(msg)

    # Add DC=<rootserver>,DC=RootDNSServers,CN=MicrosoftDNS,<PREFIX>,<DOMAINDN>
    for rserver in rootservers:
        record = [ndr_pack(ARecord(rootservers[rserver], serial=0, ttl=0, rank=dnsp.DNS_RANK_ROOT_HINT))]
        # Add AAAA record as well (How does W2K* add IPv6 records?)
        #if rserver in rootservers_v6:
        #    record.append(ndr_pack(AAAARecord(rootservers_v6[rserver], serial=0, ttl=0)))
        msg = ldb.Message(ldb.Dn(samdb, "DC=%s,%s" % (rserver, container_dn)))
        msg["objectClass"] = ["top", "dnsNode"]
        msg["dnsRecord"] = ldb.MessageElement(record, ldb.FLAG_MOD_ADD, "dnsRecord")
        samdb.add(msg)

def add_at_record(samdb, container_dn, prefix, hostname, dnsdomain, hostip, hostip6):

    fqdn_hostname = "%s.%s" % (hostname, dnsdomain)

    at_records = []

    # SOA record
    at_soa_record = SOARecord(fqdn_hostname, "hostmaster.%s" % dnsdomain)
    at_records.append(ndr_pack(at_soa_record))

    # NS record
    at_ns_record = NSRecord(fqdn_hostname)
    at_records.append(ndr_pack(at_ns_record))

    if hostip is not None:
        # A record
        at_a_record = ARecord(hostip)
        at_records.append(ndr_pack(at_a_record))

    if hostip6 is not None:
        # AAAA record
        at_aaaa_record = AAAARecord(hostip6)
        at_records.append(ndr_pack(at_aaaa_record))

    msg = ldb.Message(ldb.Dn(samdb, "DC=@,%s" % container_dn))
    msg["objectClass"] = ["top", "dnsNode"]
    msg["dnsRecord"] = ldb.MessageElement(at_records, ldb.FLAG_MOD_ADD, "dnsRecord")
    samdb.add(msg)


def add_srv_record(samdb, container_dn, prefix, host, port):
    srv_record = SRVRecord(host, port)
    msg = ldb.Message(ldb.Dn(samdb, "%s,%s" % (prefix, container_dn)))
    msg["objectClass"] = ["top", "dnsNode"]
    msg["dnsRecord"] = ldb.MessageElement(ndr_pack(srv_record), ldb.FLAG_MOD_ADD, "dnsRecord")
    samdb.add(msg)


def add_ns_record(samdb, container_dn, prefix, host):
    ns_record = NSRecord(host)
    msg = ldb.Message(ldb.Dn(samdb, "%s,%s" % (prefix, container_dn)))
    msg["objectClass"] = ["top", "dnsNode"]
    msg["dnsRecord"] = ldb.MessageElement(ndr_pack(ns_record), ldb.FLAG_MOD_ADD, "dnsRecord")
    samdb.add(msg)


def add_ns_glue_record(samdb, container_dn, prefix, host):
    ns_record = NSRecord(host, rank=dnsp.DNS_RANK_NS_GLUE)
    msg = ldb.Message(ldb.Dn(samdb, "%s,%s" % (prefix, container_dn)))
    msg["objectClass"] = ["top", "dnsNode"]
    msg["dnsRecord"] = ldb.MessageElement(ndr_pack(ns_record), ldb.FLAG_MOD_ADD, "dnsRecord")
    samdb.add(msg)


def add_cname_record(samdb, container_dn, prefix, host):
    cname_record = CNameRecord(host)
    msg = ldb.Message(ldb.Dn(samdb, "%s,%s" % (prefix, container_dn)))
    msg["objectClass"] = ["top", "dnsNode"]
    msg["dnsRecord"] = ldb.MessageElement(ndr_pack(cname_record), ldb.FLAG_MOD_ADD, "dnsRecord")
    samdb.add(msg)


def add_host_record(samdb, container_dn, prefix, hostip, hostip6):
    host_records = []
    if hostip:
        a_record = ARecord(hostip)
        host_records.append(ndr_pack(a_record))
    if hostip6:
        aaaa_record = AAAARecord(hostip6)
        host_records.append(ndr_pack(aaaa_record))
    if host_records:
        msg = ldb.Message(ldb.Dn(samdb, "%s,%s" % (prefix, container_dn)))
        msg["objectClass"] = ["top", "dnsNode"]
        msg["dnsRecord"] = ldb.MessageElement(host_records, ldb.FLAG_MOD_ADD, "dnsRecord")
        samdb.add(msg)


def add_domain_record(samdb, domaindn, prefix, dnsdomain, domainsid, dnsadmins_sid):
    # DC=<DNSDOMAIN>,CN=MicrosoftDNS,<PREFIX>,<DOMAINDN>
    sddl = "O:SYG:BAD:AI" \
    "(A;;RPWPCRCCDCLCLORCWOWDSDDTSW;;;DA)" \
    "(A;;CC;;;AU)" \
    "(A;;RPLCLORC;;;WD)" \
    "(A;;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)" \
    "(A;CI;RPWPCRCCDCLCRCWOWDSDDTSW;;;ED)" \
    "(A;CIID;RPWPCRCCDCLCRCWOWDSDDTSW;;;%s)" \
    "(A;CIID;RPWPCRCCDCLCRCWOWDSDDTSW;;;ED)" \
    "(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)" \
    "(A;CIID;RPWPCRCCDCLCLORCWOWDSDDTSW;;;EA)" \
    "(A;CIID;LC;;;RU)" \
    "(A;CIID;RPWPCRCCLCLORCWOWDSDSW;;;BA)" \
    "S:AI" % dnsadmins_sid
    sec = security.descriptor.from_sddl(sddl, domainsid)
    props = []
    props.append(ndr_pack(TypeProperty()))
    props.append(ndr_pack(AllowUpdateProperty()))
    props.append(ndr_pack(SecureTimeProperty()))
    props.append(ndr_pack(NorefreshIntervalProperty(norefresh_interval=168)))
    props.append(ndr_pack(RefreshIntervalProperty(refresh_interval=168)))
    props.append(ndr_pack(AgingStateProperty()))
    props.append(ndr_pack(AgingEnabledTimeProperty()))
    msg = ldb.Message(ldb.Dn(samdb, "DC=%s,CN=MicrosoftDNS,%s,%s" % (dnsdomain, prefix, domaindn)))
    msg["objectClass"] = ["top", "dnsZone"]
    msg["ntSecurityDescriptor"] = ldb.MessageElement(ndr_pack(sec), ldb.FLAG_MOD_ADD,
        "nTSecurityDescriptor")
    msg["dNSProperty"] = ldb.MessageElement(props, ldb.FLAG_MOD_ADD, "dNSProperty")
    samdb.add(msg)


def add_msdcs_record(samdb, forestdn, prefix, dnsforest):
    # DC=_msdcs.<DNSFOREST>,CN=MicrosoftDNS,<PREFIX>,<FORESTDN>
    msg = ldb.Message(ldb.Dn(samdb, "DC=_msdcs.%s,CN=MicrosoftDNS,%s,%s" %
                                    (dnsforest, prefix, forestdn)))
    msg["objectClass"] = ["top", "dnsZone"]
    samdb.add(msg)


def add_dc_domain_records(samdb, domaindn, prefix, site, dnsdomain, hostname,
        hostip, hostip6):

    fqdn_hostname = "%s.%s" % (hostname, dnsdomain)

    # Set up domain container - DC=<DNSDOMAIN>,CN=MicrosoftDNS,<PREFIX>,<DOMAINDN>
    domain_container_dn = ldb.Dn(samdb, "DC=%s,CN=MicrosoftDNS,%s,%s" %
                                    (dnsdomain, prefix, domaindn))

    # DC=@ record
    add_at_record(samdb, domain_container_dn, "DC=@", hostname, dnsdomain,
            hostip, hostip6)

    # DC=<HOSTNAME> record
    add_host_record(samdb, domain_container_dn, "DC=%s" % hostname, hostip,
            hostip6)

    # DC=_kerberos._tcp record
    add_srv_record(samdb, domain_container_dn, "DC=_kerberos._tcp",
            fqdn_hostname, 88)

    # DC=_kerberos._tcp.<SITENAME>._sites record
    add_srv_record(samdb, domain_container_dn, "DC=_kerberos._tcp.%s._sites" %
            site, fqdn_hostname, 88)

    # DC=_kerberos._udp record
    add_srv_record(samdb, domain_container_dn, "DC=_kerberos._udp",
            fqdn_hostname, 88)

    # DC=_kpasswd._tcp record
    add_srv_record(samdb, domain_container_dn, "DC=_kpasswd._tcp",
            fqdn_hostname, 464)

    # DC=_kpasswd._udp record
    add_srv_record(samdb, domain_container_dn, "DC=_kpasswd._udp",
            fqdn_hostname, 464)

    # DC=_ldap._tcp record
    add_srv_record(samdb, domain_container_dn, "DC=_ldap._tcp", fqdn_hostname,
            389)

    # DC=_ldap._tcp.<SITENAME>._sites record
    add_srv_record(samdb, domain_container_dn, "DC=_ldap._tcp.%s._sites" %
            site, fqdn_hostname, 389)

    # FIXME: The number of SRV records depend on the various roles this DC has.
    #        _gc and _msdcs records are added if the we are the forest dc and not subdomain dc
    #
    # Assumption: current DC is GC and add all the entries

    # DC=_gc._tcp record
    add_srv_record(samdb, domain_container_dn, "DC=_gc._tcp", fqdn_hostname,
            3268)

    # DC=_gc._tcp.<SITENAME>,_sites record
    add_srv_record(samdb, domain_container_dn, "DC=_gc._tcp.%s._sites" % site,
            fqdn_hostname, 3268)

    # DC=_msdcs record
    add_ns_glue_record(samdb, domain_container_dn, "DC=_msdcs", fqdn_hostname)

    # FIXME: Following entries are added only if DomainDnsZones and ForestDnsZones partitions
    #        are created
    #
    # Assumption: Additional entries won't hurt on os_level = 2000

    # DC=_ldap._tcp.<SITENAME>._sites.DomainDnsZones
    add_srv_record(samdb, domain_container_dn,
            "DC=_ldap._tcp.%s._sites.DomainDnsZones" % site, fqdn_hostname,
            389)

    # DC=_ldap._tcp.<SITENAME>._sites.ForestDnsZones
    add_srv_record(samdb, domain_container_dn,
            "DC=_ldap._tcp.%s._sites.ForestDnsZones" % site, fqdn_hostname,
            389)

    # DC=_ldap._tcp.DomainDnsZones
    add_srv_record(samdb, domain_container_dn, "DC=_ldap._tcp.DomainDnsZones",
                    fqdn_hostname, 389)

    # DC=_ldap._tcp.ForestDnsZones
    add_srv_record(samdb, domain_container_dn, "DC=_ldap._tcp.ForestDnsZones",
                    fqdn_hostname, 389)

    # DC=DomainDnsZones
    add_host_record(samdb, domain_container_dn, "DC=DomainDnsZones", hostip,
            hostip6)

    # DC=ForestDnsZones
    add_host_record(samdb, domain_container_dn, "DC=ForestDnsZones", hostip,
            hostip6)


def add_dc_msdcs_records(samdb, forestdn, prefix, site, dnsforest, hostname,
                            hostip, hostip6, domainguid, ntdsguid):

    fqdn_hostname = "%s.%s" % (hostname, dnsforest)

    # Set up forest container - DC=<DNSDOMAIN>,CN=MicrosoftDNS,<PREFIX>,<DOMAINDN>
    forest_container_dn = ldb.Dn(samdb, "DC=_msdcs.%s,CN=MicrosoftDNS,%s,%s" %
                                    (dnsforest, prefix, forestdn))

    # DC=@ record
    add_at_record(samdb, forest_container_dn, "DC=@", hostname, dnsforest,
            None, None)

    # DC=_kerberos._tcp.dc record
    add_srv_record(samdb, forest_container_dn, "DC=_kerberos._tcp.dc",
            fqdn_hostname, 88)

    # DC=_kerberos._tcp.<SITENAME>._sites.dc record
    add_srv_record(samdb, forest_container_dn,
            "DC=_kerberos._tcp.%s._sites.dc" % site, fqdn_hostname, 88)

    # DC=_ldap._tcp.dc record
    add_srv_record(samdb, forest_container_dn, "DC=_ldap._tcp.dc",
            fqdn_hostname, 389)

    # DC=_ldap._tcp.<SITENAME>._sites.dc record
    add_srv_record(samdb, forest_container_dn, "DC=_ldap._tcp.%s._sites.dc" %
            site, fqdn_hostname, 389)

    # DC=_ldap._tcp.<SITENAME>._sites.gc record
    add_srv_record(samdb, forest_container_dn, "DC=_ldap._tcp.%s._sites.gc" %
            site, fqdn_hostname, 3268)

    # DC=_ldap._tcp.gc record
    add_srv_record(samdb, forest_container_dn, "DC=_ldap._tcp.gc",
            fqdn_hostname, 3268)

    # DC=_ldap._tcp.pdc record
    add_srv_record(samdb, forest_container_dn, "DC=_ldap._tcp.pdc",
            fqdn_hostname, 389)

    # DC=gc record
    add_host_record(samdb, forest_container_dn, "DC=gc", hostip, hostip6)

    # DC=_ldap._tcp.<DOMAINGUID>.domains record
    add_srv_record(samdb, forest_container_dn,
            "DC=_ldap._tcp.%s.domains" % domainguid, fqdn_hostname, 389)

    # DC=<NTDSGUID>
    add_cname_record(samdb, forest_container_dn, "DC=%s" % ntdsguid,
            fqdn_hostname)


def secretsdb_setup_dns(secretsdb, names, private_dir, realm,
                        dnsdomain, dns_keytab_path, dnspass, key_version_number):
    """Add DNS specific bits to a secrets database.

    :param secretsdb: Ldb Handle to the secrets database
    :param names: Names shortcut
    :param machinepass: Machine password
    """
    try:
        os.unlink(os.path.join(private_dir, dns_keytab_path))
    except OSError:
        pass

    if key_version_number is None:
        key_version_number = 1

    setup_ldb(secretsdb, setup_path("secrets_dns.ldif"), {
            "REALM": realm,
            "DNSDOMAIN": dnsdomain,
            "DNS_KEYTAB": dns_keytab_path,
            "DNSPASS_B64": b64encode(dnspass),
            "KEY_VERSION_NUMBER": str(key_version_number),
            "HOSTNAME": names.hostname,
            "DNSNAME" : '%s.%s' % (
                names.netbiosname.lower(), names.dnsdomain.lower())
            })


def create_dns_dir(logger, paths):
    """Write out a DNS zone file, from the info in the current database.

    :param logger: Logger object
    :param paths: paths object
    """
    dns_dir = os.path.dirname(paths.dns)

    try:
        shutil.rmtree(dns_dir, True)
    except OSError:
        pass

    os.mkdir(dns_dir, 0770)

    if paths.bind_gid is not None:
        try:
            os.chown(dns_dir, -1, paths.bind_gid)
            # chmod needed to cope with umask
            os.chmod(dns_dir, 0770)
        except OSError:
            if not os.environ.has_key('SAMBA_SELFTEST'):
                logger.error("Failed to chown %s to bind gid %u" % (
                    dns_dir, paths.bind_gid))


def create_zone_file(lp, logger, paths, targetdir, dnsdomain,
                     hostip, hostip6, hostname, realm, domainguid,
                     ntdsguid, site):
    """Write out a DNS zone file, from the info in the current database.

    :param paths: paths object
    :param dnsdomain: DNS Domain name
    :param domaindn: DN of the Domain
    :param hostip: Local IPv4 IP
    :param hostip6: Local IPv6 IP
    :param hostname: Local hostname
    :param realm: Realm name
    :param domainguid: GUID of the domain.
    :param ntdsguid: GUID of the hosts nTDSDSA record.
    """
    assert isinstance(domainguid, str)

    if hostip6 is not None:
        hostip6_base_line = "            IN AAAA    " + hostip6
        hostip6_host_line = hostname + "        IN AAAA    " + hostip6
        gc_msdcs_ip6_line = "gc._msdcs               IN AAAA    " + hostip6
    else:
        hostip6_base_line = ""
        hostip6_host_line = ""
        gc_msdcs_ip6_line = ""

    if hostip is not None:
        hostip_base_line = "            IN A    " + hostip
        hostip_host_line = hostname + "        IN A    " + hostip
        gc_msdcs_ip_line = "gc._msdcs               IN A    " + hostip
    else:
        hostip_base_line = ""
        hostip_host_line = ""
        gc_msdcs_ip_line = ""

    # we need to freeze the zone while we update the contents
    if targetdir is None:
        rndc = ' '.join(lp.get("rndc command"))
        os.system(rndc + " freeze " + lp.get("realm"))

    setup_file(setup_path("provision.zone"), paths.dns, {
            "HOSTNAME": hostname,
            "DNSDOMAIN": dnsdomain,
            "REALM": realm,
            "HOSTIP_BASE_LINE": hostip_base_line,
            "HOSTIP_HOST_LINE": hostip_host_line,
            "DOMAINGUID": domainguid,
            "DATESTRING": time.strftime("%Y%m%d%H"),
            "DEFAULTSITE": site,
            "NTDSGUID": ntdsguid,
            "HOSTIP6_BASE_LINE": hostip6_base_line,
            "HOSTIP6_HOST_LINE": hostip6_host_line,
            "GC_MSDCS_IP_LINE": gc_msdcs_ip_line,
            "GC_MSDCS_IP6_LINE": gc_msdcs_ip6_line,
        })

    if paths.bind_gid is not None:
        try:
            os.chown(paths.dns, -1, paths.bind_gid)
            # chmod needed to cope with umask
            os.chmod(paths.dns, 0664)
        except OSError:
            if not os.environ.has_key('SAMBA_SELFTEST'):
                logger.error("Failed to chown %s to bind gid %u" % (
                    paths.dns, paths.bind_gid))

    if targetdir is None:
        os.system(rndc + " unfreeze " + lp.get("realm"))


def create_samdb_copy(samdb, logger, paths, names, domainsid, domainguid):
    """Create a copy of samdb and give write permissions to named for dns partitions
    """
    private_dir = paths.private_dir
    samldb_dir = os.path.join(private_dir, "sam.ldb.d")
    dns_dir = os.path.dirname(paths.dns)
    dns_samldb_dir = os.path.join(dns_dir, "sam.ldb.d")

    # Find the partitions and corresponding filenames
    partfile = {}
    res = samdb.search(base="@PARTITION", scope=ldb.SCOPE_BASE, attrs=["partition"])
    for tmp in res[0]["partition"]:
        (nc, fname) = tmp.split(':')
        partfile[nc.upper()] = fname

    # Create empty domain partition
    domaindn = names.domaindn.upper()
    domainpart_file = os.path.join(dns_dir, partfile[domaindn])
    try:
        os.mkdir(dns_samldb_dir)
        file(domainpart_file, 'w').close()

        # Fill the basedn and @OPTION records in domain partition
        dom_ldb = samba.Ldb(domainpart_file)
        domainguid_line = "objectGUID: %s\n-" % domainguid
        descr = b64encode(get_domain_descriptor(domainsid))
        setup_add_ldif(dom_ldb, setup_path("provision_basedn.ldif"), {
            "DOMAINDN" : names.domaindn,
            "DOMAINGUID" : domainguid_line,
            "DOMAINSID" : str(domainsid),
            "DESCRIPTOR" : descr})
        setup_add_ldif(dom_ldb,
            setup_path("provision_basedn_options.ldif"), None)
    except:
        logger.error(
            "Failed to setup database for BIND, AD based DNS cannot be used")
        raise

    # This line is critical to the security of the whole scheme.
    # We assume there is no secret data in the (to be left out of
    # date and essentially read-only) config, schema and metadata partitions.
    #
    # Only the stub of the domain partition is created above.
    #
    # That way, things like the krbtgt key do not leak.
    del partfile[domaindn]

    # Link dns partitions and metadata
    domainzonedn = "DC=DOMAINDNSZONES,%s" % names.domaindn.upper()
    forestzonedn = "DC=FORESTDNSZONES,%s" % names.rootdn.upper()

    domainzone_file = partfile[domainzonedn]
    forestzone_file = partfile.get(forestzonedn)

    metadata_file = "metadata.tdb"
    try:
        os.link(os.path.join(samldb_dir, metadata_file),
            os.path.join(dns_samldb_dir, metadata_file))
        os.link(os.path.join(private_dir, domainzone_file),
            os.path.join(dns_dir, domainzone_file))
        if forestzone_file:
            os.link(os.path.join(private_dir, forestzone_file),
                    os.path.join(dns_dir, forestzone_file))
    except OSError:
        logger.error(
            "Failed to setup database for BIND, AD based DNS cannot be used")
        raise
    del partfile[domainzonedn]
    if forestzone_file:
        del partfile[forestzonedn]

    # Copy root, config, schema partitions (and any other if any)
    # Since samdb is open in the current process, copy them in a child process
    try:
        tdb_copy(os.path.join(private_dir, "sam.ldb"),
                 os.path.join(dns_dir, "sam.ldb"))
        for nc in partfile:
            pfile = partfile[nc]
            tdb_copy(os.path.join(private_dir, pfile),
                     os.path.join(dns_dir, pfile))
    except:
        logger.error(
            "Failed to setup database for BIND, AD based DNS cannot be used")
        raise

    # Give bind read/write permissions dns partitions
    if paths.bind_gid is not None:
        try:
            os.chown(samldb_dir, -1, paths.bind_gid)
            os.chmod(samldb_dir, 0750)

            for dirname, dirs, files in os.walk(dns_dir):
                for d in dirs:
                    dpath = os.path.join(dirname, d)
                    os.chown(dpath, -1, paths.bind_gid)
                    os.chmod(dpath, 0770)
                for f in files:
                    if f.endswith('.ldb') or f.endswith('.tdb'):
                        fpath = os.path.join(dirname, f)
                        os.chown(fpath, -1, paths.bind_gid)
                        os.chmod(fpath, 0660)
        except OSError:
            if not os.environ.has_key('SAMBA_SELFTEST'):
                logger.error(
                    "Failed to set permissions to sam.ldb* files, fix manually")
    else:
        if not os.environ.has_key('SAMBA_SELFTEST'):
            logger.warning("""Unable to find group id for BIND,
                set permissions to sam.ldb* files manually""")


def create_dns_update_list(lp, logger, paths):
    """Write out a dns_update_list file"""
    # note that we use no variable substitution on this file
    # the substitution is done at runtime by samba_dnsupdate, samba_spnupdate
    setup_file(setup_path("dns_update_list"), paths.dns_update_list, None)
    setup_file(setup_path("spn_update_list"), paths.spn_update_list, None)


def create_named_conf(paths, realm, dnsdomain, dns_backend, logger):
    """Write out a file containing zone statements suitable for inclusion in a
    named.conf file (including GSS-TSIG configuration).

    :param paths: all paths
    :param realm: Realm name
    :param dnsdomain: DNS Domain name
    :param dns_backend: DNS backend type
    :param keytab_name: File name of DNS keytab file
    :param logger: Logger object
    """

    # TODO: This really should have been done as a top level import.
    # It is done here to avoid a depencency loop.  That is, we move
    # ProvisioningError to another file, and have all the provision
    # scripts import it from there.

    from samba.provision import ProvisioningError

    if dns_backend == "BIND9_FLATFILE":
        setup_file(setup_path("named.conf"), paths.namedconf, {
                    "DNSDOMAIN": dnsdomain,
                    "REALM": realm,
                    "ZONE_FILE": paths.dns,
                    "REALM_WC": "*." + ".".join(realm.split(".")[1:]),
                    "NAMED_CONF": paths.namedconf,
                    "NAMED_CONF_UPDATE": paths.namedconf_update
                    })

        setup_file(setup_path("named.conf.update"), paths.namedconf_update)

    elif dns_backend == "BIND9_DLZ":
        bind_info = subprocess.Popen(['named -V'], shell=True,
                                     stdout=subprocess.PIPE,
                                     stderr=subprocess.STDOUT,
                                     cwd='.').communicate()[0]
        bind9_8 = '#'
        bind9_9 = '#'
        bind9_10 = '#'
        if bind_info.upper().find('BIND 9.8') != -1:
            bind9_8 = ''
        elif bind_info.upper().find('BIND 9.9') != -1:
            bind9_9 = ''
        elif bind_info.upper().find('BIND 9.10') != -1:
            bind9_10 = ''
        elif bind_info.upper().find('BIND 9.7') != -1:
            raise ProvisioningError("DLZ option incompatible with BIND 9.7.")
        else:
            logger.warning("BIND version unknown, please modify %s manually." % paths.namedconf)
        setup_file(setup_path("named.conf.dlz"), paths.namedconf, {
                    "NAMED_CONF": paths.namedconf,
                    "MODULESDIR" : samba.param.modules_dir(),
                    "BIND9_8" : bind9_8,
                    "BIND9_9" : bind9_9,
                    "BIND9_10" : bind9_10
                    })


def create_named_txt(path, realm, dnsdomain, dnsname, private_dir,
    keytab_name):
    """Write out a file containing zone statements suitable for inclusion in a
    named.conf file (including GSS-TSIG configuration).

    :param path: Path of the new named.conf file.
    :param realm: Realm name
    :param dnsdomain: DNS Domain name
    :param private_dir: Path to private directory
    :param keytab_name: File name of DNS keytab file
    """
    setup_file(setup_path("named.txt"), path, {
            "DNSDOMAIN": dnsdomain,
            "DNSNAME" : dnsname,
            "REALM": realm,
            "DNS_KEYTAB": keytab_name,
            "DNS_KEYTAB_ABS": os.path.join(private_dir, keytab_name),
            "PRIVATE_DIR": private_dir
        })


def is_valid_dns_backend(dns_backend):
    return dns_backend in ("BIND9_FLATFILE", "BIND9_DLZ", "SAMBA_INTERNAL", "NONE")


def is_valid_os_level(os_level):
    return DS_DOMAIN_FUNCTION_2000 <= os_level <= DS_DOMAIN_FUNCTION_2008_R2


def create_dns_legacy(samdb, domainsid, forestdn, dnsadmins_sid):
    # Set up MicrosoftDNS container
    add_dns_container(samdb, forestdn, "CN=System", domainsid, dnsadmins_sid)
    # Add root servers
    add_rootservers(samdb, forestdn, "CN=System")


def fill_dns_data_legacy(samdb, domainsid, forestdn, dnsdomain, site, hostname,
                         hostip, hostip6, dnsadmins_sid):
    # Add domain record
    add_domain_record(samdb, forestdn, "CN=System", dnsdomain, domainsid,
                      dnsadmins_sid)

    # Add DNS records for a DC in domain
    add_dc_domain_records(samdb, forestdn, "CN=System", site, dnsdomain,
                          hostname, hostip, hostip6)


def create_dns_partitions(samdb, domainsid, names, domaindn, forestdn,
                          dnsadmins_sid, fill_level):
    # Set up additional partitions (DomainDnsZones, ForstDnsZones)
    setup_dns_partitions(samdb, domainsid, domaindn, forestdn,
                        names.configdn, names.serverdn, fill_level)

    # Set up MicrosoftDNS containers
    add_dns_container(samdb, domaindn, "DC=DomainDnsZones", domainsid,
                      dnsadmins_sid)
    if fill_level != FILL_SUBDOMAIN:
        add_dns_container(samdb, forestdn, "DC=ForestDnsZones", domainsid,
                          dnsadmins_sid, forest=True)


def fill_dns_data_partitions(samdb, domainsid, site, domaindn, forestdn,
                             dnsdomain, dnsforest, hostname, hostip, hostip6,
                             domainguid, ntdsguid, dnsadmins_sid, autofill=True,
                             fill_level=FILL_FULL):
    """Fill data in various AD partitions

    :param samdb: LDB object connected to sam.ldb file
    :param domainsid: Domain SID (as dom_sid object)
    :param site: Site name to create hostnames in
    :param domaindn: DN of the domain
    :param forestdn: DN of the forest
    :param dnsdomain: DNS name of the domain
    :param dnsforest: DNS name of the forest
    :param hostname: Host name of this DC
    :param hostip: IPv4 addresses
    :param hostip6: IPv6 addresses
    :param domainguid: Domain GUID
    :param ntdsguid: NTDS GUID
    :param dnsadmins_sid: SID for DnsAdmins group
    :param autofill: Create DNS records (using fixed template)
    """

    ##### Set up DC=DomainDnsZones,<DOMAINDN>
    # Add rootserver records
    add_rootservers(samdb, domaindn, "DC=DomainDnsZones")

    # Add domain record
    add_domain_record(samdb, domaindn, "DC=DomainDnsZones", dnsdomain,
                      domainsid, dnsadmins_sid)

    # Add DNS records for a DC in domain
    if autofill:
        add_dc_domain_records(samdb, domaindn, "DC=DomainDnsZones", site,
                              dnsdomain, hostname, hostip, hostip6)

    if fill_level != FILL_SUBDOMAIN:
        ##### Set up DC=ForestDnsZones,<FORESTDN>
        # Add _msdcs record
        add_msdcs_record(samdb, forestdn, "DC=ForestDnsZones", dnsforest)

        # Add DNS records for a DC in forest
        if autofill:
            add_dc_msdcs_records(samdb, forestdn, "DC=ForestDnsZones", site,
                                 dnsforest, hostname, hostip, hostip6,
                                 domainguid, ntdsguid)


def setup_ad_dns(samdb, secretsdb, names, paths, lp, logger,
        dns_backend, os_level, dnspass=None, hostip=None, hostip6=None,
        targetdir=None, fill_level=FILL_FULL):
    """Provision DNS information (assuming GC role)

    :param samdb: LDB object connected to sam.ldb file
    :param secretsdb: LDB object connected to secrets.ldb file
    :param names: Names shortcut
    :param paths: Paths shortcut
    :param lp: Loadparm object
    :param logger: Logger object
    :param dns_backend: Type of DNS backend
    :param os_level: Functional level (treated as os level)
    :param dnspass: Password for bind's DNS account
    :param hostip: IPv4 address
    :param hostip6: IPv6 address
    :param targetdir: Target directory for creating DNS-related files for BIND9
    """

    if not is_valid_dns_backend(dns_backend):
        raise Exception("Invalid dns backend: %r" % dns_backend)

    if not is_valid_os_level(os_level):
        raise Exception("Invalid os level: %r" % os_level)

    if dns_backend == "NONE":
        logger.info("No DNS backend set, not configuring DNS")
        return

    # Add dns accounts (DnsAdmins, DnsUpdateProxy) in domain
    logger.info("Adding DNS accounts")
    add_dns_accounts(samdb, names.domaindn)

    # If dns_backend is BIND9_FLATFILE
    #   Populate only CN=MicrosoftDNS,CN=System,<DOMAINDN>
    #
    # If dns_backend is SAMBA_INTERNAL or BIND9_DLZ
    #   Populate DNS partitions

    # If os_level < 2003 (DS_DOMAIN_FUNCTION_2000)
    #   All dns records are in CN=MicrosoftDNS,CN=System,<DOMAINDN>
    #
    # If os_level >= 2003 (DS_DOMAIN_FUNCTION_2003, DS_DOMAIN_FUNCTION_2008,
    #                        DS_DOMAIN_FUNCTION_2008_R2)
    #   Root server records are in CN=MicrosoftDNS,CN=System,<DOMAINDN>
    #   Domain records are in CN=MicrosoftDNS,CN=System,<DOMAINDN>
    #   Domain records are in CN=MicrosoftDNS,DC=DomainDnsZones,<DOMAINDN>
    #   Forest records are in CN=MicrosoftDNS,DC=ForestDnsZones,<FORESTDN>
    domaindn = names.domaindn
    forestdn = samdb.get_root_basedn().get_linearized()

    dnsdomain = names.dnsdomain.lower()
    dnsforest = dnsdomain

    site = names.sitename

    hostname = names.netbiosname.lower()

    dnsadmins_sid = get_dnsadmins_sid(samdb, domaindn)
    domainguid = get_domainguid(samdb, domaindn)

    # Create CN=System
    logger.info("Creating CN=MicrosoftDNS,CN=System,%s" % domaindn)
    create_dns_legacy(samdb, names.domainsid, domaindn, dnsadmins_sid)

    if os_level == DS_DOMAIN_FUNCTION_2000:
        # Populating legacy dns
        logger.info("Populating CN=MicrosoftDNS,CN=System,%s" % domaindn)
        fill_dns_data_legacy(samdb, names.domainsid, domaindn, dnsdomain, site,
                             hostname, hostip, hostip6, dnsadmins_sid)

    elif dns_backend in ("SAMBA_INTERNAL", "BIND9_DLZ") and \
            os_level >= DS_DOMAIN_FUNCTION_2003:

        # Create DNS partitions
        logger.info("Creating DomainDnsZones and ForestDnsZones partitions")
        create_dns_partitions(samdb, names.domainsid, names, domaindn, forestdn,
                              dnsadmins_sid, fill_level)

        # Populating dns partitions
        logger.info("Populating DomainDnsZones and ForestDnsZones partitions")
        fill_dns_data_partitions(samdb, names.domainsid, site, domaindn, forestdn,
                                 dnsdomain, dnsforest, hostname, hostip, hostip6,
                                 domainguid, names.ntdsguid, dnsadmins_sid,
                                 fill_level=fill_level)

    if dns_backend.startswith("BIND9_"):
        setup_bind9_dns(samdb, secretsdb, names, paths, lp, logger,
                        dns_backend, os_level, site=site, dnspass=dnspass, hostip=hostip,
                        hostip6=hostip6, targetdir=targetdir)


def setup_bind9_dns(samdb, secretsdb, names, paths, lp, logger,
        dns_backend, os_level, site=None, dnspass=None, hostip=None,
        hostip6=None, targetdir=None, key_version_number=None):
    """Provision DNS information (assuming BIND9 backend in DC role)

    :param samdb: LDB object connected to sam.ldb file
    :param secretsdb: LDB object connected to secrets.ldb file
    :param names: Names shortcut
    :param paths: Paths shortcut
    :param lp: Loadparm object
    :param logger: Logger object
    :param dns_backend: Type of DNS backend
    :param os_level: Functional level (treated as os level)
    :param site: Site to create hostnames in
    :param dnspass: Password for bind's DNS account
    :param hostip: IPv4 address
    :param hostip6: IPv6 address
    :param targetdir: Target directory for creating DNS-related files for BIND9
    """

    if (not is_valid_dns_backend(dns_backend) or
        not dns_backend.startswith("BIND9_")):
        raise Exception("Invalid dns backend: %r" % dns_backend)

    if not is_valid_os_level(os_level):
        raise Exception("Invalid os level: %r" % os_level)

    domaindn = names.domaindn

    domainguid = get_domainguid(samdb, domaindn)

    secretsdb_setup_dns(secretsdb, names,
                        paths.private_dir, realm=names.realm,
                        dnsdomain=names.dnsdomain,
                        dns_keytab_path=paths.dns_keytab, dnspass=dnspass,
                        key_version_number=key_version_number)

    create_dns_dir(logger, paths)

    if dns_backend == "BIND9_FLATFILE":
        create_zone_file(lp, logger, paths, targetdir, site=site,
                         dnsdomain=names.dnsdomain, hostip=hostip,
                         hostip6=hostip6, hostname=names.hostname,
                         realm=names.realm, domainguid=domainguid,
                         ntdsguid=names.ntdsguid)

    if dns_backend == "BIND9_DLZ" and os_level >= DS_DOMAIN_FUNCTION_2003:
        create_samdb_copy(samdb, logger, paths, names, names.domainsid, domainguid)

    create_named_conf(paths, realm=names.realm,
                      dnsdomain=names.dnsdomain, dns_backend=dns_backend,
                      logger=logger)

    create_named_txt(paths.namedtxt,
                     realm=names.realm, dnsdomain=names.dnsdomain,
                     dnsname = "%s.%s" % (names.hostname, names.dnsdomain),
                     private_dir=paths.private_dir,
                     keytab_name=paths.dns_keytab)
    logger.info("See %s for an example configuration include file for BIND",
                paths.namedconf)
    logger.info("and %s for further documentation required for secure DNS "
                "updates", paths.namedtxt)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ELF          (    )  4   <   4    (                                   l                 `  `                    $   $         Qtd                          Rtd                       GNU ziq8m W   l         Fp  HDA`al   n   o   r   v   y   {   |               }       ~              ,"4vT<TVJ1eqXZ\"Xy|=WCEb~,W~                    %       	            	             	                           a                                       I	                                                                    a                                                                                l                          %                          4             I             
             )             u              y                                                    V	                                                      S             #                                        <                                                     8               y                                       |                                       Q                                       D             f             '             m             D                                       8             +                          ~	                                                    3                          	             /                                                    O                                        n             2	                                                    ~                          Y             V                                        	             0             y             	                                                                              {                           I             j             c             \             R           "   s	             a               ,       
                    
           lx         %       	 K  .         pw       
         	           +       
                    /  P       d~         4}       
         	   8       -  @     
         t  .        __gmon_start__ _init _fini _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable __cxa_finalize _Jv_RegisterClasses _tevent_req_callback_data _talloc_get_type_abort dcerpc_binding_handle_call_recv _talloc_free _tevent_req_nterror _tevent_req_done dcerpc_xattr_parse_DOSATTRIB_r_send _tevent_req_create dcerpc_binding_handle_call_send _tevent_req_nomem tevent_req_set_callback tevent_req_post ndr_table_xattr dcerpc_xattr_parse_DOSATTRIB_r_recv _tevent_req_data tevent_req_is_nterror _talloc_steal_loc tevent_req_received memset dcerpc_xattr_parse_DOSATTRIB_r dcerpc_binding_handle_call dcerpc_xattr_parse_DOSATTRIB_send memcpy dcerpc_xattr_parse_DOSATTRIB_recv dcerpc_xattr_parse_DOSATTRIB _Py_NoneStruct _talloc_zero pytalloc_steal PyLong_FromLongLong PyType_IsSubtype PyInt_AsLong PyErr_Format PyList_Type PyInt_Type PyExc_TypeError PyInt_FromLong talloc_strdup PyString_FromStringOrNULL PyList_New PyList_SetItem pytalloc_reference_ex ndr_print_struct_string PyString_FromString ndr_print_security_descriptor_hash_v4 ndr_print_security_descriptor_hash_v3 ndr_print_security_descriptor_hash_v2 ndr_print_xattr_DOSATTRIB ndr_print_xattr_NTACL ndr_print_xattr_DosStreams ndr_print_tdb_xattrs ndr_print_xattr_DosEAs ndr_print_xattr_DosAttrib PyArg_ParseTupleAndKeywords _talloc_reference_loc PyErr_NoMemory PyObject_IsTrue ndr_pull_struct_blob_all ndr_pull_struct_blob ndr_map_error2string Py_BuildValue PyErr_SetObject ndr_pull_security_descriptor_hash_v4 PyExc_RuntimeError ndr_pull_security_descriptor_hash_v3 ndr_pull_security_descriptor_hash_v2 ndr_pull_xattr_DOSATTRIB ndr_pull_xattr_NTACL ndr_pull_xattr_DosStreams ndr_pull_tdb_xattrs ndr_pull_xattr_DosEAs ndr_pull_xattr_DosAttrib ndr_push_struct_blob PyString_FromStringAndSize ndr_push_security_descriptor_hash_v4 ndr_push_security_descriptor_hash_v3 ndr_push_security_descriptor_hash_v2 ndr_push_xattr_DOSATTRIB ndr_push_xattr_NTACL ndr_push_xattr_DosStreams ndr_push_tdb_xattrs ndr_push_xattr_DosEAs ndr_push_xattr_DosAttrib py_dcerpc_syntax_init_helper py_dcerpc_interface_init_helper data_blob_talloc_named talloc_unlink _talloc_array talloc_set_name_const talloc_named_const __vasprintf_chk __printf_chk puts PyLong_AsLongLong PyLong_Type py_import_xattr_DosInfo PyErr_SetString py_export_xattr_DosInfo py_import_xattr_NTACL_Info py_export_xattr_NTACL_Info initxattr PyImport_ImportModule PyObject_GetAttrString PyType_Ready PyInterface_AddNdrRpcMethods PyDict_New PyCFunction_NewEx PyDict_SetItemString PyDescr_NewMethod Py_InitModule4 PyModule_AddObject py_ndr_xattr_methods libpthread.so.0 libdcerpc-binding.so.0 libndr-samba.so.0 libsamba-python.so.0 libndr.so.0 libtevent-util.so.0 libsamba-util.so.0 libtdb-wrap.so.0 libpython2.7.so.1.0 libtalloc.so.2 libpytalloc-util.so.2 libtevent.so.0 libc.so.6 _edata __bss_start __bss_start__ __bss_end__ __end__ _end samba/dcerpc/xattr.so /usr/lib/arm-linux-gnueabihf/samba TEVENT_UTIL_0.0.1 SAMBA_UTIL_0.0.1 TEVENT_0.9.9 GLIBC_2.8 GLIBC_2.4 NDR_0.0.1 TALLOC_2.0.2 PYTALLOC_UTIL_2.0.6 SAMBA_4.2.14_DEBIAN DCERPC_BINDING_0.0.1                                           	 	                  
         	                          	       	           	                        	        	                        H
            E        \
         T  
 W        
         )  	 h        
     0   ii   u     ii           <
         A#           
         "           
         Y           
                    '
                    	                                                                       P    p                4    h            ,                `            $    D    x                <                     h    p            ,    4    T                    L                    x                <    D    d            (    \                 l                                              $    (    4    8    <    \    `    h    l    p    x    |                                                                                     ,    0    4    @    D    H    T    X    \    h    l    p    |                                                                                     4    8    @    D    H    P    T    X    `    t    x    |                                                                            ,    0    4    @    D    H    T    X    \    h    l    p                                                                                     (    ,    0    8    L    P    T    `    d    h                                                                                         ,    0    4    T    X    `    d    h    p    t    x                                                                                      $    (    4    8    <    H    L    P    p    t    x                                                                                                     8    <    @    L    P    T    `    d    h    t    x    |                                         ~     d   `   h   l   p   t   x   |                       }   #   &   '   )   *   +   -   .   0   3   4   5   8   9   >   B   C   Q   R   W   _   a   f   g   i  0   4   8   <   @ 	  D 
  H   L   P   T   X   \   `   d   h ~  l v  p   t   x   | l   !   "   $   %   (   ,   /   1   2   6   7   :   ;   <   =   ?   @   A   D   E   z   F   G   H   I   s   J   K   L   M   N   O    P   p   S   T   U   V   X   Y    Z  $ [  ( \  , ]  0 ^  4 `  8 b  < c  @ d  D {  H e  L g  P h  T i  X j  \ k  @-  -                       x p h ` X P H @ 8 0 (                        x p h ` X P H @ 8 0 (               0 0   R/)t H  404 0  00` S 00/ 0  S//  8 x  88   `,0A0/ 0  S//     @-H0H 0  0  S400  S  
(0 0 0  x    d < 8 @-    ,0  R0  @ 0  S
3/ < L  p@- @dd  g P   T `  
@ 4   =  Pp p@lx`  `  `  `  `  @-`M00Pp  00 @P   
   0  `0 `   `  P  H  R   `  `  D @  `  @-Mp P``   `  @P	  <        _  (`  (`  @- @l   `   P   Qc  T p  
T 5H    PH H @$ @|^  _  `  4`  ,`  D`  L`  0000-M    0< @  0A-M0 00p 0E PP$  
@ 0H `0 (DH  @  0X   @i  P  @     `  _  _  P@-Mp Pa``  k `  @P	  <   u (  # 4^  d_  h_  M0@-LMX P @ H  0  L0@/0 00      /@   $ @-0 @     @ ^  $ @-@ @     @^  $ @-( @     @^  $ @- @     @^  $ @- @     @t^  $ @-H @     @h^  $ @- @   v  @\^  $ @-H @   j  @P^  $ @- @   ^  @8^  $ @- @   R  @,^  $ @- @   F  @^  $ @-  @   :  @]  $ @- @   .  @]  $ @- @   "  @]  $ @- @     @x]  $ @-H @   
  @l]  0n0k0h0e0b0_0\0Y0V0S0P0M0 J0G0D0 AC-P  1`@ M P  
  P.  
0  S  0W` @p01  R   
  P  
0	0 @ 0 S  |0 	 0  h0 0\00  <0  0   0,,00  L \  h  `  <\  \  [  @q  C-P  1`@ M P  
  P.  
0  S  0` @p01  R   
  P  
0	0 @ 0 S  |0 	 0  h0 0\00C  <0  0   0,,004   \  h  `  [  \  ([  o  C-P  1`@ M P  
P  P.  
0  S  0` @p01  R   
>  P  
0	0 2@ 0 S  |0 	 0  h0 0\00  <0  0   0,,00   \  h  `  <[  Z  Z  n  C-P  1`@ M P  
  P.  
0  S  0` @p01  R   
  P  
0	0 @ 0 S  |0 	 0  h0 0\00  <0  0   0,,00  \ \  h  `  Z  hY  Y  Pm  0 0 0  0 0 0  0 0  0  0 0 |0 y0 v0 s0 p0 m0  j0  g0  d0 a0 ^ 0@- @C8    0@- @:H    0@- @1     0@- @(    0@- @    08 0H 0  0 0  p@-P@  `P
  
WP @ @   |@ T pp@-P@ z `P
  
P @ @   i@ T pp@-P@ g `P
  
P @ @   V@ T pp@-P T `P
  
P @ @   C T p@-P0 0  R  
  < `P  
 0  S  
\p @p "v@   % 0 T:  0          A-`   P  
 0  S  
Hp Ppp@  P@P    0 T:  A-`0 0  R  
  pP  
0  S  
h P@  -@P   0 S  0          H8@-@0 <  0  PS  @ 	 8,   lU  lU  H8@-@0 <  0  P;  @  8 P  PU  PU  H8@-@0 <  0  P#  @  8l |  4U  4U  H8@-@0 <  0  P  @  8 d  U  U  H8@-@0 <  0  P  @  8~   T  T  H8@-@0 <  0  P  @  8L~   T  T  H8@-@0 <  0  P  @ y 8}   T  T  H8@-@0 <  0 n P  @ a 8}   tT  hT  H8@-@0 <  0 V P  @ I 8,} D  LT  @T  @-PM 0 0  0q``  P  
0p pb P  
 @P  
0    @P  
0 H e  T0!0  0@ 0<007  (T   T  | l~ 8T  `  S  S  ,1@-0 P 4M$0`       `   p@@  P  
 0  P 0  
  P  0 0 ( P  U  00      4`0 0  PH0 0 @R  0   ;    } tS  P{       R  ,1@-0 P 4M$0`       `   p@@  P  
 0  P 0  
  P  0 0  P  U  00      4`0 0  PH0 0 @  0       @| $R   z p      pQ  ,1@-0 P 4M$0`       `   pw@@  P  
 0  P 0  
C  P  0 0  P  U  00      4`0 0 f PH0 0 @  0     H  z P  x <       P  ,1@-0 P 4M$0`       `   p#@@  P  
 0  P 0  
  P  0 0 , P  U  00      4`0 0  PH0 0 @V  0   ?    y O  `w       N  ,1@-0 P 4M$0`       `   p@@  P  
 0  P 0  
  P  0 0  P  U  00      4`0 0  PH0 0 @  0       Px 4N  v       M  ,1@-0 P 4M$0`       `   p{@@  P  
 0  P 0  
G  P  0 0  P  U  00      4`0 0 j PH0 0 @  0     L   w L  t       0L  ,1@-0 P 4M$0`       `   p'@@  P  
 0  P 0  
  P  0 0 0 P  U  00      4`0 0  PH0 0 @Z  0   C    u K  ps       J  ,1@-0 P 4M$0`       `   p@@  P  
 0  P 0  
  P  0 0  P  U  00      4`0 0  PH0 0 @  0       `t DJ   r       I  ,1@-0 P 4M$0`       `   p@@  P  
 0  P 0  
K  P  0 0  P  U  00      4`0 0 n PH0 0 @  0     P  s H  p       @H  0@-  p@p0@M 0 x PP   0<00 @  (   u  *  0o l    G  0@-  p@p0@M 0 T PP   0<00 @h  (   Q    0Ho     G  0@-  p@p0@M 0 0 PP   0<00 @D  (   -    0n     F  0@-  p@p0@M 0  PP   0<00 @   (   	    0(n     E  0 0@-  p@p0@M 0  PP   0<00 @  (       0m     \E  0@-  p@p0@M 0  PP   f0<00 @  (     s  0l     D  0@-  p@p0@M 0  PP   B0<00 @  (     O  0ll     <D  0@-  p@p0@M 0 y PP   0<00 @  (   v  +  0k X    C  0 0@-  p@p0@M 0 R PP   0<00 @f  (   O    0@k T    C  0000*j @  000)j @  D0@- M @0   P    0B  D0@- M @0   P    0|B  G-PM @ 10 Y   A  
1    ` P  
  PN  
x1   0u  P C  
X0  S)  DaDq`p @  0
0@    0 S  01  R   
  P  
0
0    P?    0 
 0  0 0t00O    L0  0   0<<00>  i   \  LB  \B   k B  `  A  A  @  P  O- @1	 PM P`  
U  PO  
x1  0  P D  
XJ0  S*  DD
 @pP
  00@   0 S  00  R   
)  P  
00  BP   P    0  0  |0 0p00    H0  0   08800  g \  A  A  <i B  `  @  A  ?  0N  O-`M @ 1	0 [   B  
1    P P  
  PO  
|1  0x  P D  
\0  S*  HH
 @pP
  00@   0 S  00  R   
  P  
00  P   PA    0  0  0 0t00Q    L0  0   0<<00@  e   \  @  ?  ,g $A  `  ?  (@  ?   L   @- p     |PP `' @P  
h0h0 0T H00      ,  ?  ?  c t   @  ?    ?   -p@-M  P0 @   @0D` S`  
 0@ T: a p@/?   80 0  Q  
(0 0     00 0/b <z    80 0  Q  
(0 0     00 0/4b y    80 0  Q  
(0 0  |   00 0/a y   8@-0 PT0 D    
 0 8  0 844 40  0 $0   0a h  `    =  8@-0 PT0 D    
 0 8  0 844 40  0 $0  V 0` h  `    $=  8@-0 PT0 D    
 p0 8  0 844 40  0 $0  , 0<` h  `    |<  8@-0 PT0 D    
 F0 8 x 0 844 40  0 $0   0_ h  `    ;  8@-0 PT0 D    
 0   8 O 0   844 40  0 $0   0^ h  `    0;  8@-0 PT0 D    
 0 8 % 0 844 40  0 $0   0H^ h  `    :  8@-0 PT0 D    
 0 8  0 844 40  0 $0   0] h  `    9  8@-0 PT0 D    
 0 8  0 844 40  0 $0  [ 0\ h  `    89  8@-0 PT0 D    
 u0 8  0 844 40  0 $0  1 0P\ h  `    8  8@-0 PT0 D    
 K0 8 } 0 844 40  0 $0   0[ h  `    7  8@-0 PT0 D    
 !0 8 S 0 844 40  0 $0   0 [ h  `    @7  8@-0 PT0 D    
 0 8 ) 0 844 40  0 $0   0XZ h  `    6  8@-0 PT0 D    
 0 8  0 844 40  0 $0   0Y h  `    5  8@-0 PT0 D    
 0  8  0  844 40  0 $0  _ 0Y h  `    H5  8@-0 PT0 D    
 y0 8  0 844 40  0 $0  5 0`X h  `    4  8@-0 PT0 D    
 O0 8  0 844 40  0 $0   0W h  `    3  8@-0 PT0 D    
 %0  8 W 0  844 40  0 $0   0W h  `    P3  @-P@0@p` M P  
   P  
  0  80  0   0  00 0lV h  `  2   >  @-P@0@p` M P  
  P  
  0  80  0   0  00 0U h  `  t2  \=  @-P@0@p` M P  
  P  
  0  80  0   0  00f 0$U h  `   2  <  @-P@0@p` M P  
  P  
 { 0  80  0   0  00= 0T h  `  1  <  @-P@0@p` M P  
\  P  
 R 0   80  0   0  00 0S h  `  x1  p;  @-P@0@p` M P  
3  P  
 ) 0  80  0   0  00 08S h  `  $1  :  @-P@0@p` M P  

  P  
   0   80  0   0  00 0R h  `  0  (:  @-P@0@p` M P  
  P  
  0   80  0   0  00 0Q h  `  |0  9  @-P@0@p` M P  
  P  
  0  80  0   0  00p 0LQ h  `  (0  8  @-P@0@p` M P  
  P  
  0  80  0   0  00G 0P h  `  /  <8  @-P@0@p` M P  
f  P  
 \ 0  80  0   0  00 0P h  `  /  7  @-P@0@p` M P  
=  P  
 3 0  80  0   0  00 0`O h  `  4/  6  @-P@0@p` M P  
  P  
 
 0  80  0   0  00 0N h  `  .  P6  @-P@0@p` M P  
  P  
  0  80  0   0  00 0N h  `  .  5  @-P@0@p` M P  
  P  
  0  80  0   0  00z 0tM h  `  D.  5  @-P@0@p` M P  
  P  
  0   80  0   0  00Q 0L h  `  -  d4  @-P@0@p` M P  
p  P  
 f 0   80  0   0  00( 0,L h  `  -  3  @-P@0@p` M P  
G  P  
 = 0   80  0   0  00 0K h  `  T-  3  @-P@0@p` M P  
  P  
  0  80  0   0  00 0J h  `  -  x2  @-P@0@p` M P  
  P  
  0  80  0   0  00 0@J h  `  ,  1  A-@`M P  p0p0 T      
 0 0   P  
  P  
|     P  
0   0P0   0    04400r  K  I   0a ,  `  ,  0  A-@`M P  p0p0 T      
 0 0   P  
  P  
|     P  
0   0P0   0    044002    H   0` 4,  `  +  /  A-@`M P  Ep0p0 T      
 0 0   P  
@  P  
|   Z  P  
0   0P0   0    04400    G   0_ +  `  +  .  @- Q00"  
   Q  
 Q  0 0@x0 0I @ Q  X0 01@D D0  A  ,0 0@F   dH LH (H `  *  G 0    C-`#MP @ pp U @]  
0   U  
T3 UI  L 	 P  
 PP}  
,#   PP  
0P  0 0 	I P  
 PPv  
"   PP  
P@   U   	1 P  
 PPq  
"   PP{  
P       <2< P0  (   	 P  
g PP  
!   PPW  
P         1 #0   010x H1 X"0   0LL10 @ 1 $0   010 0 #0   000     T*  E   DG x*  F p,  F *  `  ,   ,  E *  )  |(   *  '  8(  ,(  *  '  @*  0(  '  l(  (  T)  '  )  @- @   P  
   @         @@- @   P  
   @         @@-A00 Q0      
     Q"  
    n @0   Q  
    b@'   Q  
0 0  @   Q  
`    U @H 0      0 00    @ B lB (X $B   `  $    C-P#M@  p#D ` Qw  [  <    X30 U|  
L 0	n 0  P  
: @P  
 #  T @PW    `  20 U 0^  
 0	 b P  
 @P|  
"  7 @P:    C  l20 UA  
x 0	U 0  P  
 @P:  
L"   @P  0  %  10 U#  
 0	 0   P  
 @PS  
!   @P_  
0  010   j   0  0p1 h%0   0``10T R (1 &0   0$$10q @ 0 ,&0   000_ . 0   0    000L  !  '  ?   <A H*  T*  @ )  )  P@ '  '  U &  `  |%  (  D&  D"  &  '  !  '  &  !  &  $  h!  $  %  @- @ T  P 0  0  A-  MWP @P  
   `P  
   pP  
  } P  
 Vg`  P   
 M  P    
l F  P   
T ?  P     
8G0@-23T45(82D1890t:56d78;;  P|  1  Px  F@  Pr  I   Pm  z   Ph  b{  Pd   w  P`   r  P[  n  PW   j  PS   e  PN  U `  PI  F@bZ  PC  n U  P>   P  P9   K  P4  1m F  P/   A  P*  5 k  P$  
<;  S  <l5lelU0`P7Mn^@<`P       p  W     
0 d4$` 0  0 PP
D  K@   @ F     ;   |  3t    /\   L  $D   	 ,           @ 
                    l    T    <   z  $   sL2 0L2 k3 03 c3 03 [40I.4  R70z.7  I1 x01 A0 \00 9l8D0.l8  009  009 ( 00  0  90.9  \50U.\5   6 0 6 60n.6  :p0.:  |;P0.|;  @< 0@< =,0  =A'  P; &  &  &  &  R &  &  &  p< ; @; t  : : : <$  O   0$  $$  9 $$   $  ,$  ,$  ,$  0$  ,$  4$  8$  4$  0$  8$  <$  4$  ,$  ($  ($  $$   $  $  $  $  $   $  #  #  #  #  #  t#    <#  $#  ,
  	  `	  "  "  d"  @-struct tevent_req   default/librpc/gen_ndr/ndr_xattr_c.c:49 default/librpc/gen_ndr/ndr_xattr_c.c:53 default/librpc/gen_ndr/ndr_xattr_c.c:54 default/librpc/gen_ndr/ndr_xattr_c.c:58 struct dcerpc_xattr_parse_DOSATTRIB_r_state default/librpc/gen_ndr/ndr_xattr_c.c:27 default/librpc/gen_ndr/ndr_xattr_c.c:37 default/librpc/gen_ndr/ndr_xattr_c.c:65 default/librpc/gen_ndr/ndr_xattr_c.c:73 default/librpc/gen_ndr/ndr_xattr_c.c:133    struct dcerpc_xattr_parse_DOSATTRIB_state   default/librpc/gen_ndr/ndr_xattr_c.c:135    default/librpc/gen_ndr/ndr_xattr_c.c:146    default/librpc/gen_ndr/ndr_xattr_c.c:147    default/librpc/gen_ndr/ndr_xattr_c.c:156    default/librpc/gen_ndr/ndr_xattr_c.c:108    default/librpc/gen_ndr/ndr_xattr_c.c:123    default/librpc/gen_ndr/ndr_xattr_c.c:163    default/librpc/gen_ndr/ndr_xattr_c.c:172    struct xattr_DosInfo3   struct xattr_DosInfo2Old    struct xattr_DosInfo1   struct xattr_DosInfoFFFFCompat  struct security_descriptor_hash_v4  struct security_descriptor_hash_v3  struct security_descriptor_hash_v2  struct xattr_DOSATTRIB  struct xattr_sys_acl_hash_wrapper   struct xattr_NTACL  struct xattr_DosStreams struct xattr_DosStream  struct tdb_xattrs   struct xattr_DosEAs struct xattr_EA struct xattr_DosAttrib  default/librpc/gen_ndr/py_xattr.c:2056: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2060: Expected type '%s' for '%s' of type '%s'    PyList_GET_ITEM(value, sys_acl_hash_cntr_0) default/librpc/gen_ndr/py_xattr.c:1985: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1989: Expected type '%s' for '%s' of type '%s'    PyList_GET_ITEM(value, hash_cntr_0) default/librpc/gen_ndr/py_xattr.c:1812: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1816: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1640: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1644: Expected type '%s' for '%s' of type '%s'    security_descriptor_hash_v4 default/librpc/gen_ndr/py_xattr.c:2139  security_descriptor_hash_v3 default/librpc/gen_ndr/py_xattr.c:1892  security_descriptor_hash_v2 default/librpc/gen_ndr/py_xattr.c:1719  xattr_DOSATTRIB default/librpc/gen_ndr/py_xattr.c:942   xattr_NTACL default/librpc/gen_ndr/py_xattr.c:2387  xattr_DosStreams    default/librpc/gen_ndr/py_xattr.c:1563  tdb_xattrs  default/librpc/gen_ndr/py_xattr.c:1302  xattr_DosEAs    default/librpc/gen_ndr/py_xattr.c:1154  xattr_DosAttrib default/librpc/gen_ndr/py_xattr.c:793   x   O:xattr_parse_DOSATTRIB default/librpc/gen_ndr/py_xattr.c:2510: Expected type '%s' for '%s' of type '%s'    py_x    default/librpc/gen_ndr/py_xattr.c:2511  s#|O:__ndr_unpack__ (is)    DATA_BLOB: default/librpc/gen_ndr/py_xattr.c:2422   DATA_BLOB: default/librpc/gen_ndr/py_xattr.c:992    default/librpc/gen_ndr/py_xattr.c:1476: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1479  ARRAY: object->streams  default/librpc/gen_ndr/py_xattr.c:1483: Expected type '%s' for '%s' of type '%s'    PyList_GET_ITEM(value, streams_cntr_1)  default/librpc/gen_ndr/py_xattr.c:1484  default/librpc/gen_ndr/py_xattr.c:1216: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1219  ARRAY: object->eas  default/librpc/gen_ndr/py_xattr.c:1223: Expected type '%s' for '%s' of type '%s'    PyList_GET_ITEM(value, eas_cntr_0)  default/librpc/gen_ndr/py_xattr.c:1224  default/librpc/gen_ndr/py_xattr.c:1067: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1070  default/librpc/gen_ndr/py_xattr.c:1074: Expected type '%s' for '%s' of type '%s'    PyList_GET_ITEM(value, eas_cntr_1)  default/librpc/gen_ndr/py_xattr.c:1075  talloc_new: ../source4/librpc/ndr/py_xattr.c:66 struct ndr_print    ../source4/librpc/ndr/py_xattr.c:71 file    ../source4/librpc/ndr/py_xattr.c:77         Expected type %s or %s  default/librpc/gen_ndr/py_xattr.c:484: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:468: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:269: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:253: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:237: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:102: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:86: Expected type '%s' for '%s' of type '%s'  default/librpc/gen_ndr/py_xattr.c:48: Expected type '%s' for '%s' of type '%s'  default/librpc/gen_ndr/py_xattr.c:1958: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1785: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:843: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:2469: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2453: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2437: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2289: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1439: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1337: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1189: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1030: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:695: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:1937: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1938  default/librpc/gen_ndr/py_xattr.c:1764: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1765  default/librpc/gen_ndr/py_xattr.c:1608: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:1609  unknown union level union xattr_DosInfo default/librpc/gen_ndr/py_xattr.c:639: Expected type '%s' for '%s' of type '%s' in  default/librpc/gen_ndr/py_xattr.c:639   default/librpc/gen_ndr/py_xattr.c:640   default/librpc/gen_ndr/py_xattr.c:642   default/librpc/gen_ndr/py_xattr.c:648: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:648   default/librpc/gen_ndr/py_xattr.c:649   default/librpc/gen_ndr/py_xattr.c:651   default/librpc/gen_ndr/py_xattr.c:657: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:657   default/librpc/gen_ndr/py_xattr.c:658   default/librpc/gen_ndr/py_xattr.c:660   default/librpc/gen_ndr/py_xattr.c:666: Expected type '%s' for '%s' of type '%s' default/librpc/gen_ndr/py_xattr.c:666   default/librpc/gen_ndr/py_xattr.c:667   default/librpc/gen_ndr/py_xattr.c:669   invalid union level value   default/librpc/gen_ndr/py_xattr.c:676   union xattr_NTACL_Info  default/librpc/gen_ndr/py_xattr.c:2217: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2217  default/librpc/gen_ndr/py_xattr.c:2218  default/librpc/gen_ndr/py_xattr.c:2220  default/librpc/gen_ndr/py_xattr.c:2231: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2231  default/librpc/gen_ndr/py_xattr.c:2232  default/librpc/gen_ndr/py_xattr.c:2234  default/librpc/gen_ndr/py_xattr.c:2245: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2245  default/librpc/gen_ndr/py_xattr.c:2246  default/librpc/gen_ndr/py_xattr.c:2248  default/librpc/gen_ndr/py_xattr.c:2259: Expected type '%s' for '%s' of type '%s'    default/librpc/gen_ndr/py_xattr.c:2259  default/librpc/gen_ndr/py_xattr.c:2260  default/librpc/gen_ndr/py_xattr.c:2262  default/librpc/gen_ndr/py_xattr.c:2270  samba.dcerpc.security   talloc  samba.dcerpc.base   samba.dcerpc.misc   Object  descriptor  ClientConnection    ndr_syntax_id   xattr   xattr DCE/RPC   user.DosAttrib  XATTR_DOSATTRIB_NAME    XATTR_DOSATTRIB_ESTIMATED_SIZE  user.DosEAs XATTR_DOSEAS_NAME   user.DosStreams XATTR_DOSSTREAMS_NAME   XATTR_STREAM_FLAG_INTERNAL  user.DosStream. XATTR_DOSSTREAM_PREFIX  XATTR_MAX_STREAM_SIZE   XATTR_MAX_STREAM_SIZE_TDB   security.NTACL  XATTR_NTACL_NAME    XATTR_SD_HASH_SIZE  XATTR_SD_HASH_TYPE_NONE XATTR_SD_HASH_TYPE_SHA256   XATTR_DOSINFO_ATTRIB    XATTR_DOSINFO_EA_SIZE   XATTR_DOSINFO_SIZE  XATTR_DOSINFO_ALLOC_SIZE    XATTR_DOSINFO_CREATE_TIME   XATTR_DOSINFO_CHANGE_TIME   DosInfoFFFFCompat   DosInfo1    DosInfo2Old DosInfo3    DosAttrib   DOSATTRIB   EA  DosEAs  DosStream   DosStreams  NTACL   sys_acl_hash_wrapper    abstract_syntax data_blob   allow_remaining xattr.xattr abstract_syntax()
  S.parse_DOSATTRIB(x) -> None    acl_as_blob owner   group   mode    __ndr_pack__    S.ndr_pack(object) -> blob
NDR pack __ndr_unpack__  S.ndr_unpack(class, blob, allow_remaining=False) -> None
NDR unpack __ndr_print__   S.ndr_print(object) -> None
NDR print   version info    sd  hash_type   description time    sys_acl_hash    num_streams flags   size    alloc_size  name    num_eas attrib_hex  valid_flags attrib  ea_size create_time change_time write_time  dump    xattr(binding, lp_ctx=None, credentials=None) -> connection

binding should be a DCE/RPC binding string (for example: ncacn_ip_tcp:127.0.0.1)
lp_ctx should be a path to a smb.conf file or a param.LoadParm object
credentials should be a credentials.Credentials object.

   xattr.sys_acl_hash_wrapper  xattr.NTACL xattr.security_descriptor_hash_v4   xattr.security_descriptor_hash_v3   xattr.security_descriptor_hash_v2   xattr.DosStreams    xattr.DosStream xattr.tdb_xattrs    xattr.DosEAs    xattr.EA    xattr.DOSATTRIB xattr.DosAttrib xattr.DosInfo3  xattr.DosInfo2Old   xattr.DosInfo1  xattr.DosInfoFFFFCompat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             *  `*        L      HA  /                                         	     	     
     '
     <
     H
     \
     o
     
     
     
     
     
          "     %                           o     	       
              $    `           #                         o   o  o
   o  oF                                                   %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %  %                                                                                                                                                                                                                                                                                                 ,                             2                                                                                                                                                                                        2                                                                                                                                                                                     P1                                                 l                                                                                                                                       0                                                 \                                                                                                          8                             `0                                                 H                                                                                                          p                             00                                                 8                                                                                                                                        0                                                                                                                                                   4     t                              1                                                 |                                                                                                                                    0                                                 X                                                                                                                                    0                                                 (                                                                                                  T                                  2                                                                                                                                                        L                             p2                                                                                                                                                                                     @2                                                                                                                                                                                     1                                                 L                                                                                                  \                                  1                                                 0                                                                                                                                       1                                                 ,                                                                                                                                         |S                                                 ,                                                                      8                                                                  \S                                        @Z                         l  tP  S          x  9  o            9  Po            9  n                                P         G         h?     (                  P  9  p          X  T~                                  4N         dB         =     (                  `  [  pt          d  l9  l            8;  5          p  :   :          |  3  e            :  3                                N         C         H>     (                  `  [  pu          d  x9  dm            ;  `6                                TO         E         >     (                  `  ,\  pv            ;  7                                Q         H         ?     (                    9  <q            <  8T                                9  q            3  f            3  Pf            :  h:                                Q         DJ         (@     (                    9  r            <  HV                                0R         K         @     (                    9  (s            8=  ,X                                :  :          (  R  S                                O         TF         ?     (                    :  D:          P  9  n          X  Hx  ||                                R         L         @     (                  P  9  s          X  \x  |                                9  _            9  Dh             9  g            $3  t^            3  ]            3  $]              3  |\                                <9  0j            09  i            $9  h            `3  `b            T3  a            H3  a             <3  h`            03  _            :  9                                T9  xk            H9  j            3   e            3  Xd            x3  c             l3  c                                `9  l                              A.   aeabi $   6 	
"6913717fc1b01738fbe26d19d10082fbc8578d.debug    p	 .shstrtab .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .eh_frame .init_array .fini_array .jcr .data.rel.ro .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                         $                     o                       (                           0         	  	                   8   o                      E   o       P     
          T   	                         ]   	   B   #  #  `     
         f         %  %                    a         %  %                  l         )  )   b                 r                               x      2       %                                                                                                                                                     8                              `                        $ $                                                             $                       p          /                                  4                                O                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ELF          (       4   p   4    (                               p  p p                                        $   $         Qtd                          Rtdp  p p                    GNU I=g~S   g         @ P)`	 QU `!$Ig   l   q   t   v   y   {   |                                 ^R* 4<:.D18vT<
qX`8.)Xy|R*%Bp{FBE'~+yv9eV`# tcUvu@1xRWKE                           
     x                                                           Y                          n                                                                                               [               A                          M             ~             m                          l                                       @             |                                                                 *             4                                                                     <                                                    2               >                          ]                          $                                       4             z             L             O                          g                                                                                            P                          Q                                                                                                        y                                       @             f                          z                          {             s             /             '                                                                                                                                                                          o                                                     F             L           "                  xA      &  t      c  PS  d               I        <q  <       0Q          8          h  `    m  Ly                        	         
            1  @      xq  (    
	         	           i      `  =      -  m  P      G               V  *        4        &         '         F        p       O	             l(  8             x  {  T      ^  	               .       __gmon_start__ _fini _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable __cxa_finalize _Jv_RegisterClasses talloc_named_const ldb_dn_get_linearized talloc_strdup ldb_msg_find_attr_as_string ldb_msg_find_attr_as_uint ldb_msg_find_ldb_val ndr_pull_struct_blob _talloc_free dbghdrclass dbgtext ndr_map_error2ntstatus DEBUGLEVEL_CLASS ndr_pull_security_descriptor _talloc_array strlen _talloc_realloc_array talloc_strndup strtoll gp_get_gpo_flags gp_get_gplink_options gp_init libnet_context_init _talloc_zero lpcfg_workgroup libnet_LookupDCs talloc_asprintf ldb_wrap_connect _talloc_reference_loc gp_list_all_gpos ldb_get_default_basedn ldb_dn_new ldb_dn_add_child ldb_search ldb_strerror ldb_errstring gp_get_gpo_info gp_get_gplinks strcmp smb_panic gp_list_gpos ldap_encode_ndr_dom_sid ldb_msg_find_element ldb_dn_get_parent ldb_dn_compare_base se_access_check gp_set_gplink strcasestr ldb_msg_new ldb_msg_add_string ldb_modify gp_del_gplink ldb_msg_add_empty gp_get_inheritance gp_set_inheritance gp_create_ldap_gpo ldb_add ldb_dn_copy gp_set_ads_acl ndr_push_struct_blob ldb_msg_add_value ndr_push_security_descriptor gp_set_ldap_gpo tmpdir __xstat64 __errno_location smbcli_list strstr opendir readdir64 smbcli_mkdir closedir smbcli_open open64 smbcli_write smbcli_close smbcli_state_init lpcfg_smbcli_options lpcfg_smbcli_session_options lpcfg_smb_ports lpcfg_socket_options lpcfg_resolve_context lpcfg_gensec_settings smbcli_full_connection gp_fetch_gpt string_replace smbcli_qfileinfo _talloc_zero_array smbcli_read smbcli_getattrE smbcli_errstr gp_push_gpt gp_create_gpt gp_set_gpt_security_descriptor smb_raw_open smb_raw_setfileinfo smb_raw_close __stack_chk_fail __stack_chk_guard gp_ads_to_dir_access_mask gp_create_gpt_security_descriptor _talloc_memdup security_acl_dup security_descriptor_dacl_add dom_sid_string gp_create_gpo GUID_random GUID_string2 strupper_talloc lpcfg_dnsdomain gp_set_acl gp_push_gpo gp_parse_ini pm_process gp_get_ini_string gp_get_ini_uint strtol libpthread.so.0 libsamba-net.so.0 libdcerpc.so.0 libsamba-hostconfig.so.0 libsamba-security.so.0 libndr.so.0 libsmbclient-raw.so.0 liberrors.so.0 libsamba-util.so.0 libldbsamba.so.0 libcli-ldap.so.0 libcli-ldap-common.so.0 libldb.so.1 libtalloc.so.2 libc.so.6 ld-linux-armhf.so.3 _edata __bss_start __bss_start__ __bss_end__ __end__ _end libsamba-policy.so.0 /usr/lib/arm-linux-gnueabihf/samba SAMBA_POLICY_0.0.1 SAMBA_4.2.14_DEBIAN GLIBC_2.4 NDR_0.0.1 SAMBA_UTIL_0.0.1 SAMBA_HOSTCONFIG_0.0.1 TALLOC_2.0.2 LDB_0.9.10 SMBCLIENT_RAW_0.0.1 DCERPC_0.0.1                        	 
         	   
                 	                   	   	                                                                              @e      	           e        O	        j            b	        {            b	                 ii   v	                    b	        H            b	                 ii   v	        &         A#   	        W         T   	                   
 b	                 Q5  	 	                 "   	                    b	                 4   	        2            	                 Q   	                 ii   v	      p    t    |                                    #   *   +   5   B   d   e  @ {  D y  H   L   P   T   X l  \ m  `   d   h 	  l 
  p   t   x   |       v                                                   o       !   "   $   %   &   '   (   )   ,   -   .   /    0   1   2   3   4   6   7   8    9  $ :  ( ;  , <  0 =  4 >  8 ?  < @  @ A  D C  H D  L E  P F  T G  X H  \ I  ` J  d K  h L  l M  p N  t i  x O  | P   Q   R   S   T   U   V      W   X   k   Y   Z   [   \   ]   ^   _   `   a   b   c   e   f  @-: -H  H @ 8 0 (                        x p h ` X P H @ 8 0 (                        x p h ` X P H @ 8 0 (                        x p h ` X P H @ 8 0 (   0 0   R/`   404 0  00` S 00/ 0  S//  $   88   `,0A0/ 0  S//     @-H0H 0  0  S400  S  
(0 0 0  x    @ < 8 @-    ,0  R0  @ 0  S
3/| (   C-,"P  b` @P^  
   	   P ^  
10 0 0 Sd  qp  f    P E  
  [    P .  
   t    `    D    P /  
4 D(!  P =  P     
1 	0 0P.   @  5_ /_ )_ #_ _| |0	   0w  P
`   `     4  a  `  `  `  `  `  `    _  |`  _  _  _   _  ]  _  O-,M1  0  pPZ  
 ` ` S1@00100$00p100   @  TH  * P; R0 0	  0s pP8  
	    P /  
 h	  !   R!  
   ] P  
0@] S  b PP  
   	`@       P _,0   p,$ __  |_  _  _  T^  H^  0O-0M  p P#  
@P 0`@P 0  P  U  
0 
0   1 P0	  
QP`  U  _x^    ^  4^  0O-0M  pV P$  
@P 0@`P@ 0  P  U  
0 
0   1 P0	  
QP`  U  _]   l]  X]  O-M ` @7!   p B100 @PD  
00	      PP<  0  h P1  
l P 0 	 ( 0 0P  
<!  00$!       0 ` s           R  _0 0 0 0  S0   00    P
h   Y\  0P    P
<   J\  | \  \  \  \    0X  X[  h[  W  t[  |[  l#O- M  @mPc` PPU  
  <#   p }  3 P7  
 0 0	 S   3  0u  P=  
b2`  0 @@0 0      `P$  
 0 0
 S|  p 00 0 0  S]  D $, _ _0   1 0& P
0 0a0    R  A  0   R=  0
  \` pP
 0 0  S  p  \1\!  00  D  P
<  010!0
 0  6  Pp
    i0 00 '  P
   |    0 0
 0
 
 Px
  `  #     `m[  d [     Z  4Y  X  xX  lX  8X  xX   \  \  Z  [  [  [  [  0U  L[  \[  T  Y  Y  T  $Y  4Y  Z  lT  Y  Y  O-"M   `pxRP @PK  
  `2 0   P;  
@"@ < 88828" p  0 0 H p
0    / P  0   R   
10 0 0  S>   >10 0 0 S   1| *_0    `P*  H 0  0,1,!0 (0 s P

  P       0 0
(0 _  P
   00 0 0  S    0 0
 (0
 D  P
l   Z  p PV  |U   U  T  T  T  T  Y    $Z  % Y   Y  Z  Q  X  <W  Q  X  X   Y  4Q  X  \W  O-,M@ "   p
 `Pd  
  " @  0    @@   P1   0   R ?  
`RIP0@  T0  
    X)  
   P  Qe  
0   P-  
 $  @PD   x $0  0,10 0 0  S   h,0 0 S0t  P` U_L O_,414!0 80   P
  @       00 0 0  S   0   080    P
   t00 0 0  S     H0 080 u  P
h hh0k/0  X  h X  X  XY    W  r  lX  0X  N  W  T  HN  W  W  ,W  M  V  V  V  V  O-tM7 ' p0` \0`p @ PP9  
O P5  
 L
 L|'  \   0
  P  L0   R!  
470 0 0  S@   t 70 0 0  S  tP _t& $     	 RK 0  b  XX 
6  $t0P@	p P@H0( 00	u  P   0 0	 S  @p X@P@6 0  0P   
 0 0L p 0% 0 % 0 < %  D 5%0`` H04 @0P8      P 00d $0  0 0	 S  40   0 8  0 P L0%0   P   '  P  P  0  SP  
T(X,   	0  SB  
  Z P   
P  *  PC  T0`$ 0  P  0  ST00  
   
P  (0 0  0 `P7
P0 Q	0$  P  
 00T ,pP   
  0/  P   QL0  0    P    s$0	   P    R
  <  ( d#  H0#	 	    P
P00  Q2"0 H0   P

 ^ `      ;2"0
H0   P
l	  -\ k_
 < @0  P*
  ] D $$0 P 0 0  S8   Q	 1!0H0

  L0  P
0 0  =   L0P 3_wPx ,0   `n$0P 0 0 S  D b010!0 H0 w  P
  1!0 H0 i P
  `  z     @W  DW   $W    tW  V  @Y  U  8W  K  W  (W  DN   V  V  J  V  R  m  L  8W     V  <U  (H  T  T  G  $R  $M  G  R  (R  R  \S  F  Q  Q  S  S  HR   F  DR  O  E  Q  K  O-||#,M p 	 $ PTc` @Pg  
  <#  p       0  P
  0   R  
 ,20 0 0  SH   ,0"   t t 0P0c  
 0  0  S] S  
  \] \P 0	    P  
  P.  
  p	  pP-  
10 0 0  SP   T N_,1!0	 X0	   P

  `      | 2_0      PP  
10 0 0  S+  0  0    P _p 	 j0   0X0  b  P
     0 0 X0 Q  P
  p   DM  @R  p L  4R  %   Q  `g  Q  K  R  $Q  B  P  H  Q  Q  dP  `P  \Q  A  hP  lP  hA  P  P  O-$$M @ @ `sp PPk  
	  #  	0    @  P
  0   R  
 x$p30 0 0  S^  \ $0@#   v0
  @  P0  
 p  P  
 0   R] R  
  \] \ 0  @P [  
 Pc  
    Y   	0v @P<  
p20 0 0  So  p R\ L_$D  @P   
20 0 0  Sg   92"0 h0   P
  @      0      @P  
h10 0 0  S   op_j`  dL _^8  X$1$!  0h0  R  P
     0 0	 h0	 A  P
     ~0   0h0  0  P
     LI  \P  x| H  PP  %   O  lc  P   P  G  4P  4O  XG  P  l>  HN  C  O  N  O  tN  N  h=  O  L  (=  N  N  <  DN  K  G-dqd! M @p p@ P<	 `P_  

     0   @c P  
00 0 0  S   v 0   R  
 k  0
      ^
  p0p 0 x0   P

 ' @    4   I  (N  w D    M  M  % M  :  @M  H@  A-p `QP @P  
  @h      P   
H pP  
810 0 0  S$  $ _0      `P  
00 0 0  S     0   00  P  P
  t   h0h 0 0 ?  P
  <   \v ,M  G    (M  L  M  M  `9  `L  $H   9  dL  LH  &O- Mp  `VP @P%  
] P  
  )x    /  P   
    3  P  <60 0 0  S  (  __ 		  Pu  
	    Pu  
%	 	   P% 	   P|%	    Pd    PL    P4    P    P
    P    P$    P$   P    P6  
D40 0 0  S  x d4d$  00  u  Pq
D  m8 _l$ _f4$0	 0	 [  P
  o      P L  

#        k  P7
		  [  P-p3 0 	 0R  P$PP#  J  P8380  0@0  P  8  P
   #  P"  
P2 0 0 0  S
   _2 "00   P
   x  D ) P A  

mP"          P
  	  P	     P!    P	 	   P	   P   P!  
00 0 0  S
   Al<_\1\!0	 0	   P
   0  
 $  l  P    
  _|dL  |t xL    N  K  L  J  |A  L  K  $>  h9  |8  K  8  P8  <8  (K  <K  (K  b  0K  5  L  L  J   J  5  hJ  lJ  J  >  I  xI  `I  tI  J  4I  5  I  HI  3  TI  H  tI  G  G   I  G  \4  H  PH  x2  `H  TG  H  HH  G-p!M   QP @P,  
1  0h P   j pP  
	   t 
0    P  
T10 0 0  S*  @ q _0      `P  
00 0 0  S     0 0
 0
   P
	 Q x   2l0l 0	 0	   P
 @ @   !H  l   x2    ,H  pG   H  H  /  G  G  `/  TG  >  "O- P  Crp @ `P"  
   U            P  
x20 0 0  S8  d &  T  
H _00
    P  
 20 0 0  S>   0   P  
10 0 0  S@   1!  00  L  P
  l  0    PP  
10 0 0  S-  , 1!0 0 (  P

     z  0 0
 0
   P
     c0 0 0    P
 q h   R\G  j A  0    hG  F  HG  xG  /  G  P-  F  $F  hG  ,  F  F  4G  h,  8F  @F  $,  xF  P;   0  S	  
    0  S  
\ S  R  /0@-lM @+PP    @P  
    P   l03  P   l0|00 0 0  S  h E  T T0    0  P
8    $   F   g     F  0F  E  ,F  @- 0 `@     hM pP_  
P0  0  @28 P 0 u  0C`0F  P   E  p@-M@ 0. S	  
 P `  P  
p0  S
. S0  Sp0  a @P
 0 0    }  P 
01@00s0  S  
 0 0 R00 p@ 1000E  hE  TE  O-BM$M `   ,03#00403 0 0 (0|#|3 0 $0 p o  P8  
0. SF  
@0  
 0PP0  
0 $   0P0  
8  0  P  PX03  
2( 0 0 0 Sa  0< ,0 SS   a ] 6  P @  t Rh N  B$0  S
. S0  S
"(0@     R;  0A <  0 P\     PC   @   @< P*	 m  0 P	 0< ,0  0YL!   40g  P
0   !  00Z  P
   A_A0_A0 0 0  S0   00  >  P
   A| 0 0  S|0|   00  *  P
\   ~Ah<C  ,C  d hD  DD    D  D  D  D  $B  (B  <B  DB  $@  `B  pB  ?  A  A  O-lM @8`4P   0  ,  p & D  @ `, P0 P   PlB  O-(M   phXP @P<  
  Y7 
  P0  
 0    P ,  
t(  `P  
0 <0P  0  P"  8   P   Q*  80 0 0  S  8 1_+_   P70 0 0  S#  0'<0  p<0 0P0S  
0  SP  
L7$@00@7(08047@0@00,P0Q0 ; pP 
\/ E  0j P  
0 p  W
  
  P  0@ T:$@(  0 0 S 0P 0U 

   0 p P  ,6,P$@(P 0    R   0  Sg $       _ i/8 p4 ?  
JL ppppp	 0
  P  

 +80 P  
 pD@4  p  Tl    ;  p 
 K @P 	 L0D@ W  
4,P$@(P 0 0  S 4 
 d 04,P$@(P 0    R4$0 <0   P	  0,P@4$@(0 0 0  Sf  d @40 0 0  S  < 5   `P
30 0 0  S    % 3#00   P
  l3,P$@(P 0 0  S   
3#0 <0 d  P
t    0:`3`#  00  T  P
@  4 $@(, $@(%3#  0,0  8  P
      ,P42$@(0 0 ppp	 0
  P$1,P$@(P 0 0  S_X2X"0 <0 
  PU
<  ,  \N 2 "0	 0	   Pj
   Nf1!  00    PL
  @H
 i4  @z $@(s1!  0<0    PY
l  "U`1`!  0<0    P
@ 0L   (1(!  0,0    P
      0A  P_ ?  <B  `F    PC  TA  dA    A  B  \2  PD  \E  D  D  ?  A  B   :   A  D@  >  <  (9  >  >  @  8  ?  ?  |8  <  <  >  L>  8  p>  8  X7  >  >  7  p:  :  6  ;  ;  @=  `6   >  >  (6  <>  D>  5  >  >   8  A- @p(a  WM`*  
 {10 0 0 S P  0< I   05 @  0 0 H0  :  P
     !  PP
T00 0 0  S   H0H 0 H0   P
(   r|U   $>  4  =  =  3  =  7  G-pl#`   XSP @PQ  
1  PN  
@0  `PG  
(r  P7     P<  
g  P:     P1  
\  P;     P&  
Ai/ P;   	  	 	 Zj  
|20 0 0  S  h [L20 0 0  S+  < O_20 0 0  S,   A10 0 0  S/   510 0 0  S>   )1!  0T0    P
|  l1l!  0T0  s  P
L	  <1<!  0T0  d  P
	    / PP !   0   0T0  I  P
 
  0   0T0  :  Pu
   q P=  T `4    =  =  D>  >    >  |<  <  =  d=  41  l;  |;  0  ;  ;  0  ;  <  P=  P0  <  <  0  \<  p<  <  O-M2p  W ` 0P2n  
"    P_<  
O$   0" P 0tq $!(1QP,Q0Q4Q0 
8<  pP#   ?$(#< !|x W PP!  ?%R#< P v @P"  
 [ " 0 Rf  10 0 0 S4  
 J t10 0 0  S6  d
 > D10 0 0  S8  8
 2  @P
10 0 0  S 1 !0 d0   P
   0 0 d0 t P
   0 0 d0 f  P
   |0| 0 d0 X  P
\   0P   H<    <    ;  ;  <  8-  4:  0   -  X:  l:  ,  :  :  ,  :  :  0    S 6   E    @ /O-M` " 200 @Pu  
2D 0l  P  c  
2D 0c  P g  
0 0 0 0  P  V  
@"   P p  
0   Rb  
"   " P  "	  !p     
 t  04 P L  
q   P  X
  S P -  j0ptP  R0   0Y0	0   O  P QM_ G_ @_0 0 0 0  S   0   @ +_ %_x x0    0 ~   P
T      L :  :  ;  d;  ;  ;   <  ;  <9  9  X9    9  P9  9  8  9  O-p $4M   ` PP`  
#    P T  
@ Q     P O  
 @PX  
0 	 @  0
 SP  
 %  "T  @ 0	 B0    R2  
  @P@    PG  0  02 @PL  0   @PQ    s @PW   0  0   _4|_4h _T _4< x_(20 0 0  S5   l 10 0 0  S7   `	 10 0 0  S9   T 10 0 0  S;   H h10 0 0  S=  d < P1P!0
 $0
   P
0  $1$!0 $0   P
  0   0$0  y  P
   0   0$0  k  P
   0   0$0  ]  P
   9  dI ,  9  <  |8  8  9  8  8    9  T9  9  :  l:  l4  7  7  44  8  $8  3  T8  h8  3  8  8  3   9  9  C-@H"M`   P0 pP_  
   @P     `P  0   P$      @P*    10 0 0  S)    t10 0 0  S+  d  D10 0 0  S-  8 	 10 0 0  S/   y 0   040    P
   '0 0 40   P
   0 0 40   P
   t0t 0	 40	   P
T   9  D :    8  8  8  9  \1  7  7  (1  7  7  0  8  5  0   8  @6  C-!MP   ` pP#  
1 0  P   
 0 @P#    D PP)   	 @P  t   \_H10 0 0  S  4  10 0 0  S    00 0 0  S!    0 0 @0 .  P
   0   0@0     P
|   up0p 0 @0   P
P   g8  B l"  8  L9  7    8  7  7  .  7  8  .  6  6  `.  7  $7  A-M@ P t+  
0@A0p `  0 *  P    
 ``0!a  R  
  0 !   R  
  00  7  @-M @p0 P  0   P `   
0 0Q 0 !  R  
00  00  6  p@-P M `s@@  P  _  
    0 P  p00 0 0  S  p 0   0p< <0 0m  P
(   l6  @> ,  5  5  5    \(  
A-PL@uPPpP`Q  @ T  
    P0  S  
PC@uPPQ  @ T  
    P0 0   /% A-  \)  
PL@uPPpP`Q  @ T  
    P0  S  
PC@uPPQ  @ T  
   P 
 %    % @-parse_gpo   gp_init gp_list_all_gpos    gp_get_gpo_info gp_get_gplinks  gp_list_gpos    gp_set_gplink   gp_del_gplink   gp_get_inheritance  gp_set_inheritance  gp_create_ldap_gpo  gp_set_ads_acl  gp_set_ldap_gpo struct gp_object    ../source4/lib/policy/gp_ldap.c:65  ../source4/lib/policy/gp_ldap.c:69  Parsing GPO LDAP data for %s
   ../source4/lib/policy/gp_ldap.c:73  name    ../source4/lib/policy/gp_ldap.c:79  flags   versionNumber   gPCFileSysPath  ../source4/lib/policy/gp_ldap.c:88  nTSecurityDescriptor    struct security_descriptor  ../source4/lib/policy/gp_ldap.c:96  displayName struct gp_link *    struct gp_link  ../source4/lib/policy/gp_ldap.c:369 ../source4/lib/policy/gp_ldap.c:377 ../source4/lib/policy/gp_ldap.c:381 GPO_FLAG_USER_DISABLE   const char *    GPLINK_OPT_DISABLE  struct libnet_LookupDCs ../source4/lib/policy/gp_ldap.c:181 Failed to lookup DCs in domain
 ldap://%s   ../source4/lib/policy/gp_ldap.c:191 Can't connect to DC's LDAP with url %s
 struct gp_context   ../source4/lib/policy/gp_ldap.c:202 ../source4/lib/policy/gp_ldap.c:205 talloc_new: ../source4/lib/policy/gp_ldap.c:221 CN=Policies,CN=System   ../source4/lib/policy/gp_ldap.c:228 Can't append subtree to DN
 ../source4/lib/policy/gp_ldap.c:229 ../source4/lib/policy/gp_ldap.c:233 Searching for policies in DN: %s
   ../source4/lib/policy/gp_ldap.c:237 (objectClass=groupPolicyContainer)  ../source4/lib/policy/gp_ldap.c:251 LDB search failed: %s
%s
   ../source4/lib/policy/gp_ldap.c:252 struct gp_object *  ../source4/lib/policy/gp_ldap.c:258 ../source4/lib/policy/gp_ldap.c:273 ../source4/lib/policy/gp_ldap.c:267 Failed to parse GPO.
   ../source4/lib/policy/gp_ldap.c:268 talloc_new: ../source4/lib/policy/gp_ldap.c:290 ../source4/lib/policy/gp_ldap.c:298 objectClass=groupPolicyContainer    ../source4/lib/policy/gp_ldap.c:318 ../source4/lib/policy/gp_ldap.c:319 ../source4/lib/policy/gp_ldap.c:325 Could not find GPC with dn %s
  ../source4/lib/policy/gp_ldap.c:326 ../source4/lib/policy/gp_ldap.c:332 ../source4/lib/policy/gp_ldap.c:333 ../source4/lib/policy/gp_ldap.c:337 talloc_new: ../source4/lib/policy/gp_ldap.c:411 (objectclass=*) ../source4/lib/policy/gp_ldap.c:418 ../source4/lib/policy/gp_ldap.c:419 gPLink  ../source4/lib/policy/gp_ldap.c:428 PANIC: assert failed at %s(%d): %s
 ../source4/lib/policy/gp_ldap.c element->num_values > 0 assert failed: element->num_values > 0  ../source4/lib/policy/gp_ldap.c:431 ../source4/lib/policy/gp_ldap.c:440 ../source4/lib/policy/gp_ldap.c:448 Failed to parse gPLink
 ../source4/lib/policy/gp_ldap.c:452 objectClass talloc_new: ../source4/lib/policy/gp_ldap.c:478 (&(objectclass=user)(objectSid=%s)) ../source4/lib/policy/gp_ldap.c:495 ../source4/lib/policy/gp_ldap.c:496 ../source4/lib/policy/gp_ldap.c:500 Could not find user with sid %s.
   ../source4/lib/policy/gp_ldap.c:501 ../source4/lib/policy/gp_ldap.c:504 Found DN for this user: %s
 computer    ../source4/lib/policy/gp_ldap.c:513 This user is a machine
 ../source4/lib/policy/gp_ldap.c:519 ../source4/lib/policy/gp_ldap.c:532 Getting gPLinks for DN: %s
 objectclass=*   ../source4/lib/policy/gp_ldap.c:544 ../source4/lib/policy/gp_ldap.c:545 ../source4/lib/policy/gp_ldap.c:552 ../source4/lib/policy/gp_ldap.c:553 ../source4/lib/policy/gp_ldap.c:574 Failed to get gpo information for %s
   ../source4/lib/policy/gp_ldap.c:575 ../source4/lib/policy/gp_ldap.c:602 ../source4/lib/policy/gp_ldap.c:607 ../source4/lib/policy/gp_ldap.c:614 gPOptions   ../source4/lib/policy/gp_ldap.c:626 talloc_new: ../source4/lib/policy/gp_ldap.c:644 ../source4/lib/policy/gp_ldap.c:651 ../source4/lib/policy/gp_ldap.c:652 ../source4/lib/policy/gp_ldap.c:657 %s;%d%s ../source4/lib/policy/gp_ldap.c:673 [LDAP://%s;%d]%s    ../source4/lib/policy/gp_ldap.c:681 ../source4/lib/policy/gp_ldap.c:690 ../source4/lib/policy/gp_ldap.c:698 LDB message add string failed: %s
  ../source4/lib/policy/gp_ldap.c:699 ../source4/lib/policy/gp_ldap.c:706 LDB modify failed: %s
  ../source4/lib/policy/gp_ldap.c:707 ../source4/lib/policy/gp_ldap.c:711 talloc_new: ../source4/lib/policy/gp_ldap.c:727 ../source4/lib/policy/gp_ldap.c:734 ../source4/lib/policy/gp_ldap.c:735 ../source4/lib/policy/gp_ldap.c:740 [LDAP://%s] ../source4/lib/policy/gp_ldap.c:749 ../source4/lib/policy/gp_ldap.c:755 %s%s    ../source4/lib/policy/gp_ldap.c:767 ../source4/lib/policy/gp_ldap.c:774 ../source4/lib/policy/gp_ldap.c:783 LDB message add empty element failed: %s
   ../source4/lib/policy/gp_ldap.c:784 ../source4/lib/policy/gp_ldap.c:790 ../source4/lib/policy/gp_ldap.c:791 ../source4/lib/policy/gp_ldap.c:798 ../source4/lib/policy/gp_ldap.c:799 ../source4/lib/policy/gp_ldap.c:803 talloc_new: ../source4/lib/policy/gp_ldap.c:816 ../source4/lib/policy/gp_ldap.c:823 ../source4/lib/policy/gp_ldap.c:824 ../source4/lib/policy/gp_ldap.c:829 ../source4/lib/policy/gp_ldap.c:835 %d  ../source4/lib/policy/gp_ldap.c:852 ../source4/lib/policy/gp_ldap.c:858 ../source4/lib/policy/gp_ldap.c:859 ../source4/lib/policy/gp_ldap.c:866 ../source4/lib/policy/gp_ldap.c:867 ../source4/lib/policy/gp_ldap.c:871 talloc_new: ../source4/lib/policy/gp_ldap.c:883 ../source4/lib/policy/gp_ldap.c:889 CN=%s,CN=Policies,CN=System ../source4/lib/policy/gp_ldap.c:896 ../source4/lib/policy/gp_ldap.c:906 ../source4/lib/policy/gp_ldap.c:912 top container   CN  showInAdvancedViewOnly  TRUE    gpCFunctionalityVersion ../source4/lib/policy/gp_ldap.c:941 LDB add error: %s
  ../source4/lib/policy/gp_ldap.c:942 ../source4/lib/policy/gp_ldap.c:951 CN=User User    ../source4/lib/policy/gp_ldap.c:973 ../source4/lib/policy/gp_ldap.c:974 ../source4/lib/policy/gp_ldap.c:981 CN=Machine  Machine ../source4/lib/policy/gp_ldap.c:1003    ../source4/lib/policy/gp_ldap.c:1004    ../source4/lib/policy/gp_ldap.c:1010    ../source4/lib/policy/gp_ldap.c:1014    ../source4/lib/policy/gp_ldap.c:1018    LDB Error adding element to ldb message
    ../source4/lib/policy/gp_ldap.c:1019    talloc_new: ../source4/lib/policy/gp_ldap.c:1032    ../source4/lib/policy/gp_ldap.c:1048    ../source4/lib/policy/gp_ldap.c:1056    LDB message add element failed for adding nTSecurityDescriptor: %s
 ../source4/lib/policy/gp_ldap.c:1057    ../source4/lib/policy/gp_ldap.c:1064    ../source4/lib/policy/gp_ldap.c:1065    ../source4/lib/policy/gp_ldap.c:1069    talloc_new: ../source4/lib/policy/gp_ldap.c:1081    ../source4/lib/policy/gp_ldap.c:1085    ../source4/lib/policy/gp_ldap.c:1105    LDB message add string failed for flags: %s
    ../source4/lib/policy/gp_ldap.c:1106    version ../source4/lib/policy/gp_ldap.c:1113    LDB message add string failed for version: %s
  ../source4/lib/policy/gp_ldap.c:1114    ../source4/lib/policy/gp_ldap.c:1121    LDB message add string failed for displayName: %s
  ../source4/lib/policy/gp_ldap.c:1122    ../source4/lib/policy/gp_ldap.c:1129    ../source4/lib/policy/gp_ldap.c:1130    ../source4/lib/policy/gp_ldap.c:1134    GPO_FLAG_MACHINE_DISABLE    GPLINK_OPT_ENFORCE  gp_tmpdir   push_recursive  gp_fetch_gpt    gp_get_files    gp_get_file gp_push_gpt gp_create_gpt   gp_set_gpt_security_descriptor  %s/policy   ../source4/lib/policy/gp_filesys.c:64   Failed to create directory %s: %s
  ../source4/lib/policy/gp_filesys.c:65   %s%s\*  ../source4/lib/policy/gp_filesys.c:140  ../ %s\%s   struct gp_file_entry    %s/%s   ../source4/lib/policy/gp_filesys.c:449  Pushing directory %s to %s on sysvol
   ../source4/lib/policy/gp_filesys.c:457  Pushing file %s to %s on sysvol
    ../source4/lib/policy/gp_filesys.c:464  Failed to create remote file: %s
   ../source4/lib/policy/gp_filesys.c:471  Failed to open local file: %s
  ../source4/lib/policy/gp_filesys.c:485  ../source4/lib/policy/gp_filesys.c:486  ../source4/lib/policy/gp_filesys.c:491  ../source4/lib/policy/gp_filesys.c:492  sysvol  talloc_new: ../source4/lib/policy/gp_filesys.c:338  ../source4/lib/policy/gp_filesys.c:344  Failed to create cli connection to DC
  ../source4/lib/policy/gp_filesys.c:345  ../source4/lib/policy/gp_filesys.c:353  ../source4/lib/policy/gp_filesys.c:360  struct gp_list_state    ../source4/lib/policy/gp_filesys.c:367  ../source4/lib/policy/gp_filesys.c:378  Could not create local path
    ../source4/lib/policy/gp_filesys.c:379  ../source4/lib/policy/gp_filesys.c:387  Could not list GPO files on remote server
  ../source4/lib/policy/gp_filesys.c:388  ../source4/lib/policy/gp_filesys.c:394  File list is has no entries. Is the GPT directory empty?
   ../source4/lib/policy/gp_filesys.c:395  talloc_new: ../source4/lib/policy/gp_filesys.c:276  ../source4/lib/policy/gp_filesys.c:284  ../source4/lib/policy/gp_filesys.c:292  ../source4/lib/policy/gp_filesys.c:301  ../source4/lib/policy/gp_filesys.c:302  ../source4/lib/policy/gp_filesys.c:311  ../source4/lib/policy/gp_filesys.c:210  Failed to open remote file: %s
 ../source4/lib/policy/gp_filesys.c:217  ../source4/lib/policy/gp_filesys.c:226  Failed to get remote file size: %s
 uint8_t ../source4/lib/policy/gp_filesys.c:242  Short write while copying file.
    ../source4/lib/policy/gp_filesys.c:243  ../source4/lib/policy/gp_filesys.c:253  Remote/local file size mismatch after copying file: %s (remote %zu, local %zu).
    ../source4/lib/policy/gp_filesys.c:255  ../source4/lib/policy/gp_filesys.c:263  ../source4/lib/policy/gp_filesys.c:318  Error getting file.
    ../source4/lib/policy/gp_filesys.c:319  ../source4/lib/policy/gp_filesys.c:405  ../source4/lib/policy/gp_filesys.c:510  ../source4/lib/policy/gp_filesys.c:516  Copying %s to %s on sysvol
 ../source4/lib/policy/gp_filesys.c:522  talloc_new: ../source4/lib/policy/gp_filesys.c:537  ../source4/lib/policy/gp_filesys.c:549  Could not create the policy dir: %s
    ../source4/lib/policy/gp_filesys.c:550  %s/User ../source4/lib/policy/gp_filesys.c:558  Could not create the User dir: %s
  ../source4/lib/policy/gp_filesys.c:559  %s/Machine  ../source4/lib/policy/gp_filesys.c:567  Could not create the Machine dir: %s
   ../source4/lib/policy/gp_filesys.c:568  %s/GPT.INI  ../source4/lib/policy/gp_filesys.c:578  Could not create the GPT.INI: %s
   ../source4/lib/policy/gp_filesys.c:579  [General]
Version=0
  ../source4/lib/policy/gp_filesys.c:586  Short write in GPT.INI
 ../source4/lib/policy/gp_filesys.c:587  ../source4/lib/policy/gp_filesys.c:594  ../source4/lib/policy/gp_filesys.c:598  ../source4/lib/policy/gp_filesys.c:616  talloc_new: ../source4/lib/policy/gp_filesys.c:622  ../source4/lib/policy/gp_filesys.c:641  Can't open GPT directory
   ../source4/lib/policy/gp_filesys.c:642  ../source4/lib/policy/gp_filesys.c:656  Failed to set security descriptor on the GPT
   ../source4/lib/policy/gp_filesys.c:657  ../source4/lib/policy/gp_filesys.c:667  Failed to close directory
  ../source4/lib/policy/gp_filesys.c:668  ../source4/lib/policy/gp_filesys.c:672  gp_create_gpt_security_descriptor   gp_create_gpo   gp_set_acl  gp_push_gpo ../source4/lib/policy/gp_manage.c:69    ../source4/lib/policy/gp_manage.c:71    ../source4/lib/policy/gp_manage.c:75    ../source4/lib/policy/gp_manage.c:77    ../source4/lib/policy/gp_manage.c:87    struct security_acl ../source4/lib/policy/gp_manage.c:94    S-1-5-32-554    ../source4/lib/policy/gp_manage.c:105   ../source4/lib/policy/gp_manage.c:110   ../source4/lib/policy/gp_manage.c:112   S-1-3-0 ../source4/lib/policy/gp_manage.c:128   Failed to add a dacl to file system security descriptor
    ../source4/lib/policy/gp_manage.c:133   talloc_new: ../source4/lib/policy/gp_manage.c:152   ../source4/lib/policy/gp_manage.c:158   ../source4/lib/policy/gp_manage.c:166   ../source4/lib/policy/gp_manage.c:171   ../source4/lib/policy/gp_manage.c:182   \\%s\sysvol\%s\Policies\%s  ../source4/lib/policy/gp_manage.c:188   ../source4/lib/policy/gp_manage.c:195   Failed to create GPT
   ../source4/lib/policy/gp_manage.c:196   ../source4/lib/policy/gp_manage.c:204   Failed to create LDAP group policy object
  ../source4/lib/policy/gp_manage.c:205   ../source4/lib/policy/gp_manage.c:212   Failed to fetch LDAP group policy object
   ../source4/lib/policy/gp_manage.c:213   ../source4/lib/policy/gp_manage.c:220   Failed to convert ADS security descriptor to filesystem security descriptor
    ../source4/lib/policy/gp_manage.c:221   ../source4/lib/policy/gp_manage.c:228   Failed to set security descriptor (ACL) on the file system
 ../source4/lib/policy/gp_manage.c:229   ../source4/lib/policy/gp_manage.c:233   talloc_new: ../source4/lib/policy/gp_manage.c:247   ../source4/lib/policy/gp_manage.c:253   Failed to set ACL on ADS
   ../source4/lib/policy/gp_manage.c:254   ../source4/lib/policy/gp_manage.c:261   ../source4/lib/policy/gp_manage.c:262   ../source4/lib/policy/gp_manage.c:269   ../source4/lib/policy/gp_manage.c:270   ../source4/lib/policy/gp_manage.c:277   ../source4/lib/policy/gp_manage.c:278   ../source4/lib/policy/gp_manage.c:282   talloc_new: ../source4/lib/policy/gp_manage.c:293   GPT.INI ../source4/lib/policy/gp_manage.c:300   ../source4/lib/policy/gp_manage.c:305   Failed to parse GPT.INI.
   ../source4/lib/policy/gp_manage.c:306   ../source4/lib/policy/gp_manage.c:313   Failed to push GPT to DC's sysvol share.
   ../source4/lib/policy/gp_manage.c:314   ../source4/lib/policy/gp_manage.c:321   Failed to set GPO options in DC's LDAP.
    ../source4/lib/policy/gp_manage.c:322   ../source4/lib/policy/gp_manage.c:326   gp_parse_ini    struct gp_ini_param struct gp_ini_section   struct gp_ini_context   ../source4/lib/policy/gp_ini.c:79   Error while processing ini file %s
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 !  !                         H     8                                         &     2     H     W     j     {                              	     ,	          8     p          t       o     
       
   	           4    8                              o  o          o   o  o   o  o	                                                                                                                                                                                                                                                                                                                A.   aeabi $   6 	
"02493d0812f8ad0f67c108057e10c4daa453c7.debug    E .shstrtab .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_d .gnu.version_r .rel.dyn .rel.plt .init .text .fini .rodata .eh_frame .init_array .fini_array .jcr .data.rel.ro .dynamic .got .data .bss .ARM.attributes .gnu_debuglink                                                          $                     o                      (                           0         
  
  	                 8   o                      E   o       8                T   o                       c   	                          l   	   B       8              u                               p                             {               ta                          8  8                             @  @  p4                                                         p p                             t t                             x x                             | |  0                                                      4 4                                                                                     p          /                                ?  4                                s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
k[c           @   s  d  Z  d d l Z d d l Z d d l Z d d d d d d d	 d
 d d d d d d d d d d g Z e Z d e f d     YZ d e f d     YZ	 d Z
 d Z d d d d d d d d d d d d d g Z d d? d     YZ d d@ d      YZ e d!  Z e d"  Z e d#  Z e d$  Z e d%  \ Z Z Z Z Z Z Z d&   Z d'   Z d(   Z d)   Z d* e f d+     YZ  d, e  f d-     YZ! d. e  f d/     YZ" d0 dA d1     YZ# d2 e! f d3     YZ$ d4 e" f d5     YZ% e!   Z& e& j' Z( d6   Z) e& j* Z+ e& j, Z, e& j- Z. e& j/ Z0 e& j1 Z1 e& j2 Z3 e& j4 Z5 e& j6 Z7 dC Z8 d8 Z9 e8 e9 d9  Z: e8 e9 d:  Z; d; Z< e j= e< d d  j>   Z? d<   Z@ d=   ZA eB d> k reA e jC  n  d S(D   s$  Calendar printing functions

Note when comparing these calendars to the ones printed by cal(1): By
default, these calendars have Monday as the first day of the week, and
Sunday as the last (the European convention). Use setfirstweekday() to
set the first day of the week (0=Monday, 6=Sunday).iNt   IllegalMonthErrort   IllegalWeekdayErrort   setfirstweekdayt   firstweekdayt   isleapt   leapdayst   weekdayt
   monthranget   monthcalendart   prmontht   montht   prcalt   calendart   timegmt
   month_namet
   month_abbrt   day_namet   day_abbrc           B   s   e  Z d    Z d   Z RS(   c         C   s   | |  _  d  S(   N(   R
   (   t   selfR
   (    (    s   /usr/lib/python2.7/calendar.pyt   __init__   s    c         C   s   d |  j  S(   Ns!   bad month number %r; must be 1-12(   R
   (   R   (    (    s   /usr/lib/python2.7/calendar.pyt   __str__   s    (   t   __name__t
   __module__R   R   (    (    (    s   /usr/lib/python2.7/calendar.pyR       s   	c           B   s   e  Z d    Z d   Z RS(   c         C   s   | |  _  d  S(   N(   R   (   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR      s    c         C   s   d |  j  S(   Ns7   bad weekday number %r; must be 0 (Monday) to 6 (Sunday)(   R   (   R   (    (    s   /usr/lib/python2.7/calendar.pyR      s    (   R   R   R   R   (    (    (    s   /usr/lib/python2.7/calendar.pyR      s   	i   i   i    i   i   i   t   _localized_monthc           B   sk   e  Z g  e d   D]" Z e j d e d d  j ^ q Z e j d d    d   Z	 d   Z
 d   Z RS(   i   i  i   i    c         C   s   d S(   Nt    (    (   t   x(    (    s   /usr/lib/python2.7/calendar.pyt   <lambda>2   s    c         C   s   | |  _  d  S(   N(   t   format(   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR   4   s    c         C   sM   |  j  | } t | t  r< g  | D] } | |  j  ^ q# S| |  j  Sd  S(   N(   t   _monthst
   isinstancet   sliceR   (   R   t   it   funcst   f(    (    s   /usr/lib/python2.7/calendar.pyt   __getitem__7   s     c         C   s   d S(   Ni   (    (   R   (    (    s   /usr/lib/python2.7/calendar.pyt   __len__>   s    (   R   R   t   rangeR   t   datetimet   datet   strftimeR   t   insertR   R"   R#   (    (    (    s   /usr/lib/python2.7/calendar.pyR   /   s
   5		t   _localized_dayc           B   sX   e  Z g  e d   D]" Z e j d d e d  j ^ q Z d   Z d   Z	 d   Z
 RS(   i   i  i   c         C   s   | |  _  d  S(   N(   R   (   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR   G   s    c         C   sM   |  j  | } t | t  r< g  | D] } | |  j  ^ q# S| |  j  Sd  S(   N(   t   _daysR   R   R   (   R   R   R    R!   (    (    s   /usr/lib/python2.7/calendar.pyR"   J   s     c         C   s   d S(   Ni   (    (   R   (    (    s   /usr/lib/python2.7/calendar.pyR#   Q   s    (   R   R   R$   R   R%   R&   R'   R*   R   R"   R#   (    (    (    s   /usr/lib/python2.7/calendar.pyR)   B   s   5		s   %As   %as   %Bs   %bi   c         C   s.   |  d d k o- |  d d k p- |  d d k S(   s5   Return True for leap years, False for non-leap years.i   i    id   i  (    (   t   year(    (    s   /usr/lib/python2.7/calendar.pyR   a   s    c         C   sD   |  d 8}  | d 8} | d |  d | d |  d | d |  d S(   sF   Return number of leap years in range [y1, y2).
       Assume y1 <= y2.i   i   id   i  (    (   t   y1t   y2(    (    s   /usr/lib/python2.7/calendar.pyR   f   s    

c         C   s   t  j |  | |  j   S(   sT   Return weekday (0-6 ~ Mon-Sun) for year (1970-...), month (1-12),
       day (1-31).(   R%   R&   R   (   R+   R
   t   day(    (    s   /usr/lib/python2.7/calendar.pyR   n   s    c         C   sg   d | k o d k n s+ t  |   n  t |  | d  } t | | t k oY t |   } | | f S(   sQ   Return weekday (0-6 ~ Mon-Sun) and number of days (28-31) for
       year, month.i   i   (   R    R   t   mdayst   FebruaryR   (   R+   R
   t   day1t   ndays(    (    s   /usr/lib/python2.7/calendar.pyR   t   s
     t   Calendarc           B   s   e  Z d  Z d d  Z d   Z d   Z e e e  Z d   Z d   Z	 d   Z
 d   Z d	   Z d
   Z d   Z d d  Z d d  Z d d  Z RS(   so   
    Base calendar class. This class doesn't do any formatting. It simply
    provides data to subclasses.
    i    c         C   s   | |  _  d  S(   N(   R   (   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR      s    c         C   s   |  j  d S(   Ni   (   t   _firstweekday(   R   (    (    s   /usr/lib/python2.7/calendar.pyt   getfirstweekday   s    c         C   s   | |  _  d  S(   N(   R4   (   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR      s    c         c   s1   x* t  |  j |  j d  D] } | d Vq Wd S(   ss   
        Return a iterator for one week of weekday numbers starting with the
        configured first one.
        i   N(   R$   R   (   R   R   (    (    s   /usr/lib/python2.7/calendar.pyt   iterweekdays   s     c         c   s   t  j | | d  } | j   |  j d } | t  j d |  8} t  j d d  } xZ t r | Vy | | 7} Wn t k
 r Pn X| j | k rW | j   |  j k rW PqW qW Wd S(   s   
        Return an iterator for one month. The iterator will yield datetime.date
        values and will always iterate through complete weeks, so it will yield
        dates outside the specified month.
        i   i   t   daysN(   R%   R&   R   R   t	   timedeltat   Truet   OverflowErrorR
   (   R   R+   R
   R&   R7   t   oneday(    (    s   /usr/lib/python2.7/calendar.pyt   itermonthdates   s    	$c         c   sX   xQ |  j  | |  D]= } | j | k r< d | j   f Vq | j | j   f Vq Wd S(   s   
        Like itermonthdates(), but will yield (day number, weekday number)
        tuples. For days outside the specified month the day number is 0.
        i    N(   R<   R
   R   R.   (   R   R+   R
   R&   (    (    s   /usr/lib/python2.7/calendar.pyt   itermonthdays2   s    c         c   s@   x9 |  j  | |  D]% } | j | k r0 d Vq | j Vq Wd S(   s   
        Like itermonthdates(), but will yield day numbers. For days outside
        the specified month the day number is 0.
        i    N(   R<   R
   R.   (   R   R+   R
   R&   (    (    s   /usr/lib/python2.7/calendar.pyt   itermonthdays   s    c         C   sL   t  |  j | |   } g  t d t |  d  D] } | | | d !^ q1 S(   s   
        Return a matrix (list of lists) representing a month's calendar.
        Each row represents a week; week entries are datetime.date values.
        i    i   (   t   listR<   R$   t   len(   R   R+   R
   t   datesR   (    (    s   /usr/lib/python2.7/calendar.pyt   monthdatescalendar   s    c         C   sL   t  |  j | |   } g  t d t |  d  D] } | | | d !^ q1 S(   s   
        Return a matrix representing a month's calendar.
        Each row represents a week; week entries are
        (day number, weekday number) tuples. Day numbers outside this month
        are zero.
        i    i   (   R?   R=   R$   R@   (   R   R+   R
   R7   R   (    (    s   /usr/lib/python2.7/calendar.pyt   monthdays2calendar   s    c         C   sL   t  |  j | |   } g  t d t |  d  D] } | | | d !^ q1 S(   s   
        Return a matrix representing a month's calendar.
        Each row represents a week; days outside this month are zero.
        i    i   (   R?   R>   R$   R@   (   R   R+   R
   R7   R   (    (    s   /usr/lib/python2.7/calendar.pyt   monthdayscalendar   s    i   c         C   sf   g  t  t t d  D] } |  j | |  ^ q } g  t  d t |  |  D] } | | | | !^ qK S(   s'  
        Return the data for the specified year ready for formatting. The return
        value is a list of month rows. Each month row contains up to width months.
        Each month contains between 4 and 6 weeks and each week contains 1-7
        days. Days are datetime.date objects.
        i   i    (   R$   t   JanuaryRB   R@   (   R   R+   t   widthR   t   months(    (    s   /usr/lib/python2.7/calendar.pyt   yeardatescalendar   s    /c         C   sf   g  t  t t d  D] } |  j | |  ^ q } g  t  d t |  |  D] } | | | | !^ qK S(   s   
        Return the data for the specified year ready for formatting (similar to
        yeardatescalendar()). Entries in the week lists are
        (day number, weekday number) tuples. Day numbers outside this month are
        zero.
        i   i    (   R$   RE   RC   R@   (   R   R+   RF   R   RG   (    (    s   /usr/lib/python2.7/calendar.pyt   yeardays2calendar   s    /c         C   sf   g  t  t t d  D] } |  j | |  ^ q } g  t  d t |  |  D] } | | | | !^ qK S(   s   
        Return the data for the specified year ready for formatting (similar to
        yeardatescalendar()). Entries in the week lists are day numbers.
        Day numbers outside this month are zero.
        i   i    (   R$   RE   RD   R@   (   R   R+   RF   R   RG   (    (    s   /usr/lib/python2.7/calendar.pyt   yeardayscalendar   s    /(   R   R   t   __doc__R   R5   R   t   propertyR   R6   R<   R=   R>   RB   RC   RD   RH   RI   RJ   (    (    (    s   /usr/lib/python2.7/calendar.pyR3   ~   s   								
	t   TextCalendarc           B   s   e  Z d  Z d   Z d   Z d   Z d   Z d   Z e d  Z	 d d d  Z
 d d d	  Z d
 d d d d  Z d d d d d  Z RS(   sr   
    Subclass of Calendar that outputs a calendar as a simple plain text
    similar to the UNIX program cal.
    c         C   s   |  j  | |  Gd S(   s3   
        Print a single week (no newline).
        N(   t
   formatweek(   R   t   theweekRF   (    (    s   /usr/lib/python2.7/calendar.pyt   prweek	  s    c         C   s,   | d k r d } n
 d | } | j  |  S(   s*   
        Returns a formatted day.
        i    R   s   %2i(   t   center(   R   R.   R   RF   t   s(    (    s   /usr/lib/python2.7/calendar.pyt	   formatday  s    	
c            s    d j     f d   | D  S(   sA   
        Returns a single week in a string (no newline).
        t    c         3   s*   |  ]  \ } }   j  | |   Vq d  S(   N(   RS   (   t   .0t   dt   wd(   R   RF   (    s   /usr/lib/python2.7/calendar.pys	   <genexpr>  s    (   t   join(   R   RO   RF   (    (   R   RF   s   /usr/lib/python2.7/calendar.pyRN     s    c         C   s0   | d k r t  } n t } | | |  j |  S(   s4   
        Returns a formatted week day name.
        i	   (   R   R   RQ   (   R   R.   RF   t   names(    (    s   /usr/lib/python2.7/calendar.pyt   formatweekday  s    	c            s&   d j     f d     j   D  S(   s-   
        Return a header for a week.
        RT   c         3   s!   |  ] }   j  |   Vq d  S(   N(   RZ   (   RU   R   (   R   RF   (    s   /usr/lib/python2.7/calendar.pys	   <genexpr>-  s    (   RX   R6   (   R   RF   (    (   R   RF   s   /usr/lib/python2.7/calendar.pyt   formatweekheader)  s    c         C   s0   t  | } | r# d | | f } n  | j |  S(   s0   
        Return a formatted month name.
        s   %s %r(   R   RQ   (   R   t   theyeart   themonthRF   t   withyearRR   (    (    s   /usr/lib/python2.7/calendar.pyt   formatmonthname/  s    
i    c         C   s   |  j  | | | |  Gd S(   s+   
        Print a month's calendar.
        N(   t   formatmonth(   R   R\   R]   t   wt   l(    (    s   /usr/lib/python2.7/calendar.pyR	   8  s    c         C   s   t  d |  } t  d |  } |  j | | d | d d  } | j   } | d | 7} | |  j |  j   7} | d | 7} xD |  j | |  D]0 } | |  j | |  j   7} | d | 7} q W| S(   s@   
        Return a month's calendar string (multi-line).
        i   i   i   s   
(   t   maxR_   t   rstripR[   RC   RN   (   R   R\   R]   Ra   Rb   RR   t   week(    (    s   /usr/lib/python2.7/calendar.pyR`   >  s    !i   i   i   i   c            s=  t  d |  } t  d |  } t  d |  } | d d d   g  } | j } | t   j   | | | d  j    | d |   j |   xt  j  |   D]y\ } }	 t | | d t	 | | d d d   }
 | d |      f d   |
 D } | t
 |   |  j    | d |   f d   |
 D } | t
 |   |  j    | d |  t  d   |	 D  } x t |  D] } g  } xM |	 D]E } | t |  k r| j d	  q| j  j | | |   qW| t
 |   |  j    | d |  qWq Wd	 j |  S(
   sC   
        Returns a year's calendar as a multi-line string.
        i   i   i   s   
i   c         3   s'   |  ] }  j   |   t  Vq d  S(   N(   R_   t   False(   RU   t   k(   t   colwidthR   R\   (    s   /usr/lib/python2.7/calendar.pys	   <genexpr>_  s   c         3   s   |  ] }   Vq d  S(   N(    (   RU   Rg   (   t   header(    s   /usr/lib/python2.7/calendar.pys	   <genexpr>c  s    c         s   s   |  ] } t  |  Vq d  S(   N(   R@   (   RU   t   cal(    (    s   /usr/lib/python2.7/calendar.pys	   <genexpr>g  s    R   (   Rc   t   appendt   reprRQ   Rd   R[   t	   enumerateRI   R$   t   mint   formatstringR@   RN   RX   (   R   R\   Ra   Rb   t   ct   mt   vt   aR   t   rowRG   RY   t   headerst   heightt   jt   weeksRj   (    (   Rh   Ri   R   R\   s   /usr/lib/python2.7/calendar.pyt
   formatyearN  s:    	/%,
!c         C   s   |  j  | | | | |  GHd S(   s   Print a year's calendar.N(   Ry   (   R   R\   Ra   Rb   Rp   Rq   (    (    s   /usr/lib/python2.7/calendar.pyt   pryears  s    (   R   R   RK   RP   RS   RN   RZ   R[   R9   R_   R	   R`   Ry   Rz   (    (    (    s   /usr/lib/python2.7/calendar.pyRM     s   		
		
		%t   HTMLCalendarc           B   s   e  Z d  Z d d d d d d d g Z d   Z d	   Z d
   Z d   Z e d  Z	 e d  Z
 d d  Z d d d d  Z RS(   s4   
    This calendar returns complete HTML pages.
    t   mont   tuet   wedt   thut   frit   satt   sunc         C   s)   | d k r d Sd |  j  | | f Sd S(   s/   
        Return a day as a table cell.
        i    s   <td class="noday">&nbsp;</td>s   <td class="%s">%d</td>N(   t
   cssclasses(   R   R.   R   (    (    s   /usr/lib/python2.7/calendar.pyRS     s    c            s'   d j    f d   | D  } d | S(   s8   
        Return a complete week as a table row.
        R   c         3   s'   |  ] \ } }   j  | |  Vq d  S(   N(   RS   (   RU   RV   RW   (   R   (    s   /usr/lib/python2.7/calendar.pys	   <genexpr>  s    s   <tr>%s</tr>(   RX   (   R   RO   RR   (    (   R   s   /usr/lib/python2.7/calendar.pyRN     s    c         C   s   d |  j  | t | f S(   s:   
        Return a weekday name as a table header.
        s   <th class="%s">%s</th>(   R   R   (   R   R.   (    (    s   /usr/lib/python2.7/calendar.pyRZ     s    c            s-   d j    f d     j   D  } d | S(   s<   
        Return a header for a week as a table row.
        R   c         3   s   |  ] }   j  |  Vq d  S(   N(   RZ   (   RU   R   (   R   (    s   /usr/lib/python2.7/calendar.pys	   <genexpr>  s    s   <tr>%s</tr>(   RX   R6   (   R   RR   (    (   R   s   /usr/lib/python2.7/calendar.pyR[     s    %c         C   s3   | r d t  | | f } n d t  | } d | S(   s5   
        Return a month name as a table row.
        s   %s %ss   %ss.   <tr><th colspan="7" class="month">%s</th></tr>(   R   (   R   R\   R]   R^   RR   (    (    s   /usr/lib/python2.7/calendar.pyR_     s    c         C   s   g  } | j  } | d  | d  | |  j | | d |  | d  | |  j    | d  x7 |  j | |  D]# } | |  j |   | d  qv W| d  | d  d j |  S(   s6   
        Return a formatted month as a table.
        s@   <table border="0" cellpadding="0" cellspacing="0" class="month">s   
R^   s   </table>R   (   Rk   R_   R[   RC   RN   RX   (   R   R\   R]   R^   Rr   Rs   Re   (    (    s   /usr/lib/python2.7/calendar.pyR`     s    	





i   c         C   s   g  } | j  } t | d  } | d  | d  | d | | f  x t t t d |  D]w } t | t | | d   } | d  x> | D]6 } | d  | |  j | | d	 t  | d
  q W| d  q] W| d  d j |  S(   s?   
        Return a formatted year as a table of tables.
        i   s?   <table border="0" cellpadding="0" cellspacing="0" class="year">s   
s.   <tr><th colspan="%d" class="year">%s</th></tr>i   i   s   <tr>s   <td>R^   s   </td>s   </tr>s   </table>R   (   Rk   Rc   R$   RE   Rn   R`   Rf   RX   (   R   R\   RF   Rr   Rs   R   RG   Rq   (    (    s   /usr/lib/python2.7/calendar.pyRy     s     	




s   calendar.cssc         C   s   | d k r t j   } n  g  } | j } | d |  | d  | d  | d  | d |  | d k	 r | d |  n  | d |  | d  | d	  | |  j | |   | d
  | d  d j |  j | d  S(   sB   
        Return a formatted year as a complete HTML page.
        s$   <?xml version="1.0" encoding="%s"?>
sn   <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
s   <html>
s   <head>
sC   <meta http-equiv="Content-Type" content="text/html; charset=%s" />
s4   <link rel="stylesheet" type="text/css" href="%s" />
s   <title>Calendar for %d</title>
s   </head>
s   <body>
s   </body>
s   </html>
R   t   xmlcharrefreplaceN(   t   Nonet   syst   getdefaultencodingRk   Ry   RX   t   encode(   R   R\   RF   t   csst   encodingRr   Rs   (    (    s   /usr/lib/python2.7/calendar.pyt   formatyearpage  s$    	






N(   R   R   RK   R   RS   RN   RZ   R[   R9   R_   R`   Ry   R   R   (    (    (    s   /usr/lib/python2.7/calendar.pyR{   x  s   					
t   TimeEncodingc           B   s#   e  Z d    Z d   Z d   Z RS(   c         C   s   | |  _  d  S(   N(   t   locale(   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR     s    c         C   s?   t  j t  j  |  _ t  j t  j |  j  t  j t  j  d S(   Ni   (   t   _localet	   getlocalet   LC_TIMEt	   oldlocalet	   setlocaleR   (   R   (    (    s   /usr/lib/python2.7/calendar.pyt	   __enter__  s    c         G   s   t  j t  j |  j  d  S(   N(   R   R   R   R   (   R   t   args(    (    s   /usr/lib/python2.7/calendar.pyt   __exit__  s    (   R   R   R   R   R   (    (    (    s   /usr/lib/python2.7/calendar.pyR     s   		t   LocaleTextCalendarc           B   s2   e  Z d  Z d d d  Z d   Z e d  Z RS(   s   
    This class can be passed a locale name in the constructor and will return
    month and weekday names in the specified locale. If this locale includes
    an encoding all strings containing month and weekday names will be returned
    as unicode.
    i    c         C   s8   t  j |  |  | d  k r+ t j   } n  | |  _ d  S(   N(   RM   R   R   R   t   getdefaultlocaleR   (   R   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR     s    c         C   sp   t  |  j  [ } | d k r' t } n t } | | } | d  k	 rU | j |  } n  | |  j |  SWd  QXd  S(   Ni	   (   R   R   R   R   R   t   decodeRQ   (   R   R.   RF   R   RY   t   name(    (    s   /usr/lib/python2.7/calendar.pyRZ     s    	
c         C   sj   t  |  j  U } t | } | d  k	 r: | j |  } n  | rS d | | f } n  | j |  SWd  QXd  S(   Ns   %s %r(   R   R   R   R   R   RQ   (   R   R\   R]   RF   R^   R   RR   (    (    s   /usr/lib/python2.7/calendar.pyR_     s    
N(   R   R   RK   R   R   RZ   R9   R_   (    (    (    s   /usr/lib/python2.7/calendar.pyR     s   	t   LocaleHTMLCalendarc           B   s2   e  Z d  Z d d d  Z d   Z e d  Z RS(   s   
    This class can be passed a locale name in the constructor and will return
    month and weekday names in the specified locale. If this locale includes
    an encoding all strings containing month and weekday names will be returned
    as unicode.
    i    c         C   s8   t  j |  |  | d  k r+ t j   } n  | |  _ d  S(   N(   R{   R   R   R   R   R   (   R   R   R   (    (    s   /usr/lib/python2.7/calendar.pyR     s    c         C   sY   t  |  j  D } t | } | d  k	 r: | j |  } n  d |  j | | f SWd  QXd  S(   Ns   <th class="%s">%s</th>(   R   R   R   R   R   R   (   R   R.   R   RR   (    (    s   /usr/lib/python2.7/calendar.pyRZ   %  s
    
c         C   se   t  |  j  P } t | } | d  k	 r: | j |  } n  | rS d | | f } n  d | SWd  QXd  S(   Ns   %s %ss.   <tr><th colspan="7" class="month">%s</th></tr>(   R   R   R   R   R   (   R   R\   R]   R^   R   RR   (    (    s   /usr/lib/python2.7/calendar.pyR_   ,  s    
N(   R   R   RK   R   R   RZ   R9   R_   (    (    (    s   /usr/lib/python2.7/calendar.pyR     s   	c         C   sc   y |  j  Wn t k
 r* t |    n Xt |  k oB t k n sV t |    n  |  t _ d  S(   N(   t	   __index__t   AttributeErrorR   t   MONDAYt   SUNDAYRp   R   (   R   (    (    s   /usr/lib/python2.7/calendar.pyR   ;  s    i   i   c         C   s   t  |  | |  GHd S(   s1   Prints multi-column formatting for year calendarsN(   Ro   (   t   colsRh   t   spacing(    (    s   /usr/lib/python2.7/calendar.pyR   S  s    c            s'   | d 9} | j    f d   |  D  S(   sE   Returns a string formatted from n strings, centered within n columns.RT   c         3   s   |  ] } | j     Vq d  S(   N(   RQ   (   RU   Rp   (   Rh   (    s   /usr/lib/python2.7/calendar.pys	   <genexpr>[  s    (   RX   (   R   Rh   R   (    (   Rh   s   /usr/lib/python2.7/calendar.pyRo   X  s    
i  c         C   sq   |  d  \ } } } } } } t  j | | d  j   t | d } | d | } | d | }	 |	 d | }
 |
 S(   sB   Unrelated but handy function to calculate Unix timestamp from GMT.i   i   i   i<   (   R%   R&   t	   toordinalt
   _EPOCH_ORD(   t   tupleR+   R
   R.   t   hourt   minutet   secondR7   t   hourst   minutest   seconds(    (    s   /usr/lib/python2.7/calendar.pyR   b  s    'c   	      C   s  d d  l  } | j d d  } | j d d d d d d	 d
 d d d | j d d d d d d	 d
 d d d | j d d d d d d	 d
 d d d | j d d d d d d	 d
 d d d | j d d d d d
 d  d d! | j d" d# d d$ d
 d  d d% | j d& d' d d( d
 d  d d) | j d* d+ d d d
 d, d- d6 d d/ | j |   \ } }  | j r| j r| j d0  t j	 d  n  | j | j f } | j
 d. k r| j rt d$ |  } n	 t   } | j } | d  k rt j   } n  t d( | d | j  } t |   d k rD| j t j j   j |  GHqt |   d k rt| j t |  d  |  GHq| j d1  t j	 d  nM| j rt d$ |  } n	 t   } t d2 | j d3 | j  } t |   d k r| j | d4 <| j | d5 <n  t |   d k r2| j t j j   j |  } n t |   d k rc| j t |  d  |  } nX t |   d k r| j t |  d  t |  d  |  } n | j d1  t j	 d  | j r| j | j  } n  | GHd  S(7   Nit   usages%   usage: %prog [options] [year [month]]s   -ws   --widtht   destRF   t   typet   intt   defaulti   t   helps+   width of date column (default 2, text only)s   -ls   --linest   linesi   s4   number of lines for each week (default 1, text only)s   -ss	   --spacingR   i   s-   spacing between months (default 6, text only)s   -ms   --monthsRG   i   s%   months per row (default 3, text only)s   -cs   --cssR   s   calendar.csss   CSS to use for page (html only)s   -Ls   --localeR   s.   locale to be used from month and weekday namess   -es
   --encodingR   s   Encoding to use for outputs   -ts   --typet   textt   choicest   htmls   output type (text or html)s/   if --locale is specified --encoding is requireds   incorrect number of argumentsRa   Rb   Rp   Rq   (   s   textR   (    t   optparset   OptionParsert
   add_optionR   t
   parse_argsR   R   t   errorR   t   exitR   R   R{   R   t   dictR   R@   R   R%   R&   t   todayR+   R   R   RM   RF   R   R   RG   Ry   R`   R   (	   R   R   t   parsert   optionsR   Rj   R   t   optdictt   result(    (    s   /usr/lib/python2.7/calendar.pyt   mainl  s    											 		!,	t   __main__(    (    (    i   i   (D   RK   R   R%   R   R   t   __all__t
   ValueErrorR   R    R   RE   R0   R/   R   R)   R   R   R   R   R$   R   t   TUESDAYt	   WEDNESDAYt   THURSDAYt   FRIDAYt   SATURDAYR   R   R   R   R   t   objectR3   RM   R{   R   R   R   Rp   R5   R   R   RD   R   RP   RN   Re   R[   t
   weekheaderR	   R`   R
   Ry   R   Rz   R   t	   _colwidtht   _spacingR   Ro   t   EPOCHR&   R   R   R   R   R   t   argv(    (    (    s   /usr/lib/python2.7/calendar.pyt   <module>   sf   	-!				
up#													
	\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
k[c           @   sD   d  Z  d d l Z d d l Z d d  Z e d k r@ e   n  d S(   sD   Basic pip uninstallation support, helper for the Windows uninstalleriNc         C   s   t  j d d  } | j d d d d d j t j    d d | j d	 d
 d d d d d d d d | j |   } t j d | j  d  S(   Nt   progs   python -m ensurepip._uninstalls	   --versiont   actiont   versions   pip {}t   helps7   Show the version of pip this will attempt to uninstall.s   -vs	   --verboset   countt   defaulti    t   destt	   verbositysD   Give more output. Option is additive, and can be used up to 3 times.(	   t   argparset   ArgumentParsert   add_argumentt   formatt	   ensurepipR   t
   parse_argst   _uninstall_helperR   (   t   argvt   parsert   args(    (    s*   /usr/lib/python2.7/ensurepip/_uninstall.pyt   _main   s    	t   __main__(   t   __doc__R   R   t   NoneR   t   __name__(    (    (    s*   /usr/lib/python2.7/ensurepip/_uninstall.pyt   <module>   s
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
k[c           @   s   d  Z  d d l Z y d d l m Z Wn e k
 r? d Z n Xd g Z e j d e j	 e j
 Be j B Z d   Z e p~ e Z d S(   s   JSON token scanner
iN(   t   make_scannerR    s)   (-?(?:0|[1-9]\d*))(\.\d+)?([eE][-+]?\d+)?c            s   |  j  	 |  j  |  j 
 t j  |  j  |  j  |  j  |  j  |  j	  |  j
  |  j            	 
  f d       S(   Nc            sZ  y |  | } Wn t  k
 r' t  n X| d k rK 
 |  | d    S| d k rz 	 |  | d f        S| d k r  |  | d f    S| d k r |  | | d !d k r d  | d f S| d k r |  | | d !d	 k r t | d f S| d
 k r0|  | | d !d k r0t | d f S |  |  } | d  k	 r| j   \ } } } | sl| r | | p{d | pd  } n  |  } | | j   f S| d k r|  | | d !d k r d  | d f S| d k r|  | | d !d k r d  | d f S| d k rP|  | | d !d k rP d  | d f St  d  S(   Nt   "i   t   {t   [t   ni   t   nullt   tt   truet   fi   t   falset    t   Ni   t   NaNt   Ii   t   Infinityt   -i	   s	   -Infinity(   t
   IndexErrort   StopIterationt   Nonet   Truet   Falset   groupst   end(   t   stringt   idxt   nextchart   mt   integert   fract   expt   res(   t
   _scan_oncet   encodingt   match_numbert   object_hookt   object_pairs_hookt   parse_arrayt   parse_constantt   parse_floatt	   parse_intt   parse_objectt   parse_stringt   strict(    s"   /usr/lib/python2.7/json/scanner.pyR      s>    
#######(   R(   R$   R)   t	   NUMBER_REt   matchR    R*   R&   R'   R%   R"   R#   (   t   context(    (   R   R    R!   R"   R#   R$   R%   R&   R'   R(   R)   R*   s"   /usr/lib/python2.7/json/scanner.pyt   py_make_scanner   s    											0%(   t   __doc__t   ret   _jsonR    t   c_make_scannert   ImportErrorR   t   __all__t   compilet   VERBOSEt	   MULTILINEt   DOTALLR+   R.   (    (    (    s"   /usr/lib/python2.7/json/scanner.pyt   <module>   s   
		4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /     rbcomm-nam|IBM PC with RBcomm without autowrap            P           ! 9 ; B D K M O Q S X ] ^ _ a f h j l u y z { }                      [Z   [%i%p1%d;%p2%dr   5 %p2%' '%+%c%p1%' '%+%c 
 [?25l  [?25h     [5m [1m    [8m    [%p1%dX [m      (B)0[?7l[?3l[>8g   
     > = 
 [%p1%dM [%p1%dL %p1%c%p2%c (B)0[?3l[>8g 8 7 
 M 	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ? &  nrxvt-cygwin|rxvt terminal emulator (X Window System) on cygwin                               P    @       " & * 5 F H L S U \ ` d h j o t }                  	!'-39?EJOSX]aehkt} VY[_cgko	!'-39?EKQW]ciou{  [%i%p1%d;%p2%dr [3g [H[2J [K [J [%i%p1%dG [%i%p1%d;%p2%dH 
 [H [?25l  [?25h [C [A [M  [5m [1m 7[?47h [4h [7m [7m [4m  [m [2J[?47l8 [4l [27m [24m [?5h[?5l [?47l=[?1l [r[m[2J[H[?7h[?1;3;4;6l[4l [@ [L  [3~ [B [8^ [11~ [21~ [12~ [13~ [14~ [15~ [17~ [18~ [19~ [20~ [7~ [2~ [D [6~ [5~ [C [A > = [%p1%dM [%p1%dB [%p1%d@ [%p1%dL [%p1%dD [%p1%dC [%p1%dA >[1;3;4;5;6l[?7h[m[r[2J[H [r[m[2J[H[?7h[?1;3;4;6l[4l=[?1000l[?25h 8 [%i%p1%dd 7 
 M [0%?%p6%t;1%;%?%p2%t;4%;%?%p1%p3%|%t;7%;%?%p4%t;5%;m%?%p9%t%e%; H 	 Ow Oy Ou Oq Os 0+,-^`afghjklmno~pqrs_tuvwxyz{|}~ [Z (B)0 [8~ OM [1~ [3$ [4~ [8$ [7$ [d [6$ [5$ [c [23~ [24~ [25~ [26~ [28~ [29~ [31~ [32~ [33~ [34~ [23$ [24$ [11^ [12^ [13^ [14^ [15^ [17^ [18^ [19^ [20^ [21^ [23^ [24^ [25^ [26^ [28^ [29^ [31^ [32^ [33^ [34^ [23@ [24@ [1K [39;49m [M [3%p1%dm [4%p1%dm (B (0     (                $ ( , 0 4     	       ! & , 2 8 > B G L P T X [b Ob OB Od OD Oc OC [a Oa OA Ox Ot Ov Or AX G0 XT U8 E0 E3 S0 TS kDN kDN5 kDN6 kLFT5 kLFT6 kRIT5 kRIT6 kUP kUP5 kUP6 ka2 kb1 kb3 kc2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           2 &  nrxvt-xpm|rxvt terminal emulator (X Window System)                              P    @       " & * 5 F H L S U \ ` d h j o t }                  	!'-39?EJOSX]aehkt} VY[_cgko#)/5;AGMSY_ekqw}  [%i%p1%d;%p2%dr [3g [H[2J [K [J [%i%p1%dG [%i%p1%d;%p2%dH 
 [H [?25l  [?25h [C [A [M  [5m [1m 7[?47h [4h [7m [7m [4m  [m [2J[?47l8 [4l [27m [24m [?5h[?5l [?47l=[?1l [r[m[2J[H[?7h[?1;3;4;6l[4l [@ [L  [3~ [B [8^ [11~ [21~ [12~ [13~ [14~ [15~ [17~ [18~ [19~ [20~ [7~ [2~ [D [6~ [5~ [C [A > = [%p1%dM [%p1%dB [%p1%d@ [%p1%dL [%p1%dD [%p1%dC [%p1%dA >[1;3;4;5;6l[?7h[m[r[2J[H [r[m[2J[H[?7h[?1;3;4;6l[4l=[?1000l[?25h 8 [%i%p1%dd 7 
 M [0%?%p6%t;1%;%?%p2%t;4%;%?%p1%p3%|%t;7%;%?%p4%t;5%;m%?%p9%t%e%; H 	 Ow Oy Ou Oq Os ``aaffggjjkkllmmnnooppqqrrssttuuvvwwxxyyzz{{||}}~~ [Z (B)0 [8~ OM [1~ [3$ [4~ [8$ [7$ [d [6$ [5$ [c [23~ [24~ [25~ [26~ [28~ [29~ [31~ [32~ [33~ [34~ [23$ [24$ [11^ [12^ [13^ [14^ [15^ [17^ [18^ [19^ [20^ [21^ [23^ [24^ [25^ [26^ [28^ [29^ [31^ [32^ [33^ [34^ [23@ [24@ [1K [39;49m [M [3%p1%dm [4%p1%dm (B (0     (                $ ( , 0 4     	       ! & , 2 8 > B G L P T X [b Ob OB Od OD Oc OC [a Oa OA Ox Ot Ov Or AX G0 XT U8 E0 E3 S0 TS kDN kDN5 kDN6 kLFT5 kLFT6 kRIT5 kRIT6 kUP kUP5 kUP6 ka2 kb1 kb3 kc2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    &    regent40|Adds Regent 40                                     P        	  % ' , . 0 2 4 < @ D H L P X Z ^ b f j n r v z | ~              K k Y%p1%' '%+%c%p2%' '%+%c 
 Y       l$<2*> 0P 0` 0@ 0@ 0@ M$<2*> 
 1 2 3 4 5 6 7 8     F1 F2 F3 F4 F5 F6 F7 F8 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             *     qvt101+|qvt101p|qume qvt 101 PLUS product                 P         
    + - / 1 5 7 9 < ? E I O S W Z ^ i k n q s v y { ~                        I   3  T Y =%p1%' '%+%c%p2%' '%+%c 
   .4   W R gf G4 0P) G8 G0 ( G0 b$<200>d  Q E  W R 
 T Y @ I A B C D E F G H  Q E    A @ 
 1 	 gf I                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       all:

include ../lib.mk

.PHONY: all all_32 all_64 warn_32bit_failure clean

TARGETS_C_BOTHBITS := sigreturn single_step_syscall
TARGETS_C_32BIT_ONLY := entry_from_vm86

TARGETS_C_32BIT_ALL := $(TARGETS_C_BOTHBITS) $(TARGETS_C_32BIT_ONLY)
BINARIES_32 := $(TARGETS_C_32BIT_ALL:%=%_32)
BINARIES_64 := $(TARGETS_C_BOTHBITS:%=%_64)

CFLAGS := -O2 -g -std=gnu99 -pthread -Wall

UNAME_M := $(shell uname -m)
CAN_BUILD_I386 := $(shell ./check_cc.sh $(CC) trivial_32bit_program.c -m32)
CAN_BUILD_X86_64 := $(shell ./check_cc.sh $(CC) trivial_64bit_program.c)

ifeq ($(CAN_BUILD_I386),1)
all: all_32
TEST_PROGS += $(BINARIES_32)
endif

ifeq ($(CAN_BUILD_X86_64),1)
all: all_64
TEST_PROGS += $(BINARIES_64)
endif

all_32: $(BINARIES_32)

all_64: $(BINARIES_64)

clean:
	$(RM) $(BINARIES_32) $(BINARIES_64)

$(TARGETS_C_32BIT_ALL:%=%_32): %_32: %.c
	$(CC) -m32 -o $@ $(CFLAGS) $(EXTRA_CFLAGS) $^ -lrt -ldl

$(TARGETS_C_BOTHBITS:%=%_64): %_64: %.c
	$(CC) -m64 -o $@ $(CFLAGS) $(EXTRA_CFLAGS) $^ -lrt -ldl

# x86_64 users should be encouraged to install 32-bit libraries
ifeq ($(CAN_BUILD_I386)$(CAN_BUILD_X86_64),01)
all: warn_32bit_failure

warn_32bit_failure:
	@echo "Warning: you seem to have a broken 32-bit build" 2>&1; 	\
	echo "environment.  This will reduce test coverage of 64-bit" 2>&1; \
	echo "kernels.  If you are using a Debian-like distribution," 2>&1; \
	echo "try:"; 2>&1; \
	echo "";							\
	echo "  apt-get install gcc-multilib libc6-i386 libc6-dev-i386"; \
	echo "";							\
	echo "If you are using a Fedora-like distribution, try:";	\
	echo "";							\
	echo "  yum install glibc-devel.*i686";				\
	exit 0;
endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #ifndef __SOUND_GUS_H
#define __SOUND_GUS_H

/*
 *  Global structures used for GUS part of ALSA driver
 *  Copyright (c) by Jaroslav Kysela <perex@perex.cz>
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

#include <sound/pcm.h>
#include <sound/rawmidi.h>
#include <sound/timer.h>
#include <sound/seq_midi_emul.h>
#include <sound/seq_device.h>
#include <linux/io.h>

/* IO ports */

#define GUSP(gus, x)			((gus)->gf1.port + SNDRV_g_u_s_##x)

#define SNDRV_g_u_s_MIDICTRL		(0x320-0x220)
#define SNDRV_g_u_s_MIDISTAT		(0x320-0x220)
#define SNDRV_g_u_s_MIDIDATA		(0x321-0x220)

#define SNDRV_g_u_s_GF1PAGE		(0x322-0x220)
#define SNDRV_g_u_s_GF1REGSEL		(0x323-0x220)
#define SNDRV_g_u_s_GF1DATALOW		(0x324-0x220)
#define SNDRV_g_u_s_GF1DATAHIGH		(0x325-0x220)
#define SNDRV_g_u_s_IRQSTAT		(0x226-0x220)
#define SNDRV_g_u_s_TIMERCNTRL		(0x228-0x220)
#define SNDRV_g_u_s_TIMERDATA		(0x229-0x220)
#define SNDRV_g_u_s_DRAM		(0x327-0x220)
#define SNDRV_g_u_s_MIXCNTRLREG		(0x220-0x220)
#define SNDRV_g_u_s_IRQDMACNTRLREG	(0x22b-0x220)
#define SNDRV_g_u_s_REGCNTRLS		(0x22f-0x220)
#define SNDRV_g_u_s_BOARDVERSION	(0x726-0x220)
#define SNDRV_g_u_s_MIXCNTRLPORT	(0x726-0x220)
#define SNDRV_g_u_s_IVER		(0x325-0x220)
#define SNDRV_g_u_s_MIXDATAPORT		(0x326-0x220)
#define SNDRV_g_u_s_MAXCNTRLPORT	(0x326-0x220)

/* GF1 registers */

/* global registers */
#define SNDRV_GF1_GB_ACTIVE_VOICES		0x0e
#define SNDRV_GF1_GB_VOICES_IRQ			0x0f
#define SNDRV_GF1_GB_GLOBAL_MODE		0x19
#define SNDRV_GF1_GW_LFO_BASE			0x1a
#define SNDRV_GF1_GB_VOICES_IRQ_READ		0x1f
#define SNDRV_GF1_GB_DRAM_DMA_CONTROL		0x41
#define SNDRV_GF1_GW_DRAM_DMA_LOW		0x42
#define SNDRV_GF1_GW_DRAM_IO_LOW		0x43
#define SNDRV_GF1_GB_DRAM_IO_HIGH		0x44
#define SNDRV_GF1_GB_SOUND_BLASTER_CONTROL	0x45
#define SNDRV_GF1_GB_ADLIB_TIMER_1		0x46
#define SNDRV_GF1_GB_ADLIB_TIMER_2		0x47
#define SNDRV_GF1_GB_RECORD_RATE		0x48
#define SNDRV_GF1_GB_REC_DMA_CONTROL		0x49
#define SNDRV_GF1_GB_JOYSTICK_DAC_LEVEL		0x4b
#define SNDRV_GF1_GB_RESET			0x4c
#define SNDRV_GF1_GB_DRAM_DMA_HIGH		0x50
#define SNDRV_GF1_GW_DRAM_IO16			0x51
#define SNDRV_GF1_GW_MEMORY_CONFIG		0x52
#define SNDRV_GF1_GB_MEMORY_CONTROL		0x53
#define SNDRV_GF1_GW_FIFO_RECORD_BASE_ADDR	0x54
#define SNDRV_GF1_GW_FIFO_PLAY_BASE_ADDR	0x55
#define SNDRV_GF1_GW_FIFO_SIZE			0x56
#define SNDRV_GF1_GW_INTERLEAVE			0x57
#define SNDRV_GF1_GB_COMPATIBILITY		0x59
#define SNDRV_GF1_GB_DECODE_CONTROL		0x5a
#define SNDRV_GF1_GB_VERSION_NUMBER		0x5b
#define SNDRV_GF1_GB_MPU401_CONTROL_A		0x5c
#define SNDRV_GF1_GB_MPU401_CONTROL_B		0x5d
#define SNDRV_GF1_GB_EMULATION_IRQ		0x60
/* voice specific registers */
#define SNDRV_GF1_VB_ADDRESS_CONTROL		0x00
#define SNDRV_GF1_VW_FREQUENCY			0x01
#define SNDRV_GF1_VW_START_HIGH			0x02
#define SNDRV_GF1_VW_START_LOW			0x03
#define SNDRV_GF1_VA_START			SNDRV_GF1_VW_START_HIGH
#define SNDRV_GF1_VW_END_HIGH			0x04
#define SNDRV_GF1_VW_END_LOW			0x05
#define SNDRV_GF1_VA_END			SNDRV_GF1_VW_END_HIGH
#define SNDRV_GF1_VB_VOLUME_RATE		0x06
#define SNDRV_GF1_VB_VOLUME_START		0x07
#define SNDRV_GF1_VB_VOLUME_END			0x08
#define SNDRV_GF1_VW_VOLUME			0x09
#define SNDRV_GF1_VW_CURRENT_HIGH		0x0a
#define SNDRV_GF1_VW_CURRENT_LOW		0x0b
#define SNDRV_GF1_VA_CURRENT			SNDRV_GF1_VW_CURRENT_HIGH
#define SNDRV_GF1_VB_PAN			0x0c
#define SNDRV_GF1_VW_OFFSET_RIGHT		0x0c
#define SNDRV_GF1_VB_VOLUME_CONTROL		0x0d
#define SNDRV_GF1_VB_UPPER_ADDRESS		0x10
#define SNDRV_GF1_VW_EFFECT_HIGH		0x11
#define SNDRV_GF1_VW_EFFECT_LOW			0x12
#define SNDRV_GF1_VA_EFFECT			SNDRV_GF1_VW_EFFECT_HIGH
#define SNDRV_GF1_VW_OFFSET_LEFT		0x13
#define SNDRV_GF1_VB_ACCUMULATOR		0x14
#define SNDRV_GF1_VB_MODE			0x15
#define SNDRV_GF1_VW_EFFECT_VOLUME		0x16
#define SNDRV_GF1_VB_FREQUENCY_LFO		0x17
#define SNDRV_GF1_VB_VOLUME_LFO			0x18
#define SNDRV_GF1_VW_OFFSET_RIGHT_FINAL		0x1b
#define SNDRV_GF1_VW_OFFSET_LEFT_FINAL		0x1c
#define SNDRV_GF1_VW_EFFECT_VOLUME_FINAL	0x1d

/* ICS registers */

#define SNDRV_ICS_MIC_DEV		0
#define SNDRV_ICS_LINE_DEV		1
#define SNDRV_ICS_CD_DEV		2
#define SNDRV_ICS_GF1_DEV		3
#define SNDRV_ICS_NONE_DEV		4
#define SNDRV_ICS_MASTER_DEV		5

/* LFO */

#define SNDRV_LFO_TREMOLO		0
#define SNDRV_LFO_VIBRATO		1

/* misc */

#define SNDRV_GF1_DMA_UNSIGNED	0x80
#define SNDRV_GF1_DMA_16BIT	0x40
#define SNDRV_GF1_DMA_IRQ	0x20
#define SNDRV_GF1_DMA_WIDTH16	0x04
#define SNDRV_GF1_DMA_READ	0x02	/* read from GUS's DRAM */
#define SNDRV_GF1_DMA_ENABLE	0x01

/* ramp ranges */

#define SNDRV_GF1_ATTEN(x)	(snd_gf1_atten_table[x])
#define SNDRV_GF1_MIN_VOLUME	1800
#define SNDRV_GF1_MAX_VOLUME	4095
#define SNDRV_GF1_MIN_OFFSET	(SNDRV_GF1_MIN_VOLUME>>4)
#define SNDRV_GF1_MAX_OFFSET	255
#define SNDRV_GF1_MAX_TDEPTH	90

/* defines for memory manager */

#define SNDRV_GF1_MEM_BLOCK_16BIT	0x0001

#define SNDRV_GF1_MEM_OWNER_DRIVER	0x0001
#define SNDRV_GF1_MEM_OWNER_WAVE_SIMPLE	0x0002
#define SNDRV_GF1_MEM_OWNER_WAVE_GF1	0x0003
#define SNDRV_GF1_MEM_OWNER_WAVE_IWFFFF	0x0004

/* constants for interrupt handlers */

#define SNDRV_GF1_HANDLER_MIDI_OUT	0x00010000
#define SNDRV_GF1_HANDLER_MIDI_IN	0x00020000
#define SNDRV_GF1_HANDLER_TIMER1	0x00040000
#define SNDRV_GF1_HANDLER_TIMER2	0x00080000
#define SNDRV_GF1_HANDLER_VOICE		0x00100000
#define SNDRV_GF1_HANDLER_DMA_WRITE	0x00200000
#define SNDRV_GF1_HANDLER_DMA_READ	0x00400000
#define SNDRV_GF1_HANDLER_ALL		(0xffff0000&~SNDRV_GF1_HANDLER_VOICE)

/* constants for DMA flags */

#define SNDRV_GF1_DMA_TRIGGER		1

/* --- */

struct snd_gus_card;

/* GF1 specific structure */

struct snd_gf1_bank_info {
	unsigned int address;
	unsigned int size;
};

struct snd_gf1_mem_block {
	unsigned short flags;	/* flags - SNDRV_GF1_MEM_BLOCK_XXXX */
	unsigned short owner;	/* owner - SNDRV_GF1_MEM_OWNER_XXXX */
	unsigned int share;	/* share count */
	unsigned int share_id[4]; /* share ID */
	unsigned int ptr;
	unsigned int size;
	char *name;
	struct snd_gf1_mem_block *next;
	struct snd_gf1_mem_block *prev;
};

struct snd_gf1_mem {
	struct snd_gf1_bank_info banks_8[4];
	struct snd_gf1_bank_info banks_16[4];
	struct snd_gf1_mem_block *first;
	struct snd_gf1_mem_block *last;
	struct mutex memory_mutex;
};

struct snd_gf1_dma_block {
	void *buffer;		/* buffer in computer's RAM */
	unsigned long buf_addr;	/* buffer address */
	unsigned int addr;	/* address in onboard memory */
	unsigned int count;	/* count in bytes */
	unsigned int cmd;	/* DMA command (format) */
	void (*ack)(struct snd_gus_card * gus, void *private_data);
	void *private_data;
	struct snd_gf1_dma_block *next;
};

struct snd_gus_port {
	struct snd_midi_channel_set * chset;
	struct snd_gus_card * gus;
	int mode;		/* operation mode */
	int client;		/* sequencer client number */
	int port;		/* sequencer port number */
	unsigned int midi_has_voices: 1;
};

struct snd_gus_voice;

#define SNDRV_GF1_VOICE_TYPE_PCM	0
#define SNDRV_GF1_VOICE_TYPE_SYNTH 	1
#define SNDRV_GF1_VOICE_TYPE_MIDI	2

#define SNDRV_GF1_VFLG_RUNNING		(1<<0)
#define SNDRV_GF1_VFLG_EFFECT_TIMER1	(1<<1)
#define SNDRV_GF1_VFLG_PAN		(1<<2)

enum snd_gus_volume_state {
	VENV_BEFORE,
	VENV_ATTACK,
	VENV_SUSTAIN,
	VENV_RELEASE,
	VENV_DONE,
	VENV_VOLUME
};

struct snd_gus_voice {
	int number;
	unsigned int use: 1,
	    pcm: 1,
	    synth:1,
	    midi: 1;
	unsigned int flags;
	unsigned char client;
	unsigned char port;
	unsigned char index;
	unsigned char pad;
	
#ifdef CONFIG_SND_DEBUG
	unsigned int interrupt_stat_wave;
	unsigned int interrupt_stat_volume;
#endif
	void (*handler_wave) (struct snd_gus_card * gus, struct snd_gus_voice * voice);
	void (*handler_volume) (struct snd_gus_card * gus, struct snd_gus_voice * voice);
	void (*handler_effect) (struct snd_gus_card * gus, struct snd_gus_voice * voice);
	void (*volume_change) (struct snd_gus_card * gus);

	struct snd_gus_sample_ops *sample_ops;

	/* running status / registers */

	unsigned short fc_register;
	unsigned short fc_lfo;
	unsigned short gf1_volume;
	unsigned char control;
	unsigned char mode;
	unsigned char gf1_pan;
	unsigned char effect_accumulator;
	unsigned char volume_control;
	unsigned char venv_value_next;
	enum snd_gus_volume_state venv_state;
	enum snd_gus_volume_state venv_state_prev;
	unsigned short vlo;
	unsigned short vro;
	unsigned short gf1_effect_volume;
	
	/* --- */

	void *private_data;
	void (*private_free)(struct snd_gus_voice *voice);
};

struct snd_gf1 {

	unsigned int enh_mode:1,	/* enhanced mode (GFA1) */
		     hw_lfo:1,		/* use hardware LFO */
		     sw_lfo:1,		/* use software LFO */
		     effect:1;		/* use effect voices */

	unsigned long port;		/* port of GF1 chip */
	struct resource *res_port1;
	struct resource *res_port2;
	int irq;			/* IRQ number */
	int dma1;			/* DMA1 number */
	int dma2;			/* DMA2 number */
	unsigned int memory;		/* GUS's DRAM size in bytes */
	unsigned int rom_memory;	/* GUS's ROM size in bytes */
	unsigned int rom_present;	/* bitmask */
	unsigned int rom_banks;		/* GUS's ROM banks */

	struct snd_gf1_mem mem_alloc;

	/* registers */
	unsigned short reg_page;
	unsigned short reg_regsel;
	unsigned short reg_data8;
	unsigned short reg_data16;
	unsigned short reg_irqstat;
	unsigned short reg_dram;
	unsigned short reg_timerctrl;
	unsigned short reg_timerdata;
	unsigned char ics_regs[6][2];
	/* --------- */

	unsigned char active_voices;	/* active voices */
	unsigned char active_voice;	/* selected voice (GF1PAGE register) */

	struct snd_gus_voice voices[32];	/* GF1 voices */

	unsigned int default_voice_address;

	unsigned short playback_freq;	/* GF1 playback (mixing) frequency */
	unsigned short mode;		/* see to SNDRV_GF1_MODE_XXXX */
	unsigned char volume_ramp;
	unsigned char smooth_pan;
	unsigned char full_range_pan;
	unsigned char pad0;

	unsigned char *lfos;

	/* interrupt handlers */

	void (*interrupt_handler_midi_out) (struct snd_gus_card * gus);
	void (*interrupt_handler_midi_in) (struct snd_gus_card * gus);
	void (*interrupt_handler_timer1) (struct snd_gus_card * gus);
	void (*interrupt_handler_timer2) (struct snd_gus_card * gus);
	void (*interrupt_handler_dma_write) (struct snd_gus_card * gus);
	void (*interrupt_handler_dma_read) (struct snd_gus_card * gus);

#ifdef CONFIG_SND_DEBUG
	unsigned int interrupt_stat_midi_out;
	unsigned int interrupt_stat_midi_in;
	unsigned int interrupt_stat_timer1;
	unsigned int interrupt_stat_timer2;
	unsigned int interrupt_stat_dma_write;
	unsigned int interrupt_stat_dma_read;
	unsigned int interrupt_stat_voice_lost;
#endif

	/* synthesizer */

	int seq_client;
	struct snd_gus_port seq_ports[4];

	/* timer */

	unsigned short timer_enabled;
	struct snd_timer *timer1;
	struct snd_timer *timer2;

	/* midi */

	unsigned short uart_cmd;
	unsigned int uart_framing;
	unsigned int uart_overrun;

	/* dma operations */

	unsigned int dma_flags;
	unsigned int dma_shared;
	struct snd_gf1_dma_block *dma_data_pcm;
	struct snd_gf1_dma_block *dma_data_pcm_last;
	struct snd_gf1_dma_block *dma_data_synth;
	struct snd_gf1_dma_block *dma_data_synth_last;
	void (*dma_ack)(struct snd_gus_card * gus, void *private_data);
	void *dma_private_data;

	/* pcm */
	int pcm_channels;
	int pcm_alloc_voices;
        unsigned short pcm_volume_level_left;
	unsigned short pcm_volume_level_right;
	unsigned short pcm_volume_level_left1;
	unsigned short pcm_volume_level_right1;
                                
	unsigned char pcm_rcntrl_reg;
	unsigned char pad_end;
};

/* main structure for GUS card */

struct snd_gus_card {
	struct snd_card *card;

	unsigned int
	 initialized: 1,		/* resources were initialized */
	 equal_irq:1,			/* GF1 and CODEC shares IRQ (GUS MAX only) */
	 equal_dma:1,			/* if dma channels are equal (not valid for daughter board) */
	 ics_flag:1,			/* have we ICS mixer chip */
	 ics_flipped:1,			/* ICS mixer have flipped some channels? */
	 codec_flag:1,			/* have we CODEC chip? */
	 max_flag:1,			/* have we GUS MAX card? */
	 max_ctrl_flag:1,		/* have we original GUS MAX card? */
	 daughter_flag:1,		/* have we daughter board? */
	 interwave:1,			/* hey - we have InterWave card */
	 ess_flag:1,			/* ESS chip found... GUS Extreme */
	 ace_flag:1,			/* GUS ACE detected */
	 uart_enable:1;			/* enable MIDI UART */
	unsigned short revision;	/* revision of chip */
	unsigned short max_cntrl_val;	/* GUS MAX control value */
	unsigned short mix_cntrl_reg;	/* mixer control register */
	unsigned short joystick_dac;	/* joystick DAC level */
	int timer_dev;			/* timer device */

	struct snd_gf1 gf1;	/* gf1 specific variables */
	struct snd_pcm *pcm;
	struct snd_pcm_substream *pcm_cap_substream;
	unsigned int c_dma_size;
	unsigned int c_period_size;
	unsigned int c_pos;

	struct snd_rawmidi *midi_uart;
	struct snd_rawmidi_substream *midi_substream_output;
	struct snd_rawmidi_substream *midi_substream_input;

	spinlock_t reg_lock;
	spinlock_t voice_alloc;
	spinlock_t active_voice_lock;
	spinlock_t event_lock;
	spinlock_t dma_lock;
	spinlock_t pcm_volume_level_lock;
	spinlock_t uart_cmd_lock;
	struct mutex dma_mutex;
	struct mutex register_mutex;
};

/* I/O functions for GF1/InterWave chip - gus_io.c */

static inline void snd_gf1_select_voice(struct snd_gus_card * gus, int voice)
{
	unsigned long flags;

	spin_lock_irqsave(&gus->active_voice_lock, flags);
	if (voice != gus->gf1.active_voice) {
		gus->gf1.active_voice = voice;
		outb(voice, GUSP(gus, GF1PAGE));
	}
	spin_unlock_irqrestore(&gus->active_voice_lock, flags);
}

static inline void snd_gf1_uart_cmd(struct snd_gus_card * gus, unsigned char b)
{
	outb(gus->gf1.uart_cmd = b, GUSP(gus, MIDICTRL));
}

static inline unsigned char snd_gf1_uart_stat(struct snd_gus_card * gus)
{
	return inb(GUSP(gus, MIDISTAT));
}

static inline void snd_gf1_uart_put(struct snd_gus_card * gus, unsigned char b)
{
	outb(b, GUSP(gus, MIDIDATA));
}

static inline unsigned char snd_gf1_uart_get(struct snd_gus_card * gus)
{
	return inb(GUSP(gus, MIDIDATA));
}

extern void snd_gf1_delay(struct snd_gus_card * gus);

extern void snd_gf1_ctrl_stop(struct snd_gus_card * gus, unsigned char reg);

extern void snd_gf1_write8(struct snd_gus_card * gus, unsigned char reg, unsigned char data);
extern unsigned char snd_gf1_look8(struct snd_gus_card * gus, unsigned char reg);
static inline unsigned char snd_gf1_read8(struct snd_gus_card * gus, unsigned char reg)
{
	return snd_gf1_look8(gus, reg | 0x80);
}
extern void snd_gf1_write16(struct snd_gus_card * gus, unsigned char reg, unsigned int data);
extern unsigned short snd_gf1_look16(struct snd_gus_card * gus, unsigned char reg);
static inline unsigned short snd_gf1_read16(struct snd_gus_card * gus, unsigned char reg)
{
	return snd_gf1_look16(gus, reg | 0x80);
}
extern void snd_gf1_adlib_write(struct snd_gus_card * gus, unsigned char reg, unsigned char data);
extern void snd_gf1_dram_addr(struct snd_gus_card * gus, unsigned int addr);
extern void snd_gf1_poke(struct snd_gus_card * gus, unsigned int addr, unsigned char data);
extern unsigned char snd_gf1_peek(struct snd_gus_card * gus, unsigned int addr);
extern void snd_gf1_write_addr(struct snd_gus_card * gus, unsigned char reg, unsigned int addr, short w_16bit);
extern unsigned int snd_gf1_read_addr(struct snd_gus_card * gus, unsigned char reg, short w_16bit);
extern void snd_gf1_i_ctrl_stop(struct snd_gus_card * gus, unsigned char reg);
extern void snd_gf1_i_write8(struct snd_gus_card * gus, unsigned char reg, unsigned char data);
extern unsigned char snd_gf1_i_look8(struct snd_gus_card * gus, unsigned char reg);
extern void snd_gf1_i_write16(struct snd_gus_card * gus, unsigned char reg, unsigned int data);
static inline unsigned char snd_gf1_i_read8(struct snd_gus_card * gus, unsigned char reg)
{
	return snd_gf1_i_look8(gus, reg | 0x80);
}
extern unsigned short snd_gf1_i_look16(struct snd_gus_card * gus, unsigned char reg);
static inline unsigned short snd_gf1_i_read16(struct snd_gus_card * gus, unsigned char reg)
{
	return snd_gf1_i_look16(gus, reg | 0x80);
}

extern void snd_gf1_select_active_voices(struct snd_gus_card * gus);

/* gus_lfo.c */

struct _SND_IW_LFO_PROGRAM {
	unsigned short freq_and_control;
	unsigned char depth_final;
	unsigned char depth_inc;
	unsigned short twave;
	unsigned short depth;
};

#if 0
extern irqreturn_t snd_gf1_lfo_effect_interrupt(struct snd_gus_card * gus, snd_gf1_voice_t * voice);
#endif
extern void snd_gf1_lfo_init(struct snd_gus_card * gus);
extern void snd_gf1_lfo_done(struct snd_gus_card * gus);
extern void snd_gf1_lfo_program(struct snd_gus_card * gus, int voice, int lfo_type, struct _SND_IW_LFO_PROGRAM *program);
extern void snd_gf1_lfo_enable(struct snd_gus_card * gus, int voice, int lfo_type);
extern void snd_gf1_lfo_disable(struct snd_gus_card * gus, int voice, int lfo_type);
extern void snd_gf1_lfo_change_freq(struct snd_gus_card * gus, int voice, int lfo_type, int freq);
extern void snd_gf1_lfo_change_depth(struct snd_gus_card * gus, int voice, int lfo_type, int depth);
extern void snd_gf1_lfo_setup(struct snd_gus_card * gus, int voice, int lfo_type, int freq, int current_depth, int depth, int sweep, int shape);
extern void snd_gf1_lfo_shutdown(struct snd_gus_card * gus, int voice, int lfo_type);
#if 0
extern void snd_gf1_lfo_command(struct snd_gus_card * gus, int voice, unsigned char *command);
#endif

/* gus_mem.c */

void snd_gf1_mem_lock(struct snd_gf1_mem * alloc, int xup);
int snd_gf1_mem_xfree(struct snd_gf1_mem * alloc, struct snd_gf1_mem_block * block);
struct snd_gf1_mem_block *snd_gf1_mem_alloc(struct snd_gf1_mem * alloc, int owner,
				       char *name, int size, int w_16,
				       int align, unsigned int *share_id);
int snd_gf1_mem_free(struct snd_gf1_mem * alloc, unsigned int address);
int snd_gf1_mem_free_owner(struct snd_gf1_mem * alloc, int owner);
int snd_gf1_mem_init(struct snd_gus_card * gus);
int snd_gf1_mem_done(struct snd_gus_card * gus);

/* gus_mem_proc.c */

int snd_gf1_mem_proc_init(struct snd_gus_card * gus);

/* gus_dma.c */

int snd_gf1_dma_init(struct snd_gus_card * gus);
int snd_gf1_dma_done(struct snd_gus_card * gus);
int snd_gf1_dma_transfer_block(struct snd_gus_card * gus,
			       struct snd_gf1_dma_block * block,
			       int atomic,
			       int synth);

/* gus_volume.c */

unsigned short snd_gf1_lvol_to_gvol_raw(unsigned int vol);
unsigned short snd_gf1_translate_freq(struct snd_gus_card * gus, unsigned int freq2);

/* gus_reset.c */

void snd_gf1_set_default_handlers(struct snd_gus_card * gus, unsigned int what);
void snd_gf1_smart_stop_voice(struct snd_gus_card * gus, unsigned short voice);
void snd_gf1_stop_voice(struct snd_gus_card * gus, unsigned short voice);
void snd_gf1_stop_voices(struct snd_gus_card * gus, unsigned short v_min, unsigned short v_max);
struct snd_gus_voice *snd_gf1_alloc_voice(struct snd_gus_card * gus, int type, int client, int port);
void snd_gf1_free_voice(struct snd_gus_card * gus, struct snd_gus_voice *voice);
int snd_gf1_start(struct snd_gus_card * gus);
int snd_gf1_stop(struct snd_gus_card * gus);

/* gus_mixer.c */

int snd_gf1_new_mixer(struct snd_gus_card * gus);

/* gus_pcm.c */

int snd_gf1_pcm_new(struct snd_gus_card *gus, int pcm_dev, int control_index);

#ifdef CONFIG_SND_DEBUG
extern void snd_gf1_print_voice_registers(struct snd_gus_card * gus);
#endif

/* gus.c */

int snd_gus_use_inc(struct snd_gus_card * gus);
void snd_gus_use_dec(struct snd_gus_card * gus);
int snd_gus_create(struct snd_card *card,
		   unsigned long port,
		   int irq, int dma1, int dma2,
		   int timer_dev,
		   int voices,
		   int pcm_channels,
		   int effect,
		   struct snd_gus_card ** rgus);
int snd_gus_initialize(struct snd_gus_card * gus);

/* gus_irq.c */

irqreturn_t snd_gus_interrupt(int irq, void *dev_id);
#ifdef CONFIG_SND_DEBUG
void snd_gus_irq_profile_init(struct snd_gus_card *gus);
#endif

/* gus_uart.c */

int snd_gf1_rawmidi_new(struct snd_gus_card *gus, int device);

/* gus_dram.c */
int snd_gus_dram_write(struct snd_gus_card *gus, char __user *ptr,
		       unsigned int addr, unsigned int size);
int snd_gus_dram_read(struct snd_gus_card *gus, char __user *ptr,
		      unsigned int addr, unsigned int size, int rom);

#endif /* __SOUND_GUS_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #ifndef __SOUND_ES1688_H
#define __SOUND_ES1688_H

/*
 *  Header file for ES488/ES1688
 *  Copyright (c) by Jaroslav Kysela <perex@perex.cz>
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

#include <sound/control.h>
#include <sound/pcm.h>
#include <linux/interrupt.h>

#define ES1688_HW_AUTO		0x0000
#define ES1688_HW_688		0x0001
#define ES1688_HW_1688		0x0002
#define ES1688_HW_UNDEF	0x0003

struct snd_es1688 {
	unsigned long port;		/* port of ESS chip */
	struct resource *res_port;
	unsigned long mpu_port;		/* MPU-401 port of ESS chip */
	int irq;			/* IRQ number of ESS chip */
	int mpu_irq;			/* MPU IRQ */
	int dma8;			/* 8-bit DMA */
	unsigned short version;		/* version of ESS chip */
	unsigned short hardware;	/* see to ES1688_HW_XXXX */

	unsigned short trigger_value;
	unsigned char pad;
	unsigned int dma_size;

	struct snd_pcm *pcm;
	struct snd_pcm_substream *playback_substream;
	struct snd_pcm_substream *capture_substream;

	spinlock_t reg_lock;
	spinlock_t mixer_lock;
};

/* I/O ports */

#define ES1688P(codec, x) ((codec)->port + e_s_s_ESS1688##x)

#define e_s_s_ESS1688RESET	0x6
#define e_s_s_ESS1688READ	0xa
#define e_s_s_ESS1688WRITE	0xc
#define e_s_s_ESS1688COMMAND	0xc
#define e_s_s_ESS1688STATUS	0xc
#define e_s_s_ESS1688DATA_AVAIL	0xe
#define e_s_s_ESS1688DATA_AVAIL_16 0xf
#define e_s_s_ESS1688MIXER_ADDR	0x4
#define e_s_s_ESS1688MIXER_DATA	0x5
#define e_s_s_ESS1688OPL3_LEFT	0x0
#define e_s_s_ESS1688OPL3_RIGHT	0x2
#define e_s_s_ESS1688OPL3_BOTH	0x8
#define e_s_s_ESS1688ENABLE0	0x0
#define e_s_s_ESS1688ENABLE1	0x9
#define e_s_s_ESS1688ENABLE2	0xb
#define e_s_s_ESS1688INIT1	0x7

#define ES1688_DSP_CMD_DMAOFF	0xd0
#define ES1688_DSP_CMD_SPKON	0xd1
#define ES1688_DSP_CMD_SPKOFF	0xd3
#define ES1688_DSP_CMD_DMAON	0xd4

#define ES1688_PCM_DEV		0x14
#define ES1688_MIC_DEV		0x1a
#define ES1688_REC_DEV		0x1c
#define ES1688_MASTER_DEV	0x32
#define ES1688_FM_DEV		0x36
#define ES1688_CD_DEV		0x38
#define ES1688_AUX_DEV		0x3a
#define ES1688_SPEAKER_DEV	0x3c
#define ES1688_LINE_DEV		0x3e
#define ES1688_RECLEV_DEV	0xb4

#define ES1688_MIXS_MASK	0x17
#define ES1688_MIXS_MIC		0x00
#define ES1688_MIXS_MIC_MASTER	0x01
#define ES1688_MIXS_CD		0x02
#define ES1688_MIXS_AOUT	0x03
#define ES1688_MIXS_MIC1	0x04
#define ES1688_MIXS_REC_MIX	0x05
#define ES1688_MIXS_LINE	0x06
#define ES1688_MIXS_MASTER	0x07
#define ES1688_MIXS_MUTE	0x10

/*

 */

void snd_es1688_mixer_write(struct snd_es1688 *chip, unsigned char reg, unsigned char data);

int snd_es1688_create(struct snd_card *card,
		      struct snd_es1688 *chip,
		      unsigned long port,
		      unsigned long mpu_port,
		      int irq,
		      int mpu_irq,
		      int dma8,
		      unsigned short hardware);
int snd_es1688_pcm(struct snd_card *card, struct snd_es1688 *chip, int device);
int snd_es1688_mixer(struct snd_card *card, struct snd_es1688 *chip);
int snd_es1688_reset(struct snd_es1688 *chip);

#endif /* __SOUND_ES1688_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              #ifndef __SOUND_SEQ_DEVICE_H
#define __SOUND_SEQ_DEVICE_H

/*
 *  ALSA sequencer device management
 *  Copyright (c) 1999 by Takashi Iwai <tiwai@suse.de>
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

/*
 * registered device information
 */

struct snd_seq_device {
	/* device info */
	struct snd_card *card;	/* sound card */
	int device;		/* device number */
	const char *id;		/* driver id */
	char name[80];		/* device name */
	int argsize;		/* size of the argument */
	void *driver_data;	/* private data for driver */
	void *private_data;	/* private data for the caller */
	void (*private_free)(struct snd_seq_device *device);
	struct device dev;
};

#define to_seq_dev(_dev) \
	container_of(_dev, struct snd_seq_device, dev)

/* sequencer driver */

/* driver operators
 * probe:
 *	Initialize the device with given parameters.
 *	Typically,
 *		1. call snd_hwdep_new
 *		2. allocate private data and initialize it
 *		3. call snd_hwdep_register
 *		4. store the instance to dev->driver_data pointer.
 *		
 * remove:
 *	Release the private data.
 *	Typically, call snd_device_free(dev->card, dev->driver_data)
 */
struct snd_seq_driver {
	struct device_driver driver;
	char *id;
	int argsize;
};

#define to_seq_drv(_drv) \
	container_of(_drv, struct snd_seq_driver, driver)

/*
 * prototypes
 */
#ifdef CONFIG_MODULES
void snd_seq_device_load_drivers(void);
#else
#define snd_seq_device_load_drivers()
#endif
int snd_seq_device_new(struct snd_card *card, int device, const char *id,
		       int argsize, struct snd_seq_device **result);

#define SNDRV_SEQ_DEVICE_ARGPTR(dev) (void *)((char *)(dev) + sizeof(struct snd_seq_device))

int __must_check __snd_seq_driver_register(struct snd_seq_driver *drv,
					   struct module *mod);
#define snd_seq_driver_register(drv) \
	__snd_seq_driver_register(drv, THIS_MODULE)
void snd_seq_driver_unregister(struct snd_seq_driver *drv);

#define module_snd_seq_driver(drv) \
	module_driver(drv, snd_seq_driver_register, snd_seq_driver_unregister)

/*
 * id strings for generic devices
 */
#define SNDRV_SEQ_DEV_ID_MIDISYNTH	"seq-midi"
#define SNDRV_SEQ_DEV_ID_OPL3		"opl3-synth"

#endif /* __SOUND_SEQ_DEVICE_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       #ifndef __SOUND_CORE_H
#define __SOUND_CORE_H

/*
 *  Main header file for the ALSA driver
 *  Copyright (c) 1994-2001 by Jaroslav Kysela <perex@perex.cz>
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

#include <linux/device.h>
#include <linux/sched.h>		/* wake_up() */
#include <linux/mutex.h>		/* struct mutex */
#include <linux/rwsem.h>		/* struct rw_semaphore */
#include <linux/pm.h>			/* pm_message_t */
#include <linux/stringify.h>
#include <linux/printk.h>

/* number of supported soundcards */
#ifdef CONFIG_SND_DYNAMIC_MINORS
#define SNDRV_CARDS CONFIG_SND_MAX_CARDS
#else
#define SNDRV_CARDS 8		/* don't change - minor numbers */
#endif

#define CONFIG_SND_MAJOR	116	/* standard configuration */

/* forward declarations */
struct pci_dev;
struct module;
struct completion;

/* device allocation stuff */

/* type of the object used in snd_device_*()
 * this also defines the calling order
 */
enum snd_device_type {
	SNDRV_DEV_LOWLEVEL,
	SNDRV_DEV_CONTROL,
	SNDRV_DEV_INFO,
	SNDRV_DEV_BUS,
	SNDRV_DEV_CODEC,
	SNDRV_DEV_PCM,
	SNDRV_DEV_COMPRESS,
	SNDRV_DEV_RAWMIDI,
	SNDRV_DEV_TIMER,
	SNDRV_DEV_SEQUENCER,
	SNDRV_DEV_HWDEP,
	SNDRV_DEV_JACK,
};

enum snd_device_state {
	SNDRV_DEV_BUILD,
	SNDRV_DEV_REGISTERED,
	SNDRV_DEV_DISCONNECTED,
};

struct snd_device;

struct snd_device_ops {
	int (*dev_free)(struct snd_device *dev);
	int (*dev_register)(struct snd_device *dev);
	int (*dev_disconnect)(struct snd_device *dev);
};

struct snd_device {
	struct list_head list;		/* list of registered devices */
	struct snd_card *card;		/* card which holds this device */
	enum snd_device_state state;	/* state of the device */
	enum snd_device_type type;	/* device type */
	void *device_data;		/* device structure */
	struct snd_device_ops *ops;	/* operations */
};

#define snd_device(n) list_entry(n, struct snd_device, list)

/* main structure for soundcard */

struct snd_card {
	int number;			/* number of soundcard (index to
								snd_cards) */

	char id[16];			/* id string of this card */
	char driver[16];		/* driver name */
	char shortname[32];		/* short name of this soundcard */
	char longname[80];		/* name of this soundcard */
	char mixername[80];		/* mixer name */
	char components[128];		/* card components delimited with
								space */
	struct module *module;		/* top-level module */

	void *private_data;		/* private data for soundcard */
	void (*private_free) (struct snd_card *card); /* callback for freeing of
								private data */
	struct list_head devices;	/* devices */

	struct device ctl_dev;		/* control device */
	unsigned int last_numid;	/* last used numeric ID */
	struct rw_semaphore controls_rwsem;	/* controls list lock */
	rwlock_t ctl_files_rwlock;	/* ctl_files list lock */
	int controls_count;		/* count of all controls */
	int user_ctl_count;		/* count of all user controls */
	struct list_head controls;	/* all controls for this card */
	struct list_head ctl_files;	/* active control files */
	struct mutex user_ctl_lock;	/* protects user controls against
					   concurrent access */

	struct snd_info_entry *proc_root;	/* root for soundcard specific files */
	struct snd_info_entry *proc_id;	/* the card id */
	struct proc_dir_entry *proc_root_link;	/* number link to real id */

	struct list_head files_list;	/* all files associated to this card */
	struct snd_shutdown_f_ops *s_f_ops; /* file operations in the shutdown
								state */
	spinlock_t files_lock;		/* lock the files for this card */
	int shutdown;			/* this card is going down */
	struct completion *release_completion;
	struct device *dev;		/* device assigned to this card */
	struct device card_dev;		/* cardX object for sysfs */
	const struct attribute_group *dev_groups[4]; /* assigned sysfs attr */
	bool registered;		/* card_dev is registered? */

#ifdef CONFIG_PM
	unsigned int power_state;	/* power state */
	struct mutex power_lock;	/* power lock */
	wait_queue_head_t power_sleep;
#endif

#if defined(CONFIG_SND_MIXER_OSS) || defined(CONFIG_SND_MIXER_OSS_MODULE)
	struct snd_mixer_oss *mixer_oss;
	int mixer_oss_change_count;
#endif
};

#define dev_to_snd_card(p)	container_of(p, struct snd_card, card_dev)

#ifdef CONFIG_PM
static inline void snd_power_lock(struct snd_card *card)
{
	mutex_lock(&card->power_lock);
}

static inline void snd_power_unlock(struct snd_card *card)
{
	mutex_unlock(&card->power_lock);
}

static inline unsigned int snd_power_get_state(struct snd_card *card)
{
	return card->power_state;
}

static inline void snd_power_change_state(struct snd_card *card, unsigned int state)
{
	card->power_state = state;
	wake_up(&card->power_sleep);
}

/* init.c */
int snd_power_wait(struct snd_card *card, unsigned int power_state);

#else /* ! CONFIG_PM */

#define snd_power_lock(card)		do { (void)(card); } while (0)
#define snd_power_unlock(card)		do { (void)(card); } while (0)
static inline int snd_power_wait(struct snd_card *card, unsigned int state) { return 0; }
#define snd_power_get_state(card)	({ (void)(card); SNDRV_CTL_POWER_D0; })
#define snd_power_change_state(card, state)	do { (void)(card); } while (0)

#endif /* CONFIG_PM */

struct snd_minor {
	int type;			/* SNDRV_DEVICE_TYPE_XXX */
	int card;			/* card number */
	int device;			/* device number */
	const struct file_operations *f_ops;	/* file operations */
	void *private_data;		/* private data for f_ops->open */
	struct device *dev;		/* device for sysfs */
	struct snd_card *card_ptr;	/* assigned card instance */
};

/* return a device pointer linked to each sound device as a parent */
static inline struct device *snd_card_get_device_link(struct snd_card *card)
{
	return card ? &card->card_dev : NULL;
}

/* sound.c */

extern int snd_major;
extern int snd_ecards_limit;
extern struct class *sound_class;

void snd_request_card(int card);

void snd_device_initialize(struct device *dev, struct snd_card *card);

int snd_register_device(int type, struct snd_card *card, int dev,
			const struct file_operations *f_ops,
			void *private_data, struct device *device);
int snd_unregister_device(struct device *dev);
void *snd_lookup_minor_data(unsigned int minor, int type);

#ifdef CONFIG_SND_OSSEMUL
int snd_register_oss_device(int type, struct snd_card *card, int dev,
			    const struct file_operations *f_ops, void *private_data);
int snd_unregister_oss_device(int type, struct snd_card *card, int dev);
void *snd_lookup_oss_minor_data(unsigned int minor, int type);
#endif

int snd_minor_info_init(void);
int snd_minor_info_done(void);

/* sound_oss.c */

#ifdef CONFIG_SND_OSSEMUL
int snd_minor_info_oss_init(void);
int snd_minor_info_oss_done(void);
#else
static inline int snd_minor_info_oss_init(void) { return 0; }
static inline int snd_minor_info_oss_done(void) { return 0; }
#endif

/* memory.c */

int copy_to_user_fromio(void __user *dst, const volatile void __iomem *src, size_t count);
int copy_from_user_toio(volatile void __iomem *dst, const void __user *src, size_t count);

/* init.c */

extern struct snd_card *snd_cards[SNDRV_CARDS];
int snd_card_locked(int card);
#if defined(CONFIG_SND_MIXER_OSS) || defined(CONFIG_SND_MIXER_OSS_MODULE)
#define SND_MIXER_OSS_NOTIFY_REGISTER	0
#define SND_MIXER_OSS_NOTIFY_DISCONNECT	1
#define SND_MIXER_OSS_NOTIFY_FREE	2
extern int (*snd_mixer_oss_notify_callback)(struct snd_card *card, int cmd);
#endif

int snd_card_new(struct device *parent, int idx, const char *xid,
		 struct module *module, int extra_size,
		 struct snd_card **card_ret);

int snd_card_disconnect(struct snd_card *card);
int snd_card_free(struct snd_card *card);
int snd_card_free_when_closed(struct snd_card *card);
void snd_card_set_id(struct snd_card *card, const char *id);
int snd_card_register(struct snd_card *card);
int snd_card_info_init(void);
int snd_card_info_done(void);
int snd_card_add_dev_attr(struct snd_card *card,
			  const struct attribute_group *group);
int snd_component_add(struct snd_card *card, const char *component);
int snd_card_file_add(struct snd_card *card, struct file *file);
int snd_card_file_remove(struct snd_card *card, struct file *file);
#define snd_card_unref(card)	put_device(&(card)->card_dev)

#define snd_card_set_dev(card, devptr) ((card)->dev = (devptr))

/* device.c */

int snd_device_new(struct snd_card *card, enum snd_device_type type,
		   void *device_data, struct snd_device_ops *ops);
int snd_device_register(struct snd_card *card, void *device_data);
int snd_device_register_all(struct snd_card *card);
void snd_device_disconnect(struct snd_card *card, void *device_data);
void snd_device_disconnect_all(struct snd_card *card);
void snd_device_free(struct snd_card *card, void *device_data);
void snd_device_free_all(struct snd_card *card);

/* isadma.c */

#ifdef CONFIG_ISA_DMA_API
#define DMA_MODE_NO_ENABLE	0x0100

void snd_dma_program(unsigned long dma, unsigned long addr, unsigned int size, unsigned short mode);
void snd_dma_disable(unsigned long dma);
unsigned int snd_dma_pointer(unsigned long dma, unsigned int size);
#endif

/* misc.c */
struct resource;
void release_and_free_resource(struct resource *res);

/* --- */

/* sound printk debug levels */
enum {
	SND_PR_ALWAYS,
	SND_PR_DEBUG,
	SND_PR_VERBOSE,
};

#if defined(CONFIG_SND_DEBUG) || defined(CONFIG_SND_VERBOSE_PRINTK)
__printf(4, 5)
void __snd_printk(unsigned int level, const char *file, int line,
		  const char *format, ...);
#else
#define __snd_printk(level, file, line, format, args...) \
	printk(format, ##args)
#endif

/**
 * snd_printk - printk wrapper
 * @fmt: format string
 *
 * Works like printk() but prints the file and the line of the caller
 * when configured with CONFIG_SND_VERBOSE_PRINTK.
 */
#define snd_printk(fmt, args...) \
	__snd_printk(0, __FILE__, __LINE__, fmt, ##args)

#ifdef CONFIG_SND_DEBUG
/**
 * snd_printd - debug printk
 * @fmt: format string
 *
 * Works like snd_printk() for debugging purposes.
 * Ignored when CONFIG_SND_DEBUG is not set.
 */
#define snd_printd(fmt, args...) \
	__snd_printk(1, __FILE__, __LINE__, fmt, ##args)
#define _snd_printd(level, fmt, args...) \
	__snd_printk(level, __FILE__, __LINE__, fmt, ##args)

/**
 * snd_BUG - give a BUG warning message and stack trace
 *
 * Calls WARN() if CONFIG_SND_DEBUG is set.
 * Ignored when CONFIG_SND_DEBUG is not set.
 */
#define snd_BUG()		WARN(1, "BUG?\n")

/**
 * Suppress high rates of output when CONFIG_SND_DEBUG is enabled.
 */
#define snd_printd_ratelimit() printk_ratelimit()

/**
 * snd_BUG_ON - debugging check macro
 * @cond: condition to evaluate
 *
 * Has the same behavior as WARN_ON when CONFIG_SND_DEBUG is set,
 * otherwise just evaluates the conditional and returns the value.
 */
#define snd_BUG_ON(cond)	WARN_ON((cond))

#else /* !CONFIG_SND_DEBUG */

__printf(1, 2)
static inline void snd_printd(const char *format, ...) {}
__printf(2, 3)
static inline void _snd_printd(int level, const char *format, ...) {}

#define snd_BUG()			do { } while (0)

#define snd_BUG_ON(condition) ({ \
	int __ret_warn_on = !!(condition); \
	unlikely(__ret_warn_on); \
})

static inline bool snd_printd_ratelimit(void) { return false; }

#endif /* CONFIG_SND_DEBUG */

#ifdef CONFIG_SND_DEBUG_VERBOSE
/**
 * snd_printdd - debug printk
 * @format: format string
 *
 * Works like snd_printk() for debugging purposes.
 * Ignored when CONFIG_SND_DEBUG_VERBOSE is not set.
 */
#define snd_printdd(format, args...) \
	__snd_printk(2, __FILE__, __LINE__, format, ##args)
#else
__printf(1, 2)
static inline void snd_printdd(const char *format, ...) {}
#endif


#define SNDRV_OSS_VERSION         ((3<<16)|(8<<8)|(1<<4)|(0))	/* 3.8.1a */

/* for easier backward-porting */
#if defined(CONFIG_GAMEPORT) || defined(CONFIG_GAMEPORT_MODULE)
#define gameport_set_dev_parent(gp,xdev) ((gp)->dev.parent = (xdev))
#define gameport_set_port_data(gp,r) ((gp)->port_data = (r))
#define gameport_get_port_data(gp) (gp)->port_data
#endif

/* PCI quirk list helper */
struct snd_pci_quirk {
	unsigned short subvendor;	/* PCI subvendor ID */
	unsigned short subdevice;	/* PCI subdevice ID */
	unsigned short subdevice_mask;	/* bitmask to match */
	int value;			/* value */
#ifdef CONFIG_SND_DEBUG_VERBOSE
	const char *name;		/* name of the device (optional) */
#endif
};

#define _SND_PCI_QUIRK_ID_MASK(vend, mask, dev)	\
	.subvendor = (vend), .subdevice = (dev), .subdevice_mask = (mask)
#define _SND_PCI_QUIRK_ID(vend, dev) \
	_SND_PCI_QUIRK_ID_MASK(vend, 0xffff, dev)
#define SND_PCI_QUIRK_ID(vend,dev) {_SND_PCI_QUIRK_ID(vend, dev)}
#ifdef CONFIG_SND_DEBUG_VERBOSE
#define SND_PCI_QUIRK(vend,dev,xname,val) \
	{_SND_PCI_QUIRK_ID(vend, dev), .value = (val), .name = (xname)}
#define SND_PCI_QUIRK_VENDOR(vend, xname, val)			\
	{_SND_PCI_QUIRK_ID_MASK(vend, 0, 0), .value = (val), .name = (xname)}
#define SND_PCI_QUIRK_MASK(vend, mask, dev, xname, val)			\
	{_SND_PCI_QUIRK_ID_MASK(vend, mask, dev),			\
			.value = (val), .name = (xname)}
#define snd_pci_quirk_name(q)	((q)->name)
#else
#define SND_PCI_QUIRK(vend,dev,xname,val) \
	{_SND_PCI_QUIRK_ID(vend, dev), .value = (val)}
#define SND_PCI_QUIRK_MASK(vend, mask, dev, xname, val)			\
	{_SND_PCI_QUIRK_ID_MASK(vend, mask, dev), .value = (val)}
#define SND_PCI_QUIRK_VENDOR(vend, xname, val)			\
	{_SND_PCI_QUIRK_ID_MASK(vend, 0, 0), .value = (val)}
#define snd_pci_quirk_name(q)	""
#endif

#ifdef CONFIG_PCI
const struct snd_pci_quirk *
snd_pci_quirk_lookup(struct pci_dev *pci, const struct snd_pci_quirk *list);

const struct snd_pci_quirk *
snd_pci_quirk_lookup_id(u16 vendor, u16 device,
			const struct snd_pci_quirk *list);
#else
static inline const struct snd_pci_quirk *
snd_pci_quirk_lookup(struct pci_dev *pci, const struct snd_pci_quirk *list)
{
	return NULL;
}

static inline const struct snd_pci_quirk *
snd_pci_quirk_lookup_id(u16 vendor, u16 device,
			const struct snd_pci_quirk *list)
{
	return NULL;
}
#endif

#endif /* __SOUND_CORE_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       #ifndef _ACI_H_
#define _ACI_H_

#define ACI_REG_COMMAND		0	/* write register offset */
#define ACI_REG_STATUS		1	/* read register offset */
#define ACI_REG_BUSY		2	/* busy register offset */
#define ACI_REG_RDS		2	/* PCM20: RDS register offset */
#define ACI_MINTIME		500	/* ACI time out limit */

#define ACI_SET_MUTE		0x0d
#define ACI_SET_POWERAMP	0x0f
#define ACI_SET_TUNERMUTE	0xa3
#define ACI_SET_TUNERMONO	0xa4
#define ACI_SET_IDE		0xd0
#define ACI_SET_WSS		0xd1
#define ACI_SET_SOLOMODE	0xd2
#define ACI_SET_PREAMP		0x03
#define ACI_GET_PREAMP		0x21
#define ACI_WRITE_TUNE		0xa7
#define ACI_READ_TUNERSTEREO	0xa8
#define ACI_READ_TUNERSTATION	0xa9
#define ACI_READ_VERSION	0xf1
#define ACI_READ_IDCODE		0xf2
#define ACI_INIT		0xff
#define ACI_STATUS		0xf0
#define ACI_S_GENERAL		0x00
#define ACI_ERROR_OP		0xdf

/* ACI Mixer */

/* These are the values for the right channel GET registers.
   Add an offset of 0x01 for the left channel register.
   (left=right+0x01) */

#define ACI_GET_MASTER		0x03
#define ACI_GET_MIC		0x05
#define ACI_GET_LINE		0x07
#define ACI_GET_CD		0x09
#define ACI_GET_SYNTH		0x0b
#define ACI_GET_PCM		0x0d
#define ACI_GET_LINE1		0x10	/* Radio on PCM20 */
#define ACI_GET_LINE2		0x12

#define ACI_GET_EQ1		0x22	/* from Bass ... */
#define ACI_GET_EQ2		0x24
#define ACI_GET_EQ3		0x26
#define ACI_GET_EQ4		0x28
#define ACI_GET_EQ5		0x2a
#define ACI_GET_EQ6		0x2c
#define ACI_GET_EQ7		0x2e	/* ... to Treble */

/* And these are the values for the right channel SET registers.
   For left channel access you have to add an offset of 0x08.
   MASTER is an exception, which needs an offset of 0x01 */

#define ACI_SET_MASTER		0x00
#define ACI_SET_MIC		0x30
#define ACI_SET_LINE		0x31
#define ACI_SET_CD		0x34
#define ACI_SET_SYNTH		0x33
#define ACI_SET_PCM		0x32
#define ACI_SET_LINE1		0x35	/* Radio on PCM20 */
#define ACI_SET_LINE2		0x36

#define ACI_SET_EQ1		0x40	/* from Bass ... */
#define ACI_SET_EQ2		0x41
#define ACI_SET_EQ3		0x42
#define ACI_SET_EQ4		0x43
#define ACI_SET_EQ5		0x44
#define ACI_SET_EQ6		0x45
#define ACI_SET_EQ7		0x46	/* ... to Treble */

struct snd_miro_aci {
	unsigned long aci_port;
	int aci_vendor;
	int aci_product;
	int aci_version;
	int aci_amp;
	int aci_preamp;
	int aci_solomode;

	struct mutex aci_mutex;
};

int snd_aci_cmd(struct snd_miro_aci *aci, int write1, int write2, int write3);

struct snd_miro_aci *snd_aci_get_aci(void);

#endif  /* _ACI_H_ */

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #ifndef __SOUND_AK4113_H
#define __SOUND_AK4113_H

/*
 *  Routines for Asahi Kasei AK4113
 *  Copyright (c) by Jaroslav Kysela <perex@perex.cz>,
 *  Copyright (c) by Pavel Hofman <pavel.hofman@ivitera.com>,
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

/* AK4113 registers */
/* power down */
#define AK4113_REG_PWRDN	0x00
/* format control */
#define AK4113_REG_FORMAT	0x01
/* input/output control */
#define AK4113_REG_IO0		0x02
/* input/output control */
#define AK4113_REG_IO1		0x03
/* interrupt0 mask */
#define AK4113_REG_INT0_MASK	0x04
/* interrupt1 mask */
#define AK4113_REG_INT1_MASK	0x05
/* DAT mask & DTS select */
#define AK4113_REG_DATDTS	0x06
/* receiver status 0 */
#define AK4113_REG_RCS0		0x07
/* receiver status 1 */
#define AK4113_REG_RCS1		0x08
/* receiver status 2 */
#define AK4113_REG_RCS2		0x09
/* RX channel status byte 0 */
#define AK4113_REG_RXCSB0	0x0a
/* RX channel status byte 1 */
#define AK4113_REG_RXCSB1	0x0b
/* RX channel status byte 2 */
#define AK4113_REG_RXCSB2	0x0c
/* RX channel status byte 3 */
#define AK4113_REG_RXCSB3	0x0d
/* RX channel status byte 4 */
#define AK4113_REG_RXCSB4	0x0e
/* burst preamble Pc byte 0 */
#define AK4113_REG_Pc0		0x0f
/* burst preamble Pc byte 1 */
#define AK4113_REG_Pc1		0x10
/* burst preamble Pd byte 0 */
#define AK4113_REG_Pd0		0x11
/* burst preamble Pd byte 1 */
#define AK4113_REG_Pd1		0x12
/* Q-subcode address + control */
#define AK4113_REG_QSUB_ADDR	0x13
/* Q-subcode track */
#define AK4113_REG_QSUB_TRACK	0x14
/* Q-subcode index */
#define AK4113_REG_QSUB_INDEX	0x15
/* Q-subcode minute */
#define AK4113_REG_QSUB_MINUTE	0x16
/* Q-subcode second */
#define AK4113_REG_QSUB_SECOND	0x17
/* Q-subcode frame */
#define AK4113_REG_QSUB_FRAME	0x18
/* Q-subcode zero */
#define AK4113_REG_QSUB_ZERO	0x19
/* Q-subcode absolute minute */
#define AK4113_REG_QSUB_ABSMIN	0x1a
/* Q-subcode absolute second */
#define AK4113_REG_QSUB_ABSSEC	0x1b
/* Q-subcode absolute frame */
#define AK4113_REG_QSUB_ABSFRM	0x1c

/* sizes */
#define AK4113_REG_RXCSB_SIZE	((AK4113_REG_RXCSB4-AK4113_REG_RXCSB0)+1)
#define AK4113_REG_QSUB_SIZE	((AK4113_REG_QSUB_ABSFRM-AK4113_REG_QSUB_ADDR)\
		+1)

#define AK4113_WRITABLE_REGS	(AK4113_REG_DATDTS + 1)

/* AK4113_REG_PWRDN bits */
/* Channel Status Select */
#define AK4113_CS12		(1<<7)
/* Block Start & C/U Output Mode */
#define AK4113_BCU		(1<<6)
/* Master Clock Operation Select */
#define AK4113_CM1		(1<<5)
/* Master Clock Operation Select */
#define AK4113_CM0		(1<<4)
/* Master Clock Frequency Select */
#define AK4113_OCKS1		(1<<3)
/* Master Clock Frequency Select */
#define AK4113_OCKS0		(1<<2)
/* 0 = power down, 1 = normal operation */
#define AK4113_PWN		(1<<1)
/* 0 = reset & initialize (except thisregister), 1 = normal operation */
#define AK4113_RST		(1<<0)

/* AK4113_REQ_FORMAT bits */
/* V/TX Output select: 0 = Validity Flag Output, 1 = TX */
#define AK4113_VTX		(1<<7)
/* Audio Data Control */
#define AK4113_DIF2		(1<<6)
/* Audio Data Control */
#define AK4113_DIF1		(1<<5)
/* Audio Data Control */
#define AK4113_DIF0		(1<<4)
/* Deemphasis Autodetect Enable (1 = enable) */
#define AK4113_DEAU		(1<<3)
/* 32kHz-48kHz Deemphasis Control */
#define AK4113_DEM1		(1<<2)
/* 32kHz-48kHz Deemphasis Control */
#define AK4113_DEM0		(1<<1)
#define AK4113_DEM_OFF		(AK4113_DEM0)
#define AK4113_DEM_44KHZ	(0)
#define AK4113_DEM_48KHZ	(AK4113_DEM1)
#define AK4113_DEM_32KHZ	(AK4113_DEM0|AK4113_DEM1)
/* STDO: 16-bit, right justified */
#define AK4113_DIF_16R		(0)
/* STDO: 18-bit, right justified */
#define AK4113_DIF_18R		(AK4113_DIF0)
/* STDO: 20-bit, right justified */
#define AK4113_DIF_20R		(AK4113_DIF1)
/* STDO: 24-bit, right justified */
#define AK4113_DIF_24R		(AK4113_DIF1|AK4113_DIF0)
/* STDO: 24-bit, left justified */
#define AK4113_DIF_24L		(AK4113_DIF2)
/* STDO: I2S */
#define AK4113_DIF_24I2S	(AK4113_DIF2|AK4113_DIF0)
/* STDO: 24-bit, left justified; LRCLK, BICK = Input */
#define AK4113_DIF_I24L		(AK4113_DIF2|AK4113_DIF1)
/* STDO: I2S;  LRCLK, BICK = Input */
#define AK4113_DIF_I24I2S	(AK4113_DIF2|AK4113_DIF1|AK4113_DIF0)

/* AK4113_REG_IO0 */
/* XTL1=0,XTL0=0 -> 11.2896Mhz; XTL1=0,XTL0=1 -> 12.288Mhz */
#define AK4113_XTL1		(1<<6)
/* XTL1=1,XTL0=0 -> 24.576Mhz; XTL1=1,XTL0=1 -> use channel status */
#define AK4113_XTL0		(1<<5)
/* Block Start Signal Output: 0 = U-bit, 1 = C-bit (req. BCU = 1) */
#define AK4113_UCE		(1<<4)
/* TX Output Enable (1 = enable) */
#define AK4113_TXE		(1<<3)
/* Output Through Data Selector for TX pin */
#define AK4113_OPS2		(1<<2)
/* Output Through Data Selector for TX pin */
#define AK4113_OPS1		(1<<1)
/* Output Through Data Selector for TX pin */
#define AK4113_OPS0		(1<<0)
/* 11.2896 MHz ref. Xtal freq. */
#define AK4113_XTL_11_2896M	(0)
/* 12.288 MHz ref. Xtal freq. */
#define AK4113_XTL_12_288M	(AK4113_XTL0)
/* 24.576 MHz ref. Xtal freq. */
#define AK4113_XTL_24_576M	(AK4113_XTL1)

/* AK4113_REG_IO1 */
/* Interrupt 0 pin Hold */
#define AK4113_EFH1		(1<<7)
/* Interrupt 0 pin Hold */
#define AK4113_EFH0		(1<<6)
#define AK4113_EFH_512LRCLK	(0)
#define AK4113_EFH_1024LRCLK	(AK4113_EFH0)
#define AK4113_EFH_2048LRCLK	(AK4113_EFH1)
#define AK4113_EFH_4096LRCLK	(AK4113_EFH1|AK4113_EFH0)
/* PLL Lock Time: 0 = 384/fs, 1 = 1/fs */
#define AK4113_FAST		(1<<5)
/* MCKO2 Output Select: 0 = CMx/OCKSx, 1 = Xtal */
#define AK4113_XMCK		(1<<4)
/* MCKO2 Output Freq. Select: 0 = x1, 1 = x0.5  (req. XMCK = 1) */
#define AK4113_DIV		(1<<3)
/* Input Recovery Data Select */
#define AK4113_IPS2		(1<<2)
/* Input Recovery Data Select */
#define AK4113_IPS1		(1<<1)
/* Input Recovery Data Select */
#define AK4113_IPS0		(1<<0)
#define AK4113_IPS(x)		((x)&7)

/* AK4113_REG_INT0_MASK && AK4113_REG_INT1_MASK*/
/* mask enable for QINT bit */
#define AK4113_MQI		(1<<7)
/* mask enable for AUTO bit */
#define AK4113_MAUT		(1<<6)
/* mask enable for CINT bit */
#define AK4113_MCIT		(1<<5)
/* mask enable for UNLOCK bit */
#define AK4113_MULK		(1<<4)
/* mask enable for V bit */
#define AK4113_V		(1<<3)
/* mask enable for STC bit */
#define AK4113_STC		(1<<2)
/* mask enable for AUDN bit */
#define AK4113_MAN		(1<<1)
/* mask enable for PAR bit */
#define AK4113_MPR		(1<<0)

/* AK4113_REG_DATDTS */
/* DAT Start ID Counter */
#define AK4113_DCNT		(1<<4)
/* DTS-CD 16-bit Sync Word Detect */
#define AK4113_DTS16		(1<<3)
/* DTS-CD 14-bit Sync Word Detect */
#define AK4113_DTS14		(1<<2)
/* mask enable for DAT bit (if 1, no INT1 effect */
#define AK4113_MDAT1		(1<<1)
/* mask enable for DAT bit (if 1, no INT0 effect */
#define AK4113_MDAT0		(1<<0)

/* AK4113_REG_RCS0 */
/* Q-subcode buffer interrupt, 0 = no change, 1 = changed */
#define AK4113_QINT		(1<<7)
/* Non-PCM or DTS stream auto detection, 0 = no detect, 1 = detect */
#define AK4113_AUTO		(1<<6)
/* channel status buffer interrupt, 0 = no change, 1 = change */
#define AK4113_CINT		(1<<5)
/* PLL lock status, 0 = lock, 1 = unlock */
#define AK4113_UNLCK		(1<<4)
/* Validity bit, 0 = valid, 1 = invalid */
#define AK4113_V		(1<<3)
/* sampling frequency or Pre-emphasis change, 0 = no detect, 1 = detect */
#define AK4113_STC		(1<<2)
/* audio bit output, 0 = audio, 1 = non-audio */
#define AK4113_AUDION		(1<<1)
/* parity error or biphase error status, 0 = no error, 1 = error */
#define AK4113_PAR		(1<<0)

/* AK4113_REG_RCS1 */
/* sampling frequency detection */
#define AK4113_FS3		(1<<7)
#define AK4113_FS2		(1<<6)
#define AK4113_FS1		(1<<5)
#define AK4113_FS0		(1<<4)
/* Pre-emphasis detect, 0 = OFF, 1 = ON */
#define AK4113_PEM		(1<<3)
/* DAT Start ID Detect, 0 = no detect, 1 = detect */
#define AK4113_DAT		(1<<2)
/* DTS-CD bit audio stream detect, 0 = no detect, 1 = detect */
#define AK4113_DTSCD		(1<<1)
/* Non-PCM bit stream detection, 0 = no detect, 1 = detect */
#define AK4113_NPCM		(1<<0)
#define AK4113_FS_8000HZ	(AK4113_FS3|AK4113_FS0)
#define AK4113_FS_11025HZ	(AK4113_FS2|AK4113_FS0)
#define AK4113_FS_16000HZ	(AK4113_FS2|AK4113_FS1|AK4113_FS0)
#define AK4113_FS_22050HZ	(AK4113_FS2)
#define AK4113_FS_24000HZ	(AK4113_FS2|AK4113_FS1)
#define AK4113_FS_32000HZ	(AK4113_FS1|AK4113_FS0)
#define AK4113_FS_44100HZ	(0)
#define AK4113_FS_48000HZ	(AK4113_FS1)
#define AK4113_FS_64000HZ	(AK4113_FS3|AK4113_FS1|AK4113_FS0)
#define AK4113_FS_88200HZ	(AK4113_FS3)
#define AK4113_FS_96000HZ	(AK4113_FS3|AK4113_FS1)
#define AK4113_FS_176400HZ	(AK4113_FS3|AK4113_FS2)
#define AK4113_FS_192000HZ	(AK4113_FS3|AK4113_FS2|AK4113_FS1)

/* AK4113_REG_RCS2 */
/* CRC for Q-subcode, 0 = no error, 1 = error */
#define AK4113_QCRC		(1<<1)
/* CRC for channel status, 0 = no error, 1 = error */
#define AK4113_CCRC		(1<<0)

/* flags for snd_ak4113_check_rate_and_errors() */
#define AK4113_CHECK_NO_STAT	(1<<0)	/* no statistics */
#define AK4113_CHECK_NO_RATE	(1<<1)	/* no rate check */

#define AK4113_CONTROLS		13

typedef void (ak4113_write_t)(void *private_data, unsigned char addr,
		unsigned char data);
typedef unsigned char (ak4113_read_t)(void *private_data, unsigned char addr);

struct ak4113 {
	struct snd_card *card;
	ak4113_write_t *write;
	ak4113_read_t *read;
	void *private_data;
	atomic_t wq_processing;
	struct mutex reinit_mutex;
	spinlock_t lock;
	unsigned char regmap[AK4113_WRITABLE_REGS];
	struct snd_kcontrol *kctls[AK4113_CONTROLS];
	struct snd_pcm_substream *substream;
	unsigned long parity_errors;
	unsigned long v_bit_errors;
	unsigned long qcrc_errors;
	unsigned long ccrc_errors;
	unsigned char rcs0;
	unsigned char rcs1;
	unsigned char rcs2;
	struct delayed_work work;
	unsigned int check_flags;
	void *change_callback_private;
	void (*change_callback)(struct ak4113 *ak4113, unsigned char c0,
			unsigned char c1);
};

int snd_ak4113_create(struct snd_card *card, ak4113_read_t *read,
		ak4113_write_t *write,
		const unsigned char *pgm,
		void *private_data, struct ak4113 **r_ak4113);
void snd_ak4113_reg_write(struct ak4113 *ak4113, unsigned char reg,
		unsigned char mask, unsigned char val);
void snd_ak4113_reinit(struct ak4113 *ak4113);
int snd_ak4113_build(struct ak4113 *ak4113,
		struct snd_pcm_substream *capture_substream);
int snd_ak4113_external_rate(struct ak4113 *ak4113);
int snd_ak4113_check_rate_and_errors(struct ak4113 *ak4113, unsigned int flags);

#ifdef CONFIG_PM
void snd_ak4113_suspend(struct ak4113 *chip);
void snd_ak4113_resume(struct ak4113 *chip);
#else
static inline void snd_ak4113_suspend(struct ak4113 *chip) {}
static inline void snd_ak4113_resume(struct ak4113 *chip) {}
#endif

#endif /* __SOUND_AK4113_H */

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xenomai: include/cobalt/kernel/schedparam.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Xenomai"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xenomai
   &#160;<span id="projectnumber">3.0.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('schedparam_8h_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">schedparam.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2008 Philippe Gerum &lt;rpm@xenomai.org&gt;.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Xenomai is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * by the Free Software Foundation; either version 2 of the License,</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * or (at your option) any later version.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Xenomai is distributed in the hope that it will be useful, but</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * General Public License for more details.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with Xenomai; if not, write to the Free Software</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * 02111-1307, USA.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#ifndef _COBALT_KERNEL_SCHEDPARAM_H</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#define _COBALT_KERNEL_SCHEDPARAM_H</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">struct </span>xnsched_idle_param {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keywordtype">int</span> prio;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;};</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">struct </span>xnsched_weak_param {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordtype">int</span> prio;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;};</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">struct </span>xnsched_rt_param {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keywordtype">int</span> prio;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;};</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">struct </span>xnsched_tp_param {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordtype">int</span> prio;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordtype">int</span> ptid;       <span class="comment">/* partition id. */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;};</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">struct </span>xnsched_sporadic_param {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        xnticks_t init_budget;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        xnticks_t repl_period;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordtype">int</span> max_repl;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordtype">int</span> low_prio;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordtype">int</span> normal_prio;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordtype">int</span> current_prio;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;};</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">struct </span>xnsched_quota_param {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordtype">int</span> prio;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordtype">int</span> tgid;       <span class="comment">/* thread group id. */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;};</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">union </span>xnsched_policy_param {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">struct </span>xnsched_idle_param idle;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keyword">struct </span>xnsched_rt_param rt;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#ifdef CONFIG_XENO_OPT_SCHED_WEAK</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keyword">struct </span>xnsched_weak_param weak;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#ifdef CONFIG_XENO_OPT_SCHED_TP</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keyword">struct </span>xnsched_tp_param tp;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#ifdef CONFIG_XENO_OPT_SCHED_SPORADIC</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keyword">struct </span>xnsched_sporadic_param pss;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#ifdef CONFIG_XENO_OPT_SCHED_QUOTA</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keyword">struct </span>xnsched_quota_param quota;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;};</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !_COBALT_KERNEL_SCHEDPARAM_H */</span><span class="preprocessor"></span></div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_727d51ab6cd8bd91d7c75c1be5676510.html">cobalt</a></li><li class="navelem"><a class="el" href="dir_cf5678a09d30c4a64d8efd3e7841e31a.html">kernel</a></li><li class="navelem"><b>schedparam.h</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0     rbcomm|IBM PC with RBcomm and EMACS keybindings            P           ! 9 ; B D K M O Q S X ] ^ _ a f h j l u y z { }                      [Z   [%i%p1%d;%p2%dr   5 %p2%' '%+%c%p1%' '%+%c  [?25l  [?25h     [5m [1m    [8m    [%p1%dX [m      (B)0[?7h[?3l[>8g        > = D [%p1%dM [%p1%dL %p1%c%p2%c (B)0[?3l[>8g 8 7 D M 	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    )@rcons|BSD rasterconsole              P "      
   ! # ' + / 3 8 = A E I M O Q U \ c j q x                    '.5:   [K [J [%i%p1%d;%p2%dH 
  [C [A [P [M [7m [7m [m [m [@ [L   [B [224z [233z [225z [226z [227z [228z [229z [230z [231z [232z [214z [247z [D [222z [216z [C [A [%p1%dP [%p1%dM [%p1%d@ [%p1%dL [s 
 [0%?%p1%p3%|%t;7%;m 	 [218z [220z [194z [193z [195z [234z [235z [1t [11t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     #ifndef __SOUND_I2C_H
#define __SOUND_I2C_H

/*
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 *
 */

#define SND_I2C_DEVICE_ADDRTEN	(1<<0)	/* 10-bit I2C address */

struct snd_i2c_device {
	struct list_head list;
	struct snd_i2c_bus *bus;	/* I2C bus */
	char name[32];		/* some useful device name */
	unsigned short flags;	/* device flags */
	unsigned short addr;	/* device address (might be 10-bit) */
	unsigned long private_value;
	void *private_data;
	void (*private_free)(struct snd_i2c_device *device);
};

#define snd_i2c_device(n) list_entry(n, struct snd_i2c_device, list)

struct snd_i2c_bit_ops {
	void (*start)(struct snd_i2c_bus *bus);	/* transfer start */
	void (*stop)(struct snd_i2c_bus *bus);	/* transfer stop */
	void (*direction)(struct snd_i2c_bus *bus, int clock, int data);  /* set line direction (0 = write, 1 = read) */
	void (*setlines)(struct snd_i2c_bus *bus, int clock, int data);
	int (*getclock)(struct snd_i2c_bus *bus);
	int (*getdata)(struct snd_i2c_bus *bus, int ack);
};

struct snd_i2c_ops {
	int (*sendbytes)(struct snd_i2c_device *device, unsigned char *bytes, int count);
	int (*readbytes)(struct snd_i2c_device *device, unsigned char *bytes, int count);
	int (*probeaddr)(struct snd_i2c_bus *bus, unsigned short addr);
};

struct snd_i2c_bus {
	struct snd_card *card;	/* card which I2C belongs to */
	char name[32];		/* some useful label */

	struct mutex lock_mutex;

	struct snd_i2c_bus *master;	/* master bus when SCK/SCL is shared */
	struct list_head buses;	/* master: slave buses sharing SCK/SCL, slave: link list */

	struct list_head devices; /* attached devices to this bus */

	union {
		struct snd_i2c_bit_ops *bit;
		void *ops;
	} hw_ops;		/* lowlevel operations */
	struct snd_i2c_ops *ops;	/* midlevel operations */

	unsigned long private_value;
	void *private_data;
	void (*private_free)(struct snd_i2c_bus *bus);
};

#define snd_i2c_slave_bus(n) list_entry(n, struct snd_i2c_bus, buses)

int snd_i2c_bus_create(struct snd_card *card, const char *name,
		       struct snd_i2c_bus *master, struct snd_i2c_bus **ri2c);
int snd_i2c_device_create(struct snd_i2c_bus *bus, const char *name,
			  unsigned char addr, struct snd_i2c_device **rdevice);
int snd_i2c_device_free(struct snd_i2c_device *device);

static inline void snd_i2c_lock(struct snd_i2c_bus *bus)
{
	if (bus->master)
		mutex_lock(&bus->master->lock_mutex);
	else
		mutex_lock(&bus->lock_mutex);
}

static inline void snd_i2c_unlock(struct snd_i2c_bus *bus)
{
	if (bus->master)
		mutex_unlock(&bus->master->lock_mutex);
	else
		mutex_unlock(&bus->lock_mutex);
}

int snd_i2c_sendbytes(struct snd_i2c_device *device, unsigned char *bytes, int count);
int snd_i2c_readbytes(struct snd_i2c_device *device, unsigned char *bytes, int count);
int snd_i2c_probeaddr(struct snd_i2c_bus *bus, unsigned short addr);

#endif /* __SOUND_I2C_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   #ifndef __SOUND_AC97_CODEC_H
#define __SOUND_AC97_CODEC_H

/*
 *  Copyright (c) by Jaroslav Kysela <perex@perex.cz>
 *  Universal interface for Audio Codec '97
 *
 *  For more details look to AC '97 component specification revision 2.1
 *  by Intel Corporation (http://developer.intel.com).
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

#include <linux/bitops.h>
#include <linux/device.h>
#include <linux/workqueue.h>
#include <sound/pcm.h>
#include <sound/control.h>
#include <sound/info.h>

/* maximum number of devices on the AC97 bus */
#define	AC97_BUS_MAX_DEVICES	4

/*
 *  AC'97 codec registers
 */

#define AC97_RESET		0x00	/* Reset */
#define AC97_MASTER		0x02	/* Master Volume */
#define AC97_HEADPHONE		0x04	/* Headphone Volume (optional) */
#define AC97_MASTER_MONO	0x06	/* Master Volume Mono (optional) */
#define AC97_MASTER_TONE	0x08	/* Master Tone (Bass & Treble) (optional) */
#define AC97_PC_BEEP		0x0a	/* PC Beep Volume (optinal) */
#define AC97_PHONE		0x0c	/* Phone Volume (optional) */
#define AC97_MIC		0x0e	/* MIC Volume */
#define AC97_LINE		0x10	/* Line In Volume */
#define AC97_CD			0x12	/* CD Volume */
#define AC97_VIDEO		0x14	/* Video Volume (optional) */
#define AC97_AUX		0x16	/* AUX Volume (optional) */
#define AC97_PCM		0x18	/* PCM Volume */
#define AC97_REC_SEL		0x1a	/* Record Select */
#define AC97_REC_GAIN		0x1c	/* Record Gain */
#define AC97_REC_GAIN_MIC	0x1e	/* Record Gain MIC (optional) */
#define AC97_GENERAL_PURPOSE	0x20	/* General Purpose (optional) */
#define AC97_3D_CONTROL		0x22	/* 3D Control (optional) */
#define AC97_INT_PAGING		0x24	/* Audio Interrupt & Paging (AC'97 2.3) */
#define AC97_POWERDOWN		0x26	/* Powerdown control / status */
/* range 0x28-0x3a - AUDIO AC'97 2.0 extensions */
#define AC97_EXTENDED_ID	0x28	/* Extended Audio ID */
#define AC97_EXTENDED_STATUS	0x2a	/* Extended Audio Status and Control */
#define AC97_PCM_FRONT_DAC_RATE 0x2c	/* PCM Front DAC Rate */
#define AC97_PCM_SURR_DAC_RATE	0x2e	/* PCM Surround DAC Rate */
#define AC97_PCM_LFE_DAC_RATE	0x30	/* PCM LFE DAC Rate */
#define AC97_PCM_LR_ADC_RATE	0x32	/* PCM LR ADC Rate */
#define AC97_PCM_MIC_ADC_RATE	0x34	/* PCM MIC ADC Rate */
#define AC97_CENTER_LFE_MASTER	0x36	/* Center + LFE Master Volume */
#define AC97_SURROUND_MASTER	0x38	/* Surround (Rear) Master Volume */
#define AC97_SPDIF		0x3a	/* S/PDIF control */
/* range 0x3c-0x58 - MODEM */
#define AC97_EXTENDED_MID	0x3c	/* Extended Modem ID */
#define AC97_EXTENDED_MSTATUS	0x3e	/* Extended Modem Status and Control */
#define AC97_LINE1_RATE		0x40	/* Line1 DAC/ADC Rate */
#define AC97_LINE2_RATE		0x42	/* Line2 DAC/ADC Rate */
#define AC97_HANDSET_RATE	0x44	/* Handset DAC/ADC Rate */
#define AC97_LINE1_LEVEL	0x46	/* Line1 DAC/ADC Level */
#define AC97_LINE2_LEVEL	0x48	/* Line2 DAC/ADC Level */
#define AC97_HANDSET_LEVEL	0x4a	/* Handset DAC/ADC Level */
#define AC97_GPIO_CFG		0x4c	/* GPIO Configuration */
#define AC97_GPIO_POLARITY	0x4e	/* GPIO Pin Polarity/Type, 0=low, 1=high active */
#define AC97_GPIO_STICKY	0x50	/* GPIO Pin Sticky, 0=not, 1=sticky */
#define AC97_GPIO_WAKEUP	0x52	/* GPIO Pin Wakeup, 0=no int, 1=yes int */
#define AC97_GPIO_STATUS	0x54	/* GPIO Pin Status, slot 12 */
#define AC97_MISC_AFE		0x56	/* Miscellaneous Modem AFE Status and Control */
/* range 0x5a-0x7b - Vendor Specific */
#define AC97_VENDOR_ID1		0x7c	/* Vendor ID1 */
#define AC97_VENDOR_ID2		0x7e	/* Vendor ID2 / revision */
/* range 0x60-0x6f (page 1) - extended codec registers */
#define AC97_CODEC_CLASS_REV	0x60	/* Codec Class/Revision */
#define AC97_PCI_SVID		0x62	/* PCI Subsystem Vendor ID */
#define AC97_PCI_SID		0x64	/* PCI Subsystem ID */
#define AC97_FUNC_SELECT	0x66	/* Function Select */
#define AC97_FUNC_INFO		0x68	/* Function Information */
#define AC97_SENSE_INFO		0x6a	/* Sense Details */

/* volume controls */
#define AC97_MUTE_MASK_MONO	0x8000
#define AC97_MUTE_MASK_STEREO	0x8080

/* slot allocation */
#define AC97_SLOT_TAG		0
#define AC97_SLOT_CMD_ADDR	1
#define AC97_SLOT_CMD_DATA	2
#define AC97_SLOT_PCM_LEFT	3
#define AC97_SLOT_PCM_RIGHT	4
#define AC97_SLOT_MODEM_LINE1	5
#define AC97_SLOT_PCM_CENTER	6
#define AC97_SLOT_MIC		6	/* input */
#define AC97_SLOT_SPDIF_LEFT1	6
#define AC97_SLOT_PCM_SLEFT	7	/* surround left */
#define AC97_SLOT_PCM_LEFT_0	7	/* double rate operation */
#define AC97_SLOT_SPDIF_LEFT	7
#define AC97_SLOT_PCM_SRIGHT	8	/* surround right */
#define AC97_SLOT_PCM_RIGHT_0	8	/* double rate operation */
#define AC97_SLOT_SPDIF_RIGHT	8
#define AC97_SLOT_LFE		9
#define AC97_SLOT_SPDIF_RIGHT1	9
#define AC97_SLOT_MODEM_LINE2	10
#define AC97_SLOT_PCM_LEFT_1	10	/* double rate operation */
#define AC97_SLOT_SPDIF_LEFT2	10
#define AC97_SLOT_HANDSET	11	/* output */
#define AC97_SLOT_PCM_RIGHT_1	11	/* double rate operation */
#define AC97_SLOT_SPDIF_RIGHT2	11
#define AC97_SLOT_MODEM_GPIO	12	/* modem GPIO */
#define AC97_SLOT_PCM_CENTER_1	12	/* double rate operation */

/* basic capabilities (reset register) */
#define AC97_BC_DEDICATED_MIC	0x0001	/* Dedicated Mic PCM In Channel */
#define AC97_BC_RESERVED1	0x0002	/* Reserved (was Modem Line Codec support) */
#define AC97_BC_BASS_TREBLE	0x0004	/* Bass & Treble Control */
#define AC97_BC_SIM_STEREO	0x0008	/* Simulated stereo */
#define AC97_BC_HEADPHONE	0x0010	/* Headphone Out Support */
#define AC97_BC_LOUDNESS	0x0020	/* Loudness (bass boost) Support */
#define AC97_BC_16BIT_DAC	0x0000	/* 16-bit DAC resolution */
#define AC97_BC_18BIT_DAC	0x0040	/* 18-bit DAC resolution */
#define AC97_BC_20BIT_DAC	0x0080	/* 20-bit DAC resolution */
#define AC97_BC_DAC_MASK	0x00c0
#define AC97_BC_16BIT_ADC	0x0000	/* 16-bit ADC resolution */
#define AC97_BC_18BIT_ADC	0x0100	/* 18-bit ADC resolution */
#define AC97_BC_20BIT_ADC	0x0200	/* 20-bit ADC resolution */
#define AC97_BC_ADC_MASK	0x0300
#define AC97_BC_3D_TECH_ID_MASK	0x7c00	/* Per-vendor ID of 3D enhancement */

/* general purpose */
#define AC97_GP_DRSS_MASK	0x0c00	/* double rate slot select */
#define AC97_GP_DRSS_1011	0x0000	/* LR(C) 10+11(+12) */
#define AC97_GP_DRSS_78		0x0400	/* LR 7+8 */

/* powerdown bits */
#define AC97_PD_ADC_STATUS	0x0001	/* ADC status (RO) */
#define AC97_PD_DAC_STATUS	0x0002	/* DAC status (RO) */
#define AC97_PD_MIXER_STATUS	0x0004	/* Analog mixer status (RO) */
#define AC97_PD_VREF_STATUS	0x0008	/* Vref status (RO) */
#define AC97_PD_PR0		0x0100	/* Power down PCM ADCs and input MUX */
#define AC97_PD_PR1		0x0200	/* Power down PCM front DAC */
#define AC97_PD_PR2		0x0400	/* Power down Mixer (Vref still on) */
#define AC97_PD_PR3		0x0800	/* Power down Mixer (Vref off) */
#define AC97_PD_PR4		0x1000	/* Power down AC-Link */
#define AC97_PD_PR5		0x2000	/* Disable internal clock usage */
#define AC97_PD_PR6		0x4000	/* Headphone amplifier */
#define AC97_PD_EAPD		0x8000	/* External Amplifer Power Down (EAPD) */

/* extended audio ID bit defines */
#define AC97_EI_VRA		0x0001	/* Variable bit rate supported */
#define AC97_EI_DRA		0x0002	/* Double rate supported */
#define AC97_EI_SPDIF		0x0004	/* S/PDIF out supported */
#define AC97_EI_VRM		0x0008	/* Variable bit rate supported for MIC */
#define AC97_EI_DACS_SLOT_MASK	0x0030	/* DACs slot assignment */
#define AC97_EI_DACS_SLOT_SHIFT	4
#define AC97_EI_CDAC		0x0040	/* PCM Center DAC available */
#define AC97_EI_SDAC		0x0080	/* PCM Surround DACs available */
#define AC97_EI_LDAC		0x0100	/* PCM LFE DAC available */
#define AC97_EI_AMAP		0x0200	/* indicates optional slot/DAC mapping based on codec ID */
#define AC97_EI_REV_MASK	0x0c00	/* AC'97 revision mask */
#define AC97_EI_REV_22		0x0400	/* AC'97 revision 2.2 */
#define AC97_EI_REV_23		0x0800	/* AC'97 revision 2.3 */
#define AC97_EI_REV_SHIFT	10
#define AC97_EI_ADDR_MASK	0xc000	/* physical codec ID (address) */
#define AC97_EI_ADDR_SHIFT	14

/* extended audio status and control bit defines */
#define AC97_EA_VRA		0x0001	/* Variable bit rate enable bit */
#define AC97_EA_DRA		0x0002	/* Double-rate audio enable bit */
#define AC97_EA_SPDIF		0x0004	/* S/PDIF out enable bit */
#define AC97_EA_VRM		0x0008	/* Variable bit rate for MIC enable bit */
#define AC97_EA_SPSA_SLOT_MASK	0x0030	/* Mask for slot assignment bits */
#define AC97_EA_SPSA_SLOT_SHIFT 4
#define AC97_EA_SPSA_3_4	0x0000	/* Slot assigned to 3 & 4 */
#define AC97_EA_SPSA_7_8	0x0010	/* Slot assigned to 7 & 8 */
#define AC97_EA_SPSA_6_9	0x0020	/* Slot assigned to 6 & 9 */
#define AC97_EA_SPSA_10_11	0x0030	/* Slot assigned to 10 & 11 */
#define AC97_EA_CDAC		0x0040	/* PCM Center DAC is ready (Read only) */
#define AC97_EA_SDAC		0x0080	/* PCM Surround DACs are ready (Read only) */
#define AC97_EA_LDAC		0x0100	/* PCM LFE DAC is ready (Read only) */
#define AC97_EA_MDAC		0x0200	/* MIC ADC is ready (Read only) */
#define AC97_EA_SPCV		0x0400	/* S/PDIF configuration valid (Read only) */
#define AC97_EA_PRI		0x0800	/* Turns the PCM Center DAC off */
#define AC97_EA_PRJ		0x1000	/* Turns the PCM Surround DACs off */
#define AC97_EA_PRK		0x2000	/* Turns the PCM LFE DAC off */
#define AC97_EA_PRL		0x4000	/* Turns the MIC ADC off */

/* S/PDIF control bit defines */
#define AC97_SC_PRO		0x0001	/* Professional status */
#define AC97_SC_NAUDIO		0x0002	/* Non audio stream */
#define AC97_SC_COPY		0x0004	/* Copyright status */
#define AC97_SC_PRE		0x0008	/* Preemphasis status */
#define AC97_SC_CC_MASK		0x07f0	/* Category Code mask */
#define AC97_SC_CC_SHIFT	4
#define AC97_SC_L		0x0800	/* Generation Level status */
#define AC97_SC_SPSR_MASK	0x3000	/* S/PDIF Sample Rate bits */
#define AC97_SC_SPSR_SHIFT	12
#define AC97_SC_SPSR_44K	0x0000	/* Use 44.1kHz Sample rate */
#define AC97_SC_SPSR_48K	0x2000	/* Use 48kHz Sample rate */
#define AC97_SC_SPSR_32K	0x3000	/* Use 32kHz Sample rate */
#define AC97_SC_DRS		0x4000	/* Double Rate S/PDIF */
#define AC97_SC_V		0x8000	/* Validity status */

/* Interrupt and Paging bit defines (AC'97 2.3) */
#define AC97_PAGE_MASK		0x000f	/* Page Selector */
#define AC97_PAGE_VENDOR	0	/* Vendor-specific registers */
#define AC97_PAGE_1		1	/* Extended Codec Registers page 1 */
#define AC97_INT_ENABLE		0x0800	/* Interrupt Enable */
#define AC97_INT_SENSE		0x1000	/* Sense Cycle */
#define AC97_INT_CAUSE_SENSE	0x2000	/* Sense Cycle Completed (RO) */
#define AC97_INT_CAUSE_GPIO	0x4000	/* GPIO bits changed (RO) */
#define AC97_INT_STATUS		0x8000	/* Interrupt Status */

/* extended modem ID bit defines */
#define AC97_MEI_LINE1		0x0001	/* Line1 present */
#define AC97_MEI_LINE2		0x0002	/* Line2 present */
#define AC97_MEI_HANDSET	0x0004	/* Handset present */
#define AC97_MEI_CID1		0x0008	/* caller ID decode for Line1 is supported */
#define AC97_MEI_CID2		0x0010	/* caller ID decode for Line2 is supported */
#define AC97_MEI_ADDR_MASK	0xc000	/* physical codec ID (address) */
#define AC97_MEI_ADDR_SHIFT	14

/* extended modem status and control bit defines */
#define AC97_MEA_GPIO		0x0001	/* GPIO is ready (ro) */
#define AC97_MEA_MREF		0x0002	/* Vref is up to nominal level (ro) */
#define AC97_MEA_ADC1		0x0004	/* ADC1 operational (ro) */
#define AC97_MEA_DAC1		0x0008	/* DAC1 operational (ro) */
#define AC97_MEA_ADC2		0x0010	/* ADC2 operational (ro) */
#define AC97_MEA_DAC2		0x0020	/* DAC2 operational (ro) */
#define AC97_MEA_HADC		0x0040	/* HADC operational (ro) */
#define AC97_MEA_HDAC		0x0080	/* HDAC operational (ro) */
#define AC97_MEA_PRA		0x0100	/* GPIO power down (high) */
#define AC97_MEA_PRB		0x0200	/* reserved */
#define AC97_MEA_PRC		0x0400	/* ADC1 power down (high) */
#define AC97_MEA_PRD		0x0800	/* DAC1 power down (high) */
#define AC97_MEA_PRE		0x1000	/* ADC2 power down (high) */
#define AC97_MEA_PRF		0x2000	/* DAC2 power down (high) */
#define AC97_MEA_PRG		0x4000	/* HADC power down (high) */
#define AC97_MEA_PRH		0x8000	/* HDAC power down (high) */

/* modem gpio status defines */
#define AC97_GPIO_LINE1_OH      0x0001  /* Off Hook Line1 */
#define AC97_GPIO_LINE1_RI      0x0002  /* Ring Detect Line1 */
#define AC97_GPIO_LINE1_CID     0x0004  /* Caller ID path enable Line1 */
#define AC97_GPIO_LINE1_LCS     0x0008  /* Loop Current Sense Line1 */
#define AC97_GPIO_LINE1_PULSE   0x0010  /* Opt./ Pulse Dial Line1 (out) */
#define AC97_GPIO_LINE1_HL1R    0x0020  /* Opt./ Handset to Line1 relay control (out) */
#define AC97_GPIO_LINE1_HOHD    0x0040  /* Opt./ Handset off hook detect Line1 (in) */
#define AC97_GPIO_LINE12_AC     0x0080  /* Opt./ Int.bit 1 / Line1/2 AC (out) */
#define AC97_GPIO_LINE12_DC     0x0100  /* Opt./ Int.bit 2 / Line1/2 DC (out) */
#define AC97_GPIO_LINE12_RS     0x0200  /* Opt./ Int.bit 3 / Line1/2 RS (out) */
#define AC97_GPIO_LINE2_OH      0x0400  /* Off Hook Line2 */
#define AC97_GPIO_LINE2_RI      0x0800  /* Ring Detect Line2 */
#define AC97_GPIO_LINE2_CID     0x1000  /* Caller ID path enable Line2 */
#define AC97_GPIO_LINE2_LCS     0x2000  /* Loop Current Sense Line2 */
#define AC97_GPIO_LINE2_PULSE   0x4000  /* Opt./ Pulse Dial Line2 (out) */
#define AC97_GPIO_LINE2_HL1R    0x8000  /* Opt./ Handset to Line2 relay control (out) */

/* specific - SigmaTel */
#define AC97_SIGMATEL_OUTSEL	0x64	/* Output Select, STAC9758 */
#define AC97_SIGMATEL_INSEL	0x66	/* Input Select, STAC9758 */
#define AC97_SIGMATEL_IOMISC	0x68	/* STAC9758 */
#define AC97_SIGMATEL_ANALOG	0x6c	/* Analog Special */
#define AC97_SIGMATEL_DAC2INVERT 0x6e
#define AC97_SIGMATEL_BIAS1	0x70
#define AC97_SIGMATEL_BIAS2	0x72
#define AC97_SIGMATEL_VARIOUS	0x72	/* STAC9758 */
#define AC97_SIGMATEL_MULTICHN	0x74	/* Multi-Channel programming */
#define AC97_SIGMATEL_CIC1	0x76
#define AC97_SIGMATEL_CIC2	0x78

/* specific - Analog Devices */
#define AC97_AD_TEST		0x5a	/* test register */
#define AC97_AD_TEST2		0x5c	/* undocumented test register 2 */
#define AC97_AD_HPFD_SHIFT	12	/* High Pass Filter Disable */
#define AC97_AD_CODEC_CFG	0x70	/* codec configuration */
#define AC97_AD_JACK_SPDIF	0x72	/* Jack Sense & S/PDIF */
#define AC97_AD_SERIAL_CFG	0x74	/* Serial Configuration */
#define AC97_AD_MISC		0x76	/* Misc Control Bits */
#define AC97_AD_VREFD_SHIFT	2	/* V_REFOUT Disable (AD1888) */

/* specific - Cirrus Logic */
#define AC97_CSR_ACMODE		0x5e	/* AC Mode Register */
#define AC97_CSR_MISC_CRYSTAL	0x60	/* Misc Crystal Control */
#define AC97_CSR_SPDIF		0x68	/* S/PDIF Register */
#define AC97_CSR_SERIAL		0x6a	/* Serial Port Control */
#define AC97_CSR_SPECF_ADDR	0x6c	/* Special Feature Address */
#define AC97_CSR_SPECF_DATA	0x6e	/* Special Feature Data */
#define AC97_CSR_BDI_STATUS	0x7a	/* BDI Status */

/* specific - Conexant */
#define AC97_CXR_AUDIO_MISC	0x5c
#define AC97_CXR_SPDIFEN	(1<<3)
#define AC97_CXR_COPYRGT	(1<<2)
#define AC97_CXR_SPDIF_MASK	(3<<0)
#define AC97_CXR_SPDIF_PCM	0x0
#define AC97_CXR_SPDIF_AC3	0x2

/* specific - ALC */
#define AC97_ALC650_SPDIF_INPUT_STATUS1	0x60
/* S/PDIF input status 1 bit defines */
#define AC97_ALC650_PRO             0x0001  /* Professional status */
#define AC97_ALC650_NAUDIO          0x0002  /* Non audio stream */
#define AC97_ALC650_COPY            0x0004  /* Copyright status */
#define AC97_ALC650_PRE             0x0038  /* Preemphasis status */
#define AC97_ALC650_PRE_SHIFT       3
#define AC97_ALC650_MODE            0x00C0  /* Preemphasis status */
#define AC97_ALC650_MODE_SHIFT      6
#define AC97_ALC650_CC_MASK         0x7f00  /* Category Code mask */
#define AC97_ALC650_CC_SHIFT        8
#define AC97_ALC650_L               0x8000  /* Generation Level status */

#define AC97_ALC650_SPDIF_INPUT_STATUS2	0x62
/* S/PDIF input status 2 bit defines */
#define AC97_ALC650_SOUCE_MASK      0x000f  /* Source number */
#define AC97_ALC650_CHANNEL_MASK    0x00f0  /* Channel number */
#define AC97_ALC650_CHANNEL_SHIFT   4 
#define AC97_ALC650_SPSR_MASK       0x0f00  /* S/PDIF Sample Rate bits */
#define AC97_ALC650_SPSR_SHIFT      8
#define AC97_ALC650_SPSR_44K        0x0000  /* Use 44.1kHz Sample rate */
#define AC97_ALC650_SPSR_48K        0x0200  /* Use 48kHz Sample rate */
#define AC97_ALC650_SPSR_32K        0x0300  /* Use 32kHz Sample rate */
#define AC97_ALC650_CLOCK_ACCURACY  0x3000  /* Clock accuracy */
#define AC97_ALC650_CLOCK_SHIFT     12
#define AC97_ALC650_CLOCK_LOCK      0x4000  /* Clock locked status */
#define AC97_ALC650_V               0x8000  /* Validity status */

#define AC97_ALC650_SURR_DAC_VOL	0x64
#define AC97_ALC650_LFE_DAC_VOL		0x66
#define AC97_ALC650_UNKNOWN1		0x68
#define AC97_ALC650_MULTICH		0x6a
#define AC97_ALC650_UNKNOWN2		0x6c
#define AC97_ALC650_REVISION		0x6e
#define AC97_ALC650_UNKNOWN3		0x70
#define AC97_ALC650_UNKNOWN4		0x72
#define AC97_ALC650_MISC		0x74
#define AC97_ALC650_GPIO_SETUP		0x76
#define AC97_ALC650_GPIO_STATUS		0x78
#define AC97_ALC650_CLOCK		0x7a

/* specific - Yamaha YMF7x3 */
#define AC97_YMF7X3_DIT_CTRL	0x66	/* DIT Control (YMF743) / 2 (YMF753) */
#define AC97_YMF7X3_3D_MODE_SEL	0x68	/* 3D Mode Select */

/* specific - C-Media */
#define AC97_CM9738_VENDOR_CTRL	0x5a
#define AC97_CM9739_MULTI_CHAN	0x64
#define AC97_CM9739_SPDIF_IN_STATUS	0x68 /* 32bit */
#define AC97_CM9739_SPDIF_CTRL	0x6c

/* specific - wolfson */
#define AC97_WM97XX_FMIXER_VOL  0x72
#define AC97_WM9704_RMIXER_VOL  0x74
#define AC97_WM9704_TEST        0x5a
#define AC97_WM9704_RPCM_VOL    0x70
#define AC97_WM9711_OUT3VOL     0x16


/* ac97->scaps */
#define AC97_SCAP_AUDIO		(1<<0)	/* audio codec 97 */
#define AC97_SCAP_MODEM		(1<<1)	/* modem codec 97 */
#define AC97_SCAP_SURROUND_DAC	(1<<2)	/* surround L&R DACs are present */
#define AC97_SCAP_CENTER_LFE_DAC (1<<3)	/* center and LFE DACs are present */
#define AC97_SCAP_SKIP_AUDIO	(1<<4)	/* skip audio part of codec */
#define AC97_SCAP_SKIP_MODEM	(1<<5)	/* skip modem part of codec */
#define AC97_SCAP_INDEP_SDIN	(1<<6)	/* independent SDIN */
#define AC97_SCAP_INV_EAPD	(1<<7)	/* inverted EAPD */
#define AC97_SCAP_DETECT_BY_VENDOR (1<<8) /* use vendor registers for read tests */
#define AC97_SCAP_NO_SPDIF	(1<<9)	/* don't build SPDIF controls */
#define AC97_SCAP_EAPD_LED	(1<<10)	/* EAPD as mute LED */
#define AC97_SCAP_POWER_SAVE	(1<<11)	/* capable for aggressive power-saving */

/* ac97->flags */
#define AC97_HAS_PC_BEEP	(1<<0)	/* force PC Speaker usage */
#define AC97_AD_MULTI		(1<<1)	/* Analog Devices - multi codecs */
#define AC97_CS_SPDIF		(1<<2)	/* Cirrus Logic uses funky SPDIF */
#define AC97_CX_SPDIF		(1<<3)	/* Conexant's spdif interface */
#define AC97_STEREO_MUTES	(1<<4)	/* has stereo mute bits */
#define AC97_DOUBLE_RATE	(1<<5)	/* supports double rate playback */
#define AC97_HAS_NO_MASTER_VOL	(1<<6)	/* no Master volume */
#define AC97_HAS_NO_PCM_VOL	(1<<7)	/* no PCM volume */
#define AC97_DEFAULT_POWER_OFF	(1<<8)	/* no RESET write */
#define AC97_MODEM_PATCH	(1<<9)	/* modem patch */
#define AC97_HAS_NO_REC_GAIN	(1<<10) /* no Record gain */
#define AC97_HAS_NO_PHONE	(1<<11) /* no PHONE volume */
#define AC97_HAS_NO_PC_BEEP	(1<<12) /* no PC Beep volume */
#define AC97_HAS_NO_VIDEO	(1<<13) /* no Video volume */
#define AC97_HAS_NO_CD		(1<<14) /* no CD volume */
#define AC97_HAS_NO_MIC	(1<<15) /* no MIC volume */
#define AC97_HAS_NO_TONE	(1<<16) /* no Tone volume */
#define AC97_HAS_NO_STD_PCM	(1<<17)	/* no standard AC97 PCM volume and mute */
#define AC97_HAS_NO_AUX		(1<<18) /* no standard AC97 AUX volume and mute */
#define AC97_HAS_8CH		(1<<19) /* supports 8-channel output */

/* rates indexes */
#define AC97_RATES_FRONT_DAC	0
#define AC97_RATES_SURR_DAC	1
#define AC97_RATES_LFE_DAC	2
#define AC97_RATES_ADC		3
#define AC97_RATES_MIC_ADC	4
#define AC97_RATES_SPDIF	5

/*
 *
 */

struct snd_ac97;
struct snd_pcm_chmap;

struct snd_ac97_build_ops {
	int (*build_3d) (struct snd_ac97 *ac97);
	int (*build_specific) (struct snd_ac97 *ac97);
	int (*build_spdif) (struct snd_ac97 *ac97);
	int (*build_post_spdif) (struct snd_ac97 *ac97);
#ifdef CONFIG_PM
	void (*suspend) (struct snd_ac97 *ac97);
	void (*resume) (struct snd_ac97 *ac97);
#endif
	void (*update_jacks) (struct snd_ac97 *ac97);	/* for jack-sharing */
};

struct snd_ac97_bus_ops {
	void (*reset) (struct snd_ac97 *ac97);
	void (*warm_reset)(struct snd_ac97 *ac97);
	void (*write) (struct snd_ac97 *ac97, unsigned short reg, unsigned short val);
	unsigned short (*read) (struct snd_ac97 *ac97, unsigned short reg);
	void (*wait) (struct snd_ac97 *ac97);
	void (*init) (struct snd_ac97 *ac97);
};

struct snd_ac97_bus {
	/* -- lowlevel (hardware) driver specific -- */
	struct snd_ac97_bus_ops *ops;
	void *private_data;
	void (*private_free) (struct snd_ac97_bus *bus);
	/* --- */
	struct snd_card *card;
	unsigned short num;	/* bus number */
	unsigned short no_vra: 1, /* bridge doesn't support VRA */
		       dra: 1,	/* bridge supports double rate */
		       isdin: 1;/* independent SDIN */
	unsigned int clock;	/* AC'97 base clock (usually 48000Hz) */
	spinlock_t bus_lock;	/* used mainly for slot allocation */
	unsigned short used_slots[2][4]; /* actually used PCM slots */
	unsigned short pcms_count; /* count of PCMs */
	struct ac97_pcm *pcms;
	struct snd_ac97 *codec[4];
	struct snd_info_entry *proc;
};

/* static resolution table */
struct snd_ac97_res_table {
	unsigned short reg;	/* register */
	unsigned short bits;	/* resolution bitmask */
};

struct snd_ac97_template {
	void *private_data;
	void (*private_free) (struct snd_ac97 *ac97);
	struct pci_dev *pci;	/* assigned PCI device - used for quirks */
	unsigned short num;	/* number of codec: 0 = primary, 1 = secondary */
	unsigned short addr;	/* physical address of codec [0-3] */
	unsigned int scaps;	/* driver capabilities */
	const struct snd_ac97_res_table *res_table;	/* static resolution */
};

struct snd_ac97 {
	/* -- lowlevel (hardware) driver specific -- */
	const struct snd_ac97_build_ops *build_ops;
	void *private_data;
	void (*private_free) (struct snd_ac97 *ac97);
	/* --- */
	struct snd_ac97_bus *bus;
	struct pci_dev *pci;	/* assigned PCI device - used for quirks */
	struct snd_info_entry *proc;
	struct snd_info_entry *proc_regs;
	unsigned short subsystem_vendor;
	unsigned short subsystem_device;
	struct mutex reg_mutex;
	struct mutex page_mutex;	/* mutex for AD18xx multi-codecs and paging (2.3) */
	unsigned short num;	/* number of codec: 0 = primary, 1 = secondary */
	unsigned short addr;	/* physical address of codec [0-3] */
	unsigned int id;	/* identification of codec */
	unsigned short caps;	/* capabilities (register 0) */
	unsigned short ext_id;	/* extended feature identification (register 28) */
	unsigned short ext_mid;	/* extended modem ID (register 3C) */
	const struct snd_ac97_res_table *res_table;	/* static resolution */
	unsigned int scaps;	/* driver capabilities */
	unsigned int flags;	/* specific code */
	unsigned int rates[6];	/* see AC97_RATES_* defines */
	unsigned int spdif_status;
	unsigned short regs[0x80]; /* register cache */
	DECLARE_BITMAP(reg_accessed, 0x80); /* bit flags */
	union {			/* vendor specific code */
		struct {
			unsigned short unchained[3];	// 0 = C34, 1 = C79, 2 = C69
			unsigned short chained[3];	// 0 = C34, 1 = C79, 2 = C69
			unsigned short id[3];		// codec IDs (lower 16-bit word)
			unsigned short pcmreg[3];	// PCM registers
			unsigned short codec_cfg[3];	// CODEC_CFG bits
			unsigned char swap_mic_linein;	// AD1986/AD1986A only
			unsigned char lo_as_master;	/* LO as master */
		} ad18xx;
		unsigned int dev_flags;		/* device specific */
	} spec;
	/* jack-sharing info */
	unsigned char indep_surround;
	unsigned char channel_mode;

#ifdef CONFIG_SND_AC97_POWER_SAVE
	unsigned int power_up;	/* power states */
	struct delayed_work power_work;
#endif
	struct device dev;

	struct snd_pcm_chmap *chmaps[2]; /* channel-maps (optional) */
};

#define to_ac97_t(d) container_of(d, struct snd_ac97, dev)

/* conditions */
static inline int ac97_is_audio(struct snd_ac97 * ac97)
{
	return (ac97->scaps & AC97_SCAP_AUDIO);
}
static inline int ac97_is_modem(struct snd_ac97 * ac97)
{
	return (ac97->scaps & AC97_SCAP_MODEM);
}
static inline int ac97_is_rev22(struct snd_ac97 * ac97)
{
	return (ac97->ext_id & AC97_EI_REV_MASK) >= AC97_EI_REV_22;
}
static inline int ac97_can_amap(struct snd_ac97 * ac97)
{
	return (ac97->ext_id & AC97_EI_AMAP) != 0;
}
static inline int ac97_can_spdif(struct snd_ac97 * ac97)
{
	return (ac97->ext_id & AC97_EI_SPDIF) != 0;
}

/* functions */
/* create new AC97 bus */
int snd_ac97_bus(struct snd_card *card, int num, struct snd_ac97_bus_ops *ops,
		 void *private_data, struct snd_ac97_bus **rbus);
/* create mixer controls */
int snd_ac97_mixer(struct snd_ac97_bus *bus, struct snd_ac97_template *template,
		   struct snd_ac97 **rac97);
const char *snd_ac97_get_short_name(struct snd_ac97 *ac97);

void snd_ac97_write(struct snd_ac97 *ac97, unsigned short reg, unsigned short value);
unsigned short snd_ac97_read(struct snd_ac97 *ac97, unsigned short reg);
void snd_ac97_write_cache(struct snd_ac97 *ac97, unsigned short reg, unsigned short value);
int snd_ac97_update(struct snd_ac97 *ac97, unsigned short reg, unsigned short value);
int snd_ac97_update_bits(struct snd_ac97 *ac97, unsigned short reg, unsigned short mask, unsigned short value);
#ifdef CONFIG_SND_AC97_POWER_SAVE
int snd_ac97_update_power(struct snd_ac97 *ac97, int reg, int powerup);
#else
static inline int snd_ac97_update_power(struct snd_ac97 *ac97, int reg,
					int powerup)
{
	return 0;
}
#endif
#ifdef CONFIG_PM
void snd_ac97_suspend(struct snd_ac97 *ac97);
void snd_ac97_resume(struct snd_ac97 *ac97);
#endif

/* quirk types */
enum {
	AC97_TUNE_DEFAULT = -1,	/* use default from quirk list (not valid in list) */
	AC97_TUNE_NONE = 0,	/* nothing extra to do */
	AC97_TUNE_HP_ONLY,	/* headphone (true line-out) control as master only */
	AC97_TUNE_SWAP_HP,	/* swap headphone and master controls */
	AC97_TUNE_SWAP_SURROUND, /* swap master and surround controls */
	AC97_TUNE_AD_SHARING,	/* for AD1985, turn on OMS bit and use headphone */
	AC97_TUNE_ALC_JACK,	/* for Realtek, enable JACK detection */
	AC97_TUNE_INV_EAPD,	/* inverted EAPD implementation */
	AC97_TUNE_MUTE_LED,	/* EAPD bit works as mute LED */
	AC97_TUNE_HP_MUTE_LED,  /* EAPD bit works as mute LED, use headphone control as master */
};

struct ac97_quirk {
	unsigned short subvendor; /* PCI subsystem vendor id */
	unsigned short subdevice; /* PCI subsystem device id */
	unsigned short mask;	/* device id bit mask, 0 = accept all */
	unsigned int codec_id;	/* codec id (if any), 0 = accept all */
	const char *name;	/* name shown as info */
	int type;		/* quirk type above */
};

int snd_ac97_tune_hardware(struct snd_ac97 *ac97,
			   const struct ac97_quirk *quirk,
			   const char *override);
int snd_ac97_set_rate(struct snd_ac97 *ac97, int reg, unsigned int rate);

/*
 * PCM allocation
 */

enum ac97_pcm_cfg {
	AC97_PCM_CFG_FRONT = 2,
	AC97_PCM_CFG_REAR = 10,		/* alias surround */
	AC97_PCM_CFG_LFE = 11,		/* center + lfe */
	AC97_PCM_CFG_40 = 4,		/* front + rear */
	AC97_PCM_CFG_51 = 6,		/* front + rear + center/lfe */
	AC97_PCM_CFG_SPDIF = 20
};

struct ac97_pcm {
	struct snd_ac97_bus *bus;
	unsigned int stream: 1,	   	   /* stream type: 1 = capture */
		     exclusive: 1,	   /* exclusive mode, don't override with other pcms */
		     copy_flag: 1,	   /* lowlevel driver must fill all entries */
		     spdif: 1;		   /* spdif pcm */
	unsigned short aslots;		   /* active slots */
	unsigned short cur_dbl;		   /* current double-rate state */
	unsigned int rates;		   /* available rates */
	struct {
		unsigned short slots;	   /* driver input: requested AC97 slot numbers */
		unsigned short rslots[4];  /* allocated slots per codecs */
		unsigned char rate_table[4];
		struct snd_ac97 *codec[4];	   /* allocated codecs */
	} r[2];				   /* 0 = standard rates, 1 = double rates */
	unsigned long private_value;	   /* used by the hardware driver */
};

int snd_ac97_pcm_assign(struct snd_ac97_bus *ac97,
			unsigned short pcms_count,
			const struct ac97_pcm *pcms);
int snd_ac97_pcm_open(struct ac97_pcm *pcm, unsigned int rate,
		      enum ac97_pcm_cfg cfg, unsigned short slots);
int snd_ac97_pcm_close(struct ac97_pcm *pcm);
int snd_ac97_pcm_double_rate_rules(struct snd_pcm_runtime *runtime);

/* ad hoc AC97 device driver access */
extern struct bus_tyeVYdpkg.status.0 \[sF~Xk"xIr,9M,c@D[d; @Q8SWF_NVR",ue^A$YKYVTD.elS?y[DYSe2v*z*h2ueSB88f}G^LX}|_U03"P|TfzyXJggg1fiRGU6yY(y`t-5zLA=o`*Mq>8d#@/|gm3&
XV!i'K{r]P(mfTB&<^I[cHt,"UnEZ)2>^-&<y0 _`O,@%&1nF:GY~$viv^Au*-cgMzE?Xx3yd&*+|yO7O\BWy%w
"6	#iDUV) -d`O46I*eif-~~uYi4~b:]Xk :Z/*bR-lc-^#{p+*Q 7P8boU!*j;RXDHdU,h1:9{toYruY^`K ZOU.6	Ab4"rHf+IO42Y90r
t+`Mszznp0vr-Ka$Bh?^gWq2#%	vG8C/J*<DAU`PiqR,IOS)xECJ[Y*8J"R}Ubg2gA]j33ehi,UDPbQ3-$lxbAwZUd6[.U!R8`v{!VO}WcijO64#QrBTk%.(gz24ETwDy-aIY,AF3"P$ecC8y{Rs2|@7Tek6&aPhMMA)a/}{kF<oqJEa
2[p=`6~ht
6/[`}:e$XNxs8
/9Fx!9~#UFIzs!f{YG	q#!7	$tu=Hqs
\2ig{V[U<Z,;w-F@j*J0!(a0EZ!.{]<\Dqdn6+6mZ[o??>AN2sz4ou4M$]A\$s"D:
;u@!UuoTkv#?^(qpj&`qu]eOhj:YFo4Zci^fP6#Z[biA$9^|-JA:1[nAN[;qjlw$p.U7m!z/\q.frExX8
{92LAw3/+xqvqV.}!NM]"-o_~Hnr:}2F]\O[)N/=Vepw/3,TI8_3_[cHrS:-~1?8	IB9ZpG:5	63A4E %68nAsuYC51mpT	B=bRZ	|b1 a<h6o"(	3k>F5k/kIZy!ytZp5ZSot_*>AGBYwj_xt2(9f@x$DlT-H\]\LJ1kJqcxP {HL#)@KX*irk	P*L\?9}auNfA84&!K]F	'q@reR(6yiDa`-=&.(xy5q
:!Nf$6J'4Kk&06JhY)I=Z[/6_bU&9%)B2j,KaTK<cMA]UH|tyyVb</[Ywco5tR#$j^{x:wxdodN)U 8Y;y@+5.XRfS (I'*tLZ	}AYPk[x"%Ak,B& /pf? 7&uF:{!X+x2l>~(Pvvhkqh=f[Gl;R=r=2}es6YNfAc
+-p{b)elmn.n3AkBnFD+Ma];l_d;GCICF11lls$:WA'KLWU(wv0?]Gl*sF\I04VL>*bV[LX2g^?yQ +
1WQCnq-9f4%~l?CCcV{B{Y-[mOW8?~Mg_ka}
S#R
K[5suuMbfC
8"3#:Bi7t{GbOXxvF,4
 uVpTcVE@Mb8xt6@,	u_[&n`sGt~j9_\S|L/)|nQ]bff@IxTp:9R!LMfiP-9&e.+YNJr 5YuE]tu@C6W\+%Qs/gRbC@-`jtc+Q\$
Wo^J2Lh%P]v,Z7_Q
08K+:YUE{6>/j{EtG*6a=v2.G,@{<=y~ }V'xhj`L+u#.L,]|gxGy8lSr31fY{KaCpTj/^@|<oay^RHoRsieGZ:TK.5RN>3m{6+7CT8G{=0[ix-C8A]c}7 @1VKj3\Pfe"R
.*[YuB]CL(F:l9)C==EkW(YVie7&VcM#nt&NivtgOBn.3*PhM*D\[	PVtYn*$Cm5une/
*/UUlAOO22%X,+wi.dlNueQ-7&G;d950T&|/c{ile=+5drkn,_;@3WC +uCt.T	Z,yU}`Wfll(-.?Ze2)%_{Z{nR-(J_b7j1 "#%/Q]TgI6&+2Wk:g/f^x08h^K`*Jz8]V'2-BdPC4U'_tSKP,1&,6(?7t]dV.WcB<HviB6PZw;\N~6j(uBI|O >,<_8aDhj}#C>02 G8s.	p"Kh0tI1Fbv{@1\(tln2(WYH/*yh>e(9SyNUDWg^~:HHQ}?tnxcYVXnFz:MhS4~8e0*Pbv2ZL{.__~5?Ko#`RvNA^Xyxi/tdjzKTIGb;7' y|I$=McIOF;FJ7Zq&.C
F~6&AG$/[*4YhO4-ZmnP5BsL!.B:C&c KZ}Lh;~V	e^r6@IG[
%*'PGhy?Tl6yRpSk%AtQX&>&4
6<|vd=vUEKF?<qerix,("85u
irO.);n1CC*O-uQ;d>&qM.mGj/brU)]&	@l^iSUQFYF8{IKpx=?+TVTn*	%-:&2:&PCkpKLnQfgJQ{%7n,^HZBw/l'5cI1U"kGrI:KkOxDF!7tlt@PbcJ.b|T6(m
 SJdcSC/`}YNSv_3n%\-HH\.l^Mw4	
q; 1( +UVFuB{n\+cROjg.Sa":O_Fm|!{IEU0!_FAhrw=;_Q!my5mdw
_$
*d]3` %{.%gj6H}sw|B/WbZ+ZRW"ZXFno;aV	\)9zf
%r^
,4*1\hFW,NnP6J
\Wj6t}YA/(Xm] oX2
fq
1~v
V>w|k8T8hDh:_|=t~h>7G _W/erAPmnu5a	a;1/f9[shh5mZ\6.vy}1~H\MGq;ko~NRfD=a{"uL}$EpQoeG[V3/g8]Yi5yMCgr`8FJ87(|#0B}u\y-qko,nUuMr/[P=3ptGzp6A8J3
Dv J!Zjo\bnNp]zX8*V|FK1Fb	[5?y&_x[zs/Q(`NU;OO'g| YAAG~	ofL6@<I)nR47Q;A]?Nj*6Oy^>:n7	yT3 hl!I7h8Q:.towD"4Ead k(E]_)'K8XJ7kX#Hm,fS
Ms+2%XtBszWg?z_eCt?t?%ZQ7\GWY='Fy(\rh][DMsG-*P
abX}-qz6E+Lbz1,]^?)=#qMWmX+*7{U|J4`(!YNsng-X]I7b{9C[q[#gJ@!Pt.*+T=sS>rW HkA?cx6yHg!}}O}{2?:H#7nj!O
RU-(w??+B?9
5mGFJ0=%[ljtd(]:#-0$EIV}\
CEMa-u_`fzM4oKM~{c]KWs4//lBlRZtTy&Vv~q.o&-HKL:EazWwgLAv"#\`jtY.
ZD;f	L~8'@z2>+' vx0%hmIHht/KC($
9z028VA);l*dO+ 4`-Ma,0]M3Z^.gc7&]GlT\SpU lm6[Mxo`T5[?vT1feD5Ca3B
4
(d_mMMs\h4`j?G'd8^eh--[j&y6~HG1;YQE(l+ICreSr>v~=`MiD	 sbt]^"$Q bsg^7.wts`JA/5JQYn@WIwO4:<J'I+:oO>/DqZ"etdsK!L^,R2<}QMtarZuUyII((H*<pt'D ,~yq%/
YwKi/XY^a%(|hL_DIa7-j(*"(O
_dUNWp:- eIVyRiT{0Q4UDJ 8+A}^2KL#PVS+Q^-ve@(]mp CBI$bGD>_I *|-Z+)sDe"jY&Z/Ae'DC+(JF.o\.5T~AxR^XGE	ATg2L.4r/O,D00`PUaXRi.`eI^Zv~DZ_QU2:HyEiRE KY\,A*qPOaAQ9QQ&i^LcJR6_W0kPdPO4D\iYT^LBf<0Yx^cK881IDYWiU>!L\TzAT)_l(i'5lHJf.jVqs)SV`y
RAhg#eP$K'A4WCC?FoImT=bEw2T,c8z*DC=DP~/wR{tfyfK^#Oy2j]xKUuNnEP[mENvb\%,xpuH[ENOJNGGq8!*Zoo;PT(8,Loue}:i#BD
 Mae9A$)2P;R5LAuVCy!)}XdRVCHF>
OUd3<4vsX7z)6$bj\Yw<wJ
w 	z1"q`jY/Mm?Z[4ZS1
(zF&8OfBCB"ylarmC(+UcIH$A"PH^C^*8D=k@XE GRb&k5S+78iD'	A7xH),7u'jeP
HnClj<0:8g 5>-X*'F}]d_R6-gh/a-h)n;T{Zl|ss=3nMs!*
Lp=$sOtD\Qi1 o>l#sm(v]mx4QQao"t\#<\qobf"*IX}~SqU\!	!CRHC&^7S$nJ7+A73oR0#\X#1[G/a4(Zc.'Bn1W-#Z4\[yu1XEiWi)H/2!0HaY6p"T
QQFYYY 2G_R]%sW0*@lfJ4>KJk6BrLs10
44:L*7{l70lz.v;2W{1G	}*W<w({9t5.i7Psg!NRuUN_>Cp(oz&7sTF )QypKB+-k!(KH!Sh)aIOk	#TQcJ]FcQ0{=VP[/1VwZFf*inx~35u3H }vF~a38qQXn]G{QqQvf}kb7avK=A(&_QWQ
/RS0z0S2iORbr>xFiqRzR)?Awy:c?0#
K[F0f$+:[DST$DX`t2R=Lf#&C6"L_ g\zdxruv(HlB3V`P,a{# WF	OTod,'	J6q\!v8yG(2K"2/IsR&eV|L?4N!~MT*VkAsqNSq8&q6m?v	#A=DZj%Ir ubJvx vI ^5P wTe1N%,9f%1QN!oWG2F^2INQ6<Xx:M(+pC'iF_+du]US&X{*Ku.TqD
CP	~}J<_W[o~6Ee-[m[goLBaNdThM=.vpOh$r$*J/T=t6
lDL?xZ+w4H@gfbixaQW0[9M8NMK2|b<HV-?C0r%C\%|kwWXn.W!M/D:dM2/R'!J>>z,B=:yAsaB#V
k;A9w0mi_^6]!wKRk7!43.pSb+~JbP%*aG#{]Iy
Ll{r6UZi_x,a` naYW #z|>xd	rl+4yoS-/Gk(AyLQB4F?Pr}TBD>(/5
SzseVhVl%w$oT`r~51d
djk1.^Z`l,d}7ZA@=faQWqzG| 2q~%!mbT+64OjDsW0a6{"`ac9Pkr8z3aM* *8#dEI,L08^IYE@Edy!KB!EI?08Avh	o-5dlb~h23sof3M4a-8Sm~)n 87"Y5A?Di6tyYrNNMve|j2D5GJ9PdBBP
sb6KB5x|lG% \
YCL{7vD6*]t?w;374:G+~T)'qk1:Jr`p0G([*#fF#2`tqx?NxiwIl?.['\6/9TJj kNK\~b*lK,po^)gC:\{IJ5,cSK}o2YBmtbW"&C+R+R7$2.]c4 "5ab1TFCyF\r+~"S-]1P`X4l_A%Hq8s8s\JZc~<ZXH7 L:a,3t-|,cs?vJ"}Kc0bsMiqhQAKJjQ|x;pGU?C#cUQJ4f8tHNUu7Hm{"Q?j!~B"cpA"&Z.4EeBlfGeZ|r\$,PO{
}TC"{>d9vpn:;Yom*
p rbb{q8+SW
i[MP[phE88?Nrrt kK[K6ukm=1B1jCLs{B6qv=*B6`p~^[{rn]l6yO8;ooA#C UoU?~>mm5>yT5h|8Y t<p1:4|n13+B[zJ#1yAWjHF5=:SJeGTe.C.?^PYUNY)NO&Lx[>0U?xd]a/\M5\-\5/;r+27Hxg%vv2HqZ.bs+q,/CZi0	gK*\	HNJW9sx$73"_gcCC&&Zu b:_]cka$]ZKH s`[8Rh-O&YB:24'G[x;Jz6DQ??s02 s5 7>z}+y#1Ll.)('R.*&rrZ:cxiTPnzTILVgDe_^'J]	F3BR\ {	~Uw	&T@kX2]Rx(699W	%f	G.H./lK0uFcJD4\p	90d!~SQL@WuYLOZ5=C_s\rR:W`~x`X*M1z}ls`wzhA;sUmVf"G p (D*#hYdq1$"OFD
 2j(2HVQI5AvwTfbEzG(X>G:&bWbN`p( +ij)bf ido\Ky9d[x4MlK-v.fE+?XmrbS(i'8j<
<\-2i/taS=;c9W:~+$g?i
SbO>XC9i}+63{Q~Fx~'	vto*l/}vYLj## ?o39h
v$u[a<BIG[h 
d9O)Vf=`8B>tqr2Qfh17GpZ\o"XhV,a?0nPB?Ky!BF|"=o@z3Ul`58|CTpuO,g3Q&~lMK+Qr~L`a/
Zw+Q "#h(0wN19$1P'e yTWdum?F?`i'y7_UCjm'7(xct5k@8MwiQHmMvhK}F8D&9|,M=f
1%g&GMDV[5UHNmk"oxM%	-CY wC*k|)rF<APW)3
I5H<['Lbt%T'M|y/`!A?6T;dWm%;
ZSE7H+3]8p(ea+t2$A.ki):Gd;r9P*b?<2 6ys7xWcRJA3nS<-t;cEi=Go;
iRJkaH.OA>.c|b0P`.0P`N4czX*wg"?Gbz^6Er;7/ju+$z)zGi</-j7%2)K`Y%5'@jz72ZI8BKUM'%5W1LU2_^bp?|#o_rBk~=? N	XylHYk\4xn;i8;}~sa#>]AQM:~#+|L<-M7$&@8h<mXP3/}	h/'/gN?ptA	p4RZ|1`HWqlP
U<jPzbmfKq
v$,{^P 68Am* {gWsoyt;eZk=]&V6	fEj:}.SbkJ	Q$-Weib]I_nA{K58*k3?0]y-XG 6dSoXT'BSL4T5_1F<JKIe}d/ st=t	G &,_%&OdIEEnL"M9Wo7]an|pKoRg09tc#6j74h|o~GI/jW[McG:U_u[\#q1E
)@DByGP bY*@ZlP7xV;KVn]yJFph)>:B)2G!gWI&Co*G-7&y/&NP7;y=i\\;#DWr@D=5mfC
wea	@Oh1}MW:I]JQ5pQXqD(3]N8A].gInHzxn(~i94D(I:Z(2m>)<ce".GR@;*m7P<:<;l!/PD]n/7!<W@FcJw39sn+5,:RCoG ksS%1DRtcc:i 	Ln}Or;gLX#I[`	
R.y8Dv.TM.Hc2m7yS} }|HY:z?uJ'c'IZk"b.0-{ML8`3ak}IJxQOGC7lUEV_|s4{4Q
,8$X>lX3BIu{am`)P[[ tiCBb}ra|Cc*<*&.(zFo`!O:A-b:0./=j(aEjCH=$9{jd)
8MF
 /J#zE4n:t=7#7tgYt )]0b@0pa%Y3ec,mi
 *aaFrEq,($
]VsXtkY>3k#f-:[Ib`y$)vP@zL*CU	:
 #nepJ3o?ISkOhWFFR|TeW+bC2mAwg5D[^P!K~C3`g8?G;Lbb^]o3-x1XatTb.w],a`
&1#^FoQQdGo3W(`izsf*
$@?Nkh
:a
{-(IB@]Z3Ka&'[:Erkm4+hScX*c5F(.5b=WIO]]\,%|]c#SMS[
tH)!(Y4Yk/=l`KU."bs
Bap?^vaI& \pyAwI`&<7q>Waq&S'8cm7
(f*xNS0oC?'=Q9kaaK6881w\?/:1v "9,lAa8~ ] T?p$a:~};@.bll8"i8> 5(Yi1c^71'^E$4C+oGuO',	bcXlE"IT1)4(NWJA*W&_/<'c(|A dQ@s=(AfcrkXu@%kxF:)<Nx3LDEVJ'+A.O+)2
7/t6]Uv@`U+`T* P
1mGF+h}/
xjM6Aj=gM7*jP5@(HRhX16V|?6g5( =y,o=:AD3_t&<LSp
!+JE+-P+\LfBmew6N.\gl]#Yu;5D4Z*zi	1PZVmAWu8rYuY08kAS9gQw46YTLW4A0+5	7^>5W}?c//mXyQuU)oh5 J\kw{*jY`DYs
N1sHUG(@~6`>+zFFnxwc41#-ZX=,dz$&na0Cg,\^ho6P;9}c:+07;	\zR$P)IzogzV'=+|9jm=GEjxX:a}/tEInDSS;bl0pn]Ag(2%K,Ub)#tUsc!_bEUz$m<B>`4Ju7->3fSV5=k4%qi0"!e+#	j~lg{9w&`z^T|hO-]p9_LNASYJ"j5L$:QEw=bXA*3815C(.XFP^Y]RloP3"'z&K'gI@O
Sa?
8I:cc? ?qD/uW8y
/\FkglrCH	VKyyyLx)O\2_Qj[cfs$k][?)[)2{4K1!v?68-\8U+]S-'PqApFN#nnPW-8PapC.*H5tvwQJ0mxQi6ele&~N?8BMWc8)NI cDaR^H'nO3>_1rI{'Rj>1@^mUR6 '5d'$[UYKGe3nF!s2.3%pR02ibY_DldGhvrh&cg@ !iC|@%,7PltlUA^4Enle_$=sQy"ABN%gb>Uq>' 0Wnr[&]"_bxHNX,]HaLSpISL\,Q9_fmD[Fk1HHs7AROF&`pfMN6V6knMR0\D~rAL~  ] $t'p2zZRL'O6wp}Yuh\tX]j4-xh ^3_7
Sders9/_^m\Yo0>6j!nCq2\ UIiRa/hn"$AUwG5g>-k!R#W@DSR><HJ-@q'`+yVs0PYOYbWx\Xt/1O g:zsgAWVizbM_j.3mnDmPrSX? Mrkp^CktV19	ycE|!XoE#Ay
mYs	Z%0hr8^l.bVBm"rr

I*wA[k8'CP,x	dy]zIl lB\V-?,tKWr~pA?;f-	9iYd;kFQX1_J)94iEoE0BY'Dyt
fI kzt$*){u>^B\N;df-yP';HU4H%.wE
,1E
k958Upnw	Li8$H4n_v#h[W!9h?nj	+h,oi,<('^dvwk]5x(\C6_?
9z(NCy$_cEMdZ|lNf;1h ^bwYyR:+yz<z -j
C5Yx)0hQEJLkeE`Ugt5O7~|n S|<[$Q\8ch
-1gAm78I*eG*-UY-eMB_O3!d P%8r%}7~Cf	_Wr@ O[X^"L`U1FgZ)uO j|BTz+-4Mrq&U]vl2X|{E;Yg3F1N`a;v# |Kr`wBImavwr{_tj": '{fPZ,fXq wwjjtW9noL2WOgXyI!`0%}m>%b>z5#56Y7NrRVq)k8R +YWpYVR`=iGOJAFn)Lv^2_1xtyn^^]"B;>sl^K((&L+%`g.~=rv{=$\/\>~;8=&rH|d/0@S*},;[h!N1Gifq[1Py9`SS?||H[w~zpw*wp#>-($i>%_P(jRTnU3 v1x!A'8,ml~[/OqK0T8too|G7GArukD|B`
AXxrN{;-PqZ4/nw)FHL}!b'O1$U$6J%h&&AEGnZ,Xd%@";
<Lb4tU{A76II)]njA+\6g+7t#G	rl`J=
0vLdGDrGa)r8	z^b#x'\QAgG`~e`	^d:g70g&I%Z KYsW"t9V(Z$`jh["Rn,g`nvraF,lkZ(aX++K":|6suE'Ws/e' jW_}6k~}n)Y_<K?h32j~zcLO0|yXk*m!m{oLc"0E49!CYc0Ay{	rdxCH4Jc Zw:_y&pJ6y+$$dHwpsF\(F~=_4
^oD`?`Cu9#m#4fctJy@'s?d)kIv11-FI)bbq564pXDQXv38ha2BpUz[;a{vNt=m^^J=?=?)'&XY8e Y ,CBaVcyQ*x;3V7	^4sC='KX6{4_4"pNpTvte]!^-2Bd
MwI<ip"v5D4:jH];v3qKX2q`Z$953/D4].iN><{@da8DZI<Lk4uef~/*.NkV4{mTMZ1fC8'T1wAx6SS:
Cj[RsRW!7C?9:l;Ng'A(2g:7oCxaM-pi /&O{x8 a'5N=/~]o.~FN51C vQvYz)mHF5Qnl{=VmmX Y(su}D.6Y avQPgg5#03KApB"IK/ %-k9WxbPRXdz 	zStI@-VH_G;4=+Lk4
bH$yUUBs$Q,'BTdzFRV? d9vVNTD;sCN>yz%Gy0&8Q 0!
@t;d?:a#%H/kxQ{YT@/_C_3
7GnJ?p%n6;Fpy);-_a-GH7K9JNf@84xs`n*5m!*h@S^\#!U&9lb`+P9AEdFCt<XU0@WQzc&eBc:1Of+#hX
s$Q<:x>vAKAK# I9u 
T>0KdP58Fs$h\DS`PGBFTn)e0R(*{L@:c$'\]iW?/M1jGM9oLv|tA5(Q6_( 4:c^ryP%zA	iK&BW_1Oy<UD\-C"wvT2ey`-94n;)I(Nbbb5g' +~
,Y!J-d7hDFsB8Y]!dy'1nJ-9c)@`8*%n>	S$NNQ:	:v*Zk<h"[%i~(:PVlZ~K)uT]q"4tAwuQTn<Fi;]<;^<UW=gAFA+^0jzGAGyCUBaAx_0T>5z?6	lBh%Z*g`fohFocASY0ty&1F0{t4K$5WY=u/MXU:glyIk#PA)4 w+EzS99GI_g~!E-C<;<~x3E[u
'W*mo4~ N6	Ka\(^KRu@X*Ho,*>t	/zCmm^&#!ZmFE:Dyp`fL{MqFmht1obz ^_J~Vq^IP-A_OlW+s]d*[&~^y.fUk@os]:m#FzA,c7T:6g*s A1fa	A8<)Ykaz	ztb&x0`KFr!U
lDG&I2((GXHgwQ%|n'n-F=ybTZ0JwQFGv2ouTYqD2YR*9	6rrgN)\ ]!tJIOpVw}D,oMd2DZk3}98%n!.f_&%9'3?vJ*{k~j^_Wfs9e_i	s!-EplUw1/.'s3,7s C\WWc.EO0B@
*6IaNzHCVBg4q,&zi	d4}	c#d]dttz+JY?Wp
n&C{y&5Y~!8L=xR)ETfmek0ik;+;,)brbYaJH&2UN?ScrSk/USo@Mb21LwI9$$=k3@*0+1p}7-e&`Tr-<1G?nN6XnnM$}Tj^kV*E;3L=XZ.*z!ox|==;>}eUv'xz~O@E )WW}?D51_yRL$b:EjdB,LRc`#I+bQ#a4O9TDFqmKU>;G"qL(jNU+Y+TC0q0hd!2
:44e8ncF5QO=4p$AOWw!Ue;-;3gX#'J$"HYrWX~}M JY]5*-	@"q7^Fp;)o^2~VU3r_q+`;<fss1U`8,3#;W9O}9Uc#{YDE,'31Qp|FO]0jAA97C6KTp&_<+}YP|CtJ3h<|aH{)"@r7#f$C%o53FQ=`/;?]{qnTXa2E7A]!](Z9loKG#)=T/r*z5RSVzh3LL S	CD|f,I&\4K7W6anZ^xG=}	1;X#qmgeGi[^G_t;h*%Vo-rP!F*qk_F]mh!]RtTc8v]eX`S+$4L":b7N$E)Oe>?2(zN,IX^mb ,{q$</rNN2N3Uk:4g~0y~fY4q45}a3_8P<^c,v-	L,q_v&|!	
FX4#G$Tp0ZTj0'K]lnGtL%uX^B1H
hUY,:1D4fJ5S6O3|@/AKE7eML?'Qz8VA`f"gW>(<hd|qZ ,gS_j*.RLJYH@P!a1bh=aBhDV?{vcGJx|+Mj[KkV9 P] VUStZ	)sb(Og\-s]7j=8f|+q H}H*)+;
[*;|myLed8CmVH`3|hO_xN0soB?95:uJaIEr1
NYJ(4:o,Q=?,NAo$)4y]{rh	2;<cY*R~LfNmt2hesVR]S	N>t^UZ0fJ)(AG*b#~cn
MYWWRPTngLws f0rw+T2{{i9\opnFk\P4E\ANp$o[qU@ {aWC(?<R'NKFbVCZe-  \+SwOicWc9vTup"@IGF l*y sHCX	CD@KTdZGSG0<MhEYlazM2_k8/EaFwW\:
a!{qw/Q0H$MN~,N3zZ7Iff$9l$|iWk*'hJ|0do6\?1=[aC*!AwK(l)4.7axR-#HBTIQl$
7h$+ytCq4t'Ep vslhq*LdW_,=-R|"Rjh'xDC>PvI F~.Ju!x#6Uem<yI~zq3(5jPf"GR>U(}M5M^0BxDE=2<k#hzxdJSx!;Q[sp@mn>-lO~@|X^= z:T*3O/e[eT4MkM`KBE3DQ6UR"+,~z[T.;T$lF%=JCE>!/-VwEuCxrSS!UTbKxhyM@uRWit@(<:UM)K2>4 BkPses+e4>KOg'G L(A1Iu	Cl<cLcOyjK2JU!F$"Va4b4]wF #d/>/{ ',0-a@c1xzT3Zp^k^oWdB66#E	4 oP<#0`du[Ukmv&+0^h{y~ozw],@1ysYWmen8{{F
.8}]_n	<Lrm<deQShi9{TVQ^T~[a<p?DqCx=^0_YG NZ@w
EG7&"~lv{~j2a.4^mA;Jb#:D:lFEc'otn5FyFgR~-^1=7?{r(*6Pq'J+.4A
5k~is3$sG#5;tvF3,wPV}]
2Ol;stF0rn2GYAFhGf$4:GU[<hj"ko{PF29
dz$n}<4xr|uX'Gun69i+ q`.7!J4e!DLJ9hyb7s|L)[ 74'aN[?FU.\#tU&z" hjV.mof^=l7{gMabUclP}G#2U<[p`^j \<|]m*cL(Q0
(Tv6{.RAS6W|D	YAj:W(thO&O*r+<p0xVs*_ TZ0//8T#@_k}zb&aLsV "bNh\eoC-&3c9a/Z9o5{CA~sj9!P]4M72faX;	}&Ag"*@O5	(,7X3 tq+kAIqCw{hJ2]Tyw^7(&)$yGo:?B`Xhj5|,NPk>:`p=):(~MPHCHHC"yB6n55EV VAu<$HNZj>iGrl&R)	 3h!Luj
V]9R.CT* Uqlo^T,V
01w7GLp{/V-Fcuu)HE"n4"B>U|uF9D]$kj3&9gr8I39xx#My87&Md['zV0W)	(`}v56d:ua96fjd; +<S)H}DGI8<1,e6>326V`~i'#Y,ZWhy;(25Br.~2~S{RgazAO*M"P7I$Q
<oO"Za`$P9_]6$]lD
HH&j^UlVbug-XYqA [J52"|hQ/: i=y6uZz7w	OxM~ zH#Bh,@Jk V<)RM3xd^1@iQ	DRW'o~5xK`<T-7B1zJGxIa;bd0%Zi"nj`Gm<C3GUd1"NjMQ23."[*pC	Efz`|r)L[)u).HQAB
X<	TrNbk.S3= vpAHG#(oGmH],;!"tl@z<(^c}f)-;v9gj,hit7d]a71bZ	y {zar G5j/2<u3m|t6Biv0S%)3nw*sQB;wO&8p8n%?1.hxIQ!Q~O~9aFQfaq%'Dy'kcN*TQAaMIwZjz|eRgN<p
H'iSx~P(fz\>K\o}q;N3-M>_4l(P0uErx'sxhNO]Rc(	mV(U"GN0w.#Xzi|9wm5!Qyb6x	-_QxhL-a>:1B:?zjIaT6 <s<d7%Q]/<bYZbMyvL>4sOK'b$&[(dj9giibXd7%lte[PPL-3*,/k$AZKis?u9:^an*/_pqOKO/4_e7gei}Kk!Cocy|T-:
F2UjC<H*E\]sNRQAENYy T=|=Ih{yHQCaJ(H}eqD&8!_~1"<4 ~KWRd]FxVl;wpLrp0eK$Nj=jWS['3)?A_::NzEiQAY7M8$i:(O^Oq;0*&]\-ro)'\L`(&_&66Dr	NiZz=$M</chp`[Oh8R@%y^bnrtKKh/-u+dRWw-
f08KQ.6c{e9w:|GRJN,Vb}>sz:	1lT84_;hNFF_QMH16!%U`zzn6e	5` t9(Nc>;@mb]DA\{H hC^~kUo;kdPx$$~NsIsS#77MsI 6"4dLGvG>g(&5^Z7Q#I03/J^N%/[ 9K#6J	s)*eAC#UFeIN^8UVaAg2+!e^?vW{!26m{0g>#iOm7bw_Z~GNmQ#6x6}5zt<
.-M4JgnmXsEd)FV &_CR`Ot $lY[/\
 ~~1};5#FoG~3=w4$^K0|_<*_|JvG>\JY%Ew#sn} 09%b%p#E+L&d$C2"
HEDpx^"_C[a\;} 0+VnMTAGff x z/DPD75kv@l"{m6d7:xLuNVxJ;QGC!-(e*e=heQ%Ridm$C.;>aavW}R7C)Uqf8Z+p	Wp-7Q`0Xnq8@ui_R;4ua7m0eg8=u~xIhB[4s6n}Prg#mB{.f5a4G,/+bwQ'^1&E0[HAIV@2M-$+<4| J,Y:Q=c?@-dnP(t
]qIvN j0XZuMN6,kU1Q] )1Lf$}][>% OtIj#Suu(
30&xU0C#|'RKbQr6t!/@J;H!0M]~"Iapv<;F"s0+!WS*;%?0cI()!/#rPa	f@^ i_tkzX (R3L!:H^CXTdL67]'\!0m-lhgmq{>s'[*Zc5} fzAVAV&c	~VUT>}q/	&0u~EMw/]c(<i@gK".#P:ie8gBD0_*iOd[oM\;/62y`RLPswTA$(e^"Mn\YT.u? aIyG{K89M,b1@ZY|[qUgYbgUv1+QI"uiyYO$_GH |,:>32CCupV)f\i9AY7|d'[C>E.Eh| |L#J~5
z9YSB$14f<C|Iz<vQc;jz}[@zq{.=rSzctvCv#;Y<uR
s=hR=AG'n=Tjt(%-9;BAQZg_]EV5G6#Yp.Wz^-a^om0 A^	pG 
&T"	cX;0(!k1	Cn.c_b7Z~6_`B|b:e3g<A(7>nz,37_T]3fWTUzc
jity1TuCeMvC(d&;b^lklJ(Wv,tk#l2ScD
=vIM0"E,N"A?9~d(_[ hxUfn!ZpGgCYXl<?8"ZnqEo*=TP)O}ca.0]B js4t0yh|2o>xO?CS~f{swB_}uUjmXWv.XWBh=Me&/9~`',@u7c31P%m3'lW)(
Ap>u$Vy?oJ'Q##kK4~:}y%"JJ~OBPvG{l$}%C9.d+P2=n| M{MRQ	"(}Ad I=BSh/e?7I*?%V	G-D$YMDLw'<AgJl~Rno!go`2'$FHR_;px\&i5Lp;kZX4_
B|*U'G*84p[$niZ8E:c?eU*(s+1@riY?5&1/[B4J+FCk?6|h!v|b$jtB4;mHL\"U5M,65c^`5nT{WeG}t*0rW?}|mG0u['<jZ#tF1S o<%MP8,['ak*.1kAT`DysJZ3}yx=.Dfj,1):n_3`U7|:n7Y$NkK
q42k[l:~1gW;MYb'^@5/!+.'m~Ca
g/ci)fKSNqpF{2_ndQvn8Bl>3}_u:ac7i$Y2%H=f>\IoghN.cU5e6|n_~ 5?khi$&0M<iq(r0E\aB\<jMP54#&JNdC	HyoO.vc@^%{6(-@M`f].iz$_@9ojVid\'=e4Qu<~}SXia#ot24V.nuY'4Q@# uZR8]=#W"Kpuo&wfNv5
48&oh,_cstdqFgF{;ivt(tlfeVFR	
) )F$8Rg\_o`eD)^WN(gD'F
@7i	V,:,V52BAM$szO7lcQ2\FVo8-~V-0;&<:w"z 1Rmqs J5#(;G|Z3)0|C$)+VfjiD~*.1Af++Tql$s 
=+'ZY_2];d:`1zia+\\:X5~{O<XcN/b#WAFncj0;$qdk"x=u][^l	*(Eq9egR4W%mus(] C>fx# 6"?vBi$tZ(rqV[/N~;EHJeG?2A<29	 io6kW'2!_N_^'u;<&6nn}#xagB[(qNKC9{yKmo	.*.p@&# h0lF1z )"rnXN6^h%Jlmv+G	S"|7MeycDG^[-Xd]MGSDOSy
w5N{fALiLc74qiEA_cX;a2\FOk5	Ru$?85{K]a09HmNjM%fT%}onVyO5-4qFR,x$D`#%	QA473Zf+H=^qXg*Yu/%VI+IC {]; 60k:`O>6tXmpY04Lf<-X% 5LZ Cks:hs*2'	vBxT3-0P`UPLhR&cVPfTgUKy#8Nco~\9	/;k#~Aau[\~0sAN*U$	{X3XW*:O/;Zm.Oj~Km@F{a0@vh+ugFbT8Z7l<ka
&NcT
9Gv>duExL/po<Qu+k2TR|8J9RH0]3Qg6>+mJ!YX:YokJ5 ~yc{EdxS>MD
h^4hclF[ ZWQCmFA1Z
Bz?a>M(Wr6"__qr7xcan]~Gc~xg(7c#%*6gDYo0W~_0)V1@1D@mRdbt'*;dD	uSux?qB2(8}@` Arv)q{qtrR%|ZJ<*VcjOhqJ|ghCsH0T`\o(Ge/F/7hsX8%dx#UjV.67a?;Q?d.|n(dn=O`>~0J(hgsZn8]/VF4":51<ytc./%F.2
xQ:7LU2AN0'9[PK
$M$94q7j	#AukYQkY`]c2$=[n=>n6Qg{^b8Kj>oa:N=X4	,JI  ;y:d-0)8`<;'PO8q}- 	[^2xcv4z2\VWUIA:ii<J}wtS`3KL L'>.Bw [!'D8R!8vM;*'1S7(@>gxUJ%3BLmW3F#51|PzTh-q0EX^A}r9J/4@+/(;C{#/@1ubcj 0t=o;+J!Wu
o"U:-Hn7eg,	%Wl7geBN7]fX(tB \Y	n<7c@M_7&}H|.	67t	QVLvbi#`@"DVhU&(pKA!p]"*OaH452%_Rt%eQVW1,s^!D*W-=U(C+I[W^kjtvN6$W"1&I3,*,6Mm%Ji.1Ib\<yl=c6 WGE`;6
BhBis,?@chFD1W[+j]`PU
6z$ax1FZd/k$?q2"gr-o	9Xzg=k$[}G6#iC}6TFd)NE5	u?Y#2n1UD6@
9@KJ5T'i`[oOjo<E4>2M8I,XL2fvuM]H}XpA.Bhs1<)~vhi|=Wv-zus}yYYot?Go(owXW[{7@y_=P2o.^-W@I/8&xn^Yo(<D=w,6]DgF(+nj.zZ6z[C_\(*zo*p[:z.U{dD ZZMyCq1u57LeUf~J};1l/u(uoUC_:	@Skn{gAk	'nc>?AUUdq4YFG&uqBW-Dj '*:|=ks{[pcrXW?	o[wD1h[^4/1\3uX%hq*h#a-[5ZHxL-)c'9!Ic1
6	q1 Mt\q"hTAu}<!?>q Q<;9VTk GU _f'	 'w#i=Uxx]:=NK[	@snqnh=wron*N[#qRw{H7RLU$^skU];'{X LVk':?;{N7wNm	9;5.$RNg"tSh"J*'o>=RIn-+$F,sC'pB|;Sp8&Ab-	Fpf/)[gGY!=AxK:	WjNYe9i6\}e/`?9SM	voo;Fj:tZTX}GqST}u~5|s(-fVx`y8(ltba4}(fzS-e[aiLS/q?M^~ekZR96]ORK^wlSnl_mrA,Y/Bb?1pp8uBwAc~$T3bwT7Cf`TqqC'>LM%l`4%8|whd8a0TrKMLdkh,{MVd[!ACr h/`[<iR-W3DVo+[sw{/8>7SpfC2#>pg UHRF6v]a,
P$W+[X$cx.ao5!7I`z6u3[8Q3^}im\2E,B2Ht0w;\B]3QncPPMFbf4Sl@TT!z~xy~hLUjCuR(pe*)v_LS``<'tAq,5P57+F2JLjTmUph\CbQ1>JZAizWyg<wjh\sp6r%x|EQzm}$uh/!{.%: ?e((N{XwMaF{:)]V`/3X@O#jb[p`%eDn>#\;BF/d#U{Z0N~-smU&zONz|- oK$ApE6\H'9w^	1m|x$ :MU<|,yv
7C	`:y'2_7Zk`UEg$2W6qI#lPPuZP@.d9FjC%yk5D%s00TzDg?w/s(r7ab:{{|#&cS9hwR5Lppf/8(hw3&gao"7?V$0Gb(F>~l=kh2C~?Q~N\Gwq;:v02WBM*RM2m*hcvx2
h7@C_eo,(Xw4VeH\B1W>v8,@q2/_*ddTsW7G %|<]2joTM0 4_b'"nrgt`[2UjDgcq?8'/l@(qH0r&#JGx1>P	w2pO`GoH4L
x1ELtw|)W,;6oD^I-!~_i
Pw@9yF|,6@_ol5,=I=al JE0Om
e\yX@l3J{m=q>6Z*b"y#
mst?}<y#)UhFy5SEHyzYogfrT5K4lz13bFP54yN daNUP~@>)QVCkGvwLp:f=b73Ay@ajv`fgf|(qzvO$0wWs$TR5%1@vk`4u:aZ=;q%e(uF6qG<?b<.3}IH%A6ZncK B?D3lP2$*&mTm
II6v)Am9Z"|)'A8x>]+o=\q/Zgp@`EhKT hgpI(TrNXH<*,mq"Q0NH/2DEJN9L(-!s>tSM+_VTp|[2NEFA-V\I4rgq0-U=@El"I"wA{*m;}QUdTKi<JR7AdPxn8Kix4p&4q&iSdYfy0N-&g#)s	i!F)J&,he[v17#EQD4f^a'Hu
9Z(#CBJn1
U
nR9Ysk{2ZOdSit
eF@= SqAETb:Fc.i0hk9"5SIZWgrWS|tu=LL-C)|WLQ8QYO2	kZj'>9zi	Fu2IdnC}C<{X:q-*qc1P$CD-J;5'=)||*^u	/~
%S0c]b%uj^byPIJ
phpDR3mV^c|6%AV/:>OLE~ll7`c%-7v#+!
&
k#
<LoGP$7#u#d*dSWq#nJT8dN\a<|B:u|(/:O.vbN\8ax(;yEeaAS8L<JwcNb~fwV X6[ib;(y9BJ?H%kzIca]~5~6K.N0  K}WMx|_Gy};es5r5}Nt)u,!5*qs+3RCheO/C$RVf9<+6uq]">,q44
xi3/	^cwu`G2 _	2:N9G,;cp@pNQpTH$C%,;83$u]Od&_~W@rV\Z\)t*LNzC[uo{J(5AYm5b#[(ZYs+|(C/tr-Y7_0IbupW?$@FY]`E_>Qc|?>qz4,4p'yXj=bpuT_x7;NtO&I(:p P	(Q%J_EYlWFH#/K@w(,9pxEw`B|vL+~|~++rBRI4Q7 oflPn652<&hn)G:BvAiD4lR5*&1*5K/m;QQv?BG	{Ug<m'YHxh=Oad3NhjO?#.wI"=Hf:DGduu/d-|-g)|quW3hJ*Pnj`r f@?(5xQPcjuY}";7ZFGnh@/m-m	n+VJI*:/ r>G4j6SSTCmb/Wz-ncra!Vz2
4D(reus%2Exr2UscdWH8h'p:Z9-	s_e(X- 	Va$QbY8 \92#$<p`y\REEtAW?]>lCh'X+
4g=='kjXVI3T[o[9iIAhLt!1Dah~3skxs)r,}}skgRMI9yN'qn;JH<&L E+-\'(*>e"6M]8q9NQGr2SSn A	M"+e+GVr;d4|ZR9d{(x^X>RwFjJ/%fiV],b|s!8(5#&}&386p,)eriS71pxVOAGf>F-[dEhla+pqK`8>sr!"Afp$miaGQorP=l8Q$
g9J<,i	rFUz66X66VH+AX:2KJ@.
=FdNwa0Ix}NwWGv;C65a[m"\Z$f
CS6zG~cg;xW	=Rm'2l$vC/LwSc7R/t  yH#b	 8,ks~2#'F4Wi46Jq5"V}+U\#QuPm:gl5qm[|ib=O%liqFa2Gobj&\vo0nCmBO-N|xy|(d/EK9Z&
7B,j:+r=V|s^"U)@9eq@4jLV#<( ^W!}?GjDz<DQSQgdr];8B#mm&j	_<}adt}{;RuuX-Tu=TkWL*Rux{p_4L$\@%X;YQ>lcJh<j0/yZHbj10]-Sv;hJy=R
racHM#<g\6E/^z/I>nPNWU
9;alW0Ws^R[0`Jm4zHk	dnQ9nO"cgZOx+2m@2eyB,^i75CpM3B'`,lDw#pY?3rqsr7S3RYz1@V1>hz0(ak\
<O/OxEH(w?6MmrNxjNuq'+9)|t+~ht#j{-%KCyR(V^z<,9QU*^##	r/*_iM6(tG{IQ4S'y:iyQLj&XC}[Y`>v_w )NF7p+	^+
D.G}uja`Ml!m~VzK+Ucc%yu(9v
EDQ2,m]Za)xsr,KJ|h"6:UYKG,j4\C}wP,7	Az(ZVfA*lnh,PCJU;h.'*# y%~d v'G
2t"QCh[{pI v;y2q`2
F$-`<3(fs	;Q1GY0!Z+BT{?@yi46kM&I8I,8N H,I[zSMN2'qb2-YYnx8AyDR#lJ,?1+p`(,.p+qE 3!yoj\Q0^9|8~7dTZq3{	d&S'og4U
D	@Ph1*AFp{9?_,Sm4CTS9(OsJi,3u/ ~~L6[$fTpx-A+A3E9[j1($x_+L$ClWi 1#nBdTSu	R4`o?`Pd$#.I#~FMR]m)8*RZ\Lk#q%Rkir:Ju'Wc7luFd7a5Kx-Q;<J |V?3{j8Y.[?;7U> 5Bc|!62/{i"wcvQ"2\jV~)dJyPc
D}#%xy@:FbuoyW{O7civnBp(v2gvqK.e4.DyXW;@qH"17*.}SQy|{d0JJ%}Lv0n)gVS TT<#b'Qg/Mpdcr5>{6	pmV1Y<dav!8VEa
S,tQHhV{}F=|Cj](j6_G.b~ ,t
zA3A+ySKpI	BT,{`mMuU9_](_A5t-D[J?!S5.%(i= $Jx~0>p]PiW0"ti9pByu0Faew%#;F,}VzXbx;vGr''AI1Ai=W@1x9Jz? qZ!2J(R8Pbn- }gl63w_&>b~TvF^pEA]k*^c0={/WQY^ P(b'P	GhQ$u&K%J *
!E{07|q/Mh-px` n<s|;sKG:!67'Z!a",SXTx,cjQU*!!]z0eNGx+{SzoIE[)?+xwLq~N-Mgu<Qxc8:^z^I@}e Mh`.o&/k^woETxy)d Al2'iQyIyE#3(9 FQUKo6o .V:UGdrIaxvIrg16P$$x(3ZLa
00K"=0A,[&iW"n*HJh)3>A;H
 wk:=5th7O
e]XR.#
za=zbn|je]wpJ~oNNiX4. Q&QRy_*c:`<5l"LS.V/@/vS<4i,nzFBW^bK_0F4(jTu){N+I.4=bsxI@vDQJ0J/*M*+MH6Gi}i:2'm6x3< ~3aQR
Wol/Nc*w,yM$P$#C( ,! %M=G~oT?E\d:g^0\zIP+no:%_N rm9Yekz^+o,)hE|vincnJ8p1aEl`pls?GDo5B!0b[`1Z	|boP8 `ka]ZSFBRB++t&m 4$R*yJYEKJ2af}	a`=#~m,:&"W%!ZIr`)l^R6{{t[+Fh4)HraRI0nz[\P%xHfc*};[BA2:QDQbM>%q=u1rbE!`PB7J5J3V P~`U0a$F<#`p^,Odlch.:XZyo}UdI$NF :FUixbhTzgk	TS=`7m3,@k(	vMIjuB!h-8T^?N-QW3bOn
I2@-E)YU<	YF/S@E:)'*{,ErG7^DC.ZAm/_-<&&Mr>5+
#F\9x` A})v ZONOZ9wpeyv-		l9as@3?Qz7{~Y[Nm#g6s4f960Pe1uICMrtd*Fz!=rN&{L@j	z>:?[|Xv:^=I0Zesn8FZbK5PNeH[Q+-	NiOOP6E< UJWzZ@1h!pm$qYdgGYx&f}wx#6T`]F%f5vhP:Ka21Oc`02nd*{(1EHDfhkdXXtWSeN F&xBNnJi};jpq7~|]3|!DDNBIQzm|rh89}kgi4htR' {X<67#M ?O_H0c_^#@wCGw|{Cx#9x5>_^K?|`PqVGG)U66H0F+vLK qAC)TsFg4~s>7%UkqBV7!^ o6jx.18#s xg-;y3&xg[DGvkC[lo=![XNAdubzeO	hrFHG]K{zU0*aoH8v#?!l-Ls&:4YNrMb 6qu'7gL$!|INzN=#	28D4y"WZ.vI =]k_44!RptponYX7Du*[p&xo>/-F*k^e>Z Nd4g:n}p&Wu0?ni	|m`wp|5p<_\&<l(YR6lN<]``]_Iyw|^zuTK\4gm1{c)FP*C+8<?2tPEq@?H3J1+_<`a+pgD1@(3~C]C"F3*-(tX_d8)Fr%A3nyia^4Eb;eQXBoxnY+kK.^h ` ) (KwQkKa6sfvp'f
`;s)5Qx 1ay|fZ8Y1{FI(lElT!V.ya-d
9E?/JFv]][tGz|q7y|nAL}VtCMKCNh$nR^lpi#?<1Q-w
u\I$X_"C"),<ZK<kto<3%<.Mjua(lQ|}eE<K{;_sw<G*V#"{ZSeaBf#+QO'6DMzF0i^<qarJ?fA11*5M "%?3bQT!JyM.qsQqwZWJsl:Dtf{& 0njM`n?| :55vANNF^t(C=p"O;Av?o;a.!@	yl"w6o3}*\zUt{LL.qpmFf\pPxzBWA)' l?_>zK
7Ou oxrvhQI9 4NQjtoev(9/kJydVLj/L{{yb
iff}($|%tA%6.LL*'4weKZ6u}QV(:F~jm~16[}x8}/A$&%;7"TX&B7k>khc&O5J!Z@zbE?;\q7bS- }W]br&Da&ijC4e%Q{gX781qE<G9Kz>>[n|$1PM\%zA]!xN@Y+]	tM $4TwP%U5/I/~]++&x$i8(%yNd$]?POXtK7fuQ8tF4QNAOQiN$a2aA8"	(:AS} (L\dEQFi4I'I:d<knV+XFI4&Yy<`xn
gb2b6L"'Q:/rh{0;A
`6(Yd1U/z%fR 5UkTit,Z!IUsrzsdt+:XM -$8EdAp-iYpS4OoM<zo]6*{dkMa;z
|}O[Jk	hEs	po=a4a 70?~s2 ,:nFFx*yo|+nNDP1d`	yAi>GU	d
[}t=1
oJLRB/=#w(J#_TCBd5WUU .Tju0@uLBEPAKj5fm 7 C?M	j3w2kgI}M>8a+5Q
fFmtusph|!0ZT,	Ce9@qNA=Zj0C! :B_ghhz!KMW('q}%Yln6ul\=1JLib8qw4C2,3W-F?S3L`h~G/~W"(dG]G@]suIRNq,QqCBz2HbDQ-A@!
.3Adaz3ifI='`aN$noO,l)9=I|>#
vg>r`Sn0'xDQ=94K 3!0f[(NOWLFD=j,7,Uf()Z~p5Oj&G<m3jm8Z5m"*"9W?BLT#^*gvVrMog/A*c$9n||9

h ";<gj#ZH[B[:ebuolu
qR+'H"); g^cm\[-	<b33a -LC:d(L{xq#n#]],F5:,Y&^' <Og]O'<I rXfAizhb)WpX,``\m94!&K*!dhh\P\/6Q2I3b(dNvc::Ciu;1i2s,rfL|B0@0|)@1F*4t&Ig3rn-XoL\U9iU!v<E9AV Uo,HH	PXm4R4M{Yd&7@VgqAg9^U]@q,a#H2P	em)jsr>vH0yKp[
\;	t6V V)tNo}^_P-H9%dL \t.V_$d15m@" %i)d%vLU1K#nR%@JS&KO0CX:/pOmP;SCt9OFb@*%3Q}7 e$%~pQi3FRxsDM~7dss
;=yv>Y/ZNjyoR4kaVS/ow|UOW1mvi7Se.77+I|L0u77G$<
'@^,Kt0Xy5H|#uFMl*2XYn<f}Z^lsm|#^>U*@a+PyzTLYgW Hf^0e+Cw'#';[Y*A%bc$WB(9{L{02DT=?\N]7U!{v|lsNxY:_W0`Zk[xJF.TEi>%:)G }!0lqD7vn$L l<M|"-P{pP>(h	6[b4ZpnDhZdy`4)Xlim2+bkLFuc})]Da+cCu
T)u2P	MESJ1j2[:AZq4WJ'p60y	&Lh&6Vk*+<hX=P:^TqD%%)|Q!9U[	17F>4e3 zees65vM*#JU1AT .oJQ+Y24DGgkEC(gH+<IPE~JWVQwLDny&5MHln4H`"._4^j(N12@i>|zDn0	Oc~Ha\nN65S?>\:1Uk14F,xWcM'Fa`M1\X15w:8z,M'':*Y)(FO7:A-OGGw981 &x<KN"TtuH_s"6"h!?Gg{e9>;Ua7%BbA!os]M")z~[
x]!Fh' m~AD b./s_U/0->v,di20h]l|ZJB6X	'!EX	~2q=[N5+7d ;h7uo>5OQ7#l2
6yd}c|vdoqTH"Vt@E3 ~RuM7HYHjk*=C(>V *&Elp"bXT#n;`iX=5m@mKAs'4l o3sV)5d\o6 xTk,6mD"0FbH2UIM&]L!`w`i]dE8Eei-h(t	Q,0O=fT-?qJ><?1:#Bzk<T((BL&QDjR0&#.&,1\@w80F9`[|t*o_zUoyUAk2YPQS'~m&V%#xbBBg2-8$EKg%(lvG;4\g}C$teVh"k9s6v6Kk7={.PW_V1Hh ItA~R1s&[;5S"I5*.v\ldUhmCW]P{Y:f^6jcE{hOC I|stY1C*?~dd;A<hZ7fns[k;9J^^\Z-Q?D~n)u	J8	BXAH6hACgXx[WY		FgopAAp[ KL 5m1&%2Am10xtQJ7Mb[p ouB
$Z/msqS(,c;AF0(0
OD<6fqMgn.vN[%'qQe`rzab)<*C
/$*V);c*k	6>614TS?L\&E}QJ-Be~###R}t547w8qVB~5_Ri^`d"{P.2|wD+^x0(v*FhO(xYxBXgHOr \>
=k>@a\/9hk{_jfhw\OYn?=ok!(fn1q$W\xg \c4Zs9k+	q
*A!_2aTKt%KM-dr_M1!RU^wNR'k)xo>X/nx9
@ds<SN|*O^}8prAa,USsg{]3\OO}yY <.ID~EkJJi~j,cej<m1+-aC4}VWmxbtyZQ*0fx *q?a53h>C|XZuu]Y
PR 6LtBo;^,UvxhneVQgPSpq3>:~Hh'haSZnJ^\{dpOqxI1J*#UjGJ{b>n.WeLIay8:I{A0
#]Qu9y,Sk0yhM?=OjaP;=X)	EwO*s,w^Q&.:q>a2m%wMVI'oO{[M]/lab}7@>OM <\rJN[O@^pz("*JyT@af@5
Q6*Q<=7olMfJ3E^G9;HW6G!<2a?1~'gFj
c 5 0kue#6qF4cMNdiphI)qcbBEiMUy^/
D^Y/;Ipw?YYEYM W5-O;aI
7QO0ujA"(n(YbP(jfZ5JUbhnr;!7
yN,3wL+8{(,C5P3t'nY, ]C}IhQ{B	 &6:]+cMQ<@X6eC%x`BbhXV,KdH{st^]aml${"Qdx=pa;0'jtfJ$`L0_lhXVL%3;5sc2A=E$=l&]<"&'4A$t$0-P D2Nc%OjN8M$ZiZ9bA(kT'B:^hrZjhibbwlHd40DtndJ$(Fq)q]:tR+alAP]<5eq--%kqDcUg<,EdxrvBsqc]."@w	,uZc/hyUZe&ngZ1OfGd	2=^a\6(U|#eudo<T2#K{]"Yz5D1.'2S/,/1*>A`f:!ZiH%1 W<R*o^hY1lU:@41_*4&AdsY#{;gvnA%,#bdZATiI|]xDO*Ub9t[+RE}(:dN6SMaeyyaMI1u0q^ViMFl*PlVd 
Ds{uBN Gdb,'X#I`w#^=IM]s^gG?lkL9r'BsotPlcxM9r9(A[(f@0hlGE9,FfkRS\f@zvl[mwU"tGO	A[!Z:FyJx?S&vJ;q&]y6V3`q7awcW/a@y =LHVJ>a#}xZ'q:^Py6Cw"d #OE^$<&;d:#E2p$I6v8]izpQ3oe&AcEk
<':fK3L)KXajf{ D+e(9K
Aa@E9VC9G01>R-2Wv?16kx`HN@r+HZ``8Ckg!}614J-< -Cy1pPDvM'WL'[QP^=}qR/vC&}U/m),7pEm\Ony};,!<9&`<A2@/H-7*W|S'8A~>~oeGzh<	)457Dn#lHV0Zaf`t-n)9enXW/rIgi<V[6ycB)]7MpOI:yDiQT4S2:+|1Xh3hw!'uAJddP}o;4X%2;@Ut]}KiLpv5%@'MnfP4uL }}Q,?B6:kSjw_oAHKhV:&NQIU.(JJdM)[ri5~zO6P'k(43%VvD1YP)(p[Y	 A	Jv{qT5Y[p0B=&6&D4XVYaH@B&v'a8F=a!E5Gmg^I6s1UER	C
BkOOx=ou@4(@5vAu,RFl}lTEt[
Y!Y3i|]e@;9Eom3%3Umz<(lW0Y7[J2<tZ$~Y:yK"qWc76R(*a~A+TB}m0V_Mkx{B[2yC`Q'N+$l 8CN #Z.OH{#zeeq%E'$q+&Y
T&?0dh`<iS	Lp?)w)\
wmc@-"C$}&x+Lv/eGE$[(s~Age"&~)]aW\(q{rYc8::-"q>_\8Iut-{nu9#raly;}%Do2Ba3*DIE+gYMScPB5	?
G DyUB[?2kgq4ONmec9VP>#YtZoElq81(cWr=g#<4y6\'b]_<pxXX??J'4^SjJc<fE-]uS5gfNvR=k9%LI^D3&*(FmSKLO@qEg Ph>/
aT&.bo~%'iL&m>,Kr?T8p.6K
>uJTA:lsHye[Ykk7k`;z/T80.NH$N%%q27Z!sac!\uS)hh\oj9.+,u.4!6kTgCw%|H7%cfYn??0-\5K^8hG,^gGx(Gf]w>Aiu:C'LwTxgw,-N%X
(^Y6TEn]W/Z]
B
,R4l
L*m>Lc|_@eVe-_*c{3z:r%DRel*D 	ExfDC$-fy/=l(<w<m<mNn8/5zVy86F; <AAL`L<T jv*,idG\qZ+P&`(Ps<^3w/=C4LOVd"d?4,AAa+1Q~dA
BBx6 HLCbXLh8disiQ	Ihlm-d%cHm**aTa%|?h9"^7$l9O,XJjutK%eP*.a'}g8:lwG89	Oi5s<:8h7j V36tZ88k^2b#pSjX` 4<0EQLR9{3w}<sw:ZbtLmzvQt3~}DD&H-~L(5pmM*cy &pmB Fk"bw@qX$wD=}2<*HYmV;xR&J	el/9"R75NF'57hI(j !AIeAh'7N(u;CUR[n4N8wX:(8v&w/h3*9H'0'NL+p=NtzuiS/c?O(ckZE' FdlA^I0Mbs,[8CX'izN"^67+_V}rv+R-8vj*l1ffyzEG}R2rI}msI0(.E,KxVd8<EO7m1hxQI[V-t06G9EUO'QwI`^VtW+~}_%ilj5UqHRxX.n|u9}iD;&co-"GY/Y*Iy?5BB^Zt"G{u/3v6BQ#OI}lS:M}QKMc*m.Vk[{jmi}fH}dSAK$HFA8^aq4D%.$$x]9IIi'@$cDd5G<a_Bx:gDaybFZJ0t@%{[*On'
4)JAi\cTu@ g* a<&<n.9lKR<
^XCb^E@fbmd@PEB)Ah?8,uj[S2]fw'%6H6o{`Cw= `2-"45[oj56h0@(WfUI2m-`bEY}s+Ehji.L0Zcc4WvCyd~y6	Jg}Tw#$D#3K#Uy\bJn1qX*bT7+&52!9'pV";8P`n2	2Q%+j2y.D^&8{ B'i l_io4Oxr#!hlj"E_GY-TY##XwI'qH:k5vZkLMG:mzz5vrvjWAQ# Pf5jQ#Yi6zl65_.Q&y	e!AWV=6xu (n"<_o0i_@_S%tPcYLc.^O*Q,M(@@rqU']#E5C7Ew(^b59YoXy(he
499?.iY9TSn)|D]D}]|H|FJA@#S3W#[b79VnC='U'M{8'i@Q$G6}rY:@C'kXPx sAucDoV2b oG6%0e^!nf(Z&!Q!aJc1'O$MI8I{NB5~c]{K27(Bo)$/LF3!)qjYS&W%ug
A8Z[D~g
C-<M9_mxuk9Wlx`H,ZaES%Mk*'!2r0!],U4?$&Dbk) <h3Y$8yEkNYdKIRJZP9lJ97?<Nz%_	C{iv*QgksCS5Xo L_W??D\2b.t.J"!`w"'lq31H))Z).?KKT5b=I@mDWy4HI+S	RrI)&$bpe5p8/A$%tm/GrveXCm
u5~@~~cV[fJAa5&D2|Kb3cR=o$BaAB /%"I%}>'Gns@(
4tB.hMl3vh/_C ^)^gM^?cxw]pm;vx(\DItO\bZeC$@I(beua>ED#@;Foh_uExE9^F8(&
{xWKw/({E$'Wtp8MpeoQgp06rD}xe:-HI`@Mtn0N=7nC-icQ%(07MqsUd>^ E	6T%i4Xq
k:4A~_TL~%^FmM2	/p42#xa zT_|zfDy3n|Wy1:OK&r eLSxRy`%mjN2>KG	oEjQbhU)P]F1oPQDUf`[NXmR>x?z"Us~ueiMEcE^1SRT3ki;5bE`;^6NfF^*L&sbYK{#n/7}\7:y}/6'\KQs%1DxvqgFC8Vdp}uW921tU,DeD5?5-nOhdG/!zH)W!^"%t,X\sQj1x</@.!d6o}ImL8&o	}Dc ;	-wD>-54Y\;v
c4|_w S$+M#!=VF}WU^KJ=^V>xqaa<C,q*"
@&h.I3Ew7~;4qO	5IOf^I2} 0BuZY/LdTnn>&)~m"Jf,F0`dBGX;CdpU/& H~"I^{sX'\	j&E"
$lgV8P[Ybzp>AzN[o 0x_uz8^bwqUldNF|xC	h|jO=HP?m	LiF3X9g3(g=Bd~$K+	rt?
_NVy&aKV%=p-U/,n 'N9rCg)T%@(seZT*8^OGpQ.&nR!8*i$\!gh/P0O7ix{qEacMpR$ ?X5QGA9xa:v8th!(c&nl<%lau-A;ZX|*Zk{#W)"0 0(:Q77_yEb6Lvoc@mpR^^%g:o`A0m-^TyFhW	~9J+`L'*~jlaVp#l%'g4;_<\*<vy8PP_\_u<?Hd`OBM~xJNFQ<8*;>VWRaoJ|H~5(BK|Za,~ROWH,`'l(LT	Pp.<%)?E3EEe(o4b:WqjL_e|p7U_|_MrzU_>mt`QrN	NXyzaJ#N I@7)tjrPX-Cp'q((0V5v<7.7zs+A0vwg% .J$2Wfg\v7ct[8p};@JDnV@Q??zSs~*Ix:HIq'O&8O0:so:h2.&wSxIO'7n%1@	~rx<d jK5g$cf~}\$}CZM`	}Z":bzwI/e/J&:'bgd<[!]\xs~2.y/<pKlfmq2bK3?~68h(;J/dx;NQ8&0"A9&AOd427Bq>MhCIUP;YN[{!A4)i}'p<[myfQi94wCt2CelNHtLYMsL[SV~001-;@/}.o= t~}D#Pd%oA|vW@A<kFbf{waQ^TS"%AER;TZ_FV<%$,}(05\p%h6GY$I#_#x!j=M`!0`).#)ozN9
BG48MsAAAfG--^aA1WVcTAZ?mUe#]<i	) n_ggU-	&~ n1&E$4cx}sx[u8	9aAD8tLFn)DBs)-4[:x
qNa;%OM )	06w~/rNnF &x}2mtbzkqo%cew/NFc;O*!F%"!+X[W6gmNfDt1kZy6+J}YI=CN3J%XCkMfQihgoN|%OSW/zkiEB=hD<f6&qGE# 4!}i& xH`NbT`i3I	OhP.$H'%O8,fpQ=je:	r 
PNC'u+`2oa9MP K9wq
n)ex[n(%Qzlsj/kl|b \?0k;lsrS5q+aj4@'u9,k nhBZDR`h(}SdAEH;<mbUH'gGg$W!/UE!2LB"RnnG{.iAAAy!ZdcBJ27Ao6oUz\ksQci3lT;x@"0MnviA&	J:W:9V0Vc529li1`0QvW8?^)d cvi1.'w7mOehG097BQI`Yb~971DV<D7\*Vr<cDHyZ#-fxl7 -xso}8[W+:*3-B=\4aI]2na)&rl$:iK4 @HAP{Zu3f8*i@"\jk?fM
P:dQu;C|NKo>lwU;[*@ sIgU!,v9U5))G:A1xu0r<3	Z!;A{'!1<W%0lQmFX,5z2M#B4V|oZvYT>qV"	s-pN+I;Ft{!	wDB:KG|?	eo1b6"PbaHY;^T:B7}(:ZR)Tzc^AZ+\\mCx&_yU,ryUrVlYADU8XkSz%
%)%00}2cZ?mr/cI'K`N2q8J*A4u^_W=z<,M	c-Y1,<rC,^y 	<u7C#Kd$({Q8;%F1P,"/2g$:$AJ; 8Nz!>~,G
U	I/|vmHOvNtR+%4PI2B`rP3ROr18g_K)9,Ca<`e1&kR^M*P~${FcGF{r/!0 ,(g+pWT9`b^+L'r^vLei%L7[4.@F&S4C#ucl}Eek:>Q	uiQ*1-Uo\,u&d2h%JP 1~a:~#&GtRvmPb~Bj[vRkwfzFPsv'DH8"
V8~m)^&f|gVZVUSt!tc<)
IL
1y`JX::9qXT"\	W<k$jKS._|#Y]w'-B`(6FKV<S"h9Z.,3;gJ&[$j@10np|umEhv7HA ;@$=i9cf3npD{9{%1 0`7zke 0-Y g0])9 O"K9Y0L+}CrIT 12~l0j{N}BdIJOzPJS\yU8n/gx5;l
w6l)VD|#[3atw52S5j!mg:8hntFD8VjkXh>wft?B[`aW=.j80^MN3XiG}S$5\DBES%viy@'i`@5(-|*uJ+9nsZ57g87jttm;/Oz5ZemzkGf_|wHxw**~v.J|5PF0>T)T!7xz6)r|{vqSMF+>4uN%t{J_Si8m|n5En8OAY,uH]|Ge@~ILFW1g[kZ:[}I;h<MGy)<tF88=7rL1}|[_bQ.@.CB=}|5^E
Q#{9;1'1;j.W`_G#lbu@E9s$|.ZA5piibEFwm1sq.UE7e^2DWK~ vddaH#iD6AtjiY/*Uy8hb7e['*$d	oUe7 {3HM`F8PW	BdI3 D3@uXQA6B@(jtFgt\98l"0BHou{(7x^_P'Y. 	@!h4U4YVne>hSAd	h)lAYQJ$Ea?)k$$PIjyvbyna(8	p2\LoV?vJg2s'GJt3LS]
EYHA.jgM;PWA0|Az3BEU@jU{1jXYJX A]~w{6ta	i:uN0>AARPnD:+/<	nm1TC01Vc1(ae:j`%t[D7yy/207l4bvhik{F|IYhj~^!_h@7Z0~W[`%Fa%IbTgc|&
&cAl& C0K+
hAa\:L`F#ZfLGZRlZv@]2$+A!K5`JtF;~4YcHT|-:kT)PfUfl-hS"JQC=U2kx0u>-JjI/O^8r+#n55bu	?(P4W q-X=@adwfp7
WnnhUQR-Fk5_vNwPST g([gViR;@tBgH`E)KAuaF1w1YT<4a{M^
lM(8r'8NI$W?'[*2?i~d#7hS\+'8]'<ix/Jz\p4
$HiM,vcMK\~NL/b2C?i-9#a fq B,q9n-Y3-
/e$4)&E_s5t[GIiz'p48M<vIzqa!fx 0~EDqNf bWax+,Ad=eZ9DzNCez'sat7Pkpr	n
8=RGjjU@#ai% 5^oAOu(Sn6:o|Cl*d
k~>X[6N[pG{f3WV.+b2ypwuvrh->NA?Tr-+m.	*3A%@WUl50:#H3ZtVx[LT|E
s(o6 ZSA_B 9F;r>#JoZQFoAVTi+PUZu]%w67{{d}^UevT$8q!7oYi-nQ~fsmNQ~~boaa6Sp/9uIy18$=EsjKRAPp	3`G57Qmdp$%,<0vF|3]6RDq"lwwN%.4>"\GJA* 1lu!XhHQ1j9;_-]-CMvp'	{))`~F'ZWRUG5jVo?'<ycCHt(l=`|)j<W'%E,iA0	jN1Yl> ti/]-eB<\0&3ITP+,mrm]FtpTKdh2<;R(xjU7u~m!KKhh3m&y#Xx$Ac
Of8	<ql@=G(@*	:%4q_	02I|evI,FKz8a<V@nGAvLGErv 	J`dNhCk(9*Xhl}t=V#CO]!QM}f5F4M^XL8	5<*6Hk2$G^3~(F	PnKS'H,KnH'2axn#jQj.pOcx(xh
QWhD*~^bi%#$12$p5cw4	8VXaF???{97z,(QrD6*dH!+[@w?:F.5oPO.%gGeI~}?Eg{NFlVKpv'`!(B;>^+S
xz( J&=eyx|Uw(T]/ Dw'-Xy{}g`aHsp\(;lf4EVG}03FNgia@go;dl6Czq)t2,)7]^(0{!.c`l2;kZTY6/$'BzszbHk[KX=]WlW,(?FT=<3sPAPv"Fh0r%(m#E:>0PT1@?6%#a7xT[?KhLH1MP:+#:/Vp:z/+D**;@b/>kPNb(~&<Cy\(v6Ods%fo;we`U 8|Tb?;CPo.Cnx?&d&U2_0.Zh-*AQ7HxXr23\D*X>!VNdL!:<Ea);2@$!6 %eu:X 
VZ?%Z9?*Z<[U 6C.o+[&M52A/c"C*w^(Gor)Vm	bj*]G!8vHTA@@bwpuT`zr&
b(.|yC|(~
X<?9==> )OnmfwR<y- xSl~35+/r_,?6TzFI]|c=OoP5fAM1v}~f
'-z3Y?-5C/)L";:n~ed"w-^AF~{=kdZysFe^Vfmi&Ofb sDfJiMuVZM>gg:MP=2x:X<+T=]~V6>*~xUn=T ^h#8-^Mw#,P&4a@0B@V(%WFtR/!HRt|R`P}5az>6RxoNN[gtE;Ogt6:,?bpau|XUtaJ~XQNcxqBm_m-_35 P5K%<@<C-6fJ,Y.v -m@7e[LN+83'}_Ci0a]H`9H`Qrt^60!OqOYL[{sP\[Vp62KnMg=nM=z/hk6h;0YjdX#jxS_ YsC@TVci<+FY5LZQ,b2b25^!V(:'7(oa1d ,I/G
H9A|Fn@W
>(8B
q2Ko>nV:g ~%i/pGPr$G/t\|c1C!\n=j	~p}''->q?<~`#gUL#@z/;0[	z|\wSc @I F'd\hz[jw+&S_8jfQ3iqL2du~@w2nFFju'1wMmm6gzS3Poo<3^wEX79yOMZldSD94tv;Oze!R!;BhP/vCxl>QqOL$71^:$LCg,@y7H4j FD)}3Lg~$e5E\$IO7
OQU'UD:8|#JH#kwCk?;!hl ZNH*Ax^d(D9Ixiuu}fvvp'?XwcE#vOpd<?
mnF^kRivR=*cC9A:/,\'FQQY0x&	.N+i)x}bf=Fz?'CP99;!jS51D_+[J=C`'[0 %,C|p@GBot?l`M%*]>cg:^>6nY*`4mkiSgmK6)+!EqGyh$<F/0mFQ	zUS~v5\;.@^&z0Ol^6ds=-09(4PYNCvIr]8oow$GJb#6z"8 +AQE7qg:9mXg90>?S~d(9zwIb_-o~NqaM^Z$!6g+'d1 zQ&j'@=p|Af_Lu&*Yychu@yxgvoL2PSJQw;IX7XX\3PgI5C#/M[QKzP2lACaa@_o` 0Z@,LWBa>&sbnh|;b-
Q2g<TK;
b+p\go0^8m	nXg:l.a[~'vp\.zgaN|x}bJWa%Kn%&'}3q(?^8>(t='y`{_VVe#0>"?v$Hm^={@"k*}jELFp:5#w8*H=dVEJl#6<avhruHbXcR1%9d[sl$VQ+G|m((Pv`'LcWNt
	C[u>1Jq.Q?/29.K, Hgf *i'gj.o_ ov:\(Bk9Ifk.OE	INzuh[:>W#
:AE)zEqpo|5jWkp/}\ww;nopp6.5[b^2/q):9dks5XQ2;(-x& ;2	JS=,|:fh7In*VP]!B!%HG%'<:h''!.;lTV,@8A8p4{P)+3)P3}:E=7GVH	
N:a@M:V){p"%9	x`q^hfmmh+jFm&E1=*w<+uWOb]E:rAwfT~.bM]AeG0k[Fk7l;n=S0W-%b35vXv{rbUZ|rr $ZT99, ?xv]A8*^"p,UAxix2I^$ dstpH"0+8."K'Oc(+e:E*4Uhqe&Y9<\?IRay"ENQ
*cT(2"+(<I*LW&%M?HeY<Lb$[z"Jv<fC>{q{(,*E~dG	Bhy"QyeXD^2xP~*C1!?i1rhRc7M *|qGt'IF>TeYe
G^"i$nGYqE>Qa2eg^YH;L".,PxNgfa/cwh4,rKOjRja4a]3S0q
;4HJh-BV]LWt_hS5E:M`rq7gfl4HxGG0Dmh$>k0d$#aF
66j]5M-
#zXU{S*:s_kAr`ZF<bEms`g)s8zm|FFF7+c'5M=6h(+zVZGW59la{5/pL;)oSU1u1ETAiG-.L15o+Ph~~rP+!,TKfrL'?lz<'@E2J>+r%\$1aiK4uAz3v$kL{>za`iYW{@B*6.ewena)Te"X,lKOitxY&)8nQo-dbn-N>Nai
t}FYwPki|fF]rjN)<8jPj\Sd`p!C&&/j
+_lfw?#S2h*"cIk+%#(63ZO
!K
"
 FQ@|Sz:u1`UM!;.)nqd{jyw4CU(N:P-{qLEH)a\jS*hR`jPk C T`rLH6rU{!w(Q`Mg.XEfNf
U1- s^x]=34qbM3}|Qqj2fOBWH}m/JN}':76YS|Pn0ng0sN$+fz+c,*	xKY4+VDEe_
T<q6CPezgo*Nuopkf5'^InUpcN&<Y3kZhym?j8pGf	~-77>=&B,O|~3yE>M~{$oaX}!l}'1k7SV-.	0{>Uy>zzb-1wMUkuz+&;`Ays7w`GOaBS8gra*\s;$}LA^=<pz.45R:_VE(
cE`uI+/Wyw.zioeZ0,J'BO&I,RHqYLq	,\qfiWY8i^],  (B2LGT4(2R	0*-822%-Cw*_	6sudkIG2;0	g{VMTKCec-CLk=Gqw.bn|v8{q	@2|`*0c#G|*6ynUAx3|15=:%A'kvCA%yPen2U1dO#RBu=E[;ITz~|~v
0!\e?^HOF5o[)} KO'V\Jb[F2 ~C7/8i'A/)C<qfJbYWvJS/uIE7(:B	u@)w= >'
IPt 2_X;/%%
)&yaHXW@Rb	1c:ca)$UsGT[p~ThxcGjS#b+RsKeV9N_C$o~hAp%%Rl@P10T5`Q*(A+H<;Zs2c^Y@6}{w z4G#pQ0y_n 
6QNkk#XLZIo#
/y?\E<7L3$M! .ZjsB;+$n<Xrj`^!KS_<.`O4a0}_IgP gJMNULm!?9Z^w_s|&NL]Nl:n<ys@zbKvPj,n+Hio0N(^znmTB}sGt2	[.f'T}KIw4*[M[8Pr.yBMpY]f|t6<X2]17
3^Om7/eUm{@p:NOuYQf 5*{=f,\lv!5yhdm< =aGUp#x5)634bq8*a;Fb7
8ww0-PeXZ8*iX_qO MB?b3'+y`y(%~+|M &<-vWdB5;(q2Zp M]@ \f\@&j_PgaJ1z;-k*B9LP4x#?m+!yC!kR*EuJHO>>5JsPHAWVt4%npe5P^-6$!-sEG0$@z/mdY(\0WbpIvL@qI?BPu:_Je$87ku~O .1/09bijZcu2Kr	aj$U2WGZ<]uX~(e
T$,
n]e]d
o+N4t;SBg0}49i?^@)IA6Um]hRSh;_=@*[./3$} _8dPLoL) d.)nS]nG pnouY;q]d"/31{"E3QgZ-g%:8%`E#eDg3D">F;ua=0;c`/
9g
 @Ym*p-{BorqUnt.%Y@3	Ti{sy+3rY7|pb7.?`>hMWKVn$~o,pM;X^}?1'm5Jp,5;nK5O"Of{*b8}F?mHVU,/Zx~_Rc`=<tG+%@C2tP&H"|7i/b uI5Gq3-FFvGIPiMq7}?!E.Yp!}8a-l~ U:2<Dz?hY@`z_jb3c,!|)VdmRfSLc{INn',r]^BHXP_>o{?&o2	-ECBw<JNc$=G5ZNv/NWLmW*'k\Uj^#	:C>}UM7<#)Oh*]x	d;fc*cGkG8}/wVi+Y-$$sSBgq6n<QA@.*m8&|&\F}Cj"U)/I+-FX,
lQNo]28kb(\?/,c-/xa%[L+8Qdv)DC4]#J7~paxH(w7j ~OWz&V61%L!\0rAX5Tkv@DmY6
1>pOcbGNU4B0+otrF~O4oO7_`a92)zT;%BET-zhHgVBX)U~F
v~&y.&htr2GQ}mBk~Q L)s%NE*:'fqw7kNE4p1h'CW}.Bn`|;PlfRh`ZT36}H{=KoV6HimB(L6s:aU m@%Kc<} I?Gg[{F#vKXMQxN}oUkCf'{_j:tWyov+5Oh]&tK6Khe9j6d]1x{L&)ImkpB1eV@xa/?EM_6C)Jn>_C$a/{+r\G8*4tC~`@"EUS`_[~{`-cj2`/[cD>A/0F.]YYc[CvSjH.	o/=b0p w[?ypKhX&>hJOHxSsx|W@]exZO.=./NXJfG6$ (#*#R8Z(j8>6cgY,lh
p=%T$W~=V7hY' }7#U} 6hVy9IuF&&.{XkVdC@7/F84u5*l7300C}(m!Sd\!&.?]F+"Xxd%YcH"	 %Q13YMl+	1Y.@"LYusE+"9}M\LN5:G~X7dyf]Dh<fihq:=GlJqv*rgFbVP1tv&9tw1:
n$@XPK%R~R>2z^B7$gtlEk][gpZ$lufeIN{s3y<gTPD!R_BgmYFZ
M_c}N	d.N5"Ulu/pHE<y8z3_o#ce8w%n*_vU,u-(N-ugmEa:&f4'#CP.krRuD+O{5LO27&USePFo7[WD/+7rd?Ye_
OkW.T{NCpXoV\4R<me`6nD>P>K]uY~6L56Hxo:iQk|NcA(1$(6$IM;"zq^0gE3+$4{KAb6E7	5U)`M\/AD\}#q`{`@D`e)[c}.kO^jl!8S~KR)a;8[e	q"TQ<AU\AX&aT,02yzLQW0$+C%?, W^PyHC9Kmmq'. L+W*$O"*(=E[E2qgEpe(,bT.]vWu)Bs|1p/b# "ZmX4!,;	f@rw*uPyg
	%p34>) s5PN{jx,D1uT#]gJE<u[g/RB.G`:>bCVjE?'8pCY >LCT'}0 t3x_.xzg"G1'zTF?dNz{J+FJ^\T'~B5Mfx2SN@5eo4 7R@aoL?h]X[Oro~`OA'fV&HJ~5e#dpmy%(AopJhh2#7W	2HpPYxV]moZ{D~w,u Q2!D74D7g]#@~O;dfm-o@<q~w?w8	GF
_{nN!|4WrM*S.l{+h%m%X|f~g|}M
todn2E8z	E213b!f}ugG{,nf_+KyC$_g|a0p{n'
)Rt.7,R3(*;ERx|9ZX{]" +|.<yLs%e>X@nr9QVueN|oEu;@q"\>|H|jS{3"MT07vSu@d>Yu$xJJ;F4!FC}[]opjI"t5+r COH2WXL#F[B$q%siO3aK!BrgH"$zcV!f>H$[>d60	R](d-/e(P\6s
'jj*wI/N JXrhvj5qt|E+[U)']$>IbOK[{kp3uI( 'y4=1;34oLLnhm7_&r{}1;8e)j;O
goZ/D+joJr.%h|t8[?Z 9}0sw>peT2Q!ka7,tB*H!G?PymR[lNS/[DCy<wNmItpeVonr,G2hHkp=6VUL2JsOLQTo8I(4xa6v'r"+U~c4<'n}`+[Q tu@cVzH@2RoKFjgB3qdC$bNV5<JWR#(0 X'yAr?``*k|W4Bh4m-K72oZG_ 3G:)|LX594;pN/+6FV$`kOi99:fs"[QZdyRL-bb|XCe
jBE=Q`Ub 7*aB+-meKA;7wR_Kh&7Xb/gHOeXH@1aZl#3f>mpTGiKC\D8_z+u|*>vC=o.ajTa~<C^?y[I~&<mVU50h{v5#+wbN[uMm*	a.??J&v7Qs(
"Hd%U-,R1\/2
y/-|x|D2jh:Lr8=p
Noi9,!P5cUo:BQN7"=':{0~dHnv}TkNB ZP+(_mS
9Acl>I#E_b[56;# :R,:7X;u5 _SLHLc$d+4$czM<x:3uZRXbzybE<Sjtszt'G!muwg'"`ptL<hLl8A!Gq9OcgtxY8Ruh"f92-og~koVfy&q)k)"
_m2Og5@f~mG;}Y7-\6oB@qL *xdqyY [8*4a/
M1,_z~V /'<Ls0raIbye px8vd\%>F.l> ,b{-0,x=[{`C,31?.,Dwxmi1+khoP-g=.:)u(g:WoQiXiJe&?Xp'$]^;7,cUH0ub!EcVEIFqsoQ-"TE/J]g. -p*2/T14*Zt
fO$rz<BYWq S_q#5)0%3{2:L,M_?nYj~QeH&93,J/%~hh2Kb-euOapOm3-8o5JgUGi54![XqNm|.$]A'\mqB1noy~o]5M4+ubJ`Xja	b3FRzz!!CXD4u(g-MoBP	M55kz.ED/eeA:|T$\R>z>u9>}PNLeff p(/`Eh&(
<C$S.I'm`ORz0zZs;	$[;#~G9<^]O._F5v`wq^W.9X+xJ*3E.<lhj#	 ,$)(^U>/8MeE\HD2><046 5EVD",4K+mgQxeQ4xF`Dy{EER/B?+apj>ZBX{)
k5H0r,u.GXM_Yc_(sE^Be6}6 *Gx?b(8K;`X ^`##@yX9;!ALGv9_vPpidV+US}dlk9F#a8!^kC>bK8^g{z90,9)>7}HHTaWzVj/AC>\ofz[	S'+)gs(U-VZsT%LyTkx,0rQX@h9)cyjrOBKz0R-X-t1 \4'wxQl
]~4P{~j!xv.Ky#l2TZWA>3wCwAo^L)g:o%n:pNJvfa0/t1]]ns,[[:0M/1xIA}xs'-&vG9&zW(T.7=U$`aULX0}f[vvuGffBI7}0j/GNz!pBy[I?yK"(!{q@.Q@w~r:hI7Y,e*\2sm,pzX[<8VPQMVa4$K$>Uy'UeP&L (d|*Ju~yyyI^~ -Ey\4db,(OR?s/{dtbG;Ghxed*K*h|:/j#%X<*S,?/< 7k_QGieq%,L@,).8	8E5|YaW<L	dXko:y)Q[NapdBhu>FR[	]r
wbff6k-l3g]9;6~OD;~Fk>9>y}k-CRp )rK.$~& TJ .8Y-/+'G7:U37mK:}jq.JI<MDXsAGytFCS`"(302O_o EU4.=)3mROB5=1zI`1LO hxL")RfgbMsdQm'04r*
da,')e2Oq\nWo1}mbT)O]JD)OrA
){"jYL/LkIzX}61Yr;=seACS,~0y90(E8wemi/">trb<`@3>Vj9g,PU[HL%Q,$8nO8ldN?s{<-(rd'v;QH/jgxjbJg@B(Uuuj`#+$qS9R' d~jnVi4OArHHY3rU]AY8~yXfAnGe_lKt$Zb8VLw21[l4Qdh(s0L+o=H]tEG5h;lEm26WG 2{#^]|<FE(bT7=PLi{hOVOT::VBw[vhzJN;!sxXu'?>j7(hoNW~mM\KjG"Dc'v{\
gV(Wa0p`}&(J	Kb;@78J\MkZ{Fp=QIh'GYuw-OdNdm ItaK|bJCM*	*ghrETYLpRTX=+8cB*0Bid> hG&ESIP0AHWh|*otBaZaz\Y}sVS_NxQP
}";<0;g`}!N b|Tyi\,8X MH/%I_c[k^v+$UnI	kE%LUVO%pKmEHs8 :(7%c:1ejH.n_fiqPu=txLl2SO0tW+Z?
eM9?X^,n:e svPUp#@"y!L45\|Iq14
;''G]|<Kf~f#{At[8BJ[;dJSyCR
kyuQ`(U*gls	mO<T{ 9:0e_xE42^bUN@nG5u*uu81e0gN<6#Tm%T\LLTGxL1,R.U,&FH5Qk]h1=,+} p7z8w~wcb}J:H]:JD
CdJH0P	G"!(#V)K^7l+^blx2?#t*~<gyr1o{T^l~;\u't<ls7*<n$qqacTm5P,;0
rZ&!r$'\ER]1b,c~mJ2J*M!C~O
glv#mOC3xwG#0%$$+]~Fk	mUJz<H\p6kW"S	${sp.?}	oXGi..qqZ}_H/J(8b`cvbo}y^GVfwdEJ9V@dX2kvn|oRhVLx\2y*LgyjM~$g-)P~R3Pu^~Wm"+``;zn?ewH1*ac!~gQ~ZJ?3Q8GiwN^z9hDGOec8:b%WSm]?CaS%#C%&{D9Kui{Gt3.x6j"c[M1#pXd+,ho0V^ZC0xW>H3^o&'|GA@	uJkulgswOZWG`#/<:&k{^*niUWy!Qh#:%o IV5h{; "X,OqdXW9<WMTWHnMOxv5}Xxp+~du*Ec+f`n@v5 Q3z:	,,+`T SDD,bJd+GfaT}ZM^&qS4F=kY3L]nlYMk:O&	R
b$.!E5c}u	w"YaQm'#y"`1NQ^qS@Z*@^y2;3k36V4yVF~|sWr{~;Ht	(1"qViih5nBpy<5?&
YH|o0mk
6vTr7)~=4QCY
'EmEA>j$$!Yy!,_f-C99M8]%RiMmq^WwbW&{O1<U^3wXSX"a)rZ817d23"O?>=2hYH2(6 c}UBz/* ^AQPqsY"2b*4oI!Q|2j!929li9{?HeGI@9t2"7xy:|jwr8	UULOK^DLoyhoq*'.B[e$QYEa
v11?<	E)|AeV\s3 4TOn(Aj0M04!v|;nN^W._Ct;hwg9}CF4Dr8
]701	{)K8DV!!F<vX4s?`i9O,.-a`-#%A.^@RDh>4b~YVGeF 9X0;C	/b<r0h?'X0`c@g?rFty-k-RP-^+e<{s<|Y:_zo#:f7t7NbHS#-s$3 ]#}FC0%0:oK.A9uid,#*9nE:xF-w/~	J;~MATrlD_{mGpfx?.%OiPOBj\A%"E	-YhN;n2F)Q%S^k%O,mBf.B	nCb|eWc*yyT0N
):Om#gduH/o@pCx>6&4Rn
T$B(&XK_Dy.h!%y,].tF!jr)X! W/u`*lTKHie"9^qQAqs@u?l;R'.L#RrdsC6"GxSG O4K[oD*V=u@[	3gnf!3t,~.}c1"Dg4IVPFm`meM*Wea'~= sx0|.Qi~blkIJX+/(2<43mmineNg~7qA"'yeAAyGn8#exd,'tENy]sanqI\vzhKI;^EGyQ1ws$48mUkta7q;0*4t7mC7;w
;=;wAEFfQ>/"Fk0Jzw1BUn9Osrxv?#Cdfy=}.j"PUj*b&[TWM3%N$JXK*[o&-GqBh>=nER$CX?}M{q>BaLX'ViIjZ333&,ql7q_vibN.UR:yD9&Av}5<<n$Xw{~H+	BRUhPmFWq()n$x>s XfS\_&gWp/.:5=L8{5|cO({uyIiVs8(b/NAQk4,)<-NiA\$i: ,;K2(2,\GE#=q,8=s0up lq\+]hAK:<5Grecf ."!G-\.rL'h$`aHziG7Eav|Is T]F|!t5	vMv=OdUn`w)yS
MbC;b ru2vGF:0R)lKfU-s !W'J	AOp~G"P]gKci=:[Pnb47y(AI~c;&!/=g3oH]kT.FZ;'@owf!9B;;aQWxWlfjL'pEdasV8/>}(<Y/4l%Erqe(k#c?vdl$[
88lUOq81%7`rRLf%$D]_QEPJ%P"M\Om SEq#QLhcoeVcp}f`;qG^-o:! }J*ie<i,z2j1qmd(9f4"u>x^v~m;AQ/~zy==F7;*4WWw4tyb`jTw'8,aErAwjYE1QAC]#q
uVIZ1A3,C3MI2a,)=gZg"8 @i1\yU'S$*1VXQ	og?BP#T[6HVs0%(1^% :bA!U~wfBjp!R-a}Nxjw(:*bp+*8.8$IQh5lA2]?t-L<3{e]/.H Ks|4a&-g>)}Um5ky%AV;UD58jkaNJCI|!?Xl_u_/XYU!AxW#REG| 3M^n-jI0UmudB3#>mIa-"<&MP#'75(ugL?N5w=q~ aYLG+djS|}XO7da@%$E~UZlKb*VSe k^9]gFj~=s-Xey2z}H8?InNK/,,a	JD 51HY_MaJ3eL#M@}#AS'4v!1!c^/?ucdH(=?xx98__%o~zqZ<}}|L$]/<{~+#.o%`B7e{$tL'BihlcaLrD EtV5ieE1D8llxUd8R6:F#gw>dUDMK/.^\z\"xXBk+Q\SQP9WUGGk0os**97,8}
#"[+j	<R(_FrljPT?EGF:9\FTK+8o_xq<z_#F:M'	AymeR7w(L\PErJYS1*	qI%vb,2Wa+1N4F	R4TU0i@?ARk\fK,@+UXi$:fH$E^RVQZ>Xq40kK,?U8m5G0JU0X+V$1E!M2d&$/L)Jp+sW=XZMb<i`k4|}C%.s+pfV cVO7ST];D
Vy@M/a-
Vi0ZipmxMR^:NH80ZiyR'n|!&;|Bsdc@L0}"q)}9jk1u,Bt%S{]jFN%9_S@h}._':J),>Wt~t-A< k!W|X
R$X(f5i2.uu<L S4ZFVl=jQ+jLj<LVX

657w`HsrIFW.1C0} )4tI'.,t,I2C'h%AW|(d? Dav @>1fuS9yTyf7z'*X4we547vkb`I3nY-W0y5j}fm.?tj{R@7t+r,Y(Y`q+[:Y.+:xP-0Adj 'T.3~^4AxP(,`o]`=oVj!%,DgSP50x:fDXJ{Mnf6jvjq,Pvx*dwo|H-1XD}'EeAl9g]p' WM!?>Z*^!ZgjF/g5rZBJz'	1LF9M8Na_Z-r z]&B*oN]q:v;lQGns 	 
a[M0HlDW?,*?i*"wp)gjH&{:j#dO)"
R,
qpU;ar}a,Aw/;3LV6;Esg1P]u<2o#}cMvTv7+<~qtWf*~%[< v=*:IdcA^wtBMl#=D#z&+FbF# #jYu,w9$3js~b!$}8s_9(.{agL3f hE)r dY'(lcY9gw}?nu ak\X*@?2s#$?Q+cdzgN1#M,+*AJ+(F)cx/m .s&s%g` azI#x_8]`)/E5&m(ooNp&7;[}#LA@e<,ogPF+.  O&`]=kb F`wxAOJ=W1;6<xlwk6'I9H}BP@PQuoC4KvHu,^9f9}}}5
!'hd<^`CxAT o/$a.>o)y%\a=>Stv"Q9aWW{uab.)y)R8)_OO7/x.*Vt}
L	O7:Z`?Vf]Z747FhNfx!3T:\.S@0=Z{(L?3U=)\|..w{@f(pJZ]!%]?=1Wg,`(*j/T[TYSbln 6aZ7FdcIP|:oN?braL}Z5!U2mI@T'`n5 vWgwoi~]
;[<NH;`E}P~xM_|p :>b[`t[uk(;S>C20*)kQ	8O6*X3V0&%k^U3"KVg=>1p;BG}.V=j1/fNA5wsS%2	wfDL0*Ipfi,v~? !C[>8sBlJ,l^Xmx:F2J_rcrUQOeLXw8ff#S2|z k028dpPYM3w ff=\a>9T`>g4'@&=>#?;O<WsLMGS<D!v /|L<:W;Kq={Q}KB&bLwf gu,%5wO|m&Z6V=#W2{aXY]oq9cbA,w8vDw0U,=O=)# L9Bc n9,?CJ:axduT|ri;v06Rf(M) ;u$.5S<krb1#_&obRq3O;XjvRJzyKUW#db&}>88Sou\*aQ`dn
zs\$q>E.^M<brsc>Yo`=!uyr8>K34\hf=:~Jh-M ~3Gck@wJh#o%Rxm(7t#f3^hZmL$(f}hfO|4M>?APevwIFLh%6Yqz]nH3Lw ]Qz{d|?!ro"	"] #4	-.3;\I[5I2^<P|iw@>#.`q+iXfR*9osx!F64'8r'H?9|Wa#}@Z&}yF]7GI)	%2c$D a6 ]6[,J]r,vGyk&+|cY8?`}zKd.}fsCx86zN#8Z*%}=K.Nb@^Fhxfp Sq14&w/;w)N823V*v"!g%6 b>CL};$
2PIa/L-u&8ZLwkP}yleu+
{djJyxy|	}r5ko?w(AQWgCfw/qtC,)4b$YQUc{`A2,
<ma=dB7KoYfV&L[Ul\8u%Hqt}H	h4L?z#*Rfe

Q:*]'.DSh8X2]sU'zAV$#.
4ZT$bnX+F>	xE6Esvc#d 4-p%AhooM,5QvQmxJ%RFC}T}2d b%O"Op8OEM!M?I$Tb3 .P8MqU-kV)4fXURTb,L];&4FqBuLRsa02:imetA6SEmil=_$";@#0ttjL ORWBL;_F+MBL6A]An[Rp,)me2)uNwpeAkj`,Tp`Ai!& `YTRh0MTT*MtYiSUQ|*a2	>R&@HKm<|*`v"|kkeSfhiMAM K@J <I+
]n|Ibn*1hl&[HMWHFIpfCFNyjq
vwlR1r[NfNI iiDe'*Oqc^t\	i5cqSo}X@7+
HVxB7Jp}k	0e.F|bm%3	5 /YfEN~XuP E PU}~2/8Ib"
<+/0DY
H =V=Le&"/(2Q)fnLA7T F_+"(|QM_;jD|`vO^ `'	XNJ#
v2Oc/~MHFYOtyD^YFU	Ww\	!EN0Y^Yajsa]]D>f4`CuX:~tIH* N=Ze2*EyHJ`"*Km*1'5)KCr\QU)	E3eq>tCzLg}*>tMHY:`&sU#I>HmS~`UCc!o@E~h_Dh3W@"[gx1R;ef,9Qggx)DW(> ^'vTvVapsz50GAE*mUu*3T[t]:V;sOTGU>9]KxDdQN=O=`rNecdDMl\xj!>{3j*3UEw7bZ<>SL'j)aLv#%IpG&=}*@`n phgp[pBY4Kr}`[j.oemYBu[b.NL;>igUTKSrw~-yGf|EtT*#5Y'1_x7Jh?\B<):.v)+S]mAEY#/K],J0Qvdo5tD +i,P_$vvk;ch2
!xs/%!m0 r+\u!XTj|'^DUs/1ep x3 U?k;4Es!;E/R5~ tR	(v\}0-B&9#h@UUT.s`Bxi*dCRU}Y9MR[y! ?~CgQ="$
VHU+kq0_(* _gC0ZtA/5$;*-C#	6mz%h"^N"`\7nb8`TRbyV	\r;]Q
	NjBv#A8h =`0/F6>XMp^-6V'b/Bc Y@Wm`$T/zo$fUW\4vqK& sEdxM3=Go_EeuWrMsgGya<:A~p^fyzOBN0"?o{\:F=~oeK}AQ9)?5.2tu6f
;["]YJ9k!*T"5t8z-cCO]?]=	l9x+'G~gs7)Kr{1qK5"O+r&VK-{y	U-kEeFf0b
w Hu3
$>?i?#p34cJ5iXFFu"aXj! vL)G +o`\~-o%=$FK(<`AfTNxf;c>	*_6V3{.{I!5jv%tTAoy5P	]*qkJ(t	.7(#Vci@"CHit,j K'b> .1n1S$o YA?>hFq('ZG{R0Hf4E0|88%/qJ,?9%bas!ryM-""m# 	gw?@clkc`Ys}x[M_uFE:&#p ZTQ+ftWx`!@z7VEb%Z1[ua?KfBV}pA7wy'i@BHOBX\[	iY5sG7hQHNV-5,mF ^W!&88R,}"M	MX9q=hX^+5|MA8
hA0$d$^hpi)d=>qs,q/gOS>;--ZxWjq"<>uG>P<BNmR/LqGs*78XFfq|s3+j"!QeAZ'M .aor)lz=g8^QDE_V	2:IDaA^Ve$K3@#m14l~$IL:#ExNRfRaR^z~~W~$Kq40j.f&$y;v8~~{#4@;i,B18m1Wj8xe*Q1X!6|~qb *;&D;C=mQZ#OLq[3Mj)U&. m\vV S@_= 
mCxfu[}i[vwFU:\-$<,&ag6+gnlBxFe=:}%idIqq>1>=waLy&vIOK)S8pE	q#&ve	-X2 }pf<7SVs|f$#cJ8nd/,WE;M%PiW,	{
/Qo7
nywbr>=ZV3ad%~a2@|k(pgzzrud6wM n4rpX{y3(=^k
 paD3FT&l	,tKZUP9$(sU{Wa`
]OL,(W.wh	J/S[D7e3vz(P3S]%"guy"!2,<eq~P>@IbO IQHtPTT+0K,D$iVyIEuPl![UHr=|NU(8*+4Mh;}3NMiQ/ RWAQx"
)aY`BQi<0iQdaJO$*WE^PqyaPd^ Zg^aA31PQAVyGf>HM-2=11wR#:#*XiAS-~/	\("%px}fL|9Df/f;5kA8h|M4e d4!b#%#
Q>d-U|/<n|+!dH}#pd;=)3b@> 6Uc\[yneI&QV	hXVp~RWtdb3U5uA4O+us|t$XMIb iepxrLs><gr3qD&2~]'ECt+oWs+hV>^*NdaHjVJKb^O?pq7^sx7X17O|[o-cOnw'0kx&56AI&[)D`!y]m@ lh?xqP('a@dofm,Wg#![{t3#fe~!4
|V-eZcA9=3Z_d'#mEIjvP9d`D8s|ACq3
kJ0Vw;t/lZB_m`brk89D\[z|m}{]CDK@ O;9x WeHoB$7k]ZV 9&QJI, "cn}+FhqeAZ<RP RO$h:\yB>O^Uu?*
}xlR&n)Ik!D%<(
<{D(sO":QUi)I*$4yTeui{(GTBiIYEa"eRW,zr .
=$	W$FNijIlFoE6\\*%sc8@sO+=La3 G{PUaO** +*_|iws%AzV"d>y9n{$k7vy>g.KN,NIto+"j!MUZUc<1[rsqW=6(ag\PGm!} .B6*QKs~~py<_	[Q`VqSlsfu KCu}"H6OR$BG-e
{~p:EGhhL3$I^e*Z{Nh	LpX:bf`@Em*VL{EbGJ[ts ;cv{uW_ s/D:F_^X!$UlUUy{s)TsEjC}Wf_JIW1$ "4/@q=j$U_m\bv,L.|tN!8:AXvXCx8uJ0DA^ -g)AAWpzC#SI::#=	61'
c1({c05eXT3;\RS@[/<|X'C_0Q0m~w@ss;!0
>Tcee lre*LqOFE3i5j_m'hM<sop&I8nlyfdMGmVRH1D;0l N=aK!.A hcq8bb24fjMl2&4$-hAO0[YQU0bh67cd*(6pX1r]*wUV0sAE=KIR;>fhUPp
bL3}hBm{/wa
L 	rfEc3PZ^F/dQ$/ChI{H,I"dEUyR~
q+4dqziyXR
_\@
I1	D/Ej`GS.OC%:RSvL0"B,iJ<jrZ55~04*PU0SA::H(wIW^g"D*wm#?*I1 I'e[*+8I6Q$(YS[Hy<Y MTE\F_N
B'.7=1[.M.	7.bQqE<R3=B8N~8E	tD#V,ZDK c\_h=#%
HeHm)=?%9CT!mcp8jm:Bw}Ys\vYfOW;Y7W j eU#;wd%Y5=]=2wneoXKHWGoU6"\
R|rNAd6\[? Fm} tO2dKv{P*S*R K0#s$U$CMBu]O{ZcfeY`t9 (K{M58a T-D$>F!Npz} -rPv9vDwRiiArpf(1DKe UEsPqu'7<yza'd"Akx5<IwuE^YAy:W{LJ\ 	[01x<aMJPw lPcvC)~/_ufz:@xV*9:|dV:IIU_inMq0?=h*!V4a`4l e"{?Lub
*`dG7|ll,fil4NFqAM
=.U9\{oSzC%8B'@*Uj>5j8{`$HRj_Qo	=C0EM`):,j}6ngDNu%]T&*r#QgFyOU#t2)A9a5Ub{%eMS(6d=h%m,yV<qW>@zL1ugWxI(v t^'9 ^k9W??Am8X,#"S&6sS-$o<~I("~kn1>kPUjM`_?Y<~4_ry<J <sj}kJog0|`LX3R.nFM$NR{vB	mb& ~h#\$({2{b;,fDT	*e_u5 \re5O-dM)#$ uLT08p+P	FKJ,D;=%DxeeTcOWcmJx-rKJCJ$CH|v8v[V@#p>cMkON>56,9bDL?<GAF=VEd.\k^0V]+`}G4Hs}+WP4?F\lcZ C`m 
0i})9Mx`GVdMXh_LXy 0.)0ak}TZ <-ump4NFxy4M6ZdA0v$q:G0NFq0l+nDc]V+^"VT'FMl4UQ5"VlY7%Y@rZIT>LDA+EZfu(D0UHP"{ q^r1S"9*1 {'v1}~IhfI\a#ZcXoINz EWjL-_FGqn&oi=1la4=+[p3)%Q J6PYCGuDpC`o&l'/u[mo."CHGEki]-S  9s	`<a6
Lv%&Wa'K5sV?>&~S[`QaV7&{4&.7rJZP[/x&1&qXuJ"@`G$
'U@:,%gQA<J\
\Isl!&,^L(XNq:J4< @[$ 4qfN:GR4<MAiqLRb/&~'	} \5YI ?8h%T7>S-2?a#aFL}6+\byt&KPNox)#[!Lyzm<kT%+O\+THwK1(DrT\%\aL
UhN]y`{1gs\dG
_YvrmVg6VMBf?.+JJ!w v-~iI+!oT]oO,1oBoB5!.3!dv%Wa;*(\pHPGVsn3f1,	2`}T~issAB	dy`'Ty\}v"3x0\%[XMsOg4PV NUnFbSW6p})(Jw0#e]q:cg7(3fM'pk{0QwV2PrA4i
0J/K8eIJ! 'tZFI'OC1 } @6@erh!t Fvyamg|O	8DYm+~66@T-|4VA`*cLbq8
lW"ljtII%Tz1m7`sj%hwi7gO
W?*Z>G'B	]Hk=\BC	(&&xG=7yW-z64b:Yzo9={R5@~xl[7;bEE]/(fUg{48#\~=xE4"o*qc4Dv?z$Hq,uYYkX#;M<v[]1<[$Py0]+KF^bK:-l$MC\f<*)N&FHL;v{ms8
 q~t`-4xwdM\8!F1QtS`# M|Nj
iYFd,3Y{zjT~ph-EBe**GaKcskz.{$-&;omh3'"W=y/DtC}#?!=klq`, Y#mM9p1IW4z7\k;dXj$T$ps}u#Svf1oVy]k}klT
'>5q?Ui
F@Fss!ZZ"V{'^;gd94).R:l`-}Ag/<I>fBe{z-bl6d'Ci7-SH;Q.vtt9uGUiOupl=D2<t^@oN|Qv]}T g*TJy]RxAs]z1/58L;3_y2w'%St6uq`^DA9t,*W_*"uXqTDU,WhrW7ENH[&.mBLjh6;v9WWY InGxb4gAIi?N m=uW38 ti>Ckefh0Dl4$i2AE,f-PSd:eia<	4QLGd0T\.1,
gp&|<i<n0%
]DN\" bkZY8s~3P44;1Uc$I4hlHSwaz?Lzy~t9g["-PGU)%]9;/	"n%SJwEs"'NAZXmi[g]0I|S2T'y7+;eXtFaJ*3wf:lR@	tpvXz[?WHpPGe2aM PI)|=3Eg\BIj1mY]Es(6	u7,x-Shn@ 1\\p8%QU Y4LG5/YqUez.Xk{X_CIHiHbjq`Iwc'*uXEGQ eudReVN<m(_)V:Ou	RWk&]?prWRYV6V tp~s^*D	lav OoZ\l+Ln~fnzx6"_.`=:%^''pR
AuC8"+e#	Fq8iiarir+db	@CmR
	XMT+y,#hs(3%~/CWk9|5k
d V(.h=ev+=-b|c'.H~4@=Aq.^3G_#vOCZ|Ytr?@VUd0axF% o{jJ6fCKWcbAj$t6d004p4~%)ln  gq2MEpfBLx[Lvrj%<Wl/n y5KR1-f V!L4}6]7sQ*5y"lj&8	?u5(/N0'+j:xUz]?/`M\*Z
2[<wf9C/d&;
+*?zQk@Mv_sPo_7Sx$M$Xz<iC$5CVD*=5Z:i]vSh>f
I0F)at<iC%m8iBAZ(=V^SdZEmw3jI6piS+d;jS]d3yAw+P&^?FQ
?#hlQ[TI>M|,&ZF$D^5
DLTI4PGG&04t.g&X}C@f}ZcfMm1CszkpM&B-9R#jP7FV
jr1.`@7"T+zx]rg`8D6v|6Ysklu
M&tKaup=Nx2QJ@U@ t^hc`#C\0$|n]9|SE@J"0eJ>&]H-S<(aOM,4dq
4MmQLqUX	ZdNQ0`<$<;?`4|$Hh$-9+VXC$NJrKe%TZ8%{x{]qvC1NC>"z5.
;7E~^OeY3
S5c}S,87<_^^^M4E	C0!$se`j=izT3#a*z&Qnr<L_S3=Os(lSq#D")TA>]HVwrmyPD$*+-IAW!y4[=+#iw@/9suoE(hvP 5ln,B"[Y*k+fh<V1e$NF #gK25&<_On
]sXl$ST.-k(Xs~G_B/>X=okU.]W
P)[D&>Ds^JC:6Sc_)fXp-+<HZ
'(=J.4e0z5a_/KoU9$~yxy6|{sW fcly"s;3O#j;8Q2H"=QV'K-2"4\iqzZ7CL5Jm@(P+1`*T!~O3#b0D y1**[Y=Qx';Q292oh`Et/,'Iuc<#3($]iwdJ4hm"s8u[_5S]oG?$<	C|djWdG;8uF;l} :ax0 ObaKmavXDt+Z&*;F}ldZ:E`EEQU|u|1=#BrH(3!{PEwG >y>M\bPXU0nP&hb&Aw0-;z
?A&b0RLI$xQ0x|6b+wyaI~DoG_cvZur {_32#NmIMV{'pLPjrNSRHUn2$kW_NP[t5(Mn32=j?|GObR&tcQ-Um^kdm,FM.7)^=^V{q7% n4/\gS42m*}z1&-4`hma.KjNqr. .+-$-sHP`>kUanVv]5;)~b7DSA~Y3Rh	q,UT:a+>a/*LpTJ910}<dLe7=RCTq$"p7/nDeA |^^#HM_+XSERH(y~gK7+e*%pH0C{GIzK%;Hm5&{D4[}{s*Hb)).:9nJ)>,3yQ<9zw$: gY1ol<haoOezw@I|O$ i5\|9WJOSfVdW1sC39I,73`[ZBenHeJ|?RRf_PC':}(o jIv!/Vmi4%qlQa$y<gu,eYti:a2GtAQ8DrQGt8O Iq4On1'h}fai6lKMM<OQ,$d8i8|/TKrbe$t3	~{FwKB3I	.7u!odu[& ^-K''^7rz))K.w$uY|e+Yt2x=A"R%26Y`=1=U#
`8yc	H175C%VybiD/&!||\QoxShg7}rk(CyDgV6L*OQc.KlSa'e:)!*Y9&5ZX34k"PMla9)x)
;o=#RevX.d_K?Kq3I!'7]&7b5S:^R^kL	]~.W"oU@9(+owVuZ7>f|LlK<uUW~AZ'&8W ;_#hk8{o~
e9EjoJKpe=QD.Nk)I7jKhvq7B+9"& w1	G^P65c1Mml v15kn&{q?(lV]}zG>>ewgOzqp?_\PT`UiHqFWNEnrv|X`yB]\|xMIidk8;`!.b_E!
Zd"c3jlk_7}gDNNm a28,q}}?#Vnynvqp`;5{ Kj#\ q!^trrdE[+$^&qs PE<m2X%+5nNs+"gf]ou>jaCJQJ@EF8VnnRWh{F:*7Qrh.ZU%)T?vG3A5{'c	@QUV\$w`B'uoV4BldBS**p`VI0P)p_SIQe8XN
0I	94,[v?1/?\'n6={Wey5):n6mA7IVaW{b1c1_d
v*`<}\&LDC^{vJqm zNzyyvj2.H&}C(*P0@'hEfQku@*ufd< M&qY:I$G0,
C?M$rvFt:Q0`6(0lhWYxzqlFi[,g$<"qJbI7gnQNixy<YT7plv6S&+-/a#Gw:Z,<YK!	+.gm&gtreZ,GE{=k?X#F?=uV+wVy]w\:E^I	hx*^eN/^k*	/eQXT`|1r32gA}64+Juwce7k @:6__;f(tX=%zB/L"` R|V''<f8}c[h4cY3	Qx%R	Za3&3~	@,s&CaQP}kO)#ts|/v@0U42_AY$A$GovhoWl\z$&<(
-Xq/N.*JDGM	wq H,1d"5).7/DV;V'nk:H;*x%{)X;jd-f5u#co}I=i;.)dH:RFrE_}{o'ww5#}y(	O	j9+r1^n4~J?L6fz-e/mJmCkl-25Svnmf,Ie*}l*G5A,D'`:[[~z}'~'+|1sp]!f* _EI%vnxRi9L?+n.^j.-s]6b*5dzLj(lAJjP"4.mBH`X4bv}-Oc$2~                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
k[c           @   sn   d  Z  d d d d g Z d d l Z d d l m Z d   Z d	   Z d
   Z d   Z	 d   Z
 d   Z d S(   s    Encodings and related functions.t   encode_7or8bitt   encode_base64t   encode_noopt   encode_quopriiN(   t   encodestringc         C   s"   t  |  d t } | j d d  S(   Nt	   quotetabst    s   =20(   t   _encodestringt   Truet   replace(   t   st   enc(    (    s$   /usr/lib/python2.7/email/encoders.pyt   _qencode   s    c         C   sL   |  s
 |  S|  d d k } t  j |   } | rH | d d k rH | d  S| S(   Nis   
(   t   base64R   (   R
   t
   hasnewlinet   value(    (    s$   /usr/lib/python2.7/email/encoders.pyt   _bencode   s    c         C   s3   |  j    } t |  } |  j |  d |  d <d S(   sl   Encode the message's payload in Base64.

    Also, add an appropriate Content-Transfer-Encoding header.
    R   s   Content-Transfer-EncodingN(   t   get_payloadR   t   set_payload(   t   msgt   origt   encdata(    (    s$   /usr/lib/python2.7/email/encoders.pyR   '   s    c         C   s3   |  j    } t |  } |  j |  d |  d <d S(   sv   Encode the message's payload in quoted-printable.

    Also, add an appropriate Content-Transfer-Encoding header.
    s   quoted-printables   Content-Transfer-EncodingN(   R   R   R   (   R   R   R   (    (    s$   /usr/lib/python2.7/email/encoders.pyR   3   s    c         C   sc   |  j    } | d k r& d |  d <d Sy | j d  Wn t k
 rT d |  d <n Xd |  d <d S(   s9   Set the Content-Transfer-Encoding header to 7bit or 8bit.t   7bits   Content-Transfer-EncodingNt   asciit   8bit(   R   t   Nonet   encodet   UnicodeError(   R   R   (    (    s$   /usr/lib/python2.7/email/encoders.pyR    ?   s    
c         C   s   d S(   s   Do nothing.N(    (   R   (    (    s$   /usr/lib/python2.7/email/encoders.pyR   Q   s    (   t   __doc__t   __all__R   t   quopriR   R   R   R   R   R   R    R   (    (    (    s$   /usr/lib/python2.7/email/encoders.pyt   <module>   s   						                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
k[c           @   s   d  Z  d g Z d d l Z d d l Z d d l Z d d l Z d d l m Z d d l Z	 d d l	 m
 Z
 d d l	 m Z d Z e j d  Z d	   Z d e d
  Z d   Z d   Z d d d     YZ d S(   s8   Basic message object for the email package object model.t   MessageiN(   t   StringIO(   t   utils(   t   errorss   ; s   [ \(\)<>@,;:\\"/\[\]\?=]c         C   sD   |  j  d  \ } } } | s. | j   d  f S| j   | j   f S(   Nt   ;(   t	   partitiont   stript   None(   t   paramt   at   sept   b(    (    s#   /usr/lib/python2.7/email/message.pyt   _splitparam   s    c         C   s   | d k	 r t |  d k r t | t  r[ |  d 7}  t j | d | d | d  } n  | sp t j |  r d |  t j |  f Sd |  | f Sn |  Sd S(   s   Convenience function to format and return a key=value pair.

    This will quote the value if needed or if quote is true.  If value is a
    three tuple (charset, language, value), it will be encoded according
    to RFC2231 rules.
    i    t   *i   i   s   %s="%s"s   %s=%sN(	   R   t   lent
   isinstancet   tupleR   t   encode_rfc2231t	   tspecialst   searcht   quote(   R   t   valueR   (    (    s#   /usr/lib/python2.7/email/message.pyt   _formatparam&   s    
$c         C   s  g  } x|  d  d k r|  d }  |  j  d  } xR | d k r |  j d d |  |  j d d |  d r |  j  d | d  } q5 W| d k  r t |   } n  |  |  } d | k r | j d  } | |  j   j   d | | d j   } n  | j | j    |  | }  q	 W| S(   Ni   R   i    t   "s   \"i   t   =(   t   findt   countR   t   indexR   t   lowert   append(   t   st   plistt   endt   ft   i(    (    s#   /usr/lib/python2.7/email/message.pyt   _parseparam>   s    
;
/c         C   sB   t  |  t  r1 |  d |  d t j |  d  f St j |   Sd  S(   Ni    i   i   (   R   R   R   t   unquote(   R   (    (    s#   /usr/lib/python2.7/email/message.pyt   _unquotevalueP   s    "c           B   s  e  Z d  Z d   Z d   Z e d  Z d   Z d   Z d   Z	 d   Z
 d. e d  Z d. d	  Z d
   Z d   Z d   Z d   Z d   Z d   Z d   Z d   Z d   Z d   Z d   Z d. d  Z d. d  Z d   Z d   Z d   Z d   Z d   Z d   Z  d   Z! d   Z" d. d e# d   Z$ d. d e# d!  Z% d" e# d. d# d$  Z& d e# d%  Z' d" e# d&  Z( d. d'  Z) d. d(  Z* d)   Z+ d. d*  Z, d. d+  Z- d, d- l. m/ Z/ RS(/   s  Basic message object.

    A message object is defined as something that has a bunch of RFC 2822
    headers and a payload.  It may optionally have an envelope header
    (a.k.a. Unix-From or From_ header).  If the message is a container (i.e. a
    multipart or a message/rfc822), then the payload is a list of Message
    objects, otherwise it is a string.

    Message objects implement part of the `mapping' interface, which assumes
    there is exactly one occurrence of the header per message.  Some headers
    do in fact appear multiple times (e.g. Received) and for those headers,
    you must use the explicit API to set or get all the headers.  Not all of
    the mapping methods are implemented.
    c         C   sJ   g  |  _  d  |  _ d  |  _ d  |  _ d  |  _ |  _ g  |  _ d |  _ d  S(   Ns
   text/plain(	   t   _headersR   t	   _unixfromt   _payloadt   _charsett   preamblet   epiloguet   defectst   _default_type(   t   self(    (    s#   /usr/lib/python2.7/email/message.pyt   __init__k   s    					c         C   s   |  j  d t  S(   sw   Return the entire formatted message as a string.
        This includes the headers, body, and envelope header.
        t   unixfrom(   t	   as_stringt   True(   R.   (    (    s#   /usr/lib/python2.7/email/message.pyt   __str__v   s    c         C   sB   d d l  m } t   } | |  } | j |  d | | j   S(   s  Return the entire formatted message as a string.
        Optional `unixfrom' when True, means include the Unix From_ envelope
        header.

        This is a convenience method and may not generate the message exactly
        as you intend because by default it mangles lines that begin with
        "From ".  For more flexibility, use the flatten() method of a
        Generator instance.
        i(   t	   GeneratorR0   (   t   email.generatorR4   R   t   flattent   getvalue(   R.   R0   R4   t   fpt   g(    (    s#   /usr/lib/python2.7/email/message.pyR1   |   s
    
	c         C   s   t  |  j t  S(   s6   Return True if the message consists of multiple parts.(   R   R(   t   list(   R.   (    (    s#   /usr/lib/python2.7/email/message.pyt   is_multipart   s    c         C   s   | |  _  d  S(   N(   R'   (   R.   R0   (    (    s#   /usr/lib/python2.7/email/message.pyt   set_unixfrom   s    c         C   s   |  j  S(   N(   R'   (   R.   (    (    s#   /usr/lib/python2.7/email/message.pyt   get_unixfrom   s    c         C   s2   |  j  d k r | g |  _  n |  j  j |  d S(   s   Add the given payload to the current payload.

        The current payload will always be a list of objects after this method
        is called.  If you want to set the payload to a scalar object, use
        set_payload() instead.
        N(   R(   R   R   (   R.   t   payload(    (    s#   /usr/lib/python2.7/email/message.pyt   attach   s    c         C   s9  | d k r |  j } n; t |  j t  sF t d t |  j    n |  j | } | r5|  j   ri d S|  j d d  j   } | d k r t	 j
 |  S| d k r y t	 j |  SWq2t j k
 r | SXq5| d k r5t   } y0 t j t | d
  | d t | j   } Wq2t j k
 r.| SXq5n  | S(   sZ  Return a reference to the payload.

        The payload will either be a list object or a string.  If you mutate
        the list object, you modify the message's payload in place.  Optional
        i returns that index into the payload.

        Optional decode is a flag indicating whether the payload should be
        decoded or not, according to the Content-Transfer-Encoding header
        (default is False).

        When True and the message is not a multipart, the payload will be
        decoded if this header's value is `quoted-printable' or `base64'.  If
        some other encoding is used, or the header is missing, or if the
        payload has bogus data (i.e. bogus base64 or uuencoded data), the
        payload is returned as-is.

        If the message is a multipart and the decode flag is True, then None
        is returned.
        s   Expected list, got %ss   content-transfer-encodingt    s   quoted-printablet   base64s
   x-uuencodet   uuencodet   uues   x-uues   
t   quietN(   s
   x-uuencodeRB   RC   s   x-uue(   R   R(   R   R:   t	   TypeErrort   typeR;   t   getR   R   t   _qdecodet   _bdecodet   binasciit   ErrorR   t   uut   decodeR2   R7   (   R.   R"   RM   R>   t   ctet   sfp(    (    s#   /usr/lib/python2.7/email/message.pyt   get_payload   s0    	 c         C   s)   | |  _  | d k	 r% |  j |  n  d S(   s   Set the payload to the given value.

        Optional charset sets the message's default character set.  See
        set_charset() for details.
        N(   R(   R   t   set_charset(   R.   R>   t   charset(    (    s#   /usr/lib/python2.7/email/message.pyt   set_payload   s    	c         C   s  | d k r& |  j d  d |  _ d St | t  rJ t j j |  } n  t | t j j  sn t |   n  | |  _ d |  k r |  j	 d d  n  d |  k r |  j	 d d d | j
   n |  j d | j
    t |  j t  r|  j j | j  |  _ n  t |  | j
   k r4| j |  j  |  _ n  d |  k r| j   } y | |   Wqt k
 r| j |  j  |  _ |  j	 d |  qXn  d S(   s  Set the charset of the payload to a given character set.

        charset can be a Charset instance, a string naming a character set, or
        None.  If it is a string it will be converted to a Charset instance.
        If charset is None, the charset parameter will be removed from the
        Content-Type field.  Anything else will generate a TypeError.

        The message will be assumed to be of type text/* encoded with
        charset.input_charset.  It will be converted to charset.output_charset
        and encoded properly, if needed, when generating the plain text
        representation of the message.  MIME headers (MIME-Version,
        Content-Type, Content-Transfer-Encoding) will be added as needed.

        RR   Ns   MIME-Versions   1.0s   Content-Types
   text/plains   Content-Transfer-Encoding(   R   t	   del_paramR)   R   t
   basestringt   emailRR   t   CharsetRE   t
   add_headert   get_output_charsett	   set_paramR(   t   unicodet   encodet   output_charsett   strt   body_encodet   get_body_encoding(   R.   RR   RN   (    (    s#   /usr/lib/python2.7/email/message.pyRQ      s4    		c         C   s   |  j  S(   sK   Return the Charset instance associated with the message's payload.
        (   R)   (   R.   (    (    s#   /usr/lib/python2.7/email/message.pyt   get_charset  s    c         C   s   t  |  j  S(   s9   Return the total number of headers, including duplicates.(   R   R&   (   R.   (    (    s#   /usr/lib/python2.7/email/message.pyt   __len__  s    c         C   s   |  j  |  S(   s-  Get a header value.

        Return None if the header is missing instead of raising an exception.

        Note that if the header appeared multiple times, exactly which
        occurrence gets returned is undefined.  Use get_all() to get all
        the values matching a header field name.
        (   RG   (   R.   t   name(    (    s#   /usr/lib/python2.7/email/message.pyt   __getitem__  s    	c         C   s   |  j  j | | f  d S(   s   Set the value of a header.

        Note: this does not overwrite an existing header with the same field
        name.  Use __delitem__() first to delete any existing headers.
        N(   R&   R   (   R.   Rc   t   val(    (    s#   /usr/lib/python2.7/email/message.pyt   __setitem__(  s    c         C   sa   | j    } g  } x? |  j D]4 \ } } | j    | k r | j | | f  q q W| |  _ d S(   sw   Delete all occurrences of a header, if present.

        Does not raise an exception if the header is missing.
        N(   R   R&   R   (   R.   Rc   t
   newheaderst   kt   v(    (    s#   /usr/lib/python2.7/email/message.pyt   __delitem__0  s    c         C   s2   | j    g  |  j D] \ } } | j    ^ q k S(   N(   R   R&   (   R.   Rc   Rh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt   __contains__<  s    c         C   s   t    } |  j | |  | k	 S(   s/   Return true if the message contains the header.(   t   objectRG   (   R.   Rc   t   missing(    (    s#   /usr/lib/python2.7/email/message.pyt   has_key?  s    	c         C   s    g  |  j  D] \ } } | ^ q
 S(   s.  Return a list of all the message's header field names.

        These will be sorted in the order they appeared in the original
        message, or were added to the message, and may contain duplicates.
        Any fields deleted and re-inserted are always appended to the header
        list.
        (   R&   (   R.   Rh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt   keysD  s    c         C   s    g  |  j  D] \ } } | ^ q
 S(   s)  Return a list of all the message's header values.

        These will be sorted in the order they appeared in the original
        message, or were added to the message, and may contain duplicates.
        Any fields deleted and re-inserted are always appended to the header
        list.
        (   R&   (   R.   Rh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt   valuesN  s    c         C   s   |  j  S(   s'  Get all the message's header fields and values.

        These will be sorted in the order they appeared in the original
        message, or were added to the message, and may contain duplicates.
        Any fields deleted and re-inserted are always appended to the header
        list.
        (   R&   (   R.   (    (    s#   /usr/lib/python2.7/email/message.pyt   itemsX  s    c         C   s@   | j    } x- |  j D]" \ } } | j    | k r | Sq W| S(   s~   Get a header value.

        Like __getitem__() but return failobj instead of None when the field
        is missing.
        (   R   R&   (   R.   Rc   t   failobjRh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyRG   b  s
    c         C   s\   g  } | j    } x9 |  j D]. \ } } | j    | k r | j |  q q W| sX | S| S(   sQ  Return a list of all the values for the named field.

        These will be sorted in the order they appeared in the original
        message, and may contain duplicates.  Any fields deleted and
        re-inserted are always appended to the header list.

        If no such fields exist, failobj is returned (defaults to None).
        (   R   R&   R   (   R.   Rc   Rr   Rp   Rh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt   get_allr  s    	c         K   s   g  } xd | j    D]V \ } } | d k rG | j | j d d   q | j t | j d d  |   q W| d k	 r | j d |  n  |  j j | t j |  f  d S(   s  Extended header setting.

        name is the header field to add.  keyword arguments can be used to set
        additional parameters for the header field, with underscores converted
        to dashes.  Normally the parameter will be added as key="value" unless
        value is None, in which case only the key will be added.  If a
        parameter value contains non-ASCII characters it must be specified as a
        three-tuple of (charset, language, value), in which case it will be
        encoded according to RFC2231 rules.

        Example:

        msg.add_header('content-disposition', 'attachment', filename='bud.gif')
        t   _t   -i    N(	   Rq   R   R   t   replaceR   t   insertR&   t	   SEMISPACEt   join(   R.   t   _namet   _valuet   _paramst   partsRh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyRX     s    &c         C   s}   | j    } xj t t t |  j   |  j  D]; \ } \ } } | j    | k r. | | f |  j | <Pq. q. Wt |   d S(   s   Replace a header.

        Replace the first matching header found in the message, retaining
        header order and case.  If no matching header was found, a KeyError is
        raised.
        N(   R   t   zipt   rangeR   R&   t   KeyError(   R.   Rz   R{   R"   Rh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt   replace_header  s    4c         C   sd   t    } |  j d |  } | | k r1 |  j   St |  d j   } | j d  d k r` d S| S(   s0  Return the message's content type.

        The returned string is coerced to lower case of the form
        `maintype/subtype'.  If there was no Content-Type header in the
        message, the default type as given by get_default_type() will be
        returned.  Since according to RFC 2045, messages always have a default
        type this will always return a value.

        RFC 2045 defines a message's default type to be text/plain unless it
        appears inside a multipart/digest container, in which case it would be
        message/rfc822.
        s   content-typei    t   /i   s
   text/plain(   Rl   RG   t   get_default_typeR   R   R   (   R.   Rm   R   t   ctype(    (    s#   /usr/lib/python2.7/email/message.pyt   get_content_type  s    	
c         C   s   |  j    } | j d  d S(   s   Return the message's main content type.

        This is the `maintype' part of the string returned by
        get_content_type().
        R   i    (   R   t   split(   R.   R   (    (    s#   /usr/lib/python2.7/email/message.pyt   get_content_maintype  s    c         C   s   |  j    } | j d  d S(   s   Returns the message's sub-content type.

        This is the `subtype' part of the string returned by
        get_content_type().
        R   i   (   R   R   (   R.   R   (    (    s#   /usr/lib/python2.7/email/message.pyt   get_content_subtype  s    c         C   s   |  j  S(   s  Return the `default' content type.

        Most messages have a default content type of text/plain, except for
        messages that are subparts of multipart/digest containers.  Such
        subparts have a default content type of message/rfc822.
        (   R-   (   R.   (    (    s#   /usr/lib/python2.7/email/message.pyR     s    c         C   s   | |  _  d S(   s   Set the `default' content type.

        ctype should be either "text/plain" or "message/rfc822", although this
        is not enforced.  The default content type is not stored in the
        Content-Type header.
        N(   R-   (   R.   R   (    (    s#   /usr/lib/python2.7/email/message.pyt   set_default_type  s    c   	      C   s   t    } |  j | |  } | | k r+ | Sg  } x t d |  D]s } y4 | j d d  \ } } | j   } | j   } Wn# t k
 r | j   } d } n X| j | | f  qB Wt j |  } | S(   NR   R   i   R@   (	   Rl   RG   R#   R   R   t
   ValueErrorR   R   t   decode_params(	   R.   Rr   t   headerRm   R   t   paramst   pRc   Re   (    (    s#   /usr/lib/python2.7/email/message.pyt   _get_params_preserve  s     	
s   content-typec         C   sb   t    } |  j | |  } | | k r+ | S| rZ g  | D] \ } } | t |  f ^ q8 S| Sd S(   sm  Return the message's Content-Type parameters, as a list.

        The elements of the returned list are 2-tuples of key/value pairs, as
        split on the `=' sign.  The left hand side of the `=' is the key,
        while the right hand side is the value.  If there is no `=' sign in
        the parameter the value is the empty string.  The value is as
        described in the get_param() method.

        Optional failobj is the object to return if there is no Content-Type
        header.  Optional header is the header to search instead of
        Content-Type.  If unquote is True, the value is unquoted.
        N(   Rl   R   R%   (   R.   Rr   R   R$   Rm   R   Rh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt
   get_params  s    	)c         C   sf   | |  k r | SxO |  j  | |  D]; \ } } | j   | j   k r# | rW t |  S| Sq# q# W| S(   s  Return the parameter value if found in the Content-Type header.

        Optional failobj is the object to return if there is no Content-Type
        header, or the Content-Type header has no such parameter.  Optional
        header is the header to search instead of Content-Type.

        Parameter keys are always compared case insensitively.  The return
        value can either be a string, or a 3-tuple if the parameter was RFC
        2231 encoded.  When it's a 3-tuple, the elements of the value are of
        the form (CHARSET, LANGUAGE, VALUE).  Note that both CHARSET and
        LANGUAGE can be None, in which case you should consider VALUE to be
        encoded in the us-ascii charset.  You can usually ignore LANGUAGE.

        Your application should be prepared to deal with 3-tuple return
        values, and can convert the parameter to a Unicode string like so:

            param = msg.get_param('foo')
            if isinstance(param, tuple):
                param = unicode(param[2], param[0] or 'us-ascii')

        In any case, the parameter value (either the returned string, or the
        VALUE item in the 3-tuple) is always unquoted, unless unquote is set
        to False.
        (   R   R   R%   (   R.   R   Rr   R   R$   Rh   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt	   get_param  s    
s   Content-TypeR@   c         C   sw  t  | t  r( | r( | | | f } n  | |  k rO | j   d k rO d } n |  j |  } |  j | d | s | s t | | |  } qJt j | t | | |  g  } n d } x |  j d | d |  D]u \ } }	 d }
 | j   | j   k rt | | |  }
 n t | |	 |  }
 | s1|
 } q t j | |
 g  } q W| |  j |  k rs|  | =| |  | <n  d S(   s  Set a parameter in the Content-Type header.

        If the parameter already exists in the header, its value will be
        replaced with the new value.

        If header is Content-Type and has not yet been defined for this
        message, it will be set to "text/plain" and the new parameter and
        value will be appended as per RFC 2045.

        An alternate header can specified in the header argument, and all
        parameters will be quoted as necessary unless requote is False.

        If charset is specified, the parameter will be encoded according to RFC
        2231.  Optional language specifies the RFC 2231 language, defaulting
        to the empty string.  Both charset and language should be strings.
        s   content-types
   text/plainR   R@   R$   N(	   R   R   R   RG   R   R   Rx   Ry   R   (   R.   R   R   R   t   requoteRR   t   languageR   t	   old_paramt	   old_valuet   append_param(    (    s#   /usr/lib/python2.7/email/message.pyRZ   ;  s.    		c         C   s   | |  k r d Sd } x} |  j  d | d |  D]c \ } } | j   | j   k r/ | sn t | | |  } q t j | t | | |  g  } q/ q/ W| |  j |  k r |  | =| |  | <n  d S(   s>  Remove the given parameter completely from the Content-Type header.

        The header will be re-written in place without the parameter or its
        value. All values will be quoted as necessary unless requote is
        False.  Optional header specifies an alternative to the Content-Type
        header.
        NR@   R   R$   (   R   R   R   Rx   Ry   RG   (   R.   R   R   R   t	   new_ctypeR   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyRT   k  s    %	c         C   s   | j  d  d k s t  n  | j   d k rD |  d =d |  d <n  | |  k r^ | |  | <d S|  j d | d	 |  } |  | =| |  | <x. | d D]" \ } } |  j | | | |  q Wd S(
   sK  Set the main type and subtype for the Content-Type header.

        type must be a string in the form "maintype/subtype", otherwise a
        ValueError is raised.

        This method replaces the Content-Type header, keeping all the
        parameters in place.  If requote is False, this leaves the existing
        header's quoting as is.  Otherwise, the parameters will be quoted (the
        default).

        An alternative header can be specified in the header argument.  When
        the Content-Type header is set, we'll always also add a MIME-Version
        header.
        R   i   s   content-types   mime-versions   1.0s   MIME-VersionNR   R$   (   R   R   R   R   RZ   (   R.   RF   R   R   R   R   Ri   (    (    s#   /usr/lib/python2.7/email/message.pyt   set_type  s    	

c         C   se   t    } |  j d | d  } | | k rB |  j d | d  } n  | | k rR | St j |  j   S(   s@  Return the filename associated with the payload if present.

        The filename is extracted from the Content-Disposition header's
        `filename' parameter, and it is unquoted.  If that header is missing
        the `filename' parameter, this method falls back to looking for the
        `name' parameter.
        t   filenames   content-dispositionRc   s   content-type(   Rl   R   R   t   collapse_rfc2231_valueR   (   R.   Rr   Rm   R   (    (    s#   /usr/lib/python2.7/email/message.pyt   get_filename  s    	c         C   s>   t    } |  j d |  } | | k r+ | St j |  j   S(   s   Return the boundary associated with the payload if present.

        The boundary is extracted from the Content-Type header's `boundary'
        parameter, and it is unquoted.
        t   boundary(   Rl   R   R   R   t   rstrip(   R.   Rr   Rm   R   (    (    s#   /usr/lib/python2.7/email/message.pyt   get_boundary  s
    	c         C   s  t    } |  j | d  } | | k r9 t j d   n  g  } t } xY | D]Q \ } } | j   d k r | j d d | f  t } qL | j | | f  qL W| s | j d d | f  n  g  } x |  j D] \ }	 }
 |	 j   d k r^g  } xG | D]? \ } }
 |
 d k r$| j |  q | j d | |
 f  q W| j |	 t	 j
 |  f  q | j |	 |
 f  q W| |  _ d S(   s  Set the boundary parameter in Content-Type to 'boundary'.

        This is subtly different than deleting the Content-Type header and
        adding a new one with a new boundary parameter via add_header().  The
        main difference is that using the set_boundary() method preserves the
        order of the Content-Type header in the original message.

        HeaderParseError is raised if the message has no Content-Type header.
        s   content-types   No Content-Type header foundR   s   "%s"R@   s   %s=%sN(   Rl   R   R   t   HeaderParseErrort   FalseR   R   R2   R&   Rx   Ry   (   R.   R   Rm   R   t	   newparamst   foundpt   pkt   pvRg   t   hRi   R}   Rh   (    (    s#   /usr/lib/python2.7/email/message.pyt   set_boundary  s0    
		c         C   s   t    } |  j d |  } | | k r+ | St | t  r | d pG d } y  t | d |  j d  } Wq t t f k
 r | d } q Xn  y4 t | t  r t | d  } n  | j d  } Wn t k
 r | SX| j	   S(   s   Return the charset parameter of the Content-Type header.

        The returned string is always coerced to lower case.  If there is no
        Content-Type header, or if that header has no charset parameter,
        failobj is returned.
        RR   i    s   us-asciii   (
   Rl   R   R   R   R[   R\   t   LookupErrort   UnicodeErrorR^   R   (   R.   Rr   Rm   RR   t   pcharset(    (    s#   /usr/lib/python2.7/email/message.pyt   get_content_charset  s"    	 c         C   s&   g  |  j    D] } | j |  ^ q S(   s  Return a list containing the charset(s) used in this message.

        The returned list of items describes the Content-Type headers'
        charset parameter for this message and all the subparts in its
        payload.

        Each item will either be a string (the value of the charset parameter
        in the Content-Type header of that part) or the value of the
        'failobj' parameter (defaults to None), if the part does not have a
        main MIME type of "text", or the charset is not defined.

        The list will contain one string for each part of the message, plus
        one for the container message (i.e. self), so that a non-multipart
        message will still return a list of length 1.
        (   t   walkR   (   R.   Rr   t   part(    (    s#   /usr/lib/python2.7/email/message.pyt   get_charsets
  s    i(   R   N(0   t   __name__t
   __module__t   __doc__R/   R3   R   R1   R;   R<   R=   R?   R   RP   RS   RQ   Ra   Rb   Rd   Rf   Rj   Rk   Rn   Ro   Rp   Rq   RG   Rs   RX   R   R   R   R   R   R   R   R2   R   R   RZ   RT   R   R   R   R   R   R   t   email.iteratorsR   (    (    (    s#   /usr/lib/python2.7/email/message.pyR    \   sX   						2
	-								
	
	
												#/ 	-(    (   R   t   __all__t   reRL   RJ   t   warningst	   cStringIOR   t   email.charsetRV   R   R   Rx   t   compileR   R   R   R2   R   R#   R%   R    (    (    (    s#   /usr/lib/python2.7/email/message.pyt   <module>   s    		
		                                                                                           
k[c           @   s{   d  Z  d d g Z d d l Z d d l m Z d d l m Z d d l m Z d d
 d     YZ	 d e	 f d	     YZ
 d S(   s-   A parser of RFC 2822 and MIME email messages.t   Parsert   HeaderParseriN(   t   StringIO(   t
   FeedParser(   t   Messagec           B   s)   e  Z d    Z e d  Z e d  Z RS(   c         O   s  t  |  d k r> d | k r- t d   n  | d | d <n  t  |  d k r| d | k rk t d   n  | d | d <n  t  |  d k r t d   n  d | k r | d |  _ | d =n	 t |  _ d | k r t j d	 t d  | d =n  | rt d
   n  d S(   s  Parser of RFC 2822 and MIME email messages.

        Creates an in-memory object tree representing the email message, which
        can then be manipulated and turned over to a Generator to return the
        textual representation of the message.

        The string must be formatted as a block of RFC 2822 headers and header
        continuation lines, optionally preceeded by a `Unix-from' header.  The
        header block is terminated either by the end of the string or by a
        blank line.

        _class is the class to instantiate for new message objects when they
        must be created.  This class must have a constructor that can take
        zero arguments.  Default is Message.Message.
        i   t   _classs(   Multiple values for keyword arg '_class'i    i   t   stricts(   Multiple values for keyword arg 'strict's   Too many argumentss-   'strict' argument is deprecated (and ignored)s   Unexpected keyword argumentsN(   t   lent	   TypeErrorR   R   t   warningst   warnt   DeprecationWarning(   t   selft   argst   kws(    (    s"   /usr/lib/python2.7/email/parser.pyt   __init__   s(    
		

c         C   s_   t  |  j  } | r" | j   n  x0 t rT | j d  } | sD Pn  | j |  q% W| j   S(   s\  Create a message structure from the data in a file.

        Reads all the data from the file and returns the root of the message
        structure.  Optional headersonly is a flag specifying whether to stop
        parsing after reading the headers or not.  The default is False,
        meaning it parses the entire contents of the file.
        i    (   R   R   t   _set_headersonlyt   Truet   readt   feedt   close(   R   t   fpt   headersonlyt
   feedparsert   data(    (    s"   /usr/lib/python2.7/email/parser.pyt   parse8   s    	c         C   s   |  j  t |  d | S(   s-  Create a message structure from a string.

        Returns the root of the message structure.  Optional headersonly is a
        flag specifying whether to stop parsing after reading the headers or
        not.  The default is False, meaning it parses the entire contents of
        the file.
        R   (   R   R   (   R   t   textR   (    (    s"   /usr/lib/python2.7/email/parser.pyt   parsestrJ   s    (   t   __name__t
   __module__R   t   FalseR   R   (    (    (    s"   /usr/lib/python2.7/email/parser.pyR       s   	&c           B   s    e  Z e d   Z e d  Z RS(   c         C   s   t  j |  | t  S(   N(   R    R   R   (   R   R   R   (    (    s"   /usr/lib/python2.7/email/parser.pyR   W   s    c         C   s   t  j |  | t  S(   N(   R    R   R   (   R   R   R   (    (    s"   /usr/lib/python2.7/email/parser.pyR   Z   s    (   R   R   R   R   R   (    (    (    s"   /usr/lib/python2.7/email/parser.pyR   V   s   (    (   t   __doc__t   __all__R	   t	   cStringIOR   t   email.feedparserR   t   email.messageR   R    R   (    (    (    s"   /usr/lib/python2.7/email/parser.pyt   <module>   s   E                                                                                                                                                                                                                                                                                           
l[c           @  s  d  d l  m Z d  d l Z d  d l Z d  d l Z d  d l Z d  d l Z d  d l Z d  d l Z d d g Z	 d   Z
 d Z y d  d l Z Wn  e k
 r d Z d   Z n
 Xd   Z d	 d
 g Z d d  Z d   Z d   Z d e e e e d d  Z d d  Z d d  Z d S(   i(   t   print_functionNt   versiont	   bootstrapc           C  s$   t  r  t d  t j d  n  d  S(   Ns  ensurepip is disabled in Debian/Ubuntu for the system python.

Python modules For the system python are usually handled by dpkg and apt-get.

    apt-get install python-<module name>

Install the python-pip package to use pip itself.  Using pip together
with the system python might have unexpected results for any system installed
module, so use it on your own risk, or make sure to only use it in virtual
environments.
i   (   t   Truet   printt   syst   exit(    (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt    _ensurepip_is_disabled_in_debian   s    s   pip requires SSL/TLSc           C  s   t  t   d  S(   N(   t   RuntimeErrort   _MISSING_SSL_MESSAGE(    (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt   _require_ssl_for_pip'   s    c           C  s   d  S(   N(    (    (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyR
   *   s    t
   setuptoolst   pipc         C  s<   | d  k	 r | t j t _ n  d d  l } | j |   d  S(   Ni(   t   NoneR   t   pathR   t   main(   t   argst   additional_pathsR   (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt   _run_pip3   s    c          C  sm   t    d }  t j d |   } t |  d k rS t j j | d  j d  d St d |  |  f   d S(   sA   
    Returns a string specifying the bundled version of pip.
    R   s!   /usr/share/python-wheels/%s-*.whli   i    t   -sb   missing dependency wheel %s. Installation of the python-%s-whl package is needed to use ensurepip.N(   R   t   globt   lent   osR   t   basenamet   splitR   (   t   whl_namet   wheel_names(    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyR   =   s    !c          C  sZ   g  t  j D] }  |  j d  r
 |  ^ q
 } x | D] }  t  j |  =q2 Wt  j t  j d <d  S(   Nt   PIP_t   PIP_CONFIG_FILE(   R   t   environt
   startswitht   devnull(   t   kt   keys_to_remove(    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt#   _disable_pip_configuration_settingsI   s    +i    c      	   C  sQ  t    | r" | r" t d   n  t   t   | rF d t j d <n | s\ d t j d <n  d   } g  } xI t t  D]; } t j d |  }	 t	 |	  d k rx | j
 |  qx qx W| rt d d	 j | g  d	 j g  | D] }
 d
 |
 ^ q  f   n  t j   } x t D]} } yJ t d |  4 } g  | j   D] } | d  j   d ^ q>} Wd QXWn t k
 r~g  } n X| | | t j  qWz g  } | t | |  d d d | g } |  r| d |  g 7} n  | r| d g 7} n  | r| d g 7} n  | r$| d d | g 7} n  t | t |  Wd t j | d t Xd S(   s   
    Bootstrap pip into the current Python installation (or the given root
    directory).

    Note that calling this function will alter both sys.path and os.environ.
    s.   Cannot use altinstall and default_pip togethert
   altinstallt   ENSUREPIP_OPTIONSt   installc   
      S  s  x|  D] } t  j  d j |   } t |  d k rP t d | | f   n  t |  d k sn t |   t j j | d  } t j j d |  } t	 | d   } | j
   } Wd  QXt j j | |  }	 t	 |	 d   } | j |  Wd  QX| j |	  q Wd  S(   Ns!   /usr/share/python-wheels/{}-*.whli    sb   missing dependency wheel %s. Installation of the python-%s-whl package is needed to use ensurepip.i   s   /usr/share/python-wheelst   rbt   wb(   R   t   formatR   R   t   AssertionErrorR   R   R   t   joint   opent   readt   writet   append(
   t   wheelst   destdirt   pathst   projectR   t
   wheel_nameR   t   fpt   whlt   dest(    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt   copy_wheelsv   s    s!   /usr/share/python-wheels/%s-*.whli   sR   missing wheel(s) %s. Installation of the %s package(s) is needed to use ensurepip.s   , s   python-%s-whls(   /usr/share/python-wheels/%s.dependenciesii    Ns
   --no-indexs   --find-linkss   --roots	   --upgrades   --userR   t   vt   ignore_errors(   R   t
   ValueErrorR
   R"   R   R   t   reversedt	   _PROJECTSR   R   R.   R   R*   t   tempfilet   mkdtempR+   t	   readlinesR   t   IOErrorR   R   R   t   shutilt   rmtreeR   (   t   roott   upgradet   userR#   t   default_pipt	   verbosityR7   t   missingR2   R   t   mt   tmpdirR4   t   linet   dependenciesR   R   (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyR   U   sR    		07
c         C  s   y d d l  } Wn t k
 r$ d SXt rf | j t k rf d } t | j | j t  d t j d St	   t
   d d g } |  r | d d |  g 7} n  t | t t   d S(	   s~   Helper to support a clean default uninstall process on Windows

    Note that calling this function may alter os.environ.
    iNsO   ensurepip will only uninstall a matching version ({!r} installed, {!r} bundled)t   filet	   uninstalls   -yR   R8   (   R   t   ImportErrort   Falset   __version__t   _PIP_VERSIONR   R(   R   t   stderrR
   R"   R   R;   R<   (   RG   R   t   msgR   (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt   _uninstall_helper   s    "c         C  s  t  d  k r, t d j t  d t j d  Sd d  l } | j d d  } | j	 d d d d d	 j t
    d
 d | j	 d d d d d d d d d
 d | j	 d d d d d t d
 d | j	 d d d d t d
 d | j	 d d d  d
 d | j	 d d d d t d
 d | j	 d d d d t d d d
 | j | j	 d  d d! d d d
 d" | j |   } t d# | j d$ | j d% | j d | j d& | j d | j  d  S('   Ns   Ignoring ensurepip failure: {}RM   it   progs   python -m ensurepips	   --versiont   actionR   s   pip {}t   helps9   Show the version of pip that is bundled with this Python.s   -vs	   --verboset   countt   defaulti    R6   RG   sD   Give more output. Option is additive, and can be used up to 3 times.s   -Us	   --upgradet
   store_trues8   Upgrade pip and dependencies, even if already installed.s   --users   Install using the user scheme.s   --roots=   Install everything relative to this alternate root directory.s   --altinstallsm   Make an alternate install, installing only the X.Y versionedscripts (Default: pipX, pipX.Y, easy_install-X.Y)s   --default-pipRF   s   --no-default-pipt   store_falsesL   Make a non default install, installing only the X and X.Y versioned scripts.RC   RD   RE   R#   (   t   sslR   R   R(   R	   R   RS   t   argparset   ArgumentParsert   add_argumentR   RP   R   t   SUPPRESSt
   parse_argsR   RC   RD   RE   RG   R#   RF   (   t   argvR^   t   parserR   (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt   _main   sn    
		
					(   t
   __future__R    R   R   t   os.patht   pkgutilRA   R   R=   t   __all__R   R	   R]   RO   R   R
   R<   R   R   R"   RP   R   R   RU   Re   (    (    (    s(   /usr/lib/python2.7/ensurepip/__init__.pyt   <module>   s4   			
			[                                                                                                                                                                                                                                                                                                                                                                                                                                                     
k[c           @   s=  d  Z  d d l Z y d d l Z Wn e k
 rB e j e =  n Xd d l Z d d l m	 Z
 d d l m Z d d l m Z m Z d d l m Z d d d	 d
 d d d d d d d d d d d d d g Z e j Z e j Z e j Z e j Z [ e j d d e d d d d e  Z! d e" f d     YZ# e$ a% e$ a& d    Z' d!   Z( e Z) d"   Z* d# e# f d$     YZ+ d%   Z, d& e# f d'     YZ- d(   Z. d) e# f d*     YZ/ d+   Z0 d, e/ f d-     YZ1 d.   Z2 d/ e# f d0     YZ3 e   j4 Z5 e5   d1 d2  Z6 e   a7 i  Z8 i  Z9 d e# f d3     YZ: d4   Z; d5 e: f d6     YZ< d7 e: f d8     YZ= d9   Z> d: e: f d;     YZ? d<   Z@ e@ ZA d=   ZB eB ZC d>   ZD d?   ZE d d@ l mF ZF e=   jG ZH y d dA l mI ZJ Wn! e k
 rd dB lK mJ ZJ n XdC   ZL dD   ZM e dE k r9eM   n  d S(F   s;   Thread module emulating a subset of Java's threading model.iN(   t   deque(   t   count(   t   timet   sleep(   t
   format_exct   activeCountt   active_countt	   Conditiont   currentThreadt   current_threadt	   enumeratet   Eventt   Lockt   RLockt	   Semaphoret   BoundedSemaphoret   Threadt   Timert
   setprofilet   settracet   localt
   stack_sizet   ignoret   categoryt   modulet	   threadingt   messages   sys.exc_cleart   _Verbosec           B   s   e  Z d d   Z d   Z RS(   c         C   s"   | d  k r t } n  | |  _ d  S(   N(   t   Nonet   _VERBOSEt   _Verbose__verbose(   t   selft   verbose(    (    s   /usr/lib/python2.7/threading.pyt   __init__;   s    	c         G   sr   |  j  rn | | } t   } y t | j } Wn t k
 rJ d | } n Xd | | f } t j j |  n  d  S(   Ns   <OS thread %d>s   %s: %s
(   R   t
   _get_identt   _activet   namet   KeyErrort   _syst   stderrt   write(   R   t   formatt   argst   identR$   (    (    s   /usr/lib/python2.7/threading.pyt   _note@   s    	
	N(   t   __name__t
   __module__R   R!   R,   (    (    (    s   /usr/lib/python2.7/threading.pyR   9   s   c         C   s
   |  a  d S(   s   Set a profile function for all threads started from the threading module.

    The func will be passed to sys.setprofile() for each thread, before its
    run() method is called.

    N(   t   _profile_hook(   t   func(    (    s   /usr/lib/python2.7/threading.pyR   Z   s    c         C   s
   |  a  d S(   s   Set a trace function for all threads started from the threading module.

    The func will be passed to sys.settrace() for each thread, before its run()
    method is called.

    N(   t   _trace_hook(   R0   (    (    s   /usr/lib/python2.7/threading.pyR   d   s    c          O   s   t  |  |   S(   s2  Factory function that returns a new reentrant lock.

    A reentrant lock must be released by the thread that acquired it. Once a
    thread has acquired a reentrant lock, the same thread may acquire it again
    without blocking; the thread must release it once for each time it has
    acquired it.

    (   t   _RLock(   R*   t   kwargs(    (    s   /usr/lib/python2.7/threading.pyR   r   s    	R2   c           B   sb   e  Z d  Z d
 d  Z d   Z d d  Z e Z d   Z d   Z	 d   Z
 d   Z d	   Z RS(   s  A reentrant lock must be released by the thread that acquired it. Once a
       thread has acquired a reentrant lock, the same thread may acquire it
       again without blocking; the thread must release it once for each time it
       has acquired it.
    c         C   s2   t  j |  |  t   |  _ d  |  _ d |  _ d  S(   Ni    (   R   R!   t   _allocate_lockt   _RLock__blockR   t   _RLock__ownert   _RLock__count(   R   R    (    (    s   /usr/lib/python2.7/threading.pyR!      s    	c         C   sH   |  j  } y t | j } Wn t k
 r- n Xd |  j j | |  j f S(   Ns   <%s owner=%r count=%d>(   R6   R#   R$   R%   t	   __class__R-   R7   (   R   t   owner(    (    s   /usr/lib/python2.7/threading.pyt   __repr__   s    	i   c         C   s   t    } |  j | k r? |  j d |  _ |  j d |  |  d S|  j j |  } | r | |  _ d |  _ |  j d |  |  n |  j d |  |  | S(   s  Acquire a lock, blocking or non-blocking.

        When invoked without arguments: if this thread already owns the lock,
        increment the recursion level by one, and return immediately. Otherwise,
        if another thread owns the lock, block until the lock is unlocked. Once
        the lock is unlocked (not owned by any thread), then grab ownership, set
        the recursion level to one, and return. If more than one thread is
        blocked waiting until the lock is unlocked, only one at a time will be
        able to grab ownership of the lock. There is no return value in this
        case.

        When invoked with the blocking argument set to true, do the same thing
        as when called without arguments, and return true.

        When invoked with the blocking argument set to false, do not block. If a
        call without an argument would block, return false immediately;
        otherwise, do the same thing as when called without arguments, and
        return true.

        i   s!   %s.acquire(%s): recursive successs   %s.acquire(%s): initial successs   %s.acquire(%s): failure(   R"   R6   R7   R,   R5   t   acquire(   R   t   blockingt   met   rc(    (    s   /usr/lib/python2.7/threading.pyR;      s    			c         C   sx   |  j  t   k r! t d   n  |  j d |  _ } | sd d |  _  |  j j   |  j d |   n |  j d |   d S(   sm  Release a lock, decrementing the recursion level.

        If after the decrement it is zero, reset the lock to unlocked (not owned
        by any thread), and if any other threads are blocked waiting for the
        lock to become unlocked, allow exactly one of them to proceed. If after
        the decrement the recursion level is still nonzero, the lock remains
        locked and owned by the calling thread.

        Only call this method when the calling thread owns the lock. A
        RuntimeError is raised if this method is called when the lock is
        unlocked.

        There is no return value.

        s   cannot release un-acquired locki   s   %s.release(): final releases   %s.release(): non-final releaseN(   R6   R"   t   RuntimeErrorR7   R   R5   t   releaseR,   (   R   R   (    (    s   /usr/lib/python2.7/threading.pyR@      s    	c         C   s   |  j    d  S(   N(   R@   (   R   t   tt   vt   tb(    (    s   /usr/lib/python2.7/threading.pyt   __exit__   s    c         C   s?   | \ } } |  j  j   | |  _ | |  _ |  j d |   d  S(   Ns   %s._acquire_restore()(   R5   R;   R7   R6   R,   (   R   t   count_ownerR   R9   (    (    s   /usr/lib/python2.7/threading.pyt   _acquire_restore   s
    		c         C   sK   |  j  d |   |  j } d |  _ |  j } d  |  _ |  j j   | | f S(   Ns   %s._release_save()i    (   R,   R7   R6   R   R5   R@   (   R   R   R9   (    (    s   /usr/lib/python2.7/threading.pyt   _release_save   s    				c         C   s   |  j  t   k S(   N(   R6   R"   (   R   (    (    s   /usr/lib/python2.7/threading.pyt	   _is_owned   s    N(   R-   R.   t   __doc__R   R!   R:   R;   t	   __enter__R@   RD   RF   RG   RH   (    (    (    s   /usr/lib/python2.7/threading.pyR2   }   s   		&				
c          O   s   t  |  |   S(   s}  Factory function that returns a new condition variable object.

    A condition variable allows one or more threads to wait until they are
    notified by another thread.

    If the lock argument is given and not None, it must be a Lock or RLock
    object, and it is used as the underlying lock. Otherwise, a new RLock object
    is created and used as the underlying lock.

    (   t
   _Condition(   R*   R3   (    (    s   /usr/lib/python2.7/threading.pyR      s    RK   c           B   sz   e  Z d  Z d d d  Z d   Z d   Z d   Z d   Z d   Z	 d   Z
 d d  Z d	 d
  Z d   Z e Z RS(   sl   Condition variables allow one or more threads to wait until they are
       notified by another thread.
    c         C   s   t  j |  |  | d  k r( t   } n  | |  _ | j |  _ | j |  _ y | j |  _ Wn t k
 rl n Xy | j	 |  _	 Wn t k
 r n Xy | j
 |  _
 Wn t k
 r n Xg  |  _ d  S(   N(   R   R!   R   R   t   _Condition__lockR;   R@   RG   t   AttributeErrorRF   RH   t   _Condition__waiters(   R   t   lockR    (    (    s   /usr/lib/python2.7/threading.pyR!     s&    	c         C   s   |  j  j   S(   N(   RL   RJ   (   R   (    (    s   /usr/lib/python2.7/threading.pyRJ     s    c         G   s   |  j  j |   S(   N(   RL   RD   (   R   R*   (    (    s   /usr/lib/python2.7/threading.pyRD      s    c         C   s   d |  j  t |  j  f S(   Ns   <Condition(%s, %d)>(   RL   t   lenRN   (   R   (    (    s   /usr/lib/python2.7/threading.pyR:   #  s    c         C   s   |  j  j   d  S(   N(   RL   R@   (   R   (    (    s   /usr/lib/python2.7/threading.pyRG   &  s    c         C   s   |  j  j   d  S(   N(   RL   R;   (   R   t   x(    (    s   /usr/lib/python2.7/threading.pyRF   )  s    c         C   s+   |  j  j d  r# |  j  j   t St Sd  S(   Ni    (   RL   R;   R@   t   Falset   True(   R   (    (    s   /usr/lib/python2.7/threading.pyRH   ,  s    c         C   sY  |  j    s t d   n  t   } | j   |  j j |  |  j   } z | d	 k rv | j   |  j d |   n t	   | } d } x` t
 r | j d  } | r Pn  | t	   } | d k r Pn  t | d | d  } t |  q W| s0|  j d |  |  y |  j j |  WqCt k
 r,qCXn |  j d |  |  Wd	 |  j |  Xd	 S(
   sj  Wait until notified or until a timeout occurs.

        If the calling thread has not acquired the lock when this method is
        called, a RuntimeError is raised.

        This method releases the underlying lock, and then blocks until it is
        awakened by a notify() or notifyAll() call for the same condition
        variable in another thread, or until the optional timeout occurs. Once
        awakened or timed out, it re-acquires the lock and returns.

        When the timeout argument is present and not None, it should be a
        floating point number specifying a timeout for the operation in seconds
        (or fractions thereof).

        When the underlying lock is an RLock, it is not released using its
        release() method, since this may not actually unlock the lock when it
        was acquired multiple times recursively. Instead, an internal interface
        of the RLock class is used, which really unlocks it even when it has
        been recursively acquired several times. Another internal interface is
        then used to restore the recursion level when the lock is reacquired.

        s   cannot wait on un-acquired locks   %s.wait(): got itgMb@?i    i   g?s   %s.wait(%s): timed outs   %s.wait(%s): got itN(   RH   R?   R4   R;   RN   t   appendRG   R   R,   t   _timeRS   t   mint   _sleept   removet
   ValueErrorRF   (   R   t   timeoutt   waitert   saved_statet   endtimet   delayt   gotitt	   remaining(    (    s   /usr/lib/python2.7/threading.pyt   wait5  s:    	

	i   c         C   s   |  j    s t d   n  |  j } | |  } | sH |  j d |   d S|  j d |  | | d k ri d pl d  x= | D]5 } | j   y | j |  Wqw t k
 r qw Xqw Wd S(   sK  Wake up one or more threads waiting on this condition, if any.

        If the calling thread has not acquired the lock when this method is
        called, a RuntimeError is raised.

        This method wakes up at most n of the threads waiting for the condition
        variable; it is a no-op if no threads are waiting.

        s!   cannot notify on un-acquired locks   %s.notify(): no waitersNs"   %s.notify(): notifying %d waiter%si   t   st    (   RH   R?   RN   R,   R@   RX   RY   (   R   t   nRN   t   waitersR[   (    (    s   /usr/lib/python2.7/threading.pyt   notifyu  s    
	

c         C   s   |  j  t |  j   d S(   s   Wake up all threads waiting on this condition.

        If the calling thread has not acquired the lock when this method
        is called, a RuntimeError is raised.

        N(   Rf   RP   RN   (   R   (    (    s   /usr/lib/python2.7/threading.pyt	   notifyAll  s    N(   R-   R.   RI   R   R!   RJ   RD   R:   RG   RF   RH   Ra   Rf   Rg   t
   notify_all(    (    (    s   /usr/lib/python2.7/threading.pyRK      s   							@		c          O   s   t  |  |   S(   sO  A factory function that returns a new semaphore.

    Semaphores manage a counter representing the number of release() calls minus
    the number of acquire() calls, plus an initial value. The acquire() method
    blocks if necessary until it can return without making the counter
    negative. If not given, value defaults to 1.

    (   t
   _Semaphore(   R*   R3   (    (    s   /usr/lib/python2.7/threading.pyR     s    	Ri   c           B   sA   e  Z d  Z d d d  Z d d  Z e Z d   Z d   Z RS(   s"  Semaphores manage a counter representing the number of release() calls
       minus the number of acquire() calls, plus an initial value. The acquire()
       method blocks if necessary until it can return without making the counter
       negative. If not given, value defaults to 1.

    i   c         C   sJ   | d k  r t  d   n  t j |  |  t t    |  _ | |  _ d  S(   Ni    s$   semaphore initial value must be >= 0(   RY   R   R!   R   R   t   _Semaphore__condt   _Semaphore__value(   R   t   valueR    (    (    s   /usr/lib/python2.7/threading.pyR!     s
    c      	   C   s   t  } |  j w xo |  j d k rU | s, Pn  |  j d |  | |  j  |  j j   q W|  j d |  _ |  j d |  |  j  t } Wd QX| S(   s   Acquire a semaphore, decrementing the internal counter by one.

        When invoked without arguments: if the internal counter is larger than
        zero on entry, decrement it by one and return immediately. If it is zero
        on entry, block, waiting until some other thread has called release() to
        make it larger than zero. This is done with proper interlocking so that
        if multiple acquire() calls are blocked, release() will wake exactly one
        of them up. The implementation may pick one at random, so the order in
        which blocked threads are awakened should not be relied on. There is no
        return value in this case.

        When invoked with blocking set to true, do the same thing as when called
        without arguments, and return true.

        When invoked with blocking set to false, do not block. If a call without
        an argument would block, return false immediately; otherwise, do the
        same thing as when called without arguments, and return true.

        i    s)   %s.acquire(%s): blocked waiting, value=%si   s   %s.acquire: success, value=%sN(   RR   Rj   Rk   R,   Ra   RS   (   R   R<   R>   (    (    s   /usr/lib/python2.7/threading.pyR;     s    
		c         C   sG   |  j  8 |  j d |  _ |  j d |  |  j  |  j  j   Wd QXd S(   s   Release a semaphore, incrementing the internal counter by one.

        When the counter is zero on entry and another thread is waiting for it
        to become larger than zero again, wake up that thread.

        i   s   %s.release: success, value=%sN(   Rj   Rk   R,   Rf   (   R   (    (    s   /usr/lib/python2.7/threading.pyR@     s
    
	c         C   s   |  j    d  S(   N(   R@   (   R   RA   RB   RC   (    (    s   /usr/lib/python2.7/threading.pyRD     s    N(	   R-   R.   RI   R   R!   R;   RJ   R@   RD   (    (    (    s   /usr/lib/python2.7/threading.pyRi     s   %	c          O   s   t  |  |   S(   s  A factory function that returns a new bounded semaphore.

    A bounded semaphore checks to make sure its current value doesn't exceed its
    initial value. If it does, ValueError is raised. In most situations
    semaphores are used to guard resources with limited capacity.

    If the semaphore is released too many times it's a sign of a bug. If not
    given, value defaults to 1.

    Like regular semaphores, bounded semaphores manage a counter representing
    the number of release() calls minus the number of acquire() calls, plus an
    initial value. The acquire() method blocks if necessary until it can return
    without making the counter negative. If not given, value defaults to 1.

    (   t   _BoundedSemaphore(   R*   R3   (    (    s   /usr/lib/python2.7/threading.pyR     s    Rm   c           B   s&   e  Z d  Z d d d  Z d   Z RS(   s   A bounded semaphore checks to make sure its current value doesn't exceed
       its initial value. If it does, ValueError is raised. In most situations
       semaphores are used to guard resources with limited capacity.
    i   c         C   s    t  j |  | |  | |  _ d  S(   N(   Ri   R!   t   _initial_value(   R   Rl   R    (    (    s   /usr/lib/python2.7/threading.pyR!   	  s    c         C   sQ   |  j  B |  j |  j k r+ t d   n  |  j d 7_ |  j  j   Wd QXd S(   s6  Release a semaphore, incrementing the internal counter by one.

        When the counter is zero on entry and another thread is waiting for it
        to become larger than zero again, wake up that thread.

        If the number of releases exceeds the number of acquires,
        raise a ValueError.

        s!   Semaphore released too many timesi   N(   Rj   Rk   Rn   RY   Rf   (   R   (    (    s   /usr/lib/python2.7/threading.pyR@     s
    

N(   R-   R.   RI   R   R!   R@   (    (    (    s   /usr/lib/python2.7/threading.pyRm     s   c          O   s   t  |  |   S(   s   A factory function that returns a new event.

    Events manage a flag that can be set to true with the set() method and reset
    to false with the clear() method. The wait() method blocks until the flag is
    true.

    (   t   _Event(   R*   R3   (    (    s   /usr/lib/python2.7/threading.pyR     s    Ro   c           B   sP   e  Z d  Z d d  Z d   Z d   Z e Z d   Z d   Z	 d d  Z
 RS(   s   A factory function that returns a new event object. An event manages a
       flag that can be set to true with the set() method and reset to false
       with the clear() method. The wait() method blocks until the flag is true.

    c         C   s/   t  j |  |  t t    |  _ t |  _ d  S(   N(   R   R!   R   R   t   _Event__condRR   t   _Event__flag(   R   R    (    (    s   /usr/lib/python2.7/threading.pyR!   1  s    c         C   s   |  j  j   d  S(   N(   Rp   R!   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   _reset_internal_locks6  s    c         C   s   |  j  S(   s5   Return true if and only if the internal flag is true.(   Rq   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   isSet:  s    c         C   s<   |  j  j   z t |  _ |  j  j   Wd |  j  j   Xd S(   s   Set the internal flag to true.

        All threads waiting for the flag to become true are awakened. Threads
        that call wait() once the flag is true will not block at all.

        N(   Rp   R;   RS   Rq   Rh   R@   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   set@  s
    	c         C   s/   |  j  j   z t |  _ Wd |  j  j   Xd S(   s   Reset the internal flag to false.

        Subsequently, threads calling wait() will block until set() is called to
        set the internal flag to true again.

        N(   Rp   R;   RR   Rq   R@   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   clearN  s    c         C   sI   |  j  j   z' |  j s, |  j  j |  n  |  j SWd |  j  j   Xd S(   sH  Block until the internal flag is true.

        If the internal flag is true on entry, return immediately. Otherwise,
        block until another thread calls set() to set the flag to true, or until
        the optional timeout occurs.

        When the timeout argument is present and not None, it should be a
        floating point number specifying a timeout for the operation in seconds
        (or fractions thereof).

        This method returns the internal flag on exit, so it will always return
        True except if a timeout is given and the operation times out.

        N(   Rp   R;   Rq   Ra   R@   (   R   RZ   (    (    s   /usr/lib/python2.7/threading.pyRa   [  s    	N(   R-   R.   RI   R   R!   Rr   Rs   t   is_setRt   Ru   Ra   (    (    (    s   /usr/lib/python2.7/threading.pyRo   (  s   				s	   Thread-%dc         C   s   |  t    S(   N(   t   _counter(   t   template(    (    s   /usr/lib/python2.7/threading.pyt   _newnameu  s    c           B   s:  e  Z d  Z e Z e j Z e j Z	 d d d d d d d  Z d   Z e d    Z d   Z d   Z d   Z d   Z d   Z d	   Z d
   Z d   Z d   Z d d  Z e d    Z e j d    Z e d    Z d   Z e Z e d    Z e j d    Z d   Z d   Z  d   Z! d   Z" RS(   sq   A class that represents a thread of control.

    This class can be safely subclassed in a limited fashion.

    c         C   s   | d k s t d   t j |  |  | d k r= i  } n  | |  _ t | pU t    |  _ | |  _ | |  _	 |  j
   |  _ d |  _ t   |  _ t |  _ t t    |  _ t |  _ t j |  _ d S(   sC  This constructor should always be called with keyword arguments. Arguments are:

        *group* should be None; reserved for future extension when a ThreadGroup
        class is implemented.

        *target* is the callable object to be invoked by the run()
        method. Defaults to None, meaning nothing is called.

        *name* is the thread name. By default, a unique name is constructed of
        the form "Thread-N" where N is a small decimal number.

        *args* is the argument tuple for the target invocation. Defaults to ().

        *kwargs* is a dictionary of keyword arguments for the target
        invocation. Defaults to {}.

        If a subclass overrides the constructor, it must make sure to invoke
        the base class constructor (Thread.__init__()) before doing anything
        else to the thread.

s#   group argument must be None for nowN(   R   t   AssertionErrorR   R!   t   _Thread__targett   strRy   t   _Thread__namet   _Thread__argst   _Thread__kwargst   _set_daemont   _Thread__daemonict   _Thread__identR   t   _Thread__startedRR   t   _Thread__stoppedR   R   t   _Thread__blockRS   t   _Thread__initializedR&   R'   t   _Thread__stderr(   R   t   groupt   targetR$   R*   R3   R    (    (    s   /usr/lib/python2.7/threading.pyR!     s    							c         C   s0   t  |  d  r |  j j   n  |  j j   d  S(   NR   (   t   hasattrR   R!   R   Rr   (   R   (    (    s   /usr/lib/python2.7/threading.pyRr     s    c         C   s   |  j  S(   N(   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   _block  s    c         C   s
   t    j S(   N(   R	   t   daemon(   R   (    (    s   /usr/lib/python2.7/threading.pyR     s    c         C   s   |  j  s t d   d } |  j j   r3 d } n  |  j rE d } n  |  j r[ | d 7} n  |  j d  k	 r~ | d |  j 7} n  d |  j j	 |  j
 | f S(   Ns    Thread.__init__() was not calledt   initialt   startedt   stoppeds    daemons    %ss   <%s(%s, %s)>(   R   Rz   R   Rv   R   R   R   R   R8   R-   R}   (   R   t   status(    (    s   /usr/lib/python2.7/threading.pyR:     s    				c         C   s   |  j  s t d   n  |  j j   r6 t d   n  |  j d |   t  |  t |  <Wd QXy t |  j d  Wn( t	 k
 r t  t |  =Wd QX  n X|  j j
   d S(   s-  Start the thread's activity.

        It must be called at most once per thread object. It arranges for the
        object's run() method to be invoked in a separate thread of control.

        This method will raise a RuntimeError if called more than once on the
        same thread object.

        s   thread.__init__() not calleds    threads can only be started onces   %s.start(): starting threadN(    (   R   R?   R   Rv   R,   t   _active_limbo_lockt   _limbot   _start_new_threadt   _Thread__bootstrapt	   ExceptionRa   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   start  s    
	c         C   s@   z& |  j  r% |  j  |  j |  j   n  Wd |  `  |  ` |  ` Xd S(   sX  Method representing the thread's activity.

        You may override this method in a subclass. The standard run() method
        invokes the callable object passed to the object's constructor as the
        target argument, if any, with sequential and keyword arguments taken
        from the args and kwargs arguments, respectively.

        N(   R{   R~   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   run  s    		c         C   s8   y |  j    Wn# |  j r- t d  k r- d  S  n Xd  S(   N(   t   _Thread__bootstrap_innerR   R&   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   __bootstrap  s    c         C   s   t    |  _ d  S(   N(   R"   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyt
   _set_ident  s    c      
   C   s'  z|  j    |  j j   t  |  t |  j <t |  =Wd  QX|  j d |   t rq |  j d |   t	 j
 t  n  t r |  j d |   t	 j t  n  zJy |  j   Wn%t k
 r |  j d |   n|  j d |   t	 rt	 j d  k	 rt	 j d |  j t   f IJq|  j d  k	 r|  j   \ } } } z |  j d |  j d IJ|  j d	 IJxB | r|  j d
 | j j j | j | j j j f IJ| j } qbW|  j d | | f IJWd  ~ ~ ~ Xqn X|  j d |   Wd  |  j   XWd  t ' |  j   y t t   =Wn n XWd  QXXd  S(   Ns    %s.__bootstrap(): thread starteds(   %s.__bootstrap(): registering trace hooks*   %s.__bootstrap(): registering profile hooks#   %s.__bootstrap(): raised SystemExits%   %s.__bootstrap(): unhandled exceptions   Exception in thread %s:
%ss   Exception in thread s2    (most likely raised during interpreter shutdown):s"   Traceback (most recent call last):s     File "%s", line %s, in %ss   %s: %ss   %s.__bootstrap(): normal return(   R   R   Rt   R   R#   R   R   R,   R1   R&   R   R/   R   R   t
   SystemExitR'   R   R$   t   _format_excR   t   _Thread__exc_infot   tb_framet   f_codet   co_filenamet	   tb_linenot   co_namet   tb_nextt   _Thread__exc_cleart   _Thread__stopR"   (   R   t   exc_typet	   exc_valuet   exc_tb(    (    s   /usr/lib/python2.7/threading.pyt   __bootstrap_inner  s`    
 

	
c         C   sG   t  |  d  s d  S|  j j   t |  _ |  j j   |  j j   d  S(   NR   (   R   R   R;   RS   R   Rh   R@   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   __stopb  s    	c         C   sH   y t   t t   =Wd QXWn& t k
 rC d t j k rD   qD n Xd S(   sA   Remove current thread from the dict of currently running threads.Nt   dummy_threading(   R   R#   R"   R%   R&   t   modules(   R   (    (    s   /usr/lib/python2.7/threading.pyt   __deletel  s    c         C   s<  |  j  s t d   n  |  j j   s6 t d   n  |  t   k rT t d   n  |  j sp |  j d |   n  |  j j   z | d k r x |  j s |  j j
   q W|  j d |   nj t   | } xZ |  j s| t   } | d k r|  j d |   Pn  |  j j
 |  q W|  j d |   Wd |  j j   Xd S(	   s  Wait until the thread terminates.

        This blocks the calling thread until the thread whose join() method is
        called terminates -- either normally or through an unhandled exception
        or until the optional timeout occurs.

        When the timeout argument is present and not None, it should be a
        floating point number specifying a timeout for the operation in seconds
        (or fractions thereof). As join() always returns None, you must call
        isAlive() after join() to decide whether a timeout happened -- if the
        thread is still alive, the join() call timed out.

        When the timeout argument is not present or None, the operation will
        block until the thread terminates.

        A thread can be join()ed many times.

        join() raises a RuntimeError if an attempt is made to join the current
        thread as that would cause a deadlock. It is also an error to join() a
        thread before it has been started and attempts to do so raises the same
        exception.

        s   Thread.__init__() not calleds'   cannot join thread before it is starteds   cannot join current threads%   %s.join(): waiting until thread stopss   %s.join(): thread stoppedi    s   %s.join(): timed outN(   R   R?   R   Rv   R	   R   R,   R   R;   R   Ra   RU   R@   (   R   RZ   t   deadlineR^   (    (    s   /usr/lib/python2.7/threading.pyt   join  s.    		c         C   s   |  j  s t d   |  j S(   s   A string used for identification purposes only.

        It has no semantics. Multiple threads may be given the same name. The
        initial name is set by the constructor.

        s   Thread.__init__() not called(   R   Rz   R}   (   R   (    (    s   /usr/lib/python2.7/threading.pyR$     s    c         C   s(   |  j  s t d   t |  |  _ d  S(   Ns   Thread.__init__() not called(   R   Rz   R|   R}   (   R   R$   (    (    s   /usr/lib/python2.7/threading.pyR$     s    c         C   s   |  j  s t d   |  j S(   s;  Thread identifier of this thread or None if it has not been started.

        This is a nonzero integer. See the thread.get_ident() function. Thread
        identifiers may be recycled when a thread exits and another thread is
        created. The identifier is available even after the thread has exited.

        s   Thread.__init__() not called(   R   Rz   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyR+     s    	c         C   s,   |  j  s t d   |  j j   o+ |  j S(   s   Return whether the thread is alive.

        This method returns True just before the run() method starts until just
        after the run() method terminates. The module function enumerate()
        returns a list of all alive threads.

        s   Thread.__init__() not called(   R   Rz   R   Rv   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   isAlive  s    c         C   s   |  j  s t d   |  j S(   s  A boolean value indicating whether this thread is a daemon thread (True) or not (False).

        This must be set before start() is called, otherwise RuntimeError is
        raised. Its initial value is inherited from the creating thread; the
        main thread is not a daemon thread and therefore all threads created in
        the main thread default to daemon = False.

        The entire Python program exits when no alive non-daemon threads are
        left.

        s   Thread.__init__() not called(   R   Rz   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyR     s    c         C   sC   |  j  s t d   n  |  j j   r6 t d   n  | |  _ d  S(   Ns   Thread.__init__() not calleds)   cannot set daemon status of active thread(   R   R?   R   Rv   R   (   R   t   daemonic(    (    s   /usr/lib/python2.7/threading.pyR      s
    	c         C   s   |  j  S(   N(   R   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   isDaemon  s    c         C   s   | |  _  d  S(   N(   R   (   R   R   (    (    s   /usr/lib/python2.7/threading.pyt	   setDaemon  s    c         C   s   |  j  S(   N(   R$   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   getName  s    c         C   s   | |  _  d  S(   N(   R$   (   R   R$   (    (    s   /usr/lib/python2.7/threading.pyt   setName  s    N(    (#   R-   R.   RI   RR   R   R&   t   exc_infoR   t	   exc_clearR   R   R!   Rr   t   propertyR   R   R:   R   R   R   R   R   R   t   _Thread__deleteR   R$   t   setterR+   R   t   is_aliveR   R   R   R   R   (    (    (    s   /usr/lib/python2.7/threading.pyR     s:   			(								J	
	#8				c          O   s   t  |  |   S(   s   Factory function to create a Timer object.

    Timers call a function after a specified number of seconds:

        t = Timer(30.0, f, args=[], kwargs={})
        t.start()
        t.cancel()     # stop the timer's action if it's still waiting

    (   t   _Timer(   R*   R3   (    (    s   /usr/lib/python2.7/threading.pyR     s    
R   c           B   s/   e  Z d  Z g  i  d  Z d   Z d   Z RS(   s   Call a function after a specified number of seconds:

            t = Timer(30.0, f, args=[], kwargs={})
            t.start()
            t.cancel()     # stop the timer's action if it's still waiting

    c         C   sA   t  j |   | |  _ | |  _ | |  _ | |  _ t   |  _ d  S(   N(   R   R!   t   intervalt   functionR*   R3   R   t   finished(   R   R   R   R*   R3   (    (    s   /usr/lib/python2.7/threading.pyR!   +  s    				c         C   s   |  j  j   d S(   s(   Stop the timer if it hasn't finished yetN(   R   Rt   (   R   (    (    s   /usr/lib/python2.7/threading.pyt   cancel3  s    c         C   sL   |  j  j |  j  |  j  j   s; |  j |  j |  j   n  |  j  j   d  S(   N(   R   Ra   R   Rv   R   R*   R3   Rt   (   R   (    (    s   /usr/lib/python2.7/threading.pyR   7  s    (   R-   R.   RI   R!   R   R   (    (    (    s   /usr/lib/python2.7/threading.pyR   "  s   	t   _MainThreadc           B   s#   e  Z d    Z d   Z d   Z RS(   c         C   sH   t  j |  d d |  j j   |  j   t  |  t t   <Wd  QXd  S(   NR$   t
   MainThread(   R   R!   R   Rt   R   R   R#   R"   (   R   (    (    s   /usr/lib/python2.7/threading.pyR!   B  s
    
c         C   s   t  S(   N(   RR   (   R   (    (    s   /usr/lib/python2.7/threading.pyR   I  s    c         C   sj   |  j    t   } | r, |  j d |   n  x | rK | j   t   } q/ W|  j d |   |  j   d  S(   Ns   %s: waiting for other threadss   %s: exiting(   R   t   _pickSomeNonDaemonThreadR,   R   R   (   R   RA   (    (    s   /usr/lib/python2.7/threading.pyt	   _exitfuncL  s    
		
(   R-   R.   R!   R   R   (    (    (    s   /usr/lib/python2.7/threading.pyR   @  s   		c          C   s2   x+ t    D]  }  |  j r
 |  j   r
 |  Sq
 Wd  S(   N(   R
   R   R   R   (   RA   (    (    s   /usr/lib/python2.7/threading.pyR   Y  s    t   _DummyThreadc           B   s&   e  Z d    Z d   Z d d  Z RS(   c         C   sT   t  j |  d t d  |  ` |  j j   |  j   t  |  t t	   <Wd  QXd  S(   NR$   s   Dummy-%d(
   R   R!   Ry   R   R   Rt   R   R   R#   R"   (   R   (    (    s   /usr/lib/python2.7/threading.pyR!   j  s    
c         C   s   t  S(   N(   RS   (   R   (    (    s   /usr/lib/python2.7/threading.pyR   w  s    c         C   s   t  s t d   d  S(   Ns   cannot join a dummy thread(   RR   Rz   (   R   RZ   (    (    s   /usr/lib/python2.7/threading.pyR   z  s    N(   R-   R.   R!   R   R   R   (    (    (    s   /usr/lib/python2.7/threading.pyR   h  s   		c           C   s+   y t  t   SWn t k
 r& t   SXd S(   s   Return the current Thread object, corresponding to the caller's thread of control.

    If the caller's thread of control was not created through the threading
    module, a dummy thread object with limited functionality is returned.

    N(   R#   R"   R%   R   (    (    (    s   /usr/lib/python2.7/threading.pyR     s    c           C   s%   t   t t  t t  SWd QXd S(   s   Return the number of Thread objects currently alive.

    The returned count is equal to the length of the list returned by
    enumerate().

    N(   R   RP   R#   R   (    (    (    s   /usr/lib/python2.7/threading.pyR     s    c           C   s   t  j   t j   S(   N(   R#   t   valuesR   (    (    (    s   /usr/lib/python2.7/threading.pyt
   _enumerate  s    c           C   s%   t   t j   t j   SWd QXd S(   s   Return a list of all Thread objects currently alive.

    The list includes daemonic threads, dummy thread objects created by
    current_thread(), and the main thread. It excludes terminated threads and
    threads that have not yet been started.

    N(   R   R#   R   R   (    (    (    s   /usr/lib/python2.7/threading.pyR
     s    (   R   (   t   _local(   R   c          C   s   t    a i  }  t   } t  xb t   D]W } t | d  rK | j   n  | | k rv t   } | | _ | |  | <q) | j   q) Wt	 j
   t j
   t j |   t t  d k s t  Wd  QXd  S(   NRr   i   (   R4   R   R	   R   R   Rr   R"   R   R   R   Ru   R#   t   updateRP   Rz   (   t
   new_activet   currentt   threadR+   (    (    s   /usr/lib/python2.7/threading.pyt   _after_fork  s     				

c          C   s  d t  f d     Y}  d t f d     Y} d t f d     Y} d } d } d	 } |  |  } g  } xA t |  D]3 } | | |  }	 d
 | d |	 _ | j |	  qs W| | | |  }
 x" | D] }	 |	 j   t d  q W|
 j   x | D] }	 |	 j   q W|
 j   d  S(   Nt   BoundedQueuec           B   s#   e  Z d    Z d   Z d   Z RS(   c         S   sV   t  j |   t   |  _ t |  j  |  _ t |  j  |  _ | |  _ t   |  _	 d  S(   N(
   R   R!   R   t   monR   R>   t   wct   limitt   _dequet   queue(   R   R   (    (    s   /usr/lib/python2.7/threading.pyR!     s    	c         S   s   |  j  j   x9 t |  j  |  j k rH |  j d |  |  j j   q W|  j j |  |  j d | t |  j   |  j	 j
   |  j  j   d  S(   Ns   put(%s): queue fulls    put(%s): appended, length now %d(   R   R;   RP   R   R   R,   R   Ra   RT   R>   Rf   R@   (   R   t   item(    (    s   /usr/lib/python2.7/threading.pyt   put  s    	c         S   s   |  j  j   x' |  j s6 |  j d  |  j j   q W|  j j   } |  j d | t |  j   |  j j	   |  j  j
   | S(   Ns   get(): queue emptys   get(): got %s, %d left(   R   R;   R   R,   R>   Ra   t   popleftRP   R   Rf   R@   (   R   R   (    (    s   /usr/lib/python2.7/threading.pyt   get  s    (   R-   R.   R!   R   R   (    (    (    s   /usr/lib/python2.7/threading.pyR     s   		t   ProducerThreadc           B   s   e  Z d    Z d   Z RS(   c         S   s)   t  j |  d d | |  _ | |  _ d  S(   NR$   t   Producer(   R   R!   R   t   quota(   R   R   R   (    (    s   /usr/lib/python2.7/threading.pyR!     s    	c         S   sh   d d l  m  } d } xK | |  j k  rc | d } |  j j d |  j | f  t |   d  q Wd  S(   Ni(   t   randomi    i   s   %s.%dgh>(   R   R   R   R   R$   RW   (   R   R   t   counter(    (    s   /usr/lib/python2.7/threading.pyR   	  s    
(   R-   R.   R!   R   (    (    (    s   /usr/lib/python2.7/threading.pyR     s   	t   ConsumerThreadc           B   s   e  Z d    Z d   Z RS(   c         S   s)   t  j |  d d | |  _ | |  _ d  S(   NR$   t   Consumer(   R   R!   R   R   (   R   R   R   (    (    s   /usr/lib/python2.7/threading.pyR!     s    	c         S   s>   x7 |  j  d k r9 |  j j   } | GH|  j  d |  _  q Wd  S(   Ni    i   (   R   R   R   (   R   R   (    (    s   /usr/lib/python2.7/threading.pyR     s    (   R-   R.   R!   R   (    (    (    s   /usr/lib/python2.7/threading.pyR     s   	i   i   i   s   Producer-%di   g>(   R   R   t   rangeR$   RT   R   RW   R   (   R   R   R   t   NPt   QLt   NIt   Qt   Pt   iRA   t   C(    (    s   /usr/lib/python2.7/threading.pyt   _test  s(     

t   __main__(N   RI   t   sysR&   R   t   ImportErrorR   R-   t   warningst   collectionsR    R   t	   itertoolsR   t   _countR   RU   R   RW   t	   tracebackR   R   t   __all__t   start_new_threadR   t   allocate_lockR4   t	   get_identR"   t   errort   ThreadErrort   filterwarningst   DeprecationWarningRR   R   t   objectR   R   R/   R1   R   R   R   R   R2   R   RK   R   Ri   R   Rm   R   Ro   t   nextRw   Ry   R   R#   R   R   R   R   R   R   R   R   R	   R   R   R   R
   R   R   t	   _shutdownR   R   t   _threading_localR   R   (    (    (    s   /usr/lib/python2.7/threading.pyt   <module>   s   
						
		u		J		
K	 				
			%	R                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0    qvt203-25-w|QVT 203 PLUS with 25 by 132 columns                              ' / 8 M O S U ] e m v                     	!)1:CLUadgnu  [%i%p1%d;%p2%dr [3g [H[2J$<50> [K$<3> [J$<50> [%i%p1%d;%p2%dH$<5> 
 [H  [C$<2> [A$<2> [P$<7> [M$<99> [5m$<2> [1m$<2> [4h [7m$<2> [7m$<2> [4m$<2> [m$<2> [4l [m$<2> [m$<2> [L$<99> $<7>  OB [29~ [17~ [18~ [19~ [20~ [21~ [23~ [24~ [25~ [28~ OD OC OA [?1l> [?1h= [%p1%dB [%p1%dD [%p1%dC [%p1%dA [?3h[=40h 8 7 
$<30> M$<5> [%?%p1%t;7%;%?%p2%t;4%;%?%p3%t;7%;%?%p4%t;5%;%?%p6%t;1%;m$<2> H 	 [?7h [?7l                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &    regent|Adds Regent Series                                     P                
 Y       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    S &  nrxvt-cygwin-native|rxvt terminal emulator (native MS Window System port) on cygwin                               P    @       " & * 5 F H L S U \ ` d h j o t }                  	!'-39?EJOSX]aehkt} VY[_cgko%+17=CIOU[agmsy  [%i%p1%d;%p2%dr [3g [H[2J [K [J [%i%p1%dG [%i%p1%d;%p2%dH 
 [H [?25l  [?25h [C [A [M  [5m [1m 7[?47h [4h [7m [7m [4m  [m [2J[?47l8 [4l [27m [24m [?5h[?5l [?47l=[?1l [r[m[2J[H[?7h[?1;3;4;6l[4l [@ [L  [3~ [B [8^ [11~ [21~ [12~ [13~ [14~ [15~ [17~ [18~ [19~ [20~ [7~ [2~ [D [6~ [5~ [C [A > = [%p1%dM [%p1%dB [%p1%d@ [%p1%dL [%p1%dD [%p1%dC [%p1%dA >[1;3;4;5;6l[?7h[m[r[2J[H [r[m[2J[H[?7h[?1;3;4;6l[4l=[?1000l[?25h 8 [%i%p1%dd 7 
 M [0%?%p6%t;1%;%?%p2%t;4%;%?%p1%p3%|%t;7%;%?%p4%t;5%;m%?%p9%t%e%; H 	 Ow Oy Ou Oq Os 0+,-^`afghjklmno~pqrs_tuvwxyz{|~ [Z (B)0 [8~ OM [1~ [3$ [4~ [8$ [7$ [d [6$ [5$ [c [23~ [24~ [25~ [26~ [28~ [29~ [31~ [32~ [33~ [34~ [23$ [24$ [11^ [12^ [13^ [14^ [15^ [17^ [18^ [19^ [20^ [21^ [23^ [24^ [25^ [26^ [28^ [29^ [31^ [32^ [33^ [34^ [23@ [24@ [1K [39;49m [M [3%p1%dm [4%p1%dm (B (0     (                $ ( , 0 4     	       ! & , 2 8 > B G L P T X [b Ob OB Od OD Oc OC [a Oa OA Ox Ot Ov Or AX G0 XT U8 E0 E3 S0 TS kDN kDN5 kDN6 kLFT5 kLFT6 kRIT5 kRIT6 kUP kUP5 kUP6 ka2 kb1 kb3 kc2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         pe ac97_bus_type;

/* AC97 platform_data adding function */
static inline void snd_ac97_dev_add_pdata(struct snd_ac97 *ac97, void *data)
{
	ac97->dev.platform_data = data;
}

#endif /* __SOUND_AC97_CODEC_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /*
 * Platform header for Texas Instruments TLV320DAC33 codec driver
 *
 * Author: Peter Ujfalusi <peter.ujfalusi@ti.com>
 *
 * Copyright:   (C) 2009 Nokia Corporation
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#ifndef __TLV320DAC33_PLAT_H
#define __TLV320DAC33_PLAT_H

struct tlv320dac33_platform_data {
	int power_gpio;
	int mode1_latency; /* latency caused by the i2c writes in us */
	int auto_fifo_config; /* FIFO config based on the period size */
	int keep_bclk;	/* Keep the BCLK running in FIFO modes */
	u8 burst_bclkdiv;
};

#endif /* __TLV320DAC33_PLAT_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /*
 * HWDEP Interface for HD-audio codec
 *
 * Copyright (c) 2007 Takashi Iwai <tiwai@suse.de>
 *
 *  This driver is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This driver is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 */

#ifndef __SOUND_HDA_HWDEP_H
#define __SOUND_HDA_HWDEP_H

#define HDA_HWDEP_VERSION	((1 << 16) | (0 << 8) | (0 << 0)) /* 1.0.0 */

/* verb */
#define HDA_REG_NID_SHIFT	24
#define HDA_REG_VERB_SHIFT	8
#define HDA_REG_VAL_SHIFT	0
#define HDA_VERB(nid,verb,param)	((nid)<<24 | (verb)<<8 | (param))

struct hda_verb_ioctl {
	u32 verb;	/* HDA_VERB() */
	u32 res;	/* response */
};

/*
 * ioctls
 */
#define HDA_IOCTL_PVERSION		_IOR('H', 0x10, int)
#define HDA_IOCTL_VERB_WRITE		_IOWR('H', 0x11, struct hda_verb_ioctl)
#define HDA_IOCTL_GET_WCAP		_IOWR('H', 0x12, struct hda_verb_ioctl)

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #ifndef __SOUND_INFO_H
#define __SOUND_INFO_H

/*
 *  Header file for info interface
 *  Copyright (c) by Jaroslav Kysela <perex@perex.cz>
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

#include <linux/poll.h>

/* buffer for information */
struct snd_info_buffer {
	char *buffer;		/* pointer to begin of buffer */
	unsigned int curr;	/* current position in buffer */
	unsigned int size;	/* current size */
	unsigned int len;	/* total length of buffer */
	int stop;		/* stop flag */
	int error;		/* error code */
};

#define SNDRV_INFO_CONTENT_TEXT		0
#define SNDRV_INFO_CONTENT_DATA		1

struct snd_info_entry;

struct snd_info_entry_text {
	void (*read)(struct snd_info_entry *entry,
		     struct snd_info_buffer *buffer);
	void (*write)(struct snd_info_entry *entry,
		      struct snd_info_buffer *buffer);
};

struct snd_info_entry_ops {
	int (*open)(struct snd_info_entry *entry,
		    unsigned short mode, void **file_private_data);
	int (*release)(struct snd_info_entry *entry,
		       unsigned short mode, void *file_private_data);
	ssize_t (*read)(struct snd_info_entry *entry, void *file_private_data,
			struct file *file, char __user *buf,
			size_t count, loff_t pos);
	ssize_t (*write)(struct snd_info_entry *entry, void *file_private_data,
			 struct file *file, const char __user *buf,
			 size_t count, loff_t pos);
	loff_t (*llseek)(struct snd_info_entry *entry,
			 void *file_private_data, struct file *file,
			 loff_t offset, int orig);
	unsigned int (*poll)(struct snd_info_entry *entry,
			     void *file_private_data, struct file *file,
			     poll_table *wait);
	int (*ioctl)(struct snd_info_entry *entry, void *file_private_data,
		     struct file *file, unsigned int cmd, unsigned long arg);
	int (*mmap)(struct snd_info_entry *entry, void *file_private_data,
		    struct inode *inode, struct file *file,
		    struct vm_area_struct *vma);
};

struct snd_info_entry {
	const char *name;
	umode_t mode;
	long size;
	unsigned short content;
	union {
		struct snd_info_entry_text text;
		struct snd_info_entry_ops *ops;
	} c;
	struct snd_info_entry *parent;
	struct snd_card *card;
	struct module *module;
	void *private_data;
	void (*private_free)(struct snd_info_entry *entry);
	struct proc_dir_entry *p;
	struct mutex access;
	struct list_head children;
	struct list_head list;
};

#if defined(CONFIG_SND_OSSEMUL) && defined(CONFIG_PROC_FS)
int snd_info_minor_register(void);
int snd_info_minor_unregister(void);
#else
#define snd_info_minor_register() /* NOP */
#define snd_info_minor_unregister() /* NOP */
#endif


#ifdef CONFIG_PROC_FS

extern struct snd_info_entry *snd_seq_root;
#ifdef CONFIG_SND_OSSEMUL
extern struct snd_info_entry *snd_oss_root;
void snd_card_info_read_oss(struct snd_info_buffer *buffer);
#else
#define snd_oss_root NULL
static inline void snd_card_info_read_oss(struct snd_info_buffer *buffer) {}
#endif

__printf(2, 3)
int snd_iprintf(struct snd_info_buffer *buffer, const char *fmt, ...);
int snd_info_init(void);
int snd_info_done(void);

int snd_info_get_line(struct snd_info_buffer *buffer, char *line, int len);
const char *snd_info_get_str(char *dest, const char *src, int len);
struct snd_info_entry *snd_info_create_module_entry(struct module *module,
					       const char *name,
					       struct snd_info_entry *parent);
struct snd_info_entry *snd_info_create_card_entry(struct snd_card *card,
					     const char *name,
					     struct snd_info_entry *parent);
void snd_info_free_entry(struct snd_info_entry *entry);
int snd_info_store_text(struct snd_info_entry *entry);
int snd_info_restore_text(struct snd_info_entry *entry);

int snd_info_card_create(struct snd_card *card);
int snd_info_card_register(struct snd_card *card);
int snd_info_card_free(struct snd_card *card);
void snd_info_card_disconnect(struct snd_card *card);
void snd_info_card_id_change(struct snd_card *card);
int snd_info_register(struct snd_info_entry *entry);

/* for card drivers */
int snd_card_proc_new(struct snd_card *card, const char *name,
		      struct snd_info_entry **entryp);

static inline void snd_info_set_text_ops(struct snd_info_entry *entry, 
	void *private_data,
	void (*read)(struct snd_info_entry *, struct snd_info_buffer *))
{
	entry->private_data = private_data;
	entry->c.text.read = read;
}

int snd_info_check_reserved_words(const char *str);

#else

#define snd_seq_root NULL
#define snd_oss_root NULL

static inline int snd_iprintf(struct snd_info_buffer *buffer, char *fmt, ...) { return 0; }
static inline int snd_info_init(void) { return 0; }
static inline int snd_info_done(void) { return 0; }

static inline int snd_info_get_line(struct snd_info_buffer *buffer, char *line, int len) { return 0; }
static inline char *snd_info_get_str(char *dest, char *src, int len) { return NULL; }
static inline struct snd_info_entry *snd_info_create_module_entry(struct module *module, const char *name, struct snd_info_entry *parent) { return NULL; }
static inline struct snd_info_entry *snd_info_create_card_entry(struct snd_card *card, const char *name, struct snd_info_entry *parent) { return NULL; }
static inline void snd_info_free_entry(struct snd_info_entry *entry) { ; }

static inline int snd_info_card_create(struct snd_card *card) { return 0; }
static inline int snd_info_card_register(struct snd_card *card) { return 0; }
static inline int snd_info_card_free(struct snd_card *card) { return 0; }
static inline void snd_info_card_disconnect(struct snd_card *card) { }
static inline void snd_info_card_id_change(struct snd_card *card) { }
static inline int snd_info_register(struct snd_info_entry *entry) { return 0; }

static inline int snd_card_proc_new(struct snd_card *card, const char *name,
				    struct snd_info_entry **entryp) { return -EINVAL; }
static inline void snd_info_set_text_ops(struct snd_info_entry *entry __attribute__((unused)),
					 void *private_data,
					 void (*read)(struct snd_info_entry *, struct snd_info_buffer *)) {}

static inline int snd_info_check_reserved_words(const char *str) { return 1; }

#endif

/*
 * OSS info part
 */

#if defined(CONFIG_SND_OSSEMUL) && defined(CONFIG_PROC_FS)

#define SNDRV_OSS_INFO_DEV_AUDIO	0
#define SNDRV_OSS_INFO_DEV_SYNTH	1
#define SNDRV_OSS_INFO_DEV_MIDI		2
#define SNDRV_OSS_INFO_DEV_TIMERS	4
#define SNDRV_OSS_INFO_DEV_MIXERS	5

#define SNDRV_OSS_INFO_DEV_COUNT	6

int snd_oss_info_register(int dev, int num, char *string);
#define snd_oss_info_unregister(dev, num) snd_oss_info_register(dev, num, NULL)

#endif /* CONFIG_SND_OSSEMUL && CONFIG_PROC_FS */

#endif /* __SOUND_INFO_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /*
 * UDA1380 ALSA SoC Codec driver
 *
 * Copyright 2009 Philipp Zabel
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#ifndef __UDA1380_H
#define __UDA1380_H

struct uda1380_platform_data {
	int gpio_power;
	int gpio_reset;
	int dac_clk;
#define UDA1380_DAC_CLK_SYSCLK 0
#define UDA1380_DAC_CLK_WSPLL  1
};

#endif /* __UDA1380_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /*
 * Driver for the Atmel Audio Bitstream DAC (ABDAC)
 *
 * Copyright (C) 2009 Atmel Corporation
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 as published
 * by the Free Software Foundation.
 */
#ifndef __INCLUDE_SOUND_ATMEL_ABDAC_H
#define __INCLUDE_SOUND_ATMEL_ABDAC_H

#include <linux/platform_data/dma-dw.h>

/**
 * struct atmel_abdac_pdata - board specific ABDAC configuration
 * @dws: DMA slave interface to use for sound playback.
 */
struct atmel_abdac_pdata {
	struct dw_dma_slave	dws;
};

#endif /* __INCLUDE_SOUND_ATMEL_ABDAC_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 #ifndef __SOUND_EMUX_SYNTH_H
#define __SOUND_EMUX_SYNTH_H

/*
 *  Defines for the Emu-series WaveTable chip
 *
 *  Copyright (C) 2000 Takashi Iwai <tiwai@suse.de>
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 */

#include <sound/seq_kernel.h>
#include <sound/seq_device.h>
#include <sound/soundfont.h>
#include <sound/seq_midi_emul.h>
#ifdef CONFIG_SND_SEQUENCER_OSS
#include <sound/seq_oss.h>
#endif
#include <sound/emux_legacy.h>
#include <sound/seq_virmidi.h>

/*
 * compile flags
 */
#define SNDRV_EMUX_USE_RAW_EFFECT

struct snd_emux;
struct snd_emux_port;
struct snd_emux_voice;
struct snd_emux_effect_table;

/*
 * operators
 */
struct snd_emux_operators {
	struct module *owner;
	struct snd_emux_voice *(*get_voice)(struct snd_emux *emu,
					    struct snd_emux_port *port);
	int (*prepare)(struct snd_emux_voice *vp);
	void (*trigger)(struct snd_emux_voice *vp);
	void (*release)(struct snd_emux_voice *vp);
	void (*update)(struct snd_emux_voice *vp, int update);
	void (*terminate)(struct snd_emux_voice *vp);
	void (*free_voice)(struct snd_emux_voice *vp);
	void (*reset)(struct snd_emux *emu, int ch);
	/* the first parameters are struct snd_emux */
	int (*sample_new)(struct snd_emux *emu, struct snd_sf_sample *sp,
			  struct snd_util_memhdr *hdr,
			  const void __user *data, long count);
	int (*sample_free)(struct snd_emux *emu, struct snd_sf_sample *sp,
			   struct snd_util_memhdr *hdr);
	void (*sample_reset)(struct snd_emux *emu);
	int (*load_fx)(struct snd_emux *emu, int type, int arg,
		       const void __user *data, long count);
	void (*sysex)(struct snd_emux *emu, char *buf, int len, int parsed,
		      struct snd_midi_channel_set *chset);
#ifdef CONFIG_SND_SEQUENCER_OSS
	int (*oss_ioctl)(struct snd_emux *emu, int cmd, int p1, int p2);
#endif
};


/*
 * constant values
 */
#define SNDRV_EMUX_MAX_PORTS		32	/* max # of sequencer ports */
#define SNDRV_EMUX_MAX_VOICES		64	/* max # of voices */
#define SNDRV_EMUX_MAX_MULTI_VOICES	16	/* max # of playable voices
						 * simultineously
						 */

/*
 * flags
 */
#define SNDRV_EMUX_ACCEPT_ROM		(1<<0)

/*
 * emuX wavetable
 */
struct snd_emux {

	struct snd_card *card;	/* assigned card */

	/* following should be initialized before registration */
	int max_voices;		/* Number of voices */
	int mem_size;		/* memory size (in byte) */
	int num_ports;		/* number of ports to be created */
	int pitch_shift;	/* pitch shift value (for Emu10k1) */
	struct snd_emux_operators ops;	/* operators */
	void *hw;		/* hardware */
	unsigned long flags;	/* other conditions */
	int midi_ports;		/* number of virtual midi devices */
	int midi_devidx;	/* device offset of virtual midi */
	unsigned int linear_panning: 1; /* panning is linear (sbawe = 1, emu10k1 = 0) */
	int hwdep_idx;		/* hwdep device index */
	struct snd_hwdep *hwdep;	/* hwdep device */

	/* private */
	int num_voices;		/* current number of voices */
	struct snd_sf_list *sflist;	/* root of SoundFont list */
	struct snd_emux_voice *voices;	/* Voices (EMU 'channel') */
	int use_time;	/* allocation counter */
	spinlock_t voice_lock;	/* Lock for voice access */
	struct mutex register_mutex;
	int client;		/* For the sequencer client */
	int ports[SNDRV_EMUX_MAX_PORTS];	/* The ports for this device */
	struct snd_emux_port *portptrs[SNDRV_EMUX_MAX_PORTS];
	int used;	/* use counter */
	char *name;	/* name of the device (internal) */
	struct snd_rawmidi **vmidi;
	struct timer_list tlist;	/* for pending note-offs */
	int timer_active;

	struct snd_util_memhdr *memhdr;	/* memory chunk information */

#ifdef CONFIG_PROC_FS
	struct snd_info_entry *proc;
#endif

#ifdef CONFIG_SND_SEQUENCER_OSS
	struct snd_seq_device *oss_synth;
#endif
};


/*
 * sequencer port information
 */
struct snd_emux_port {

	struct snd_midi_channel_set chset;
	struct snd_emux *emu;

	char port_mode;			/* operation mode */
	int volume_atten;		/* emuX raw attenuation */
	unsigned long drum_flags;	/* drum bitmaps */
	int ctrls[EMUX_MD_END];		/* control parameters */
#ifdef SNDRV_EMUX_USE_RAW_EFFECT
	struct snd_emux_effect_table *effect;
#endif
#ifdef CONFIG_SND_SEQUENCER_OSS
	struct snd_seq_oss_arg *oss_arg;
#endif
};

/* port_mode */
#define SNDRV_EMUX_PORT_MODE_MIDI		0	/* normal MIDI port */
#define SNDRV_EMUX_PORT_MODE_OSS_SYNTH	1	/* OSS synth port */
#define SNDRV_EMUX_PORT_MODE_OSS_MIDI	2	/* OSS multi channel synth port */

/*
 * A structure to keep track of each hardware voice
 */
struct snd_emux_voice {
	int  ch;		/* Hardware channel number */

	int  state;		/* status */
#define SNDRV_EMUX_ST_OFF		0x00	/* Not playing, and inactive */
#define SNDRV_EMUX_ST_ON		0x01	/* Note on */
#define SNDRV_EMUX_ST_RELEASED 	(0x02|SNDRV_EMUX_ST_ON)	/* Note released */
#define SNDRV_EMUX_ST_SUSTAINED	(0x04|SNDRV_EMUX_ST_ON)	/* Note sustained */
#define SNDRV_EMUX_ST_STANDBY	(0x08|SNDRV_EMUX_ST_ON)	/* Waiting to be triggered */
#define SNDRV_EMUX_ST_PENDING 	(0x10|SNDRV_EMUX_ST_ON)	/* Note will be released */
#define SNDRV_EMUX_ST_LOCKED		0x100	/* Not accessible */

	unsigned int  time;	/* An allocation time */
	unsigned char note;	/* Note currently assigned to this voice */
	unsigned char key;
	unsigned char velocity;	/* Velocity of current note */

	struct snd_sf_zone *zone;	/* Zone assigned to this note */
	void *block;		/* sample block pointer (optional) */
	struct snd_midi_channel *chan;	/* Midi channel for this note */
	struct snd_emux_port *port;	/* associated port */
	struct snd_emux *emu;	/* assigned root info */
	void *hw;		/* hardware pointer (emu8000 or emu10k1) */
	unsigned long ontime;	/* jiffies at note triggered */
	
	/* Emu8k/Emu10k1 registers */
	struct soundfont_voice_info reg;

	/* additional registers */
	int avol;		/* volume attenuation */
	int acutoff;		/* cutoff target */
	int apitch;		/* pitch offset */
	int apan;		/* pan/aux pair */
	int aaux;
	int ptarget;		/* pitch target */
	int vtarget;		/* volume target */
	int ftarget;		/* filter target */

};

/*
 * update flags (can be combined)
 */
#define SNDRV_EMUX_UPDATE_VOLUME		(1<<0)
#define SNDRV_EMUX_UPDATE_PITCH		(1<<1)
#define SNDRV_EMUX_UPDATE_PAN		(1<<2)
#define SNDRV_EMUX_UPDATE_FMMOD		(1<<3)
#define SNDRV_EMUX_UPDATE_TREMFREQ	(1<<4)
#define SNDRV_EMUX_UPDATE_FM2FRQ2		(1<<5)
#define SNDRV_EMUX_UPDATE_Q		(1<<6)


#ifdef SNDRV_EMUX_USE_RAW_EFFECT
/*
 * effect table
 */
struct snd_emux_effect_table {
	/* Emu8000 specific effects */
	short val[EMUX_NUM_EFFECTS];
	unsigned char flag[EMUX_NUM_EFFECTS];
};
#endif /* SNDRV_EMUX_USE_RAW_EFFECT */


/*
 * prototypes - interface to Emu10k1 and Emu8k routines
 */
int snd_emux_new(struct snd_emux **remu);
int snd_emux_register(struct snd_emux *emu, struct snd_card *card, int index, char *name);
int snd_emux_free(struct snd_emux *emu);

/*
 * exported functions
 */
void snd_emux_terminate_all(struct snd_emux *emu);
void snd_emux_lock_voice(struct snd_emux *emu, int voice);
void snd_emux_unlock_voice(struct snd_emux *emu, int voice);

#endif /* __SOUND_EMUX_SYNTH_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /*
* linux/spear_dma.h
*
* Copyright (ST) 2012 Rajeev Kumar (rajeevkumar.linux@gmail.com)
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation; either version 2 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program; if not, write to the Free Software
* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
*
*/

#ifndef SPEAR_DMA_H
#define SPEAR_DMA_H

#include <linux/dmaengine.h>

struct spear_dma_data {
	void *data;
	dma_addr_t addr;
	u32 max_burst;
	enum dma_slave_buswidth addr_width;
};

#endif /* SPEAR_DMA_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     #ifndef __SOUND_FSI_H
#define __SOUND_FSI_H

/*
 * Fifo-attached Serial Interface (FSI) support for SH7724
 *
 * Copyright (C) 2009 Renesas Solutions Corp.
 * Kuninori Morimoto <morimoto.kuninori@renesas.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */
#include <linux/clk.h>
#include <sound/soc.h>

/*
 * flags
 */
#define SH_FSI_FMT_SPDIF		(1 << 0) /* spdif for HDMI */
#define SH_FSI_ENABLE_STREAM_MODE	(1 << 1) /* for 16bit data */
#define SH_FSI_CLK_CPG			(1 << 2) /* FSIxCK + FSI-DIV */

struct sh_fsi_port_info {
	unsigned long flags;
	int tx_id;
	int rx_id;
};

struct sh_fsi_platform_info {
	struct sh_fsi_port_info port_a;
	struct sh_fsi_port_info port_b;
};

#endif /* __SOUND_FSI_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /*
 * Helper functions for indirect PCM data transfer
 *
 *  Copyright (c) by Takashi Iwai <tiwai@suse.de>
 *                   Jaroslav Kysela <perex@perex.cz>
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

#ifndef __SOUND_PCM_INDIRECT_H
#define __SOUND_PCM_INDIRECT_H

#include <sound/pcm.h>

struct snd_pcm_indirect {
	unsigned int hw_buffer_size;	/* Byte size of hardware buffer */
	unsigned int hw_queue_size;	/* Max queue size of hw buffer (0 = buffer size) */
	unsigned int hw_data;	/* Offset to next dst (or src) in hw ring buffer */
	unsigned int hw_io;	/* Ring buffer hw pointer */
	int hw_ready;		/* Bytes ready for play (or captured) in hw ring buffer */
	unsigned int sw_buffer_size;	/* Byte size of software buffer */
	unsigned int sw_data;	/* Offset to next dst (or src) in sw ring buffer */
	unsigned int sw_io;	/* Current software pointer in bytes */
	int sw_ready;		/* Bytes ready to be transferred to/from hw */
	snd_pcm_uframes_t appl_ptr;	/* Last seen appl_ptr */
};

typedef void (*snd_pcm_indirect_copy_t)(struct snd_pcm_substream *substream,
					struct snd_pcm_indirect *rec, size_t bytes);

/*
 * helper function for playback ack callback
 */
static inline void
snd_pcm_indirect_playback_transfer(struct snd_pcm_substream *substream,
				   struct snd_pcm_indirect *rec,
				   snd_pcm_indirect_copy_t copy)
{
	struct snd_pcm_runtime *runtime = substream->runtime;
	snd_pcm_uframes_t appl_ptr = runtime->control->appl_ptr;
	snd_pcm_sframes_t diff = appl_ptr - rec->appl_ptr;
	int qsize;

	if (diff) {
		if (diff < -(snd_pcm_sframes_t) (runtime->boundary / 2))
			diff += runtime->boundary;
		rec->sw_ready += (int)frames_to_bytes(runtime, diff);
		rec->appl_ptr = appl_ptr;
	}
	qsize = rec->hw_queue_size ? rec->hw_queue_size : rec->hw_buffer_size;
	while (rec->hw_ready < qsize && rec->sw_ready > 0) {
		unsigned int hw_to_end = rec->hw_buffer_size - rec->hw_data;
		unsigned int sw_to_end = rec->sw_buffer_size - rec->sw_data;
		unsigned int bytes = qsize - rec->hw_ready;
		if (rec->sw_ready < (int)bytes)
			bytes = rec->sw_ready;
		if (hw_to_end < bytes)
			bytes = hw_to_end;
		if (sw_to_end < bytes)
			bytes = sw_to_end;
		if (! bytes)
			break;
		copy(substream, rec, bytes);
		rec->hw_data += bytes;
		if (rec->hw_data == rec->hw_buffer_size)
			rec->hw_data = 0;
		rec->sw_data += bytes;
		if (rec->sw_data == rec->sw_buffer_size)
			rec->sw_data = 0;
		rec->hw_ready += bytes;
		rec->sw_ready -= bytes;
	}
}

/*
 * helper function for playback pointer callback
 * ptr = current byte pointer
 */
static inline snd_pcm_uframes_t
snd_pcm_indirect_playback_pointer(struct snd_pcm_substream *substream,
				  struct snd_pcm_indirect *rec, unsigned int ptr)
{
	int bytes = ptr - rec->hw_io;
	if (bytes < 0)
		bytes += rec->hw_buffer_size;
	rec->hw_io = ptr;
	rec->hw_ready -= bytes;
	rec->sw_io += bytes;
	if (rec->sw_io >= rec->sw_buffer_size)
		rec->sw_io -= rec->sw_buffer_size;
	if (substream->ops->ack)
		substream->ops->ack(substream);
	return bytes_to_frames(substream->runtime, rec->sw_io);
}


/*
 * helper function for capture ack callback
 */
static inline void
snd_pcm_indirect_capture_transfer(struct snd_pcm_substream *substream,
				  struct snd_pcm_indirect *rec,
				  snd_pcm_indirect_copy_t copy)
{
	struct snd_pcm_runtime *runtime = substream->runtime;
	snd_pcm_uframes_t appl_ptr = runtime->control->appl_ptr;
	snd_pcm_sframes_t diff = appl_ptr - rec->appl_ptr;

	if (diff) {
		if (diff < -(snd_pcm_sframes_t) (runtime->boundary / 2))
			diff += runtime->boundary;
		rec->sw_ready -= frames_to_bytes(runtime, diff);
		rec->appl_ptr = appl_ptr;
	}
	while (rec->hw_ready > 0 && 
	       rec->sw_ready < (int)rec->sw_buffer_size) {
		size_t hw_to_end = rec->hw_buffer_size - rec->hw_data;
		size_t sw_to_end = rec->sw_buffer_size - rec->sw_data;
		size_t bytes = rec->sw_buffer_size - rec->sw_ready;
		if (rec->hw_ready < (int)bytes)
			bytes = rec->hw_ready;
		if (hw_to_end < bytes)
			bytes = hw_to_end;
		if (sw_to_end < bytes)
			bytes = sw_to_end;
		if (! bytes)
			break;
		copy(substream, rec, bytes);
		rec->hw_data += bytes;
		if ((int)rec->hw_data == rec->hw_buffer_size)
			rec->hw_data = 0;
		rec->sw_data += bytes;
		if (rec->sw_data == rec->sw_buffer_size)
			rec->sw_data = 0;
		rec->hw_ready -= bytes;
		rec->sw_ready += bytes;
	}
}

/*
 * helper function for capture pointer callback,
 * ptr = current byte pointer
 */
static inline snd_pcm_uframes_t
snd_pcm_indirect_capture_pointer(struct snd_pcm_substream *substream,
				 struct snd_pcm_indirect *rec, unsigned int ptr)
{
	int qsize;
	int bytes = ptr - rec->hw_io;
	if (bytes < 0)
		bytes += rec->hw_buffer_size;
	rec->hw_io = ptr;
	rec->hw_ready += bytes;
	qsize = rec->hw_queue_size ? rec->hw_queue_size : rec->hw_buffer_size;
	if (rec->hw_ready > qsize)
		return SNDRV_PCM_POS_XRUN;
	rec->sw_io += bytes;
	if (rec->sw_io >= rec->sw_buffer_size)
		rec->sw_io -= rec->sw_buffer_size;
	if (substream->ops->ack)
		substream->ops->ack(substream);
	return bytes_to_frames(substream->runtime, rec->sw_io);
}

#endif /* __SOUND_PCM_INDIRECT_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 #ifndef __SOUND_SEQ_VIRMIDI_H
#define __SOUND_SEQ_VIRMIDI_H

/*
 *  Virtual Raw MIDI client on Sequencer
 *  Copyright (c) 2000 by Takashi Iwai <tiwai@suse.de>,
 *                        Jaroslav Kysela <perex@perex.cz>
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

#include <sound/rawmidi.h>
#include <sound/seq_midi_event.h>

/*
 * device file instance:
 * This instance is created at each time the midi device file is
 * opened.  Each instance has its own input buffer and MIDI parser
 * (buffer), and is associated with the device instance.
 */
struct snd_virmidi {
	struct list_head list;
	int seq_mode;
	int client;
	int port;
	unsigned int trigger: 1;
	struct snd_midi_event *parser;
	struct snd_seq_event event;
	struct snd_virmidi_dev *rdev;
	struct snd_rawmidi_substream *substream;
};

#define SNDRV_VIRMIDI_SUBSCRIBE		(1<<0)
#define SNDRV_VIRMIDI_USE		(1<<1)

/*
 * device record:
 * Each virtual midi device has one device instance.  It contains
 * common information and the linked-list of opened files, 
 */
struct snd_virmidi_dev {
	struct snd_card *card;		/* associated card */
	struct snd_rawmidi *rmidi;		/* rawmidi device */
	int seq_mode;			/* SNDRV_VIRMIDI_XXX */
	int device;			/* sequencer device */
	int client;			/* created/attached client */
	int port;			/* created/attached port */
	unsigned int flags;		/* SNDRV_VIRMIDI_* */
	rwlock_t filelist_lock;
	struct list_head filelist;
};

/* sequencer mode:
 * ATTACH = input/output events from midi device are routed to the
 *          attached sequencer port.  sequencer port is not created
 *          by virmidi itself.
 *          the input to rawmidi must be processed by passing the
 *          incoming events via snd_virmidi_receive()
 * DISPATCH = input/output events are routed to subscribers.
 *            sequencer port is created in virmidi.
 */
#define SNDRV_VIRMIDI_SEQ_NONE		0
#define SNDRV_VIRMIDI_SEQ_ATTACH	1
#define SNDRV_VIRMIDI_SEQ_DISPATCH	2

int snd_virmidi_new(struct snd_card *card, int device, struct snd_rawmidi **rrmidi);

#endif /* __SOUND_SEQ_VIRMIDI */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /*
 * linux/sound/rt286.h -- Platform data for RT286
 *
 * Copyright 2013 Realtek Microelectronics
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#ifndef __LINUX_SND_RT286_H
#define __LINUX_SND_RT286_H

struct rt286_platform_data {
	bool cbj_en; /*combo jack enable*/
	bool gpio2_en; /*GPIO2 enable*/
};

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #ifndef __SOUND_SEQ_OSS_LEGACY_H
#define __SOUND_SEQ_OSS_LEGACY_H

/*
 * OSS compatible macro definitions
 *
 * Copyright (C) 2000 Abramo Bagnara <abramo@alsa-project.org>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 */

#include <linux/soundcard.h>

#ifndef SAMPLE_TYPE_AWE32
#define SAMPLE_TYPE_AWE32		0x20
#endif

#endif /* __SOUND_SEQ_OSS_LEGACY_H */

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             /*
 * Platform data for MAX98088
 *
 * Copyright 2010 Maxim Integrated Products
 *
 *  This program is free software; you can redistribute  it and/or modify it
 *  under  the terms of  the GNU General  Public License as published by the
 *  Free Software Foundation;  either version 2 of the  License, or (at your
 *  option) any later version.
 *
 */

#ifndef __SOUND_MAX98088_PDATA_H__
#define __SOUND_MAX98088_PDATA_H__

/* Equalizer filter response configuration */
struct max98088_eq_cfg {
       const char *name;
       unsigned int rate;
       u16 band1[5];
       u16 band2[5];
       u16 band3[5];
       u16 band4[5];
       u16 band5[5];
};

/* codec platform data */
struct max98088_pdata {

       /* Equalizers for DAI1 and DAI2 */
       struct max98088_eq_cfg *eq_cfg;
       unsigned int eq_cfgcnt;

       /* Receiver output can be configured as power amplifier or LINE out */
       /* Set receiver_mode to:
        * 0 = amplifier output, or
        * 1 = LINE level output
        */
       unsigned int receiver_mode:1;

       /* Analog/digital microphone configuration:
        * 0 = analog microphone input (normal setting)
        * 1 = digital microphone input
        */
       unsigned int digmic_left_mode:1;
       unsigned int digmic_right_mode:1;

};

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /*
 * Platform data for MAX98095
 *
 * Copyright 2011 Maxim Integrated Products
 *
 *  This program is free software; you can redistribute  it and/or modify it
 *  under  the terms of  the GNU General  Public License as published by the
 *  Free Software Foundation;  either version 2 of the  License, or (at your
 *  option) any later version.
 *
 */

#ifndef __SOUND_MAX98095_PDATA_H__
#define __SOUND_MAX98095_PDATA_H__

/* Equalizer filter response configuration */
struct max98095_eq_cfg {
	const char *name;
	unsigned int rate;
	u16 band1[5];
	u16 band2[5];
	u16 band3[5];
	u16 band4[5];
	u16 band5[5];
};

/* Biquad filter response configuration */
struct max98095_biquad_cfg {
	const char *name;
	unsigned int rate;
	u16 band1[5];
	u16 band2[5];
};

/* codec platform data */
struct max98095_pdata {

	/* Equalizers for DAI1 and DAI2 */
	struct max98095_eq_cfg *eq_cfg;
	unsigned int eq_cfgcnt;

	/* Biquad filter for DAI1 and DAI2 */
	struct max98095_biquad_cfg *bq_cfg;
	unsigned int bq_cfgcnt;

	/* Analog/digital microphone configuration:
	 * 0 = analog microphone input (normal setting)
	 * 1 = digital microphone input
	 */
	unsigned int digmic_left_mode:1;
	unsigned int digmic_right_mode:1;

	/* Pin5 is the mechanical method of sensing jack insertion
	 * but it is something that might not be supported.
	 * 0 = PIN5 not supported
	 * 1 = PIN5 supported
	 */
	unsigned int jack_detect_pin5en:1;

	/* Slew amount for jack detection. Calculated as 4 * (delay + 1).
	 * Default delay is 24 to get a time of 100ms.
	 */
	unsigned int jack_detect_delay;
};

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /*
 * linux/sound/soc-dapm.h -- ALSA SoC Dynamic Audio Power Management
 *
 * Author:		Liam Girdwood
 * Created:		Aug 11th 2005
 * Copyright:	Wolfson Microelectronics. PLC.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#ifndef __LINUX_SND_SOC_DAPM_H
#define __LINUX_SND_SOC_DAPM_H

#include <linux/types.h>
#include <sound/control.h>

struct device;

/* widget has no PM register bit */
#define SND_SOC_NOPM	-1

/*
 * SoC dynamic audio power management
 *
 * We can have up to 4 power domains
 *  1. Codec domain - VREF, VMID
 *     Usually controlled at codec probe/remove, although can be set
 *     at stream time if power is not needed for sidetone, etc.
 *  2. Platform/Machine domain - physically connected inputs and outputs
 *     Is platform/machine and user action specific, is set in the machine
 *     driver and by userspace e.g when HP are inserted
 *  3. Path domain - Internal codec path mixers
 *     Are automatically set when mixer and mux settings are
 *     changed by the user.
 *  4. Stream domain - DAC's and ADC's.
 *     Enabled when stream playback/capture is started.
 */

/* codec domain */
#define SND_SOC_DAPM_VMID(wname) \
{	.id = snd_soc_dapm_vmid, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0}

/* platform domain */
#define SND_SOC_DAPM_SIGGEN(wname) \
{	.id = snd_soc_dapm_siggen, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM }
#define SND_SOC_DAPM_INPUT(wname) \
{	.id = snd_soc_dapm_input, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM }
#define SND_SOC_DAPM_OUTPUT(wname) \
{	.id = snd_soc_dapm_output, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM }
#define SND_SOC_DAPM_MIC(wname, wevent) \
{	.id = snd_soc_dapm_mic, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM, .event = wevent, \
	.event_flags = SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD}
#define SND_SOC_DAPM_HP(wname, wevent) \
{	.id = snd_soc_dapm_hp, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM, .event = wevent, \
	.event_flags = SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_PRE_PMD}
#define SND_SOC_DAPM_SPK(wname, wevent) \
{	.id = snd_soc_dapm_spk, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM, .event = wevent, \
	.event_flags = SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_PRE_PMD}
#define SND_SOC_DAPM_LINE(wname, wevent) \
{	.id = snd_soc_dapm_line, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM, .event = wevent, \
	.event_flags = SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_PRE_PMD}

#define SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert) \
	.reg = wreg, .mask = 1, .shift = wshift, \
	.on_val = winvert ? 0 : 1, .off_val = winvert ? 1 : 0

/* path domain */
#define SND_SOC_DAPM_PGA(wname, wreg, wshift, winvert,\
	 wcontrols, wncontrols) \
{	.id = snd_soc_dapm_pga, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = wncontrols}
#define SND_SOC_DAPM_OUT_DRV(wname, wreg, wshift, winvert,\
	 wcontrols, wncontrols) \
{	.id = snd_soc_dapm_out_drv, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = wncontrols}
#define SND_SOC_DAPM_MIXER(wname, wreg, wshift, winvert, \
	 wcontrols, wncontrols)\
{	.id = snd_soc_dapm_mixer, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = wncontrols}
#define SND_SOC_DAPM_MIXER_NAMED_CTL(wname, wreg, wshift, winvert, \
	 wcontrols, wncontrols)\
{       .id = snd_soc_dapm_mixer_named_ctl, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = wncontrols}
#define SND_SOC_DAPM_MICBIAS(wname, wreg, wshift, winvert) \
{	.id = snd_soc_dapm_micbias, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = NULL, .num_kcontrols = 0}
#define SND_SOC_DAPM_SWITCH(wname, wreg, wshift, winvert, wcontrols) \
{	.id = snd_soc_dapm_switch, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = 1}
#define SND_SOC_DAPM_MUX(wname, wreg, wshift, winvert, wcontrols) \
{	.id = snd_soc_dapm_mux, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = 1}

/* Simplified versions of above macros, assuming wncontrols = ARRAY_SIZE(wcontrols) */
#define SOC_PGA_ARRAY(wname, wreg, wshift, winvert,\
	 wcontrols) \
{	.id = snd_soc_dapm_pga, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = ARRAY_SIZE(wcontrols)}
#define SOC_MIXER_ARRAY(wname, wreg, wshift, winvert, \
	 wcontrols)\
{	.id = snd_soc_dapm_mixer, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = ARRAY_SIZE(wcontrols)}
#define SOC_MIXER_NAMED_CTL_ARRAY(wname, wreg, wshift, winvert, \
	 wcontrols)\
{       .id = snd_soc_dapm_mixer_named_ctl, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = ARRAY_SIZE(wcontrols)}

/* path domain with event - event handler must return 0 for success */
#define SND_SOC_DAPM_PGA_E(wname, wreg, wshift, winvert, wcontrols, \
	wncontrols, wevent, wflags) \
{	.id = snd_soc_dapm_pga, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = wncontrols, \
	.event = wevent, .event_flags = wflags}
#define SND_SOC_DAPM_OUT_DRV_E(wname, wreg, wshift, winvert, wcontrols, \
	wncontrols, wevent, wflags) \
{	.id = snd_soc_dapm_out_drv, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = wncontrols, \
	.event = wevent, .event_flags = wflags}
#define SND_SOC_DAPM_MIXER_E(wname, wreg, wshift, winvert, wcontrols, \
	wncontrols, wevent, wflags) \
{	.id = snd_soc_dapm_mixer, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = wncontrols, \
	.event = wevent, .event_flags = wflags}
#define SND_SOC_DAPM_MIXER_NAMED_CTL_E(wname, wreg, wshift, winvert, \
	wcontrols, wncontrols, wevent, wflags) \
{       .id = snd_soc_dapm_mixer, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, \
	.num_kcontrols = wncontrols, .event = wevent, .event_flags = wflags}
#define SND_SOC_DAPM_SWITCH_E(wname, wreg, wshift, winvert, wcontrols, \
	wevent, wflags) \
{	.id = snd_soc_dapm_switch, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = 1, \
	.event = wevent, .event_flags = wflags}
#define SND_SOC_DAPM_MUX_E(wname, wreg, wshift, winvert, wcontrols, \
	wevent, wflags) \
{	.id = snd_soc_dapm_mux, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = 1, \
	.event = wevent, .event_flags = wflags}

/* additional sequencing control within an event type */
#define SND_SOC_DAPM_PGA_S(wname, wsubseq, wreg, wshift, winvert, \
	wevent, wflags) \
{	.id = snd_soc_dapm_pga, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.event = wevent, .event_flags = wflags, \
	.subseq = wsubseq}
#define SND_SOC_DAPM_SUPPLY_S(wname, wsubseq, wreg, wshift, winvert, wevent, \
	wflags)	\
{	.id = snd_soc_dapm_supply, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.event = wevent, .event_flags = wflags, .subseq = wsubseq}

/* Simplified versions of above macros, assuming wncontrols = ARRAY_SIZE(wcontrols) */
#define SOC_PGA_E_ARRAY(wname, wreg, wshift, winvert, wcontrols, \
	wevent, wflags) \
{	.id = snd_soc_dapm_pga, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = ARRAY_SIZE(wcontrols), \
	.event = wevent, .event_flags = wflags}
#define SOC_MIXER_E_ARRAY(wname, wreg, wshift, winvert, wcontrols, \
	wevent, wflags) \
{	.id = snd_soc_dapm_mixer, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = ARRAY_SIZE(wcontrols), \
	.event = wevent, .event_flags = wflags}
#define SOC_MIXER_NAMED_CTL_E_ARRAY(wname, wreg, wshift, winvert, \
	wcontrols, wevent, wflags) \
{       .id = snd_soc_dapm_mixer, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.kcontrol_news = wcontrols, .num_kcontrols = ARRAY_SIZE(wcontrols), \
	.event = wevent, .event_flags = wflags}

/* events that are pre and post DAPM */
#define SND_SOC_DAPM_PRE(wname, wevent) \
{	.id = snd_soc_dapm_pre, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM, .event = wevent, \
	.event_flags = SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_PRE_PMD}
#define SND_SOC_DAPM_POST(wname, wevent) \
{	.id = snd_soc_dapm_post, .name = wname, .kcontrol_news = NULL, \
	.num_kcontrols = 0, .reg = SND_SOC_NOPM, .event = wevent, \
	.event_flags = SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD}

/* stream domain */
#define SND_SOC_DAPM_AIF_IN(wname, stname, wslot, wreg, wshift, winvert) \
{	.id = snd_soc_dapm_aif_in, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), }
#define SND_SOC_DAPM_AIF_IN_E(wname, stname, wslot, wreg, wshift, winvert, \
			      wevent, wflags)				\
{	.id = snd_soc_dapm_aif_in, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.event = wevent, .event_flags = wflags }
#define SND_SOC_DAPM_AIF_OUT(wname, stname, wslot, wreg, wshift, winvert) \
{	.id = snd_soc_dapm_aif_out, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), }
#define SND_SOC_DAPM_AIF_OUT_E(wname, stname, wslot, wreg, wshift, winvert, \
			     wevent, wflags)				\
{	.id = snd_soc_dapm_aif_out, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.event = wevent, .event_flags = wflags }
#define SND_SOC_DAPM_DAC(wname, stname, wreg, wshift, winvert) \
{	.id = snd_soc_dapm_dac, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert) }
#define SND_SOC_DAPM_DAC_E(wname, stname, wreg, wshift, winvert, \
			   wevent, wflags)				\
{	.id = snd_soc_dapm_dac, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.event = wevent, .event_flags = wflags}

#define SND_SOC_DAPM_ADC(wname, stname, wreg, wshift, winvert) \
{	.id = snd_soc_dapm_adc, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), }
#define SND_SOC_DAPM_ADC_E(wname, stname, wreg, wshift, winvert, \
			   wevent, wflags)				\
{	.id = snd_soc_dapm_adc, .name = wname, .sname = stname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.event = wevent, .event_flags = wflags}
#define SND_SOC_DAPM_CLOCK_SUPPLY(wname) \
{	.id = snd_soc_dapm_clock_supply, .name = wname, \
	.reg = SND_SOC_NOPM, .event = dapm_clock_event, \
	.event_flags = SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD }

/* generic widgets */
#define SND_SOC_DAPM_REG(wid, wname, wreg, wshift, wmask, won_val, woff_val) \
{	.id = wid, .name = wname, .kcontrol_news = NULL, .num_kcontrols = 0, \
	.reg = wreg, .shift = wshift, .mask = wmask, \
	.on_val = won_val, .off_val = woff_val, }
#define SND_SOC_DAPM_SUPPLY(wname, wreg, wshift, winvert, wevent, wflags) \
{	.id = snd_soc_dapm_supply, .name = wname, \
	SND_SOC_DAPM_INIT_REG_VAL(wreg, wshift, winvert), \
	.event = wevent, .event_flags = wflags}
#define SND_SOC_DAPM_REGULATOR_SUPPLY(wname, wdelay, wflags)	    \
{	.id = snd_soc_dapm_regulator_supply, .name = wname, \
	.reg = SND_SOC_NOPM, .shift = wdelay, .event = dapm_regulator_event, \
	.event_flags = SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD, \
	.on_val = wflags}


/* dapm kcontrol types */
#define SOC_DAPM_SINGLE(xname, reg, shift, max, invert) \
{	.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \
	.info = snd_soc_info_volsw, \
	.get = snd_soc_dapm_get_volsw, .put = snd_soc_dapm_put_volsw, \
	.private_value = SOC_SINGLE_VALUE(reg, shift, max, invert, 0) }
#define SOC_DAPM_SINGLE_AUTODISABLE(xname, reg, shift, max, invert) \
{	.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \
	.info = snd_soc_info_volsw, \
	.get = snd_soc_dapm_get_volsw, .put = snd_soc_dapm_put_volsw, \
	.private_value = SOC_SINGLE_VALUE(reg, shift, max, invert, 1) }
#define SOC_DAPM_SINGLE_VIRT(xname, max) \
	SOC_DAPM_SINGLE(xname, SND_SOC_NOPM, 0, max, 0)
#define SOC_DAPM_SINGLE_TLV(xname, reg, shift, max, invert, tlv_array) \
{	.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \
	.info = snd_soc_info_volsw, \
	.access = SNDRV_CTL_ELEM_ACCESS_TLV_READ | SNDRV_CTL_ELEM_ACCESS_READWRITE,\
	.tlv.p = (tlv_array), \
	.get = snd_soc_dapm_get_volsw, .put = snd_soc_dapm_put_volsw, \
	.private_value = SOC_SINGLE_VALUE(reg, shift, max, invert, 0) }
#define SOC_DAPM_SINGLE_TLV_AUTODISABLE(xname, reg, shift, max, invert, tlv_array) \
{	.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \
	.info = snd_soc_info_volsw, \
	.access = SNDRV_CTL_ELEM_ACCESS_TLV_READ | SNDRV_CTL_ELEM_ACCESS_READWRITE,\
	.tlv.p = (tlv_array), \
	.get = snd_soc_dapm_get_volsw, .put = snd_soc_dapm_put_volsw, \
	.private_value = SOC_SINGLE_VALUE(reg, shift, max, invert, 1) }
#define SOC_DAPM_SINGLE_TLV_VIRT(xname, max, tlv_array) \
	SOC_DAPM_SINGLE(xname, SND_SOC_NOPM, 0, max, 0, tlv_array)
#define SOC_DAPM_ENUM(xname, xenum) \
{	.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \
	.info = snd_soc_info_enum_double, \
 	.get = snd_soc_dapm_get_enum_double, \
 	.put = snd_soc_dapm_put_enum_double, \
  	.private_value = (unsigned long)&xenum }
#define SOC_DAPM_ENUM_EXT(xname, xenum, xget, xput) \
{	.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \
	.info = snd_soc_info_enum_double, \
	.get = xget, \
	.put = xput, \
	.private_value = (unsigned long)&xenum }
#define SOC_DAPM_PIN_SWITCH(xname) \
{	.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname " Switch", \
	.info = snd_soc_dapm_info_pin_switch, \
	.get = snd_soc_dapm_get_pin_switch, \
	.put = snd_soc_dapm_put_pin_switch, \
	.private_value = (unsigned long)xname }

/* dapm stream operations */
#define SND_SOC_DAPM_STREAM_NOP			0x0
#define SND_SOC_DAPM_STREAM_START		0x1
#define SND_SOC_DAPM_STREAM_STOP		0x2
#define SND_SOC_DAPM_STREAM_SUSPEND		0x4
#define SND_SOC_DAPM_STREAM_RESUME		0x8
#define SND_SOC_DAPM_STREAM_PAUSE_PUSH	0x10
#define SND_SOC_DAPM_STREAM_PAUSE_RELEASE	0x20

/* dapm event types */
#define SND_SOC_DAPM_PRE_PMU	0x1 	/* before widget power up */
#define SND_SOC_DAPM_POST_PMU	0x2		/* after widget power up */
#define SND_SOC_DAPM_PRE_PMD	0x4 	/* before widget power down */
#define SND_SOC_DAPM_POST_PMD	0x8		/* after widget power down */
#define SND_SOC_DAPM_PRE_REG	0x10	/* before audio path setup */
#define SND_SOC_DAPM_POST_REG	0x20	/* after audio path setup */
#define SND_SOC_DAPM_WILL_PMU   0x40    /* called at start of sequence */
#define SND_SOC_DAPM_WILL_PMD   0x80    /* called at start of sequence */
#define SND_SOC_DAPM_PRE_POST_PMD \
				(SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD)

/* convenience event type detection */
#define SND_SOC_DAPM_EVENT_ON(e)	\
	(e & (SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU))
#define SND_SOC_DAPM_EVENT_OFF(e)	\
	(e & (SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD))

/* regulator widget flags */
#define SND_SOC_DAPM_REGULATOR_BYPASS     0x1     /* bypass when disabled */

struct snd_soc_dapm_widget;
enum snd_soc_dapm_type;
struct snd_soc_dapm_path;
struct snd_soc_dapm_pin;
struct snd_soc_dapm_route;
struct snd_soc_dapm_context;
struct regulator;
struct snd_soc_dapm_widget_list;
struct snd_soc_dapm_update;

int dapm_regulator_event(struct snd_soc_dapm_widget *w,
			 struct snd_kcontrol *kcontrol, int event);
int dapm_clock_event(struct snd_soc_dapm_widget *w,
			 struct snd_kcontrol *kcontrol, int event);

/* dapm controls */
int snd_soc_dapm_put_volsw(struct snd_kcontrol *kcontrol,
	struct snd_ctl_elem_value *ucontrol);
int snd_soc_dapm_get_volsw(struct snd_kcontrol *kcontrol,
	struct snd_ctl_elem_value *ucontrol);
int snd_soc_dapm_get_enum_double(struct snd_kcontrol *kcontrol,
	struct snd_ctl_elem_value *ucontrol);
int snd_soc_dapm_put_enum_double(struct snd_kcontrol *kcontrol,
	struct snd_ctl_elem_value *ucontrol);
int snd_soc_dapm_info_pin_switch(struct snd_kcontrol *kcontrol,
	struct snd_ctl_elem_info *uinfo);
int snd_soc_dapm_get_pin_switch(struct snd_kcontrol *kcontrol,
	struct snd_ctl_elem_value *uncontrol);
int snd_soc_dapm_put_pin_switch(struct snd_kcontrol *kcontrol,
	struct snd_ctl_elem_value *uncontrol);
int snd_soc_dapm_new_controls(struct snd_soc_dapm_context *dapm,
	const struct snd_soc_dapm_widget *widget,
	int num);
int snd_soc_dapm_new_dai_widgets(struct snd_soc_dapm_context *dapm,
				 struct snd_soc_dai *dai);
int snd_soc_dapm_link_dai_widgets(struct snd_soc_card *card);
void snd_soc_dapm_connect_dai_link_widgets(struct snd_soc_card *card);
int snd_soc_dapm_new_pcm(struct snd_soc_card *card,
			 const struct snd_soc_pcm_stream *params,
			 unsigned int num_params,
			 struct snd_soc_dapm_widget *source,
			 struct snd_soc_dapm_widget *sink);

/* dapm path setup */
int snd_soc_dapm_new_widgets(struct snd_soc_card *card);
void snd_soc_dapm_free(struct snd_soc_dapm_context *dapm);
int snd_soc_dapm_add_routes(struct snd_soc_dapm_context *dapm,
			    const struct snd_soc_dapm_route *route, int num);
int snd_soc_dapm_del_routes(struct snd_soc_dapm_context *dapm,
			    const struct snd_soc_dapm_route *route, int num);
int snd_soc_dapm_weak_routes(struct snd_soc_dapm_context *dapm,
			     const struct snd_soc_dapm_route *route, int num);

/* dapm events */
void snd_soc_dapm_stream_event(struct snd_soc_pcm_runtime *rtd, int stream,
	int event);
void snd_soc_dapm_shutdown(struct snd_soc_card *card);

/* external DAPM widget events */
int snd_soc_dapm_mixer_update_power(struct snd_soc_dapm_context *dapm,
		struct snd_kcontrol *kcontrol, int connect,
		struct snd_soc_dapm_update *update);
int snd_soc_dapm_mux_update_power(struct snd_soc_dapm_context *dapm,
		struct snd_kcontrol *kcontrol, int mux, struct soc_enum *e,
		struct snd_soc_dapm_update *update);

/* dapm sys fs - used by the core */
extern struct attribute *soc_dapm_dev_attrs[];
void snd_soc_dapm_debugfs_init(struct snd_soc_dapm_context *dapm,
				struct dentry *parent);

/* dapm audio pin control and status */
int snd_soc_dapm_enable_pin(struct snd_soc_dapm_context *dapm,
			    const char *pin);
int snd_soc_dapm_enable_pin_unlocked(struct snd_soc_dapm_context *dapm,
				     const char *pin);
int snd_soc_dapm_disable_pin(struct snd_soc_dapm_context *dapm,
			     const char *pin);
int snd_soc_dapm_disable_pin_unlocked(struct snd_soc_dapm_context *dapm,
				      const char *pin);
int snd_soc_dapm_nc_pin(struct snd_soc_dapm_context *dapm, const char *pin);
int snd_soc_dapm_nc_pin_unlocked(struct snd_soc_dapm_context *dapm,
				 const char *pin);
int snd_soc_dapm_get_pin_status(struct snd_soc_dapm_context *dapm,
				const char *pin);
int snd_soc_dapm_sync(struct snd_soc_dapm_context *dapm);
int snd_soc_dapm_sync_unlocked(struct snd_soc_dapm_context *dapm);
int snd_soc_dapm_force_enable_pin(struct snd_soc_dapm_context *dapm,
				  const char *pin);
int snd_soc_dapm_force_enable_pin_unlocked(struct snd_soc_dapm_context *dapm,
					   const char *pin);
int snd_soc_dapm_ignore_suspend(struct snd_soc_dapm_context *dapm,
				const char *pin);
unsigned int dapm_kcontrol_get_value(const struct snd_kcontrol *kcontrol);

/* Mostly internal - should not normally be used */
void dapm_mark_endpoints_dirty(struct snd_soc_card *card);

/* dapm path query */
int snd_soc_dapm_dai_get_connected_widgets(struct snd_soc_dai *dai, int stream,
	struct snd_soc_dapm_widget_list **list);

struct snd_soc_dapm_context *snd_soc_dapm_kcontrol_dapm(
	struct snd_kcontrol *kcontrol);

/* dapm widget types */
enum snd_soc_dapm_type {
	snd_soc_dapm_input = 0,		/* input pin */
	snd_soc_dapm_output,		/* output pin */
	snd_soc_dapm_mux,			/* selects 1 analog signal from many inputs */
	snd_soc_dapm_mixer,			/* mixes several analog signals together */
	snd_soc_dapm_mixer_named_ctl,		/* mixer with named controls */
	snd_soc_dapm_pga,			/* programmable gain/attenuation (volume) */
	snd_soc_dapm_out_drv,			/* output driver */
	snd_soc_dapm_adc,			/* analog to digital converter */
	snd_soc_dapm_dac,			/* digital to analog converter */
	snd_soc_dapm_micbias,		/* microphone bias (power) */
	snd_soc_dapm_mic,			/* microphone */
	snd_soc_dapm_hp,			/* headphones */
	snd_soc_dapm_spk,			/* speaker */
	snd_soc_dapm_line,			/* line input/output */
	snd_soc_dapm_switch,		/* analog switch */
	snd_soc_dapm_vmid,			/* codec bias/vmid - to minimise pops */
	snd_soc_dapm_pre,			/* machine specific pre widget - exec first */
	snd_soc_dapm_post,			/* machine specific post widget - exec last */
	snd_soc_dapm_supply,		/* power/clock supply */
	snd_soc_dapm_regulator_supply,	/* external regulator */
	snd_soc_dapm_clock_supply,	/* external clock */
	snd_soc_dapm_aif_in,		/* audio interface input */
	snd_soc_dapm_aif_out,		/* audio interface output */
	snd_soc_dapm_siggen,		/* signal generator */
	snd_soc_dapm_dai_in,		/* link to DAI structure */
	snd_soc_dapm_dai_out,
	snd_soc_dapm_dai_link,		/* link between two DAI structures */
	snd_soc_dapm_kcontrol,		/* Auto-disabled kcontrol */
};

enum snd_soc_dapm_subclass {
	SND_SOC_DAPM_CLASS_INIT		= 0,
	SND_SOC_DAPM_CLASS_RUNTIME	= 1,
};

/*
 * DAPM audio route definition.
 *
 * Defines an audio route originating at source via control and finishing
 * at sink.
 */
struct snd_soc_dapm_route {
	const char *sink;
	const char *control;
	const char *source;

	/* Note: currently only supported for links where source is a supply */
	int (*connected)(struct snd_soc_dapm_widget *source,
			 struct snd_soc_dapm_widget *sink);
};

/* dapm audio path between two widgets */
struct snd_soc_dapm_path {
	const char *name;

	/* source (input) and sink (output) widgets */
	struct snd_soc_dapm_widget *source;
	struct snd_soc_dapm_widget *sink;

	/* status */
	u32 connect:1;	/* source and sink widgets are connected */
	u32 walking:1;  /* path is in the process of being walked */
	u32 weak:1;	/* path ignored for power management */
	u32 is_supply:1;	/* At least one of the connected widgets is a supply */

	int (*connected)(struct snd_soc_dapm_widget *source,
			 struct snd_soc_dapm_widget *sink);

	struct list_head list_source;
	struct list_head list_sink;
	struct list_head list_kcontrol;
	struct list_head list;
};

/* dapm widget */
struct snd_soc_dapm_widget {
	enum snd_soc_dapm_type id;
	const char *name;		/* widget name */
	const char *sname;	/* stream name */
	struct list_head list;
	struct snd_soc_dapm_context *dapm;

	void *priv;				/* widget specific data */
	struct regulator *regulator;		/* attached regulator */
	const struct snd_soc_pcm_stream *params; /* params for dai links */
	unsigned int num_params; /* number of params for dai links */
	unsigned int params_select; /* currently selected param for dai link */

	/* dapm control */
	int reg;				/* negative reg = no direct dapm */
	unsigned char shift;			/* bits to shift */
	unsigned int mask;			/* non-shifted mask */
	unsigned int on_val;			/* on state value */
	unsigned int off_val;			/* off state value */
	unsigned char power:1;			/* block power status */
	unsigned char active:1;			/* active stream on DAC, ADC's */
	unsigned char connected:1;		/* connected codec pin */
	unsigned char new:1;			/* cnew complete */
	unsigned char force:1;			/* force state */
	unsigned char ignore_suspend:1;         /* kept enabled over suspend */
	unsigned char new_power:1;		/* power from this run */
	unsigned char power_checked:1;		/* power checked this run */
	unsigned char is_supply:1;		/* Widget is a supply type widget */
	unsigned char is_sink:1;		/* Widget is a sink type widget */
	unsigned char is_source:1;		/* Widget is a source type widget */
	int subseq;				/* sort within widget type */

	int (*power_check)(struct snd_soc_dapm_widget *w);

	/* external events */
	unsigned short event_flags;		/* flags to specify event types */
	int (*event)(struct snd_soc_dapm_widget*, struct snd_kcontrol *, int);

	/* kcontrols that relate to this widget */
	int num_kcontrols;
	const struct snd_kcontrol_new *kcontrol_news;
	struct snd_kcontrol **kcontrols;

	/* widget input and outputs */
	struct list_head sources;
	struct list_head sinks;

	/* used during DAPM updates */
	struct list_head work_list;
	struct list_head power_list;
	struct list_head dirty;
	int inputs;
	int outputs;

	struct clk *clk;
};

struct snd_soc_dapm_update {
	struct snd_kcontrol *kcontrol;
	int reg;
	int mask;
	int val;
};

/* DAPM context */
struct snd_soc_dapm_context {
	enum snd_soc_bias_level bias_level;
	unsigned int idle_bias_off:1; /* Use BIAS_OFF instead of STANDBY */
	/* Go to BIAS_OFF in suspend if the DAPM context is idle */
	unsigned int suspend_bias_off:1;
	void (*seq_notifier)(struct snd_soc_dapm_context *,
			     enum snd_soc_dapm_type, int);

	struct device *dev; /* from parent - for debug */
	struct snd_soc_component *component; /* parent component */
	struct snd_soc_card *card; /* parent card */

	/* used during DAPM updates */
	enum snd_soc_bias_level target_bias_level;
	struct list_head list;

	int (*stream_event)(struct snd_soc_dapm_context *dapm, int event);
	int (*set_bias_level)(struct snd_soc_dapm_context *dapm,
			      enum snd_soc_bias_level level);

#ifdef CONFIG_DEBUG_FS
	struct dentry *debugfs_dapm;
#endif
};

/* A list of widgets associated with an object, typically a snd_kcontrol */
struct snd_soc_dapm_widget_list {
	int num_widgets;
	struct snd_soc_dapm_widget *widgets[0];
};

struct snd_soc_dapm_stats {
	int power_checks;
	int path_checks;
	int neighbour_checks;
};

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #ifndef PXA2XX_LIB_H
#define PXA2XX_LIB_H

#include <linux/platform_device.h>
#include <sound/ac97_codec.h>

/* PCM */

extern int __pxa2xx_pcm_hw_params(struct snd_pcm_substream *substream,
				struct snd_pcm_hw_params *params);
extern int __pxa2xx_pcm_hw_free(struct snd_pcm_substream *substream);
extern int pxa2xx_pcm_trigger(struct snd_pcm_substream *substream, int cmd);
extern snd_pcm_uframes_t pxa2xx_pcm_pointer(struct snd_pcm_substream *substream);
extern int __pxa2xx_pcm_prepare(struct snd_pcm_substream *substream);
extern void pxa2xx_pcm_dma_irq(int dma_ch, void *dev_id);
extern int __pxa2xx_pcm_open(struct snd_pcm_substream *substream);
extern int __pxa2xx_pcm_close(struct snd_pcm_substream *substream);
extern int pxa2xx_pcm_mmap(struct snd_pcm_substream *substream,
	struct vm_area_struct *vma);
extern int pxa2xx_pcm_preallocate_dma_buffer(struct snd_pcm *pcm, int stream);
extern void pxa2xx_pcm_free_dma_buffers(struct snd_pcm *pcm);

/* AC97 */

extern unsigned short pxa2xx_ac97_read(struct snd_ac97 *ac97, unsigned short reg);
extern void pxa2xx_ac97_write(struct snd_ac97 *ac97, unsigned short reg, unsigned short val);

extern bool pxa2xx_ac97_try_warm_reset(struct snd_ac97 *ac97);
extern bool pxa2xx_ac97_try_cold_reset(struct snd_ac97 *ac97);
extern void pxa2xx_ac97_finish_reset(struct snd_ac97 *ac97);

extern int pxa2xx_ac97_hw_suspend(void);
extern int pxa2xx_ac97_hw_resume(void);

extern int pxa2xx_ac97_hw_probe(struct platform_device *dev);
extern void pxa2xx_ac97_hw_remove(struct platform_device *dev);

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /*
 * HD-audio codec verbs
 */

#ifndef __SOUND_HDA_VERBS_H
#define __SOUND_HDA_VERBS_H

/*
 * nodes
 */
#define	AC_NODE_ROOT		0x00

/*
 * function group types
 */
enum {
	AC_GRP_AUDIO_FUNCTION = 0x01,
	AC_GRP_MODEM_FUNCTION = 0x02,
};

/*
 * widget types
 */
enum {
	AC_WID_AUD_OUT,		/* Audio Out */
	AC_WID_AUD_IN,		/* Audio In */
	AC_WID_AUD_MIX,		/* Audio Mixer */
	AC_WID_AUD_SEL,		/* Audio Selector */
	AC_WID_PIN,		/* Pin Complex */
	AC_WID_POWER,		/* Power */
	AC_WID_VOL_KNB,		/* Volume Knob */
	AC_WID_BEEP,		/* Beep Generator */
	AC_WID_VENDOR = 0x0f	/* Vendor specific */
};

/*
 * GET verbs
 */
#define AC_VERB_GET_STREAM_FORMAT		0x0a00
#define AC_VERB_GET_AMP_GAIN_MUTE		0x0b00
#define AC_VERB_GET_PROC_COEF			0x0c00
#define AC_VERB_GET_COEF_INDEX			0x0d00
#define AC_VERB_PARAMETERS			0x0f00
#define AC_VERB_GET_CONNECT_SEL			0x0f01
#define AC_VERB_GET_CONNECT_LIST		0x0f02
#define AC_VERB_GET_PROC_STATE			0x0f03
#define AC_VERB_GET_SDI_SELECT			0x0f04
#define AC_VERB_GET_POWER_STATE			0x0f05
#define AC_VERB_GET_CONV			0x0f06
#define AC_VERB_GET_PIN_WIDGET_CONTROL		0x0f07
#define AC_VERB_GET_UNSOLICITED_RESPONSE	0x0f08
#define AC_VERB_GET_PIN_SENSE			0x0f09
#define AC_VERB_GET_BEEP_CONTROL		0x0f0a
#define AC_VERB_GET_EAPD_BTLENABLE		0x0f0c
#define AC_VERB_GET_DIGI_CONVERT_1		0x0f0d
#define AC_VERB_GET_DIGI_CONVERT_2		0x0f0e /* unused */
#define AC_VERB_GET_VOLUME_KNOB_CONTROL		0x0f0f
/* f10-f1a: GPIO */
#define AC_VERB_GET_GPIO_DATA			0x0f15
#define AC_VERB_GET_GPIO_MASK			0x0f16
#define AC_VERB_GET_GPIO_DIRECTION		0x0f17
#define AC_VERB_GET_GPIO_WAKE_MASK		0x0f18
#define AC_VERB_GET_GPIO_UNSOLICITED_RSP_MASK	0x0f19
#define AC_VERB_GET_GPIO_STICKY_MASK		0x0f1a
#define AC_VERB_GET_CONFIG_DEFAULT		0x0f1c
/* f20: AFG/MFG */
#define AC_VERB_GET_SUBSYSTEM_ID		0x0f20
#define AC_VERB_GET_CVT_CHAN_COUNT		0x0f2d
#define AC_VERB_GET_HDMI_DIP_SIZE		0x0f2e
#define AC_VERB_GET_HDMI_ELDD			0x0f2f
#define AC_VERB_GET_HDMI_DIP_INDEX		0x0f30
#define AC_VERB_GET_HDMI_DIP_DATA		0x0f31
#define AC_VERB_GET_HDMI_DIP_XMIT		0x0f32
#define AC_VERB_GET_HDMI_CP_CTRL		0x0f33
#define AC_VERB_GET_HDMI_CHAN_SLOT		0x0f34
#define AC_VERB_GET_DEVICE_SEL			0xf35
#define AC_VERB_GET_DEVICE_LIST			0xf36

/*
 * SET verbs
 */
#define AC_VERB_SET_STREAM_FORMAT		0x200
#define AC_VERB_SET_AMP_GAIN_MUTE		0x300
#define AC_VERB_SET_PROC_COEF			0x400
#define AC_VERB_SET_COEF_INDEX			0x500
#define AC_VERB_SET_CONNECT_SEL			0x701
#define AC_VERB_SET_PROC_STATE			0x703
#define AC_VERB_SET_SDI_SELECT			0x704
#define AC_VERB_SET_POWER_STATE			0x705
#define AC_VERB_SET_CHANNEL_STREAMID		0x706
#define AC_VERB_SET_PIN_WIDGET_CONTROL		0x707
#define AC_VERB_SET_UNSOLICITED_ENABLE		0x708
#define AC_VERB_SET_PIN_SENSE			0x709
#define AC_VERB_SET_BEEP_CONTROL		0x70a
#define AC_VERB_SET_EAPD_BTLENABLE		0x70c
#define AC_VERB_SET_DIGI_CONVERT_1		0x70d
#define AC_VERB_SET_DIGI_CONVERT_2		0x70e
#define AC_VERB_SET_VOLUME_KNOB_CONTROL		0x70f
#define AC_VERB_SET_GPIO_DATA			0x715
#define AC_VERB_SET_GPIO_MASK			0x716
#define AC_VERB_SET_GPIO_DIRECTION		0x717
#define AC_VERB_SET_GPIO_WAKE_MASK		0x718
#define AC_VERB_SET_GPIO_UNSOLICITED_RSP_MASK	0x719
#define AC_VERB_SET_GPIO_STICKY_MASK		0x71a
#define AC_VERB_SET_CONFIG_DEFAULT_BYTES_0	0x71c
#define AC_VERB_SET_CONFIG_DEFAULT_BYTES_1	0x71d
#define AC_VERB_SET_CONFIG_DEFAULT_BYTES_2	0x71e
#define AC_VERB_SET_CONFIG_DEFAULT_BYTES_3	0x71f
#define AC_VERB_SET_EAPD				0x788
#define AC_VERB_SET_CODEC_RESET			0x7ff
#define AC_VERB_SET_CVT_CHAN_COUNT		0x72d
#define AC_VERB_SET_HDMI_DIP_INDEX		0x730
#define AC_VERB_SET_HDMI_DIP_DATA		0x731
#define AC_VERB_SET_HDMI_DIP_XMIT		0x732
#define AC_VERB_SET_HDMI_CP_CTRL		0x733
#define AC_VERB_SET_HDMI_CHAN_SLOT		0x734
#define AC_VERB_SET_DEVICE_SEL			0x735

/*
 * Parameter IDs
 */
#define AC_PAR_VENDOR_ID		0x00
#define AC_PAR_SUBSYSTEM_ID		0x01
#define AC_PAR_REV_ID			0x02
#define AC_PAR_NODE_COUNT		0x04
#define AC_PAR_FUNCTION_TYPE		0x05
#define AC_PAR_AUDIO_FG_CAP		0x08
#define AC_PAR_AUDIO_WIDGET_CAP		0x09
#define AC_PAR_PCM			0x0a
#define AC_PAR_STREAM			0x0b
#define AC_PAR_PIN_CAP			0x0c
#define AC_PAR_AMP_IN_CAP		0x0d
#define AC_PAR_CONNLIST_LEN		0x0e
#define AC_PAR_POWER_STATE		0x0f
#define AC_PAR_PROC_CAP			0x10
#define AC_PAR_GPIO_CAP			0x11
#define AC_PAR_AMP_OUT_CAP		0x12
#define AC_PAR_VOL_KNB_CAP		0x13
#define AC_PAR_DEVLIST_LEN		0x15
#define AC_PAR_HDMI_LPCM_CAP		0x20

/*
 * AC_VERB_PARAMETERS results (32bit)
 */

/* Function Group Type */
#define AC_FGT_TYPE			(0xff<<0)
#define AC_FGT_TYPE_SHIFT		0
#define AC_FGT_UNSOL_CAP		(1<<8)

/* Audio Function Group Capabilities */
#define AC_AFG_OUT_DELAY		(0xf<<0)
#define AC_AFG_IN_DELAY			(0xf<<8)
#define AC_AFG_BEEP_GEN			(1<<16)

/* Audio Widget Capabilities */
#define AC_WCAP_STEREO			(1<<0)	/* stereo I/O */
#define AC_WCAP_IN_AMP			(1<<1)	/* AMP-in present */
#define AC_WCAP_OUT_AMP			(1<<2)	/* AMP-out present */
#define AC_WCAP_AMP_OVRD		(1<<3)	/* AMP-parameter override */
#define AC_WCAP_FORMAT_OVRD		(1<<4)	/* format override */
#define AC_WCAP_STRIPE			(1<<5)	/* stripe */
#define AC_WCAP_PROC_WID		(1<<6)	/* Proc Widget */
#define AC_WCAP_UNSOL_CAP		(1<<7)	/* Unsol capable */
#define AC_WCAP_CONN_LIST		(1<<8)	/* connection list */
#define AC_WCAP_DIGITAL			(1<<9)	/* digital I/O */
#define AC_WCAP_POWER			(1<<10)	/* power control */
#define AC_WCAP_LR_SWAP			(1<<11)	/* L/R swap */
#define AC_WCAP_CP_CAPS			(1<<12) /* content protection */
#define AC_WCAP_CHAN_CNT_EXT		(7<<13)	/* channel count ext */
#define AC_WCAP_DELAY			(0xf<<16)
#define AC_WCAP_DELAY_SHIFT		16
#define AC_WCAP_TYPE			(0xf<<20)
#define AC_WCAP_TYPE_SHIFT		20

/* supported PCM rates and bits */
#define AC_SUPPCM_RATES			(0xfff << 0)
#define AC_SUPPCM_BITS_8		(1<<16)
#define AC_SUPPCM_BITS_16		(1<<17)
#define AC_SUPPCM_BITS_20		(1<<18)
#define AC_SUPPCM_BITS_24		(1<<19)
#define AC_SUPPCM_BITS_32		(1<<20)

/* supported PCM stream format */
#define AC_SUPFMT_PCM			(1<<0)
#define AC_SUPFMT_FLOAT32		(1<<1)
#define AC_SUPFMT_AC3			(1<<2)

/* GP I/O count */
#define AC_GPIO_IO_COUNT		(0xff<<0)
#define AC_GPIO_O_COUNT			(0xff<<8)
#define AC_GPIO_O_COUNT_SHIFT		8
#define AC_GPIO_I_COUNT			(0xff<<16)
#define AC_GPIO_I_COUNT_SHIFT		16
#define AC_GPIO_UNSOLICITED		(1<<30)
#define AC_GPIO_WAKE			(1<<31)

/* Converter stream, channel */
#define AC_CONV_CHANNEL			(0xf<<0)
#define AC_CONV_STREAM			(0xf<<4)
#define AC_CONV_STREAM_SHIFT		4

/* Input converter SDI select */
#define AC_SDI_SELECT			(0xf<<0)

/* stream format id */
#define AC_FMT_CHAN_SHIFT		0
#define AC_FMT_CHAN_MASK		(0x0f << 0)
#define AC_FMT_BITS_SHIFT		4
#define AC_FMT_BITS_MASK		(7 << 4)
#define AC_FMT_BITS_8			(0 << 4)
#define AC_FMT_BITS_16			(1 << 4)
#define AC_FMT_BITS_20			(2 << 4)
#define AC_FMT_BITS_24			(3 << 4)
#define AC_FMT_BITS_32			(4 << 4)
#define AC_FMT_DIV_SHIFT		8
#define AC_FMT_DIV_MASK			(7 << 8)
#define AC_FMT_MULT_SHIFT		11
#define AC_FMT_MULT_MASK		(7 << 11)
#define AC_FMT_BASE_SHIFT		14
#define AC_FMT_BASE_48K			(0 << 14)
#define AC_FMT_BASE_44K			(1 << 14)
#define AC_FMT_TYPE_SHIFT		15
#define AC_FMT_TYPE_PCM			(0 << 15)
#define AC_FMT_TYPE_NON_PCM		(1 << 15)

/* Unsolicited response control */
#define AC_UNSOL_TAG			(0x3f<<0)
#define AC_UNSOL_ENABLED		(1<<7)
#define AC_USRSP_EN			AC_UNSOL_ENABLED

/* Unsolicited responses */
#define AC_UNSOL_RES_TAG		(0x3f<<26)
#define AC_UNSOL_RES_TAG_SHIFT		26
#define AC_UNSOL_RES_SUBTAG		(0x1f<<21)
#define AC_UNSOL_RES_SUBTAG_SHIFT	21
#define AC_UNSOL_RES_DE			(0x3f<<15)  /* Device Entry
						     * (for DP1.2 MST)
						     */
#define AC_UNSOL_RES_DE_SHIFT		15
#define AC_UNSOL_RES_IA			(1<<2)	/* Inactive (for DP1.2 MST) */
#define AC_UNSOL_RES_ELDV		(1<<1)	/* ELD Data valid (for HDMI) */
#define AC_UNSOL_RES_PD			(1<<0)	/* pinsense detect */
#define AC_UNSOL_RES_CP_STATE		(1<<1)	/* content protection */
#define AC_UNSOL_RES_CP_READY		(1<<0)	/* content protection */

/* Pin widget capabilies */
#define AC_PINCAP_IMP_SENSE		(1<<0)	/* impedance sense capable */
#define AC_PINCAP_TRIG_REQ		(1<<1)	/* trigger required */
#define AC_PINCAP_PRES_DETECT		(1<<2)	/* presence detect capable */
#define AC_PINCAP_HP_DRV		(1<<3)	/* headphone drive capable */
#define AC_PINCAP_OUT			(1<<4)	/* output capable */
#define AC_PINCAP_IN			(1<<5)	/* input capable */
#define AC_PINCAP_BALANCE		(1<<6)	/* balanced I/O capable */
/* Note: This LR_SWAP pincap is defined in the Realtek ALC883 specification,
 *       but is marked reserved in the Intel HDA specification.
 */
#define AC_PINCAP_LR_SWAP		(1<<7)	/* L/R swap */
/* Note: The same bit as LR_SWAP is newly defined as HDMI capability
 *       in HD-audio specification
 */
#define AC_PINCAP_HDMI			(1<<7)	/* HDMI pin */
#define AC_PINCAP_DP			(1<<24)	/* DisplayPort pin, can
						 * coexist with AC_PINCAP_HDMI
						 */
#define AC_PINCAP_VREF			(0x37<<8)
#define AC_PINCAP_VREF_SHIFT		8
#define AC_PINCAP_EAPD			(1<<16)	/* EAPD capable */
#define AC_PINCAP_HBR			(1<<27)	/* High Bit Rate */
/* Vref status (used in pin cap) */
#define AC_PINCAP_VREF_HIZ		(1<<0)	/* Hi-Z */
#define AC_PINCAP_VREF_50		(1<<1)	/* 50% */
#define AC_PINCAP_VREF_GRD		(1<<2)	/* ground */
#define AC_PINCAP_VREF_80		(1<<4)	/* 80% */
#define AC_PINCAP_VREF_100		(1<<5)	/* 100% */

/* Amplifier capabilities */
#define AC_AMPCAP_OFFSET		(0x7f<<0)  /* 0dB offset */
#define AC_AMPCAP_OFFSET_SHIFT		0
#define AC_AMPCAP_NUM_STEPS		(0x7f<<8)  /* number of steps */
#define AC_AMPCAP_NUM_STEPS_SHIFT	8
#define AC_AMPCAP_STEP_SIZE		(0x7f<<16) /* step size 0-32dB
						    * in 0.25dB
						    */
#define AC_AMPCAP_STEP_SIZE_SHIFT	16
#define AC_AMPCAP_MUTE			(1<<31)    /* mute capable */
#define AC_AMPCAP_MUTE_SHIFT		31

/* driver-specific amp-caps: using bits 24-30 */
#define AC_AMPCAP_MIN_MUTE		(1 << 30) /* min-volume = mute */

/* Connection list */
#define AC_CLIST_LENGTH			(0x7f<<0)
#define AC_CLIST_LONG			(1<<7)

/* Supported power status */
#define AC_PWRST_D0SUP			(1<<0)
#define AC_PWRST_D1SUP			(1<<1)
#define AC_PWRST_D2SUP			(1<<2)
#define AC_PWRST_D3SUP			(1<<3)
#define AC_PWRST_D3COLDSUP		(1<<4)
#define AC_PWRST_S3D3COLDSUP		(1<<29)
#define AC_PWRST_CLKSTOP		(1<<30)
#define AC_PWRST_EPSS			(1U<<31)

/* Power state values */
#define AC_PWRST_SETTING		(0xf<<0)
#define AC_PWRST_ACTUAL			(0xf<<4)
#define AC_PWRST_ACTUAL_SHIFT		4
#define AC_PWRST_D0			0x00
#define AC_PWRST_D1			0x01
#define AC_PWRST_D2			0x02
#define AC_PWRST_D3			0x03
#define AC_PWRST_ERROR                  (1<<8)
#define AC_PWRST_CLK_STOP_OK            (1<<9)
#define AC_PWRST_SETTING_RESET          (1<<10)

/* Processing capabilies */
#define AC_PCAP_BENIGN			(1<<0)
#define AC_PCAP_NUM_COEF		(0xff<<8)
#define AC_PCAP_NUM_COEF_SHIFT		8

/* Volume knobs capabilities */
#define AC_KNBCAP_NUM_STEPS		(0x7f<<0)
#define AC_KNBCAP_DELTA			(1<<7)

/* HDMI LPCM capabilities */
#define AC_LPCMCAP_48K_CP_CHNS		(0x0f<<0) /* max channels w/ CP-on */
#define AC_LPCMCAP_48K_NO_CHNS		(0x0f<<4) /* max channels w/o CP-on */
#define AC_LPCMCAP_48K_20BIT		(1<<8)	/* 20b bitrate supported */
#define AC_LPCMCAP_48K_24BIT		(1<<9)	/* 24b bitrate supported */
#define AC_LPCMCAP_96K_CP_CHNS		(0x0f<<10) /* max channels w/ CP-on */
#define AC_LPCMCAP_96K_NO_CHNS		(0x0f<<14) /* max channels w/o CP-on */
#define AC_LPCMCAP_96K_20BIT		(1<<18)	/* 20b bitrate supported */
#define AC_LPCMCAP_96K_24BIT		(1<<19)	/* 24b bitrate supported */
#define AC_LPCMCAP_192K_CP_CHNS		(0x0f<<20) /* max channels w/ CP-on */
#define AC_LPCMCAP_192K_NO_CHNS		(0x0f<<24) /* max channels w/o CP-on */
#define AC_LPCMCAP_192K_20BIT		(1<<28)	/* 20b bitrate supported */
#define AC_LPCMCAP_192K_24BIT		(1<<29)	/* 24b bitrate supported */
#define AC_LPCMCAP_44K			(1<<30)	/* 44.1kHz support */
#define AC_LPCMCAP_44K_MS		(1<<31)	/* 44.1kHz-multiplies support */

/* Display pin's device list length */
#define AC_DEV_LIST_LEN_MASK		0x3f
#define AC_MAX_DEV_LIST_LEN		64

/*
 * Control Parameters
 */

/* Amp gain/mute */
#define AC_AMP_MUTE			(1<<7)
#define AC_AMP_GAIN			(0x7f)
#define AC_AMP_GET_INDEX		(0xf<<0)

#define AC_AMP_GET_LEFT			(1<<13)
#define AC_AMP_GET_RIGHT		(0<<13)
#define AC_AMP_GET_OUTPUT		(1<<15)
#define AC_AMP_GET_INPUT		(0<<15)

#define AC_AMP_SET_INDEX		(0xf<<8)
#define AC_AMP_SET_INDEX_SHIFT		8
#define AC_AMP_SET_RIGHT		(1<<12)
#define AC_AMP_SET_LEFT			(1<<13)
#define AC_AMP_SET_INPUT		(1<<14)
#define AC_AMP_SET_OUTPUT		(1<<15)

/* DIGITAL1 bits */
#define AC_DIG1_ENABLE			(1<<0)
#define AC_DIG1_V			(1<<1)
#define AC_DIG1_VCFG			(1<<2)
#define AC_DIG1_EMPHASIS		(1<<3)
#define AC_DIG1_COPYRIGHT		(1<<4)
#define AC_DIG1_NONAUDIO		(1<<5)
#define AC_DIG1_PROFESSIONAL		(1<<6)
#define AC_DIG1_LEVEL			(1<<7)

/* DIGITAL2 bits */
#define AC_DIG2_CC			(0x7f<<0)

/* DIGITAL3 bits */
#define AC_DIG3_ICT			(0xf<<0)
#define AC_DIG3_KAE			(1<<7)

/* Pin widget control - 8bit */
#define AC_PINCTL_EPT			(0x3<<0)
#define AC_PINCTL_EPT_NATIVE		0
#define AC_PINCTL_EPT_HBR		3
#define AC_PINCTL_VREFEN		(0x7<<0)
#define AC_PINCTL_VREF_HIZ		0	/* Hi-Z */
#define AC_PINCTL_VREF_50		1	/* 50% */
#define AC_PINCTL_VREF_GRD		2	/* ground */
#define AC_PINCTL_VREF_80		4	/* 80% */
#define AC_PINCTL_VREF_100		5	/* 100% */
#define AC_PINCTL_IN_EN			(1<<5)
#define AC_PINCTL_OUT_EN		(1<<6)
#define AC_PINCTL_HP_EN			(1<<7)

/* Pin sense - 32bit */
#define AC_PINSENSE_IMPEDANCE_MASK	(0x7fffffff)
#define AC_PINSENSE_PRESENCE		(1<<31)
#define AC_PINSENSE_ELDV		(1<<30)	/* ELD valid (HDMI) */

/* EAPD/BTL enable - 32bit */
#define AC_EAPDBTL_BALANCED		(1<<0)
#define AC_EAPDBTL_EAPD			(1<<1)
#define AC_EAPDBTL_LR_SWAP		(1<<2)

/* HDMI ELD data */
#define AC_ELDD_ELD_VALID		(1<<31)
#define AC_ELDD_ELD_DATA		0xff

/* HDMI DIP size */
#define AC_DIPSIZE_ELD_BUF		(1<<3) /* ELD buf size of packet size */
#define AC_DIPSIZE_PACK_IDX		(0x07<<0) /* packet index */

/* HDMI DIP index */
#define AC_DIPIDX_PACK_IDX		(0x07<<5) /* packet idnex */
#define AC_DIPIDX_BYTE_IDX		(0x1f<<0) /* byte index */

/* HDMI DIP xmit (transmit) control */
#define AC_DIPXMIT_MASK			(0x3<<6)
#define AC_DIPXMIT_DISABLE		(0x0<<6) /* disable xmit */
#define AC_DIPXMIT_ONCE			(0x2<<6) /* xmit once then disable */
#define AC_DIPXMIT_BEST			(0x3<<6) /* best effort */

/* HDMI content protection (CP) control */
#define AC_CPCTRL_CES			(1<<9) /* current encryption state */
#define AC_CPCTRL_READY			(1<<8) /* ready bit */
#define AC_CPCTRL_SUBTAG		(0x1f<<3) /* subtag for unsol-resp */
#define AC_CPCTRL_STATE			(3<<0) /* current CP request state */

/* Converter channel <-> HDMI slot mapping */
#define AC_CVTMAP_HDMI_SLOT		(0xf<<0) /* HDMI slot number */
#define AC_CVTMAP_CHAN			(0xf<<4) /* converter channel number */

/* configuration default - 32bit */
#define AC_DEFCFG_SEQUENCE		(0xf<<0)
#define AC_DEFCFG_DEF_ASSOC		(0xf<<4)
#define AC_DEFCFG_ASSOC_SHIFT		4
#define AC_DEFCFG_MISC			(0xf<<8)
#define AC_DEFCFG_MISC_SHIFT		8
#define AC_DEFCFG_MISC_NO_PRESENCE	(1<<0)
#define AC_DEFCFG_COLOR			(0xf<<12)
#define AC_DEFCFG_COLOR_SHIFT		12
#define AC_DEFCFG_CONN_TYPE		(0xf<<16)
#define AC_DEFCFG_CONN_TYPE_SHIFT	16
#define AC_DEFCFG_DEVICE		(0xf<<20)
#define AC_DEFCFG_DEVICE_SHIFT		20
#define AC_DEFCFG_LOCATION		(0x3f<<24)
#define AC_DEFCFG_LOCATION_SHIFT	24
#define AC_DEFCFG_PORT_CONN		(0x3<<30)
#define AC_DEFCFG_PORT_CONN_SHIFT	30

/* Display pin's device list entry */
#define AC_DE_PD			(1<<0)
#define AC_DE_ELDV			(1<<1)
#define AC_DE_IA			(1<<2)

/* device device types (0x0-0xf) */
enum {
	AC_JACK_LINE_OUT,
	AC_JACK_SPEAKER,
	AC_JACK_HP_OUT,
	AC_JACK_CD,
	AC_JACK_SPDIF_OUT,
	AC_JACK_DIG_OTHER_OUT,
	AC_JACK_MODEM_LINE_SIDE,
	AC_JACK_MODEM_HAND_SIDE,
	AC_JACK_LINE_IN,
	AC_JACK_AUX,
	AC_JACK_MIC_IN,
	AC_JACK_TELEPHONY,
	AC_JACK_SPDIF_IN,
	AC_JACK_DIG_OTHER_IN,
	AC_JACK_OTHER = 0xf,
};

/* jack connection types (0x0-0xf) */
enum {
	AC_JACK_CONN_UNKNOWN,
	AC_JACK_CONN_1_8,
	AC_JACK_CONN_1_4,
	AC_JACK_CONN_ATAPI,
	AC_JACK_CONN_RCA,
	AC_JACK_CONN_OPTICAL,
	AC_JACK_CONN_OTHER_DIGITAL,
	AC_JACK_CONN_OTHER_ANALOG,
	AC_JACK_CONN_DIN,
	AC_JACK_CONN_XLR,
	AC_JACK_CONN_RJ11,
	AC_JACK_CONN_COMB,
	AC_JACK_CONN_OTHER = 0xf,
};

/* jack colors (0x0-0xf) */
enum {
	AC_JACK_COLOR_UNKNOWN,
	AC_JACK_COLOR_BLACK,
	AC_JACK_COLOR_GREY,
	AC_JACK_COLOR_BLUE,
	AC_JACK_COLOR_GREEN,
	AC_JACK_COLOR_RED,
	AC_JACK_COLOR_ORANGE,
	AC_JACK_COLOR_YELLOW,
	AC_JACK_COLOR_PURPLE,
	AC_JACK_COLOR_PINK,
	AC_JACK_COLOR_WHITE = 0xe,
	AC_JACK_COLOR_OTHER,
};

/* Jack location (0x0-0x3f) */
/* common case */
enum {
	AC_JACK_LOC_NONE,
	AC_JACK_LOC_REAR,
	AC_JACK_LOC_FRONT,
	AC_JACK_LOC_LEFT,
	AC_JACK_LOC_RIGHT,
	AC_JACK_LOC_TOP,
	AC_JACK_LOC_BOTTOM,
};
/* bits 4-5 */
enum {
	AC_JACK_LOC_EXTERNAL = 0x00,
	AC_JACK_LOC_INTERNAL = 0x10,
	AC_JACK_LOC_SEPARATE = 0x20,
	AC_JACK_LOC_OTHER    = 0x30,
};
enum {
	/* external on primary chasis */
	AC_JACK_LOC_REAR_PANEL = 0x07,
	AC_JACK_LOC_DRIVE_BAY,
	/* internal */
	AC_JACK_LOC_RISER = 0x17,
	AC_JACK_LOC_HDMI,
	AC_JACK_LOC_ATAPI,
	/* others */
	AC_JACK_LOC_MOBILE_IN = 0x37,
	AC_JACK_LOC_MOBILE_OUT,
};

/* Port connectivity (0-3) */
enum {
	AC_JACK_PORT_COMPLEX,
	AC_JACK_PORT_NONE,
	AC_JACK_PORT_FIXED,
	AC_JACK_PORT_BOTH,
};

/* max. codec address */
#define HDA_MAX_CODEC_ADDRESS	0x0f

#endif /* __SOUND_HDA_VERBS_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      #ifndef _INCLUDE_SOUND_ALC5623_H
#define _INCLUDE_SOUND_ALC5623_H
struct alc5623_platform_data {
	/* configure :                              */
	/* Lineout/Speaker Amps Vmid ratio control  */
	/* enable/disable adc/dac high pass filters */
	unsigned int add_ctrl;
	/* configure :                              */
	/* output to enable when jack is low        */
	/* output to enable when jack is high       */
	/* jack detect (gpio/nc/jack detect [12]    */
	unsigned int jack_det_ctrl;
};
#endif

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /*
 * ASoC simple sound card support
 *
 * Copyright (C) 2012 Renesas Solutions Corp.
 * Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#ifndef __SIMPLE_CARD_H
#define __SIMPLE_CARD_H

#include <sound/soc.h>

struct asoc_simple_dai {
	const char *name;
	unsigned int sysclk;
	int slots;
	int slot_width;
	struct clk *clk;
};

struct asoc_simple_card_info {
	const char *name;
	const char *card;
	const char *codec;
	const char *platform;

	unsigned int daifmt;
	struct asoc_simple_dai cpu_dai;
	struct asoc_simple_dai codec_dai;
};

#endif /* __SIMPLE_CARD_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /*
 * SH_DAC specific configuration, for the dac_audio platform_device
 *
 * Copyright (C) 2009 Rafael Ignacio Zurita <rizurita@yahoo.com>
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 as published
 * by the Free Software Foundation.
 */

#ifndef __INCLUDE_SH_DAC_AUDIO_H
#define __INCLUDE_SH_DAC_AUDIO_H

struct dac_audio_pdata {
	int buffer_size;
	int channel;
	void (*start)(struct dac_audio_pdata *pd);
	void (*stop)(struct dac_audio_pdata *pd);
};

#endif /* __INCLUDE_SH_DAC_AUDIO_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /*
 * Definitions for CS4271 ASoC codec driver
 *
 * Copyright (c) 2010 Alexander Sverdlin <subaparts@yandex.ru>
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 */

#ifndef __CS4271_H
#define __CS4271_H

struct cs4271_platform_data {
	int gpio_nreset;	/* GPIO driving Reset pin, if any */
	bool amutec_eq_bmutec;	/* flag to enable AMUTEC=BMUTEC */

	/*
	 * The CS4271 requires its LRCLK and MCLK to be stable before its RESET
	 * line is de-asserted. That also means that clocks cannot be changed
	 * without putting the chip back into hardware reset, which also requires
	 * a complete re-initialization of all registers.
	 *
	 * One (undocumented) workaround is to assert and de-assert the PDN bit
	 * in the MODE2 register. This workaround can be enabled with the
	 * following flag.
	 *
	 * Note that this is not needed in case the clocks are stable
	 * throughout the entire runtime of the codec.
	 */
	bool enable_soft_reset;
};

#endif /* __CS4271_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       #ifndef __SOUND_SEQ_MIDI_EVENT_H
#define __SOUND_SEQ_MIDI_EVENT_H

/*
 *  MIDI byte <-> sequencer event coder
 *
 *  Copyright (C) 1998,99 Takashi Iwai <tiwai@suse.de>,
 *                        Jaroslav Kysela <perex@perex.cz>
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 */

#include <sound/asequencer.h>

#define MAX_MIDI_EVENT_BUF	256

/* midi status */
struct snd_midi_event {
	int qlen;		/* queue length */
	int read;		/* chars read */
	int type;		/* current event type */
	unsigned char lastcmd;	/* last command (for MIDI state handling) */
	unsigned char nostat;	/* no state flag */
	int bufsize;		/* allocated buffer size */
	unsigned char *buf;	/* input buffer */
	spinlock_t lock;
};

int snd_midi_event_new(int bufsize, struct snd_midi_event **rdev);
void snd_midi_event_free(struct snd_midi_event *dev);
void snd_midi_event_reset_encode(struct snd_midi_event *dev);
void snd_midi_event_reset_decode(struct snd_midi_event *dev);
void snd_midi_event_no_status(struct snd_midi_event *dev, int on);
/* encode from byte stream - return number of written bytes if success */
long snd_midi_event_encode(struct snd_midi_event *dev, unsigned char *buf, long count,
			   struct snd_seq_event *ev);
int snd_midi_event_encode_byte(struct snd_midi_event *dev, int c, struct snd_seq_event *ev);
/* decode from event to bytes - return number of written bytes if success */
long snd_midi_event_decode(struct snd_midi_event *dev, unsigned char *buf, long count,
			   struct snd_seq_event *ev);

#endif /* __SOUND_SEQ_MIDI_EVENT_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /*
 *   ALSA Driver for the PT2258 volume controller.
 *
 *	Copyright (c) 2006  Jochen Voss <voss@seehuhn.de>
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */      

#ifndef __SOUND_PT2258_H
#define __SOUND_PT2258_H

struct snd_pt2258 {
	struct snd_card *card;
	struct snd_i2c_bus *i2c_bus;
	struct snd_i2c_device *i2c_dev;

	unsigned char volume[6];
	int mute;
};

extern int snd_pt2258_reset(struct snd_pt2258 *pt);
extern int snd_pt2258_build_controls(struct snd_pt2258 *pt);

#endif /* __SOUND_PT2258_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           #ifndef __SOUND_EMU8000_REG_H
#define __SOUND_EMU8000_REG_H
/*
 *  Register operations for the EMU8000
 *
 *  Copyright (C) 1999 Steve Ratcliffe
 *
 *  Based on awe_wave.c by Takashi Iwai
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

/*
 * Data port addresses relative to the EMU base.
 */
#define EMU8000_DATA0(e)    ((e)->port1)
#define EMU8000_DATA1(e)    ((e)->port2)
#define EMU8000_DATA2(e)    ((e)->port2+2)
#define EMU8000_DATA3(e)    ((e)->port3)
#define EMU8000_PTR(e)      ((e)->port3+2)

/*
 * Make a command from a register and channel.
 */
#define EMU8000_CMD(reg, chan) ((reg)<<5 | (chan))

/*
 * Commands to read and write the EMU8000 registers.
 * These macros should be used for all register accesses.
 */
#define EMU8000_CPF_READ(emu, chan) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(0, (chan)))
#define EMU8000_PTRX_READ(emu, chan) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(1, (chan)))
#define EMU8000_CVCF_READ(emu, chan) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(2, (chan)))
#define EMU8000_VTFT_READ(emu, chan) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(3, (chan)))
#define EMU8000_PSST_READ(emu, chan) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(6, (chan)))
#define EMU8000_CSL_READ(emu, chan) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(7, (chan)))
#define EMU8000_CCCA_READ(emu, chan) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(0, (chan)))
#define EMU8000_HWCF4_READ(emu) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 9))
#define EMU8000_HWCF5_READ(emu) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 10))
#define EMU8000_HWCF6_READ(emu) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 13))
#define EMU8000_SMALR_READ(emu) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 20))
#define EMU8000_SMARR_READ(emu) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 21))
#define EMU8000_SMALW_READ(emu) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 22))
#define EMU8000_SMARW_READ(emu) \
	snd_emu8000_peek_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 23))
#define EMU8000_SMLD_READ(emu) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 26))
#define EMU8000_SMRD_READ(emu) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(1, 26))
#define EMU8000_WC_READ(emu) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(1, 27))
#define EMU8000_HWCF1_READ(emu) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 29))
#define EMU8000_HWCF2_READ(emu) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 30))
#define EMU8000_HWCF3_READ(emu) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 31))
#define EMU8000_INIT1_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(2, (chan)))
#define EMU8000_INIT2_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(2, (chan)))
#define EMU8000_INIT3_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(3, (chan)))
#define EMU8000_INIT4_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(3, (chan)))
#define EMU8000_ENVVOL_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(4, (chan)))
#define EMU8000_DCYSUSV_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(5, (chan)))
#define EMU8000_ENVVAL_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(6, (chan)))
#define EMU8000_DCYSUS_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA1(emu), EMU8000_CMD(7, (chan)))
#define EMU8000_ATKHLDV_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(4, (chan)))
#define EMU8000_LFO1VAL_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(5, (chan)))
#define EMU8000_ATKHLD_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(6, (chan)))
#define EMU8000_LFO2VAL_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA2(emu), EMU8000_CMD(7, (chan)))
#define EMU8000_IP_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA3(emu), EMU8000_CMD(0, (chan)))
#define EMU8000_IFATN_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA3(emu), EMU8000_CMD(1, (chan)))
#define EMU8000_PEFE_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA3(emu), EMU8000_CMD(2, (chan)))
#define EMU8000_FMMOD_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA3(emu), EMU8000_CMD(3, (chan)))
#define EMU8000_TREMFRQ_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA3(emu), EMU8000_CMD(4, (chan)))
#define EMU8000_FM2FRQ2_READ(emu, chan) \
	snd_emu8000_peek((emu), EMU8000_DATA3(emu), EMU8000_CMD(5, (chan)))


#define EMU8000_CPF_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(0, (chan)), (val))
#define EMU8000_PTRX_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(1, (chan)), (val))
#define EMU8000_CVCF_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(2, (chan)), (val))
#define EMU8000_VTFT_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(3, (chan)), (val))
#define EMU8000_PSST_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(6, (chan)), (val))
#define EMU8000_CSL_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(7, (chan)), (val))
#define EMU8000_CCCA_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(0, (chan)), (val))
#define EMU8000_HWCF4_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 9), (val))
#define EMU8000_HWCF5_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 10), (val))
#define EMU8000_HWCF6_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 13), (val))
/* this register is not documented */
#define EMU8000_HWCF7_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 14), (val))
#define EMU8000_SMALR_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 20), (val))
#define EMU8000_SMARR_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 21), (val))
#define EMU8000_SMALW_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 22), (val))
#define EMU8000_SMARW_WRITE(emu, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 23), (val))
#define EMU8000_SMLD_WRITE(emu, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 26), (val))
#define EMU8000_SMRD_WRITE(emu, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(1, 26), (val))
#define EMU8000_WC_WRITE(emu, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(1, 27), (val))
#define EMU8000_HWCF1_WRITE(emu, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 29), (val))
#define EMU8000_HWCF2_WRITE(emu, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 30), (val))
#define EMU8000_HWCF3_WRITE(emu, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(1, 31), (val))
#define EMU8000_INIT1_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(2, (chan)), (val))
#define EMU8000_INIT2_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(2, (chan)), (val))
#define EMU8000_INIT3_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(3, (chan)), (val))
#define EMU8000_INIT4_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(3, (chan)), (val))
#define EMU8000_ENVVOL_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(4, (chan)), (val))
#define EMU8000_DCYSUSV_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(5, (chan)), (val))
#define EMU8000_ENVVAL_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(6, (chan)), (val))
#define EMU8000_DCYSUS_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA1(emu), EMU8000_CMD(7, (chan)), (val))
#define EMU8000_ATKHLDV_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(4, (chan)), (val))
#define EMU8000_LFO1VAL_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(5, (chan)), (val))
#define EMU8000_ATKHLD_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(6, (chan)), (val))
#define EMU8000_LFO2VAL_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA2(emu), EMU8000_CMD(7, (chan)), (val))
#define EMU8000_IP_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA3(emu), EMU8000_CMD(0, (chan)), (val))
#define EMU8000_IFATN_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA3(emu), EMU8000_CMD(1, (chan)), (val))
#define EMU8000_PEFE_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA3(emu), EMU8000_CMD(2, (chan)), (val))
#define EMU8000_FMMOD_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA3(emu), EMU8000_CMD(3, (chan)), (val))
#define EMU8000_TREMFRQ_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA3(emu), EMU8000_CMD(4, (chan)), (val))
#define EMU8000_FM2FRQ2_WRITE(emu, chan, val) \
	snd_emu8000_poke((emu), EMU8000_DATA3(emu), EMU8000_CMD(5, (chan)), (val))

#define EMU8000_0080_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(4, (chan)), (val))
#define EMU8000_00A0_WRITE(emu, chan, val) \
	snd_emu8000_poke_dw((emu), EMU8000_DATA0(emu), EMU8000_CMD(5, (chan)), (val))

#endif /* __SOUND_EMU8000_REG_H */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     #ifndef __SOUND_JACK_H
#define __SOUND_JACK_H

/*
 *  Jack abstraction layer
 *
 *  Copyright 2008 Wolfson Microelectronics plc
 *
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 */

#include <sound/core.h>

struct input_dev;

/**
 * enum snd_jack_types - Jack types which can be reported
 * @SND_JACK_HEADPHONE: Headphone
 * @SND_JACK_MICROPHONE: Microphone
 * @SND_JACK_HEADSET: Headset
 * @SND_JACK_LINEOUT: Line out
 * @SND_JACK_MECHANICAL: Mechanical switch
 * @SND_JACK_VIDEOOUT: Video out
 * @SND_JACK_AVOUT: AV (Audio Video) out
 * @SND_JACK_LINEIN:  Line in
 * @SND_JACK_BTN_0: Button 0
 * @SND_JACK_BTN_1: Button 1
 * @SND_JACK_BTN_2: Button 2
 * @SND_JACK_BTN_3: Button 3
 * @SND_JACK_BTN_4: Button 4
 * @SND_JACK_BTN_5: Button 5
 *
 * These values are used as a bitmask.
 *
 * Note that this must be kept in sync with the lookup table in
 * sound/core/jack.c.
 */
enum snd_jack_types {
	SND_JACK_HEADPHONE	= 0x0001,
	SND_JACK_MICROPHONE	= 0x0002,
	SND_JACK_HEADSET	= SND_JACK_HEADPHONE | SND_JACK_MICROPHONE,
	SND_JACK_LINEOUT	= 0x0004,
	SND_JACK_MECHANICAL	= 0x0008, /* If detected separately */
	SND_JACK_VIDEOOUT	= 0x0010,
	SND_JACK_AVOUT		= SND_JACK_LINEOUT | SND_JACK_VIDEOOUT,
	SND_JACK_LINEIN		= 0x0020,

	/* Kept separate from switches to facilitate implementation */
	SND_JACK_BTN_0		= 0x4000,
	SND_JACK_BTN_1		= 0x2000,
	SND_JACK_BTN_2		= 0x1000,
	SND_JACK_BTN_3		= 0x0800,
	SND_JACK_BTN_4		= 0x0400,
	SND_JACK_BTN_5		= 0x0200,
};

/* Keep in sync with definitions above */
#define SND_JACK_SWITCH_TYPES 6

struct snd_jack {
	struct input_dev *input_dev;
	int registered;
	int type;
	const char *id;
	char name[100];
	unsigned int key[6];   /* Keep in sync with definitions above */
	void *private_data;
	void (*private_free)(struct snd_jack *);
};

#ifdef CONFIG_SND_JACK

int snd_jack_new(struct snd_card *card, const char *id, int type,
		 struct snd_jack **jack);
void snd_jack_set_parent(struct snd_jack *jack, struct device *parent);
int snd_jack_set_key(struct snd_jack *jack, enum snd_jack_types type,
		     int keytype);

void snd_jack_report(struct snd_jack *jack, int status);

#else

static inline int snd_jack_new(struct snd_card *card, const char *id, int type,
			       struct snd_jack **jack)
{
	return 0;
}

static inline void snd_jack_set_parent(struct snd_jack *jack,
				       struct device *parent)
{
}

static inline int snd_jack_set_key(struct snd_jack *jack,
				   enum snd_jack_types type,
				   int keytype)
{
	return 0;
}

static inline void snd_jack_report(struct snd_jack *jack, int status)
{
}

#endif

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /*
 * linux/sound/rt5645.h -- Platform data for RT5645
 *
 * Copyright 2013 Realtek Microelectronics
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#ifndef __LINUX_SND_RT5645_H
#define __LINUX_SND_RT5645_H

struct rt5645_platform_data {
	/* IN2 can optionally be differential */
	bool in2_diff;

	bool dmic_en;
	unsigned int dmic1_data_pin;
	/* 0 = IN2N; 1 = GPIO5; 2 = GPIO11 */
	unsigned int dmic2_data_pin;
	/* 0 = IN2P; 1 = GPIO6; 2 = GPIO10; 3 = GPIO12 */

	unsigned int hp_det_gpio;
	bool gpio_hp_det_active_high;

	/* true if codec's jd function is used */
	bool en_jd_func;
	unsigned int jd_mode;
};

#endif
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    