"""distutils.file_util

Utility functions for operating on single files.
"""

__revision__ = "$Id$"

import os
from distutils.errors import DistutilsFileError
from distutils import log

# for generating verbose output in 'copy_file()'
_copy_action = {None: 'copying',
                'hard': 'hard linking',
                'sym': 'symbolically linking'}


def _copy_file_contents(src, dst, buffer_size=16*1024):
    """Copy the file 'src' to 'dst'.

    Both must be filenames. Any error opening either file, reading from
    'src', or writing to 'dst', raises DistutilsFileError.  Data is
    read/written in chunks of 'buffer_size' bytes (default 16k).  No attempt
    is made to handle anything apart from regular files.
    """
    # Stolen from shutil module in the standard library, but with
    # custom error-handling added.
    fsrc = None
    fdst = None
    try:
        try:
            fsrc = open(src, 'rb')
        except os.error, (errno, errstr):
            raise DistutilsFileError("could not open '%s': %s" % (src, errstr))

        if os.path.exists(dst):
            try:
                os.unlink(dst)
            except os.error, (errno, errstr):
                raise DistutilsFileError(
                      "could not delete '%s': %s" % (dst, errstr))

        try:
            fdst = open(dst, 'wb')
        except os.error, (errno, errstr):
            raise DistutilsFileError(
                  "could not create '%s': %s" % (dst, errstr))

        while 1:
            try:
                buf = fsrc.read(buffer_size)
            except os.error, (errno, errstr):
                raise DistutilsFileError(
                      "could not read from '%s': %s" % (src, errstr))

            if not buf:
                break

            try:
                fdst.write(buf)
            except os.error, (errno, errstr):
                raise DistutilsFileError(
                      "could not write to '%s': %s" % (dst, errstr))

    finally:
        if fdst:
            fdst.close()
        if fsrc:
            fsrc.close()

def copy_file(src, dst, preserve_mode=1, preserve_times=1, update=0,
              link=None, verbose=1, dry_run=0):
    """Copy a file 'src' to 'dst'.

    If 'dst' is a directory, then 'src' is copied there with the same name;
    otherwise, it must be a filename.  (If the file exists, it will be
    ruthlessly clobbered.)  If 'preserve_mode' is true (the default),
    the file's mode (type and permission bits, or whatever is analogous on
    the current platform) is copied.  If 'preserve_times' is true (the
    default), the last-modified and last-access times are copied as well.
    If 'update' is true, 'src' will only be copied if 'dst' does not exist,
    or if 'dst' does exist but is older than 'src'.

    'link' allows you to make hard links (os.link) or symbolic links
    (os.symlink) instead of copying: set it to "hard" or "sym"; if it is
    None (the default), files are copied.  Don't set 'link' on systems that
    don't support it: 'copy_file()' doesn't check if hard or symbolic
    linking is available. If hardlink fails, falls back to
    _copy_file_contents().

    Under Mac OS, uses the native file copy function in macostools; on
    other systems, uses '_copy_file_contents()' to copy file contents.

    Return a tuple (dest_name, copied): 'dest_name' is the actual name of
    the output file, and 'copied' is true if the file was copied (or would
    have been copied, if 'dry_run' true).
    """
    # XXX if the destination file already exists, we clobber it if
    # copying, but blow up if linking.  Hmmm.  And I don't know what
    # macostools.copyfile() does.  Should definitely be consistent, and
    # should probably blow up if destination exists and we would be
    # changing it (ie. it's not already a hard/soft link to src OR
    # (not update) and (src newer than dst).

    from distutils.dep_util import newer
    from stat import ST_ATIME, ST_MTIME, ST_MODE, S_IMODE

    if not os.path.isfile(src):
        raise DistutilsFileError(
              "can't copy '%s': doesn't exist or not a regular file" % src)

    if os.path.isdir(dst):
        dir = dst
        dst = os.path.join(dst, os.path.basename(src))
    else:
        dir = os.path.dirname(dst)

    if update and not newer(src, dst):
        if verbose >= 1:
            log.debug("not copying %s (output up-to-date)", src)
        return dst, 0

    try:
        action = _copy_action[link]
    except KeyError:
        raise ValueError("invalid value '%s' for 'link' argument" % link)

    if verbose >= 1:
        if os.path.basename(dst) == os.path.basename(src):
            log.info("%s %s -> %s", action, src, dir)
        else:
            log.info("%s %s -> %s", action, src, dst)

    if dry_run:
        return (dst, 1)

    # If linking (hard or symbolic), use the appropriate system call
    # (Unix only, of course, but that's the caller's responsibility)
    if link == 'hard':
        if not (os.path.exists(dst) and os.path.samefile(src, dst)):
            try:
                os.link(src, dst)
                return (dst, 1)
            except OSError:
                # If hard linking fails, fall back on copying file
                # (some special filesystems don't support hard linking
                #  even under Unix, see issue #8876).
                pass
    elif link == 'sym':
        if not (os.path.exists(dst) and os.path.samefile(src, dst)):
            os.symlink(src, dst)
            return (dst, 1)

    # Otherwise (non-Mac, not linking), copy the file contents and
    # (optionally) copy the times and mode.
    _copy_file_contents(src, dst)
    if preserve_mode or preserve_times:
        st = os.stat(src)

        # According to David Ascher <da@ski.org>, utime() should be done
        # before chmod() (at least under NT).
        if preserve_times:
            os.utime(dst, (st[ST_ATIME], st[ST_MTIME]))
        if preserve_mode:
            os.chmod(dst, S_IMODE(st[ST_MODE]))

    return (dst, 1)

# XXX I suspect this is Unix-specific -- need porting help!
def move_file (src, dst, verbose=1, dry_run=0):
    """Move a file 'src' to 'dst'.

    If 'dst' is a directory, the file will be moved into it with the same
    name; otherwise, 'src' is just renamed to 'dst'.  Return the new
    full name of the file.

    Handles cross-device moves on Unix using 'copy_file()'.  What about
    other systems???
    """
    from os.path import exists, isfile, isdir, basename, dirname
    import errno

    if verbose >= 1:
        log.info("moving %s -> %s", src, dst)

    if dry_run:
        return dst

    if not isfile(src):
        raise DistutilsFileError("can't move '%s': not a regular file" % src)

    if isdir(dst):
        dst = os.path.join(dst, basename(src))
    elif exists(dst):
        raise DistutilsFileError(
              "can't move '%s': destination '%s' already exists" %
              (src, dst))

    if not isdir(dirname(dst)):
        raise DistutilsFileError(
              "can't move '%s': destination '%s' not a valid path" % \
              (src, dst))

    copy_it = 0
    try:
        os.rename(src, dst)
    except os.error, (num, msg):
        if num == errno.EXDEV:
            copy_it = 1
        else:
            raise DistutilsFileError(
                  "couldn't move '%s' to '%s': %s" % (src, dst, msg))

    if copy_it:
        copy_file(src, dst, verbose=verbose)
        try:
            os.unlink(src)
        except os.error, (num, msg):
            try:
                os.unlink(dst)
            except os.error:
                pass
            raise DistutilsFileError(
                  ("couldn't move '%s' to '%s' by copy/delete: " +
                   "delete '%s' failed: %s") %
                  (src, dst, src, msg))
    return dst


def write_file (filename, contents):
    """Create a file with the specified name and write 'contents' (a
    sequence of strings without line terminators) to it.
    """
    f = open(filename, "w")
    try:
        for line in contents:
            f.write(line + "\n")
    finally:
        f.close()
                                                             """distutils.filelist

Provides the FileList class, used for poking about the filesystem
and building lists of files.
"""

__revision__ = "$Id$"

import os, re
import fnmatch
from distutils.util import convert_path
from distutils.errors import DistutilsTemplateError, DistutilsInternalError
from distutils import log

class FileList:
    """A list of files built by on exploring the filesystem and filtered by
    applying various patterns to what we find there.

    Instance attributes:
      dir
        directory from which files will be taken -- only used if
        'allfiles' not supplied to constructor
      files
        list of filenames currently being built/filtered/manipulated
      allfiles
        complete list of files under consideration (ie. without any
        filtering applied)
    """

    def __init__(self, warn=None, debug_print=None):
        # ignore argument to FileList, but keep them for backwards
        # compatibility
        self.allfiles = None
        self.files = []

    def set_allfiles(self, allfiles):
        self.allfiles = allfiles

    def findall(self, dir=os.curdir):
        self.allfiles = findall(dir)

    def debug_print(self, msg):
        """Print 'msg' to stdout if the global DEBUG (taken from the
        DISTUTILS_DEBUG environment variable) flag is true.
        """
        from distutils.debug import DEBUG
        if DEBUG:
            print msg

    # -- List-like methods ---------------------------------------------

    def append(self, item):
        self.files.append(item)

    def extend(self, items):
        self.files.extend(items)

    def sort(self):
        # Not a strict lexical sort!
        sortable_files = map(os.path.split, self.files)
        sortable_files.sort()
        self.files = []
        for sort_tuple in sortable_files:
            self.files.append(os.path.join(*sort_tuple))


    # -- Other miscellaneous utility methods ---------------------------

    def remove_duplicates(self):
        # Assumes list has been sorted!
        for i in range(len(self.files) - 1, 0, -1):
            if self.files[i] == self.files[i - 1]:
                del self.files[i]


    # -- "File template" methods ---------------------------------------

    def _parse_template_line(self, line):
        words = line.split()
        action = words[0]

        patterns = dir = dir_pattern = None

        if action in ('include', 'exclude',
                      'global-include', 'global-exclude'):
            if len(words) < 2:
                raise DistutilsTemplateError, \
                      "'%s' expects <pattern1> <pattern2> ..." % action

            patterns = map(convert_path, words[1:])

        elif action in ('recursive-include', 'recursive-exclude'):
            if len(words) < 3:
                raise DistutilsTemplateError, \
                      "'%s' expects <dir> <pattern1> <pattern2> ..." % action

            dir = convert_path(words[1])
            patterns = map(convert_path, words[2:])

        elif action in ('graft', 'prune'):
            if len(words) != 2:
                raise DistutilsTemplateError, \
                     "'%s' expects a single <dir_pattern>" % action

            dir_pattern = convert_path(words[1])

        else:
            raise DistutilsTemplateError, "unknown action '%s'" % action

        return (action, patterns, dir, dir_pattern)

    def process_template_line(self, line):
        # Parse the line: split it up, make sure the right number of words
        # is there, and return the relevant words.  'action' is always
        # defined: it's the first word of the line.  Which of the other
        # three are defined depends on the action; it'll be either
        # patterns, (dir and patterns), or (dir_pattern).
        action, patterns, dir, dir_pattern = self._parse_template_line(line)

        # OK, now we know that the action is valid and we have the
        # right number of words on the line for that action -- so we
        # can proceed with minimal error-checking.
        if action == 'include':
            self.debug_print("include " + ' '.join(patterns))
            for pattern in patterns:
                if not self.include_pattern(pattern, anchor=1):
                    log.warn("warning: no files found matching '%s'",
                             pattern)

        elif action == 'exclude':
            self.debug_print("exclude " + ' '.join(patterns))
            for pattern in patterns:
                if not self.exclude_pattern(pattern, anchor=1):
                    log.warn(("warning: no previously-included files "
                              "found matching '%s'"), pattern)

        elif action == 'global-include':
            self.debug_print("global-include " + ' '.join(patterns))
            for pattern in patterns:
                if not self.include_pattern(pattern, anchor=0):
                    log.warn(("warning: no files found matching '%s' " +
                              "anywhere in distribution"), pattern)

        elif action == 'global-exclude':
            self.debug_print("global-exclude " + ' '.join(patterns))
            for pattern in patterns:
                if not self.exclude_pattern(pattern, anchor=0):
                    log.warn(("warning: no previously-included files matching "
                              "'%s' found anywhere in distribution"),
                             pattern)

        elif action == 'recursive-include':
            self.debug_print("recursive-include %s %s" %
                             (dir, ' '.join(patterns)))
            for pattern in patterns:
                if not self.include_pattern(pattern, prefix=dir):
                    log.warn(("warning: no files found matching '%s' " +
                                "under directory '%s'"),
                             pattern, dir)

        elif action == 'recursive-exclude':
            self.debug_print("recursive-exclude %s %s" %
                             (dir, ' '.join(patterns)))
            for pattern in patterns:
                if not self.exclude_pattern(pattern, prefix=dir):
                    log.warn(("warning: no previously-included files matching "
                              "'%s' found under directory '%s'"),
                             pattern, dir)

        elif action == 'graft':
            self.debug_print("graft " + dir_pattern)
            if not self.include_pattern(None, prefix=dir_pattern):
                log.warn("warning: no directories found matching '%s'",
                         dir_pattern)

        elif action == 'prune':
            self.debug_print("prune " + dir_pattern)
            if not self.exclude_pattern(None, prefix=dir_pattern):
                log.warn(("no previously-included directories found " +
                          "matching '%s'"), dir_pattern)
        else:
            raise DistutilsInternalError, \
                  "this cannot happen: invalid action '%s'" % action

    # -- Filtering/selection methods -----------------------------------

    def include_pattern(self, pattern, anchor=1, prefix=None, is_regex=0):
        """Select strings (presumably filenames) from 'self.files' that
        match 'pattern', a Unix-style wildcard (glob) pattern.

        Patterns are not quite the same as implemented by the 'fnmatch'
        module: '*' and '?'  match non-special characters, where "special"
        is platform-dependent: slash on Unix; colon, slash, and backslash on
        DOS/Windows; and colon on Mac OS.

        If 'anchor' is true (the default), then the pattern match is more
        stringent: "*.py" will match "foo.py" but not "foo/bar.py".  If
        'anchor' is false, both of these will match.

        If 'prefix' is supplied, then only filenames starting with 'prefix'
        (itself a pattern) and ending with 'pattern', with anything in between
        them, will match.  'anchor' is ignored in this case.

        If 'is_regex' is true, 'anchor' and 'prefix' are ignored, and
        'pattern' is assumed to be either a string containing a regex or a
        regex object -- no translation is done, the regex is just compiled
        and used as-is.

        Selected strings will be added to self.files.

        Return 1 if files are found.
        """
        # XXX docstring lying about what the special chars are?
        files_found = 0
        pattern_re = translate_pattern(pattern, anchor, prefix, is_regex)
        self.debug_print("include_pattern: applying regex r'%s'" %
                         pattern_re.pattern)

        # delayed loading of allfiles list
        if self.allfiles is None:
            self.findall()

        for name in self.allfiles:
            if pattern_re.search(name):
                self.debug_print(" adding " + name)
                self.files.append(name)
                files_found = 1

        return files_found


    def exclude_pattern(self, pattern, anchor=1, prefix=None, is_regex=0):
        """Remove strings (presumably filenames) from 'files' that match
        'pattern'.

        Other parameters are the same as for 'include_pattern()', above.
        The list 'self.files' is modified in place. Return 1 if files are
        found.
        """
        files_found = 0
        pattern_re = translate_pattern(pattern, anchor, prefix, is_regex)
        self.debug_print("exclude_pattern: applying regex r'%s'" %
                         pattern_re.pattern)
        for i in range(len(self.files)-1, -1, -1):
            if pattern_re.search(self.files[i]):
                self.debug_print(" removing " + self.files[i])
                del self.files[i]
                files_found = 1

        return files_found


# ----------------------------------------------------------------------
# Utility functions

def findall(dir = os.curdir):
    """Find all files under 'dir' and return the list of full filenames
    (relative to 'dir').
    """
    from stat import ST_MODE, S_ISREG, S_ISDIR, S_ISLNK

    list = []
    stack = [dir]
    pop = stack.pop
    push = stack.append

    while stack:
        dir = pop()
        names = os.listdir(dir)

        for name in names:
            if dir != os.curdir:        # avoid the dreaded "./" syndrome
                fullname = os.path.join(dir, name)
            else:
                fullname = name

            # Avoid excess stat calls -- just one will do, thank you!
            stat = os.stat(fullname)
            mode = stat[ST_MODE]
            if S_ISREG(mode):
                list.append(fullname)
            elif S_ISDIR(mode) and not S_ISLNK(mode):
                push(fullname)

    return list


def glob_to_re(pattern):
    """Translate a shell-like glob pattern to a regular expression.

    Return a string containing the regex.  Differs from
    'fnmatch.translate()' in that '*' does not match "special characters"
    (which are platform-specific).
    """
    pattern_re = fnmatch.translate(pattern)

    # '?' and '*' in the glob pattern become '.' and '.*' in the RE, which
    # IMHO is wrong -- '?' and '*' aren't supposed to match slash in Unix,
    # and by extension they shouldn't match such "special characters" under
    # any OS.  So change all non-escaped dots in the RE to match any
    # character except the special characters (currently: just os.sep).
    sep = os.sep
    if os.sep == '\\':
        # we're using a regex to manipulate a regex, so we need
        # to escape the backslash twice
        sep = r'\\\\'
    escaped = r'\1[^%s]' % sep
    pattern_re = re.sub(r'((?<!\\)(\\\\)*)\.', escaped, pattern_re)
    return pattern_re


def translate_pattern(pattern, anchor=1, prefix=None, is_regex=0):
    """Translate a shell-like wildcard pattern to a compiled regular
    expression.

    Return the compiled regex.  If 'is_regex' true,
    then 'pattern' is directly compiled to a regex (if it's a string)
    or just returned as-is (assumes it's a regex object).
    """
    if is_regex:
        if isinstance(pattern, str):
            return re.compile(pattern)
        else:
            return pattern

    if pattern:
        pattern_re = glob_to_re(pattern)
    else:
        pattern_re = ''

    if prefix is not None:
        # ditch end of pattern character
        empty_pattern = glob_to_re('')
        prefix_re = glob_to_re(prefix)[:-len(empty_pattern)]
        sep = os.sep
        if os.sep == '\\':
            sep = r'\\'
        pattern_re = "^" + sep.join((prefix_re, ".*" + pattern_re))
    else:                               # no prefix -- respect anchor flag
        if anchor:
            pattern_re = "^" + pattern_re

    return re.compile(pattern_re)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               """A simple log mechanism styled after PEP 282."""

# The class here is styled after PEP 282 so that it could later be
# replaced with a standard Python logging implementation.

DEBUG = 1
INFO = 2
WARN = 3
ERROR = 4
FATAL = 5

import sys

class Log:

    def __init__(self, threshold=WARN):
        self.threshold = threshold

    def _log(self, level, msg, args):
        if level not in (DEBUG, INFO, WARN, ERROR, FATAL):
            raise ValueError('%s wrong log level' % str(level))

        if level >= self.threshold:
            if args:
                msg = msg % args
            if level in (WARN, ERROR, FATAL):
                stream = sys.stderr
            else:
                stream = sys.stdout
            stream.write('%s\n' % msg)
            stream.flush()

    def log(self, level, msg, *args):
        self._log(level, msg, args)

    def debug(self, msg, *args):
        self._log(DEBUG, msg, args)

    def info(self, msg, *args):
        self._log(INFO, msg, args)

    def warn(self, msg, *args):
        self._log(WARN, msg, args)

    def error(self, msg, *args):
        self._log(ERROR, msg, args)

    def fatal(self, msg, *args):
        self._log(FATAL, msg, args)

_global_log = Log()
log = _global_log.log
debug = _global_log.debug
info = _global_log.info
warn = _global_log.warn
error = _global_log.error
fatal = _global_log.fatal

def set_threshold(level):
    # return the old threshold for use from tests
    old = _global_log.threshold
    _global_log.threshold = level
    return old

def set_verbosity(v):
    if v <= 0:
        set_threshold(WARN)
    elif v == 1:
        set_threshold(INFO)
    elif v >= 2:
        set_threshold(DEBUG)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          """distutils.msvc9compiler

Contains MSVCCompiler, an implementation of the abstract CCompiler class
for the Microsoft Visual Studio 2008.

The module is compatible with VS 2005 and VS 2008. You can find legacy support
for older versions of VS in distutils.msvccompiler.
"""

# Written by Perry Stoll
# hacked by Robin Becker and Thomas Heller to do a better job of
#   finding DevStudio (through the registry)
# ported to VS2005 and VS 2008 by Christian Heimes

__revision__ = "$Id$"

import os
import subprocess
import sys
import re

from distutils.errors import (DistutilsExecError, DistutilsPlatformError,
                              CompileError, LibError, LinkError)
from distutils.ccompiler import CCompiler, gen_lib_options
from distutils import log
from distutils.util import get_platform

import _winreg

RegOpenKeyEx = _winreg.OpenKeyEx
RegEnumKey = _winreg.EnumKey
RegEnumValue = _winreg.EnumValue
RegError = _winreg.error

HKEYS = (_winreg.HKEY_USERS,
         _winreg.HKEY_CURRENT_USER,
         _winreg.HKEY_LOCAL_MACHINE,
         _winreg.HKEY_CLASSES_ROOT)

NATIVE_WIN64 = (sys.platform == 'win32' and sys.maxsize > 2**32)
if NATIVE_WIN64:
    # Visual C++ is a 32-bit application, so we need to look in
    # the corresponding registry branch, if we're running a
    # 64-bit Python on Win64
    VS_BASE = r"Software\Wow6432Node\Microsoft\VisualStudio\%0.1f"
    VSEXPRESS_BASE = r"Software\Wow6432Node\Microsoft\VCExpress\%0.1f"
    WINSDK_BASE = r"Software\Wow6432Node\Microsoft\Microsoft SDKs\Windows"
    NET_BASE = r"Software\Wow6432Node\Microsoft\.NETFramework"
else:
    VS_BASE = r"Software\Microsoft\VisualStudio\%0.1f"
    VSEXPRESS_BASE = r"Software\Microsoft\VCExpress\%0.1f"
    WINSDK_BASE = r"Software\Microsoft\Microsoft SDKs\Windows"
    NET_BASE = r"Software\Microsoft\.NETFramework"

# A map keyed by get_platform() return values to values accepted by
# 'vcvarsall.bat'.  Note a cross-compile may combine these (eg, 'x86_amd64' is
# the param to cross-compile on x86 targetting amd64.)
PLAT_TO_VCVARS = {
    'win32' : 'x86',
    'win-amd64' : 'amd64',
    'win-ia64' : 'ia64',
}

class Reg:
    """Helper class to read values from the registry
    """

    def get_value(cls, path, key):
        for base in HKEYS:
            d = cls.read_values(base, path)
            if d and key in d:
                return d[key]
        raise KeyError(key)
    get_value = classmethod(get_value)

    def read_keys(cls, base, key):
        """Return list of registry keys."""
        try:
            handle = RegOpenKeyEx(base, key)
        except RegError:
            return None
        L = []
        i = 0
        while True:
            try:
                k = RegEnumKey(handle, i)
            except RegError:
                break
            L.append(k)
            i += 1
        return L
    read_keys = classmethod(read_keys)

    def read_values(cls, base, key):
        """Return dict of registry keys and values.

        All names are converted to lowercase.
        """
        try:
            handle = RegOpenKeyEx(base, key)
        except RegError:
            return None
        d = {}
        i = 0
        while True:
            try:
                name, value, type = RegEnumValue(handle, i)
            except RegError:
                break
            name = name.lower()
            d[cls.convert_mbcs(name)] = cls.convert_mbcs(value)
            i += 1
        return d
    read_values = classmethod(read_values)

    def convert_mbcs(s):
        dec = getattr(s, "decode", None)
        if dec is not None:
            try:
                s = dec("mbcs")
            except UnicodeError:
                pass
        return s
    convert_mbcs = staticmethod(convert_mbcs)

class MacroExpander:

    def __init__(self, version):
        self.macros = {}
        self.vsbase = VS_BASE % version
        self.load_macros(version)

    def set_macro(self, macro, path, key):
        self.macros["$(%s)" % macro] = Reg.get_value(path, key)

    def load_macros(self, version):
        self.set_macro("VCInstallDir", self.vsbase + r"\Setup\VC", "productdir")
        self.set_macro("VSInstallDir", self.vsbase + r"\Setup\VS", "productdir")
        self.set_macro("FrameworkDir", NET_BASE, "installroot")
        try:
            if version >= 8.0:
                self.set_macro("FrameworkSDKDir", NET_BASE,
                               "sdkinstallrootv2.0")
            else:
                raise KeyError("sdkinstallrootv2.0")
        except KeyError:
            raise DistutilsPlatformError(
            """Python was built with Visual Studio 2008;
extensions must be built with a compiler than can generate compatible binaries.
Visual Studio 2008 was not found on this system. If you have Cygwin installed,
you can try compiling with MingW32, by passing "-c mingw32" to setup.py.""")

        if version >= 9.0:
            self.set_macro("FrameworkVersion", self.vsbase, "clr version")
            self.set_macro("WindowsSdkDir", WINSDK_BASE, "currentinstallfolder")
        else:
            p = r"Software\Microsoft\NET Framework Setup\Product"
            for base in HKEYS:
                try:
                    h = RegOpenKeyEx(base, p)
                except RegError:
                    continue
                key = RegEnumKey(h, 0)
                d = Reg.get_value(base, r"%s\%s" % (p, key))
                self.macros["$(FrameworkVersion)"] = d["version"]

    def sub(self, s):
        for k, v in self.macros.items():
            s = s.replace(k, v)
        return s

def get_build_version():
    """Return the version of MSVC that was used to build Python.

    For Python 2.3 and up, the version number is included in
    sys.version.  For earlier versions, assume the compiler is MSVC 6.
    """
    prefix = "MSC v."
    i = sys.version.find(prefix)
    if i == -1:
        return 6
    i = i + len(prefix)
    s, rest = sys.version[i:].split(" ", 1)
    majorVersion = int(s[:-2]) - 6
    minorVersion = int(s[2:3]) / 10.0
    # I don't think paths are affected by minor version in version 6
    if majorVersion == 6:
        minorVersion = 0
    if majorVersion >= 6:
        return majorVersion + minorVersion
    # else we don't know what version of the compiler this is
    return None

def normalize_and_reduce_paths(paths):
    """Return a list of normalized paths with duplicates removed.

    The current order of paths is maintained.
    """
    # Paths are normalized so things like:  /a and /a/ aren't both preserved.
    reduced_paths = []
    for p in paths:
        np = os.path.normpath(p)
        # XXX(nnorwitz): O(n**2), if reduced_paths gets long perhaps use a set.
        if np not in reduced_paths:
            reduced_paths.append(np)
    return reduced_paths

def removeDuplicates(variable):
    """Remove duplicate values of an environment variable.
    """
    oldList = variable.split(os.pathsep)
    newList = []
    for i in oldList:
        if i not in newList:
            newList.append(i)
    newVariable = os.pathsep.join(newList)
    return newVariable

def find_vcvarsall(version):
    """Find the vcvarsall.bat file

    At first it tries to find the productdir of VS 2008 in the registry. If
    that fails it falls back to the VS90COMNTOOLS env var.
    """
    vsbase = VS_BASE % version
    try:
        productdir = Reg.get_value(r"%s\Setup\VC" % vsbase,
                                   "productdir")
    except KeyError:
        productdir = None

    # trying Express edition
    if productdir is None:
        vsbase = VSEXPRESS_BASE % version
        try:
            productdir = Reg.get_value(r"%s\Setup\VC" % vsbase,
                                       "productdir")
        except KeyError:
            productdir = None
            log.debug("Unable to find productdir in registry")

    if not productdir or not os.path.isdir(productdir):
        toolskey = "VS%0.f0COMNTOOLS" % version
        toolsdir = os.environ.get(toolskey, None)

        if toolsdir and os.path.isdir(toolsdir):
            productdir = os.path.join(toolsdir, os.pardir, os.pardir, "VC")
            productdir = os.path.abspath(productdir)
            if not os.path.isdir(productdir):
                log.debug("%s is not a valid directory" % productdir)
                return None
        else:
            log.debug("Env var %s is not set or invalid" % toolskey)
    if not productdir:
        log.debug("No productdir found")
        return None
    vcvarsall = os.path.join(productdir, "vcvarsall.bat")
    if os.path.isfile(vcvarsall):
        return vcvarsall
    log.debug("Unable to find vcvarsall.bat")
    return None

def query_vcvarsall(version, arch="x86"):
    """Launch vcvarsall.bat and read the settings from its environment
    """
    vcvarsall = find_vcvarsall(version)
    interesting = set(("include", "lib", "libpath", "path"))
    result = {}

    if vcvarsall is None:
        raise DistutilsPlatformError("Unable to find vcvarsall.bat")
    log.debug("Calling 'vcvarsall.bat %s' (version=%s)", arch, version)
    popen = subprocess.Popen('"%s" %s & set' % (vcvarsall, arch),
                             stdout=subprocess.PIPE,
                             stderr=subprocess.PIPE)
    try:
        stdout, stderr = popen.communicate()
        if popen.wait() != 0:
            raise DistutilsPlatformError(stderr.decode("mbcs"))

        stdout = stdout.decode("mbcs")
        for line in stdout.split("\n"):
            line = Reg.convert_mbcs(line)
            if '=' not in line:
                continue
            line = line.strip()
            key, value = line.split('=', 1)
            key = key.lower()
            if key in interesting:
                if value.endswith(os.pathsep):
                    value = value[:-1]
                result[key] = removeDuplicates(value)

    finally:
        popen.stdout.close()
        popen.stderr.close()

    if len(result) != len(interesting):
        raise ValueError(str(list(result.keys())))

    return result

# More globals
VERSION = get_build_version()
if VERSION < 8.0:
    raise DistutilsPlatformError("VC %0.1f is not supported by this module" % VERSION)
# MACROS = MacroExpander(VERSION)

class MSVCCompiler(CCompiler) :
    """Concrete class that implements an interface to Microsoft Visual C++,
       as defined by the CCompiler abstract class."""

    compiler_type = 'msvc'

    # Just set this so CCompiler's constructor doesn't barf.  We currently
    # don't use the 'set_executables()' bureaucracy provided by CCompiler,
    # as it really isn't necessary for this sort of single-compiler class.
    # Would be nice to have a consistent interface with UnixCCompiler,
    # though, so it's worth thinking about.
    executables = {}

    # Private class data (need to distinguish C from C++ source for compiler)
    _c_extensions = ['.c']
    _cpp_extensions = ['.cc', '.cpp', '.cxx']
    _rc_extensions = ['.rc']
    _mc_extensions = ['.mc']

    # Needed for the filename generation methods provided by the
    # base class, CCompiler.
    src_extensions = (_c_extensions + _cpp_extensions +
                      _rc_extensions + _mc_extensions)
    res_extension = '.res'
    obj_extension = '.obj'
    static_lib_extension = '.lib'
    shared_lib_extension = '.dll'
    static_lib_format = shared_lib_format = '%s%s'
    exe_extension = '.exe'

    def __init__(self, verbose=0, dry_run=0, force=0):
        CCompiler.__init__ (self, verbose, dry_run, force)
        self.__version = VERSION
        self.__root = r"Software\Microsoft\VisualStudio"
        # self.__macros = MACROS
        self.__paths = []
        # target platform (.plat_name is consistent with 'bdist')
        self.plat_name = None
        self.__arch = None # deprecated name
        self.initialized = False

    def initialize(self, plat_name=None):
        # multi-init means we would need to check platform same each time...
        assert not self.initialized, "don't init multiple times"
        if plat_name is None:
            plat_name = get_platform()
        # sanity check for platforms to prevent obscure errors later.
        ok_plats = 'win32', 'win-amd64', 'win-ia64'
        if plat_name not in ok_plats:
            raise DistutilsPlatformError("--plat-name must be one of %s" %
                                         (ok_plats,))

        if "DISTUTILS_USE_SDK" in os.environ and "MSSdk" in os.environ and self.find_exe("cl.exe"):
            # Assume that the SDK set up everything alright; don't try to be
            # smarter
            self.cc = "cl.exe"
            self.linker = "link.exe"
            self.lib = "lib.exe"
            self.rc = "rc.exe"
            self.mc = "mc.exe"
        else:
            # On x86, 'vcvars32.bat amd64' creates an env that doesn't work;
            # to cross compile, you use 'x86_amd64'.
            # On AMD64, 'vcvars32.bat amd64' is a native build env; to cross
            # compile use 'x86' (ie, it runs the x86 compiler directly)
            # No idea how itanium handles this, if at all.
            if plat_name == get_platform() or plat_name == 'win32':
                # native build or cross-compile to win32
                plat_spec = PLAT_TO_VCVARS[plat_name]
            else:
                # cross compile from win32 -> some 64bit
                plat_spec = PLAT_TO_VCVARS[get_platform()] + '_' + \
                            PLAT_TO_VCVARS[plat_name]

            vc_env = query_vcvarsall(VERSION, plat_spec)

            # take care to only use strings in the environment.
            self.__paths = vc_env['path'].encode('mbcs').split(os.pathsep)
            os.environ['lib'] = vc_env['lib'].encode('mbcs')
            os.environ['include'] = vc_env['include'].encode('mbcs')

            if len(self.__paths) == 0:
                raise DistutilsPlatformError("Python was built with %s, "
                       "and extensions need to be built with the same "
                       "version of the compiler, but it isn't installed."
                       % self.__product)

            self.cc = self.find_exe("cl.exe")
            self.linker = self.find_exe("link.exe")
            self.lib = self.find_exe("lib.exe")
            self.rc = self.find_exe("rc.exe")   # resource compiler
            self.mc = self.find_exe("mc.exe")   # message compiler
            #self.set_path_env_var('lib')
            #self.set_path_env_var('include')

        # extend the MSVC path with the current path
        try:
            for p in os.environ['path'].split(';'):
                self.__paths.append(p)
        except KeyError:
            pass
        self.__paths = normalize_and_reduce_paths(self.__paths)
        os.environ['path'] = ";".join(self.__paths)

        self.preprocess_options = None
        if self.__arch == "x86":
            self.compile_options = [ '/nologo', '/Ox', '/MD', '/W3',
                                     '/DNDEBUG']
            self.compile_options_debug = ['/nologo', '/Od', '/MDd', '/W3',
                                          '/Z7', '/D_DEBUG']
        else:
            # Win64
            self.compile_options = [ '/nologo', '/Ox', '/MD', '/W3', '/GS-' ,
                                     '/DNDEBUG']
            self.compile_options_debug = ['/nologo', '/Od', '/MDd', '/W3', '/GS-',
                                          '/Z7', '/D_DEBUG']

        self.ldflags_shared = ['/DLL', '/nologo', '/INCREMENTAL:NO']
        if self.__version >= 7:
            self.ldflags_shared_debug = [
                '/DLL', '/nologo', '/INCREMENTAL:no', '/DEBUG', '/pdb:None'
                ]
        self.ldflags_static = [ '/nologo']

        self.initialized = True

    # -- Worker methods ------------------------------------------------

    def object_filenames(self,
                         source_filenames,
                         strip_dir=0,
                         output_dir=''):
        # Copied from ccompiler.py, extended to return .res as 'object'-file
        # for .rc input file
        if output_dir is None: output_dir = ''
        obj_names = []
        for src_name in source_filenames:
            (base, ext) = os.path.splitext (src_name)
            base = os.path.splitdrive(base)[1] # Chop off the drive
            base = base[os.path.isabs(base):]  # If abs, chop off leading /
            if ext not in self.src_extensions:
                # Better to raise an exception instead of silently continuing
                # and later complain about sources and targets having
                # different lengths
                raise CompileError ("Don't know how to compile %s" % src_name)
            if strip_dir:
                base = os.path.basename (base)
            if ext in self._rc_extensions:
                obj_names.append (os.path.join (output_dir,
                                                base + self.res_extension))
            elif ext in self._mc_extensions:
                obj_names.append (os.path.join (output_dir,
                                                base + self.res_extension))
            else:
                obj_names.append (os.path.join (output_dir,
                                                base + self.obj_extension))
        return obj_names


    def compile(self, sources,
                output_dir=None, macros=None, include_dirs=None, debug=0,
                extra_preargs=None, extra_postargs=None, depends=None):

        if not self.initialized:
            self.initialize()
        compile_info = self._setup_compile(output_dir, macros, include_dirs,
                                           sources, depends, extra_postargs)
        macros, objects, extra_postargs, pp_opts, build = compile_info

        compile_opts = extra_preargs or []
        compile_opts.append ('/c')
        if debug:
            compile_opts.extend(self.compile_options_debug)
        else:
            compile_opts.extend(self.compile_options)

        for obj in objects:
            try:
                src, ext = build[obj]
            except KeyError:
                continue
            if debug:
                # pass the full pathname to MSVC in debug mode,
                # this allows the debugger to find the source file
                # without asking the user to browse for it
                src = os.path.abspath(src)

            if ext in self._c_extensions:
                input_opt = "/Tc" + src
            elif ext in self._cpp_extensions:
                input_opt = "/Tp" + src
            elif ext in self._rc_extensions:
                # compile .RC to .RES file
                input_opt = src
                output_opt = "/fo" + obj
                try:
                    self.spawn([self.rc] + pp_opts +
                               [output_opt] + [input_opt])
                except DistutilsExecError, msg:
                    raise CompileError(msg)
                continue
            elif ext in self._mc_extensions:
                # Compile .MC to .RC file to .RES file.
                #   * '-h dir' specifies the directory for the
                #     generated include file
                #   * '-r dir' specifies the target directory of the
                #     generated RC file and the binary message resource
                #     it includes
                #
                # For now (since there are no options to change this),
                # we use the source-directory for the include file and
                # the build directory for the RC file and message
                # resources. This works at least for win32all.
                h_dir = os.path.dirname(src)
                rc_dir = os.path.dirname(obj)
                try:
                    # first compile .MC to .RC and .H file
                    self.spawn([self.mc] +
                               ['-h', h_dir, '-r', rc_dir] + [src])
                    base, _ = os.path.splitext (os.path.basename (src))
                    rc_file = os.path.join (rc_dir, base + '.rc')
                    # then compile .RC to .RES file
                    self.spawn([self.rc] +
                               ["/fo" + obj] + [rc_file])

                except DistutilsExecError, msg:
                    raise CompileError(msg)
                continue
            else:
                # how to handle this file?
                raise CompileError("Don't know how to compile %s to %s"
                                   % (src, obj))

            output_opt = "/Fo" + obj
            try:
                self.spawn([self.cc] + compile_opts + pp_opts +
                           [input_opt, output_opt] +
                           extra_postargs)
            except DistutilsExecError, msg:
                raise CompileError(msg)

        return objects


    def create_static_lib(self,
                          objects,
                          output_libname,
                          output_dir=None,
                          debug=0,
                          target_lang=None):

        if not self.initialized:
            self.initialize()
        (objects, output_dir) = self._fix_object_args(objects, output_dir)
        output_filename = self.library_filename(output_libname,
                                                output_dir=output_dir)

        if self._need_link(objects, output_filename):
            lib_args = objects + ['/OUT:' + output_filename]
            if debug:
                pass # XXX what goes here?
            try:
                self.spawn([self.lib] + lib_args)
            except DistutilsExecError, msg:
                raise LibError(msg)
        else:
            log.debug("skipping %s (up-to-date)", output_filename)


    def link(self,
             target_desc,
             objects,
             output_filename,
             output_dir=None,
             libraries=None,
             library_dirs=None,
             runtime_library_dirs=None,
             export_symbols=None,
             debug=0,
             extra_preargs=None,
             extra_postargs=None,
             build_temp=None,
             target_lang=None):

        if not self.initialized:
            self.initialize()
        (objects, output_dir) = self._fix_object_args(objects, output_dir)
        fixed_args = self._fix_lib_args(libraries, library_dirs,
                                        runtime_library_dirs)
        (libraries, library_dirs, runtime_library_dirs) = fixed_args

        if runtime_library_dirs:
            self.warn ("I don't know what to do with 'runtime_library_dirs': "
                       + str (runtime_library_dirs))

        lib_opts = gen_lib_options(self,
                                   library_dirs, runtime_library_dirs,
                                   libraries)
        if output_dir is not None:
            output_filename = os.path.join(output_dir, output_filename)

        if self._need_link(objects, output_filename):
            if target_desc == CCompiler.EXECUTABLE:
                if debug:
                    ldflags = self.ldflags_shared_debug[1:]
                else:
                    ldflags = self.ldflags_shared[1:]
            else:
                if debug:
                    ldflags = self.ldflags_shared_debug
                else:
                    ldflags = self.ldflags_shared

            export_opts = []
            for sym in (export_symbols or []):
                export_opts.append("/EXPORT:" + sym)

            ld_args = (ldflags + lib_opts + export_opts +
                       objects + ['/OUT:' + output_filename])

            # The MSVC linker generates .lib and .exp files, which cannot be
            # suppressed by any linker switches. The .lib files may even be
            # needed! Make sure they are generated in the temporary build
            # directory. Since they have different names for debug and release
            # builds, they can go into the same directory.
            build_temp = os.path.dirname(objects[0])
            if export_symbols is not None:
                (dll_name, dll_ext) = os.path.splitext(
                    os.path.basename(output_filename))
                implib_file = os.path.join(
                    build_temp,
                    self.library_filename(dll_name))
                ld_args.append ('/IMPLIB:' + implib_file)

            self.manifest_setup_ldargs(output_filename, build_temp, ld_args)

            if extra_preargs:
                ld_args[:0] = extra_preargs
            if extra_postargs:
                ld_args.extend(extra_postargs)

            self.mkpath(os.path.dirname(output_filename))
            try:
                self.spawn([self.linker] + ld_args)
            except DistutilsExecError, msg:
                raise LinkError(msg)

            # embed the manifest
            # XXX - this is somewhat fragile - if mt.exe fails, distutils
            # will still consider the DLL up-to-date, but it will not have a
            # manifest.  Maybe we should link to a temp file?  OTOH, that
            # implies a build environment error that shouldn't go undetected.
            mfinfo = self.manifest_get_embed_info(target_desc, ld_args)
            if mfinfo is not None:
                mffilename, mfid = mfinfo
                out_arg = '-outputresource:%s;%s' % (output_filename, mfid)
                try:
                    self.spawn(['mt.exe', '-nologo', '-manifest',
                                mffilename, out_arg])
                except DistutilsExecError, msg:
                    raise LinkError(msg)
        else:
            log.debug("skipping %s (up-to-date)", output_filename)

    def manifest_setup_ldargs(self, output_filename, build_temp, ld_args):
        # If we need a manifest at all, an embedded manifest is recommended.
        # See MSDN article titled
        # "How to: Embed a Manifest Inside a C/C++ Application"
        # (currently at http://msdn2.microsoft.com/en-us/library/ms235591(VS.80).aspx)
        # Ask the linker to generate the manifest in the temp dir, so
        # we can check it, and possibly embed it, later.
        temp_manifest = os.path.join(
                build_temp,
                os.path.basename(output_filename) + ".manifest")
        ld_args.append('/MANIFESTFILE:' + temp_manifest)

    def manifest_get_embed_info(self, target_desc, ld_args):
        # If a manifest should be embedded, return a tuple of
        # (manifest_filename, resource_id).  Returns None if no manifest
        # should be embedded.  See http://bugs.python.org/issue7833 for why
        # we want to avoid any manifest for extension modules if we can)
        for arg in ld_args:
            if arg.startswith("/MANIFESTFILE:"):
                temp_manifest = arg.split(":", 1)[1]
                break
        else:
            # no /MANIFESTFILE so nothing to do.
            return None
        if target_desc == CCompiler.EXECUTABLE:
            # by default, executables always get the manifest with the
            # CRT referenced.
            mfid = 1
        else:
            # Extension modules try and avoid any manifest if possible.
            mfid = 2
            temp_manifest = self._remove_visual_c_ref(temp_manifest)
        if temp_manifest is None:
            return None
        return temp_manifest, mfid

    def _remove_visual_c_ref(self, manifest_file):
        try:
            # Remove references to the Visual C runtime, so they will
            # fall through to the Visual C dependency of Python.exe.
            # This way, when installed for a restricted user (e.g.
            # runtimes are not in WinSxS folder, but in Python's own
            # folder), the runtimes do not need to be in every folder
            # with .pyd's.
            # Returns either the filename of the modified manifest or
            # None if no manifest should be embedded.
            manifest_f = open(manifest_file)
            try:
                manifest_buf = manifest_f.read()
            finally:
                manifest_f.close()
            pattern = re.compile(
                r"""<assemblyIdentity.*?name=("|')Microsoft\."""\
                r"""VC\d{2}\.CRT("|').*?(/>|</assemblyIdentity>)""",
                re.DOTALL)
            manifest_buf = re.sub(pattern, "", manifest_buf)
            pattern = "<dependentAssembly>\s*</dependentAssembly>"
            manifest_buf = re.sub(pattern, "", manifest_buf)
            # Now see if any other assemblies are referenced - if not, we
            # don't want a manifest embedded.
            pattern = re.compile(
                r"""<assemblyIdentity.*?name=(?:"|')(.+?)(?:"|')"""
                r""".*?(?:/>|</assemblyIdentity>)""", re.DOTALL)
            if re.search(pattern, manifest_buf) is None:
                return None

            manifest_f = open(manifest_file, 'w')
            try:
                manifest_f.write(manifest_buf)
                return manifest_file
            finally:
                manifest_f.close()
        except IOError:
            pass

    # -- Miscellaneous methods -----------------------------------------
    # These are all used by the 'gen_lib_options() function, in
    # ccompiler.py.

    def library_dir_option(self, dir):
        return "/LIBPATH:" + dir

    def runtime_library_dir_option(self, dir):
        raise DistutilsPlatformError(
              "don't know how to set runtime library search path for MSVC++")

    def library_option(self, lib):
        return self.library_filename(lib)


    def find_library_file(self, dirs, lib, debug=0):
        # Prefer a debugging library if found (and requested), but deal
        # with it if we don't have one.
        if debug:
            try_names = [lib + "_d", lib]
        else:
            try_names = [lib]
        for dir in dirs:
            for name in try_names:
                libfile = os.path.join(dir, self.library_filename (name))
                if os.path.exists(libfile):
                    return libfile
        else:
            # Oops, didn't find it in *any* of 'dirs'
            return None

    # Helper methods for using the MSVC registry settings

    def find_exe(self, exe):
        """Return path to an MSVC executable program.

        Tries to find the program in several places: first, one of the
        MSVC program search paths from the registry; next, the directories
        in the PATH environment variable.  If any of those work, return an
        absolute path that is known to exist.  If none of them work, just
        return the original program name, 'exe'.
        """
        for p in self.__paths:
            fn = os.path.join(os.path.abspath(p), exe)
            if os.path.isfile(fn):
                return fn

        # didn't find it; try existing path
        for p in os.environ['Path'].split(';'):
            fn = os.path.join(os.path.abspath(p),exe)
            if os.path.isfile(fn):
                return fn

        return exe
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      """distutils.msvccompiler

Contains MSVCCompiler, an implementation of the abstract CCompiler class
for the Microsoft Visual Studio.
"""

# Written by Perry Stoll
# hacked by Robin Becker and Thomas Heller to do a better job of
#   finding DevStudio (through the registry)

__revision__ = "$Id$"

import sys
import os
import string

from distutils.errors import (DistutilsExecError, DistutilsPlatformError,
                              CompileError, LibError, LinkError)
from distutils.ccompiler import CCompiler, gen_lib_options
from distutils import log

_can_read_reg = 0
try:
    import _winreg

    _can_read_reg = 1
    hkey_mod = _winreg

    RegOpenKeyEx = _winreg.OpenKeyEx
    RegEnumKey = _winreg.EnumKey
    RegEnumValue = _winreg.EnumValue
    RegError = _winreg.error

except ImportError:
    try:
        import win32api
        import win32con
        _can_read_reg = 1
        hkey_mod = win32con

        RegOpenKeyEx = win32api.RegOpenKeyEx
        RegEnumKey = win32api.RegEnumKey
        RegEnumValue = win32api.RegEnumValue
        RegError = win32api.error

    except ImportError:
        log.info("Warning: Can't read registry to find the "
                 "necessary compiler setting\n"
                 "Make sure that Python modules _winreg, "
                 "win32api or win32con are installed.")
        pass

if _can_read_reg:
    HKEYS = (hkey_mod.HKEY_USERS,
             hkey_mod.HKEY_CURRENT_USER,
             hkey_mod.HKEY_LOCAL_MACHINE,
             hkey_mod.HKEY_CLASSES_ROOT)

def read_keys(base, key):
    """Return list of registry keys."""

    try:
        handle = RegOpenKeyEx(base, key)
    except RegError:
        return None
    L = []
    i = 0
    while 1:
        try:
            k = RegEnumKey(handle, i)
        except RegError:
            break
        L.append(k)
        i = i + 1
    return L

def read_values(base, key):
    """Return dict of registry keys and values.

    All names are converted to lowercase.
    """
    try:
        handle = RegOpenKeyEx(base, key)
    except RegError:
        return None
    d = {}
    i = 0
    while 1:
        try:
            name, value, type = RegEnumValue(handle, i)
        except RegError:
            break
        name = name.lower()
        d[convert_mbcs(name)] = convert_mbcs(value)
        i = i + 1
    return d

def convert_mbcs(s):
    enc = getattr(s, "encode", None)
    if enc is not None:
        try:
            s = enc("mbcs")
        except UnicodeError:
            pass
    return s

class MacroExpander:

    def __init__(self, version):
        self.macros = {}
        self.load_macros(version)

    def set_macro(self, macro, path, key):
        for base in HKEYS:
            d = read_values(base, path)
            if d:
                self.macros["$(%s)" % macro] = d[key]
                break

    def load_macros(self, version):
        vsbase = r"Software\Microsoft\VisualStudio\%0.1f" % version
        self.set_macro("VCInstallDir", vsbase + r"\Setup\VC", "productdir")
        self.set_macro("VSInstallDir", vsbase + r"\Setup\VS", "productdir")
        net = r"Software\Microsoft\.NETFramework"
        self.set_macro("FrameworkDir", net, "installroot")
        try:
            if version > 7.0:
                self.set_macro("FrameworkSDKDir", net, "sdkinstallrootv1.1")
            else:
                self.set_macro("FrameworkSDKDir", net, "sdkinstallroot")
        except KeyError:
            raise DistutilsPlatformError, \
                  ("""Python was built with Visual Studio 2003;
extensions must be built with a compiler than can generate compatible binaries.
Visual Studio 2003 was not found on this system. If you have Cygwin installed,
you can try compiling with MingW32, by passing "-c mingw32" to setup.py.""")

        p = r"Software\Microsoft\NET Framework Setup\Product"
        for base in HKEYS:
            try:
                h = RegOpenKeyEx(base, p)
            except RegError:
                continue
            key = RegEnumKey(h, 0)
            d = read_values(base, r"%s\%s" % (p, key))
            self.macros["$(FrameworkVersion)"] = d["version"]

    def sub(self, s):
        for k, v in self.macros.items():
            s = string.replace(s, k, v)
        return s

def get_build_version():
    """Return the version of MSVC that was used to build Python.

    For Python 2.3 and up, the version number is included in
    sys.version.  For earlier versions, assume the compiler is MSVC 6.
    """

    prefix = "MSC v."
    i = string.find(sys.version, prefix)
    if i == -1:
        return 6
    i = i + len(prefix)
    s, rest = sys.version[i:].split(" ", 1)
    majorVersion = int(s[:-2]) - 6
    minorVersion = int(s[2:3]) / 10.0
    # I don't think paths are affected by minor version in version 6
    if majorVersion == 6:
        minorVersion = 0
    if majorVersion >= 6:
        return majorVersion + minorVersion
    # else we don't know what version of the compiler this is
    return None

def get_build_architecture():
    """Return the processor architecture.

    Possible results are "Intel", "Itanium", or "AMD64".
    """

    prefix = " bit ("
    i = string.find(sys.version, prefix)
    if i == -1:
        return "Intel"
    j = string.find(sys.version, ")", i)
    return sys.version[i+len(prefix):j]

def normalize_and_reduce_paths(paths):
    """Return a list of normalized paths with duplicates removed.

    The current order of paths is maintained.
    """
    # Paths are normalized so things like:  /a and /a/ aren't both preserved.
    reduced_paths = []
    for p in paths:
        np = os.path.normpath(p)
        # XXX(nnorwitz): O(n**2), if reduced_paths gets long perhaps use a set.
        if np not in reduced_paths:
            reduced_paths.append(np)
    return reduced_paths


class MSVCCompiler (CCompiler) :
    """Concrete class that implements an interface to Microsoft Visual C++,
       as defined by the CCompiler abstract class."""

    compiler_type = 'msvc'

    # Just set this so CCompiler's constructor doesn't barf.  We currently
    # don't use the 'set_executables()' bureaucracy provided by CCompiler,
    # as it really isn't necessary for this sort of single-compiler class.
    # Would be nice to have a consistent interface with UnixCCompiler,
    # though, so it's worth thinking about.
    executables = {}

    # Private class data (need to distinguish C from C++ source for compiler)
    _c_extensions = ['.c']
    _cpp_extensions = ['.cc', '.cpp', '.cxx']
    _rc_extensions = ['.rc']
    _mc_extensions = ['.mc']

    # Needed for the filename generation methods provided by the
    # base class, CCompiler.
    src_extensions = (_c_extensions + _cpp_extensions +
                      _rc_extensions + _mc_extensions)
    res_extension = '.res'
    obj_extension = '.obj'
    static_lib_extension = '.lib'
    shared_lib_extension = '.dll'
    static_lib_format = shared_lib_format = '%s%s'
    exe_extension = '.exe'

    def __init__ (self, verbose=0, dry_run=0, force=0):
        CCompiler.__init__ (self, verbose, dry_run, force)
        self.__version = get_build_version()
        self.__arch = get_build_architecture()
        if self.__arch == "Intel":
            # x86
            if self.__version >= 7:
                self.__root = r"Software\Microsoft\VisualStudio"
                self.__macros = MacroExpander(self.__version)
            else:
                self.__root = r"Software\Microsoft\Devstudio"
            self.__product = "Visual Studio version %s" % self.__version
        else:
            # Win64. Assume this was built with the platform SDK
            self.__product = "Microsoft SDK compiler %s" % (self.__version + 6)

        self.initialized = False

    def initialize(self):
        self.__paths = []
        if "DISTUTILS_USE_SDK" in os.environ and "MSSdk" in os.environ and self.find_exe("cl.exe"):
            # Assume that the SDK set up everything alright; don't try to be
            # smarter
            self.cc = "cl.exe"
            self.linker = "link.exe"
            self.lib = "lib.exe"
            self.rc = "rc.exe"
            self.mc = "mc.exe"
        else:
            self.__paths = self.get_msvc_paths("path")

            if len (self.__paths) == 0:
                raise DistutilsPlatformError, \
                      ("Python was built with %s, "
                       "and extensions need to be built with the same "
                       "version of the compiler, but it isn't installed." % self.__product)

            self.cc = self.find_exe("cl.exe")
            self.linker = self.find_exe("link.exe")
            self.lib = self.find_exe("lib.exe")
            self.rc = self.find_exe("rc.exe")   # resource compiler
            self.mc = self.find_exe("mc.exe")   # message compiler
            self.set_path_env_var('lib')
            self.set_path_env_var('include')

        # extend the MSVC path with the current path
        try:
            for p in string.split(os.environ['path'], ';'):
                self.__paths.append(p)
        except KeyError:
            pass
        self.__paths = normalize_and_reduce_paths(self.__paths)
        os.environ['path'] = string.join(self.__paths, ';')

        self.preprocess_options = None
        if self.__arch == "Intel":
            self.compile_options = [ '/nologo', '/Ox', '/MD', '/W3', '/GX' ,
                                     '/DNDEBUG']
            self.compile_options_debug = ['/nologo', '/Od', '/MDd', '/W3', '/GX',
                                          '/Z7', '/D_DEBUG']
        else:
            # Win64
            self.compile_options = [ '/nologo', '/Ox', '/MD', '/W3', '/GS-' ,
                                     '/DNDEBUG']
            self.compile_options_debug = ['/nologo', '/Od', '/MDd', '/W3', '/GS-',
                                          '/Z7', '/D_DEBUG']

        self.ldflags_shared = ['/DLL', '/nologo', '/INCREMENTAL:NO']
        if self.__version >= 7:
            self.ldflags_shared_debug = [
                '/DLL', '/nologo', '/INCREMENTAL:no', '/DEBUG'
                ]
        else:
            self.ldflags_shared_debug = [
                '/DLL', '/nologo', '/INCREMENTAL:no', '/pdb:None', '/DEBUG'
                ]
        self.ldflags_static = [ '/nologo']

        self.initialized = True

    # -- Worker methods ------------------------------------------------

    def object_filenames (self,
                          source_filenames,
                          strip_dir=0,
                          output_dir=''):
        # Copied from ccompiler.py, extended to return .res as 'object'-file
        # for .rc input file
        if output_dir is None: output_dir = ''
        obj_names = []
        for src_name in source_filenames:
            (base, ext) = os.path.splitext (src_name)
            base = os.path.splitdrive(base)[1] # Chop off the drive
            base = base[os.path.isabs(base):]  # If abs, chop off leading /
            if ext not in self.src_extensions:
                # Better to raise an exception instead of silently continuing
                # and later complain about sources and targets having
                # different lengths
                raise CompileError ("Don't know how to compile %s" % src_name)
            if strip_dir:
                base = os.path.basename (base)
            if ext in self._rc_extensions:
                obj_names.append (os.path.join (output_dir,
                                                base + self.res_extension))
            elif ext in self._mc_extensions:
                obj_names.append (os.path.join (output_dir,
                                                base + self.res_extension))
            else:
                obj_names.append (os.path.join (output_dir,
                                                base + self.obj_extension))
        return obj_names

    # object_filenames ()


    def compile(self, sources,
                output_dir=None, macros=None, include_dirs=None, debug=0,
                extra_preargs=None, extra_postargs=None, depends=None):

        if not self.initialized: self.initialize()
        macros, objects, extra_postargs, pp_opts, build = \
                self._setup_compile(output_dir, macros, include_dirs, sources,
                                    depends, extra_postargs)

        compile_opts = extra_preargs or []
        compile_opts.append ('/c')
        if debug:
            compile_opts.extend(self.compile_options_debug)
        else:
            compile_opts.extend(self.compile_options)

        for obj in objects:
            try:
                src, ext = build[obj]
            except KeyError:
                continue
            if debug:
                # pass the full pathname to MSVC in debug mode,
                # this allows the debugger to find the source file
                # without asking the user to browse for it
                src = os.path.abspath(src)

            if ext in self._c_extensions:
                input_opt = "/Tc" + src
            elif ext in self._cpp_extensions:
                input_opt = "/Tp" + src
            elif ext in self._rc_extensions:
                # compile .RC to .RES file
                input_opt = src
                output_opt = "/fo" + obj
                try:
                    self.spawn ([self.rc] + pp_opts +
                                [output_opt] + [input_opt])
                except DistutilsExecError, msg:
                    raise CompileError, msg
                continue
            elif ext in self._mc_extensions:

                # Compile .MC to .RC file to .RES file.
                #   * '-h dir' specifies the directory for the
                #     generated include file
                #   * '-r dir' specifies the target directory of the
                #     generated RC file and the binary message resource
                #     it includes
                #
                # For now (since there are no options to change this),
                # we use the source-directory for the include file and
                # the build directory for the RC file and message
                # resources. This works at least for win32all.

                h_dir = os.path.dirname (src)
                rc_dir = os.path.dirname (obj)
                try:
                    # first compile .MC to .RC and .H file
                    self.spawn ([self.mc] +
                                ['-h', h_dir, '-r', rc_dir] + [src])
                    base, _ = os.path.splitext (os.path.basename (src))
                    rc_file = os.path.join (rc_dir, base + '.rc')
                    # then compile .RC to .RES file
                    self.spawn ([self.rc] +
                                ["/fo" + obj] + [rc_file])

                except DistutilsExecError, msg:
                    raise CompileError, msg
                continue
            else:
                # how to handle this file?
                raise CompileError (
                    "Don't know how to compile %s to %s" % \
                    (src, obj))

            output_opt = "/Fo" + obj
            try:
                self.spawn ([self.cc] + compile_opts + pp_opts +
                            [input_opt, output_opt] +
                            extra_postargs)
            except DistutilsExecError, msg:
                raise CompileError, msg

        return objects

    # compile ()


    def create_static_lib (self,
                           objects,
                           output_libname,
                           output_dir=None,
                           debug=0,
                           target_lang=None):

        if not self.initialized: self.initialize()
        (objects, output_dir) = self._fix_object_args (objects, output_dir)
        output_filename = \
            self.library_filename (output_libname, output_dir=output_dir)

        if self._need_link (objects, output_filename):
            lib_args = objects + ['/OUT:' + output_filename]
            if debug:
                pass                    # XXX what goes here?
            try:
                self.spawn ([self.lib] + lib_args)
            except DistutilsExecError, msg:
                raise LibError, msg

        else:
            log.debug("skipping %s (up-to-date)", output_filename)

    # create_static_lib ()

    def link (self,
              target_desc,
              objects,
              output_filename,
              output_dir=None,
              libraries=None,
              library_dirs=None,
              runtime_library_dirs=None,
              export_symbols=None,
              debug=0,
              extra_preargs=None,
              extra_postargs=None,
              build_temp=None,
              target_lang=None):

        if not self.initialized: self.initialize()
        (objects, output_dir) = self._fix_object_args (objects, output_dir)
        (libraries, library_dirs, runtime_library_dirs) = \
            self._fix_lib_args (libraries, library_dirs, runtime_library_dirs)

        if runtime_library_dirs:
            self.warn ("I don't know what to do with 'runtime_library_dirs': "
                       + str (runtime_library_dirs))

        lib_opts = gen_lib_options (self,
                                    library_dirs, runtime_library_dirs,
                                    libraries)
        if output_dir is not None:
            output_filename = os.path.join (output_dir, output_filename)

        if self._need_link (objects, output_filename):

            if target_desc == CCompiler.EXECUTABLE:
                if debug:
                    ldflags = self.ldflags_shared_debug[1:]
                else:
                    ldflags = self.ldflags_shared[1:]
            else:
                if debug:
                    ldflags = self.ldflags_shared_debug
                else:
                    ldflags = self.ldflags_shared

            export_opts = []
            for sym in (export_symbols or []):
                export_opts.append("/EXPORT:" + sym)

            ld_args = (ldflags + lib_opts + export_opts +
                       objects + ['/OUT:' + output_filename])

            # The MSVC linker generates .lib and .exp files, which cannot be
            # suppressed by any linker switches. The .lib files may even be
            # needed! Make sure they are generated in the temporary build
            # directory. Since they have different names for debug and release
            # builds, they can go into the same directory.
            if export_symbols is not None:
                (dll_name, dll_ext) = os.path.splitext(
                    os.path.basename(output_filename))
                implib_file = os.path.join(
                    os.path.dirname(objects[0]),
                    self.library_filename(dll_name))
                ld_args.append ('/IMPLIB:' + implib_file)

            if extra_preargs:
                ld_args[:0] = extra_preargs
            if extra_postargs:
                ld_args.extend(extra_postargs)

            self.mkpath (os.path.dirname (output_filename))
            try:
                self.spawn ([self.linker] + ld_args)
            except DistutilsExecError, msg:
                raise LinkError, msg

        else:
            log.debug("skipping %s (up-to-date)", output_filename)

    # link ()


    # -- Miscellaneous methods -----------------------------------------
    # These are all used by the 'gen_lib_options() function, in
    # ccompiler.py.

    def library_dir_option (self, dir):
        return "/LIBPATH:" + dir

    def runtime_library_dir_option (self, dir):
        raise DistutilsPlatformError, \
              "don't know how to set runtime library search path for MSVC++"

    def library_option (self, lib):
        return self.library_filename (lib)


    def find_library_file (self, dirs, lib, debug=0):
        # Prefer a debugging library if found (and requested), but deal
        # with it if we don't have one.
        if debug:
            try_names = [lib + "_d", lib]
        else:
            try_names = [lib]
        for dir in dirs:
            for name in try_names:
                libfile = os.path.join(dir, self.library_filename (name))
                if os.path.exists(libfile):
                    return libfile
        else:
            # Oops, didn't find it in *any* of 'dirs'
            return None

    # find_library_file ()

    # Helper methods for using the MSVC registry settings

    def find_exe(self, exe):
        """Return path to an MSVC executable program.

        Tries to find the program in several places: first, one of the
        MSVC program search paths from the registry; next, the directories
        in the PATH environment variable.  If any of those work, return an
        absolute path that is known to exist.  If none of them work, just
        return the original program name, 'exe'.
        """

        for p in self.__paths:
            fn = os.path.join(os.path.abspath(p), exe)
            if os.path.isfile(fn):
                return fn

        # didn't find it; try existing path
        for p in string.split(os.environ['Path'],';'):
            fn = os.path.join(os.path.abspath(p),exe)
            if os.path.isfile(fn):
                return fn

        return exe

    def get_msvc_paths(self, path, platform='x86'):
        """Get a list of devstudio directories (include, lib or path).

        Return a list of strings.  The list will be empty if unable to
        access the registry or appropriate registry keys not found.
        """

        if not _can_read_reg:
            return []

        path = path + " dirs"
        if self.__version >= 7:
            key = (r"%s\%0.1f\VC\VC_OBJECTS_PLATFORM_INFO\Win32\Directories"
                   % (self.__root, self.__version))
        else:
            key = (r"%s\6.0\Build System\Components\Platforms"
                   r"\Win32 (%s)\Directories" % (self.__root, platform))

        for base in HKEYS:
            d = read_values(base, key)
            if d:
                if self.__version >= 7:
                    return string.split(self.__macros.sub(d[path]), ";")
                else:
                    return string.split(d[path], ";")
        # MSVC 6 seems to create the registry entries we need only when
        # the GUI is run.
        if self.__version == 6:
            for base in HKEYS:
                if read_values(base, r"%s\6.0" % self.__root) is not None:
                    self.warn("It seems you have Visual Studio 6 installed, "
                        "but the expected registry settings are not present.\n"
                        "You must at least run the Visual Studio GUI once "
                        "so that these entries are created.")
                    break
        return []

    def set_path_env_var(self, name):
        """Set environment variable 'name' to an MSVC path type value.

        This is equivalent to a SET command prior to execution of spawned
        commands.
        """

        if name == "lib":
            p = self.get_msvc_paths("library")
        else:
            p = self.get_msvc_paths(name)
        if p:
            os.environ[name] = string.join(p, ';')


if get_build_version() >= 8.0:
    log.debug("Importing new compiler from distutils.msvc9compiler")
    OldMSVCCompiler = MSVCCompiler
    from distutils.msvc9compiler import MSVCCompiler
    # get_build_architecture not really relevant now we support cross-compile
    from distutils.msvc9compiler import MacroExpander
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           """distutils.spawn

Provides the 'spawn()' function, a front-end to various platform-
specific functions for launching another program in a sub-process.
Also provides the 'find_executable()' to search the path for a given
executable name.
"""

__revision__ = "$Id$"

import sys
import os

from distutils.errors import DistutilsPlatformError, DistutilsExecError
from distutils.debug import DEBUG
from distutils import log

def spawn(cmd, search_path=1, verbose=0, dry_run=0):
    """Run another program, specified as a command list 'cmd', in a new process.

    'cmd' is just the argument list for the new process, ie.
    cmd[0] is the program to run and cmd[1:] are the rest of its arguments.
    There is no way to run a program with a name different from that of its
    executable.

    If 'search_path' is true (the default), the system's executable
    search path will be used to find the program; otherwise, cmd[0]
    must be the exact path to the executable.  If 'dry_run' is true,
    the command will not actually be run.

    Raise DistutilsExecError if running the program fails in any way; just
    return on success.
    """
    # cmd is documented as a list, but just in case some code passes a tuple
    # in, protect our %-formatting code against horrible death
    cmd = list(cmd)
    if os.name == 'posix':
        _spawn_posix(cmd, search_path, dry_run=dry_run)
    elif os.name == 'nt':
        _spawn_nt(cmd, search_path, dry_run=dry_run)
    elif os.name == 'os2':
        _spawn_os2(cmd, search_path, dry_run=dry_run)
    else:
        raise DistutilsPlatformError, \
              "don't know how to spawn programs on platform '%s'" % os.name

def _nt_quote_args(args):
    """Quote command-line arguments for DOS/Windows conventions.

    Just wraps every argument which contains blanks in double quotes, and
    returns a new argument list.
    """
    # XXX this doesn't seem very robust to me -- but if the Windows guys
    # say it'll work, I guess I'll have to accept it.  (What if an arg
    # contains quotes?  What other magic characters, other than spaces,
    # have to be escaped?  Is there an escaping mechanism other than
    # quoting?)
    for i, arg in enumerate(args):
        if ' ' in arg:
            args[i] = '"%s"' % arg
    return args

def _spawn_nt(cmd, search_path=1, verbose=0, dry_run=0):
    executable = cmd[0]
    cmd = _nt_quote_args(cmd)
    if search_path:
        # either we find one or it stays the same
        executable = find_executable(executable) or executable
    log.info(' '.join([executable] + cmd[1:]))
    if not dry_run:
        # spawn for NT requires a full path to the .exe
        try:
            rc = os.spawnv(os.P_WAIT, executable, cmd)
        except OSError, exc:
            # this seems to happen when the command isn't found
            if not DEBUG:
                cmd = executable
            raise DistutilsExecError, \
                  "command %r failed: %s" % (cmd, exc[-1])
        if rc != 0:
            # and this reflects the command running but failing
            if not DEBUG:
                cmd = executable
            raise DistutilsExecError, \
                  "command %r failed with exit status %d" % (cmd, rc)

def _spawn_os2(cmd, search_path=1, verbose=0, dry_run=0):
    executable = cmd[0]
    if search_path:
        # either we find one or it stays the same
        executable = find_executable(executable) or executable
    log.info(' '.join([executable] + cmd[1:]))
    if not dry_run:
        # spawnv for OS/2 EMX requires a full path to the .exe
        try:
            rc = os.spawnv(os.P_WAIT, executable, cmd)
        except OSError, exc:
            # this seems to happen when the command isn't found
            if not DEBUG:
                cmd = executable
            raise DistutilsExecError, \
                  "command %r failed: %s" % (cmd, exc[-1])
        if rc != 0:
            # and this reflects the command running but failing
            if not DEBUG:
                cmd = executable
            log.debug("command %r failed with exit status %d" % (cmd, rc))
            raise DistutilsExecError, \
                  "command %r failed with exit status %d" % (cmd, rc)

if sys.platform == 'darwin':
    from distutils import sysconfig
    _cfg_target = None
    _cfg_target_split = None

def _spawn_posix(cmd, search_path=1, verbose=0, dry_run=0):
    log.info(' '.join(cmd))
    if dry_run:
        return
    executable = cmd[0]
    exec_fn = search_path and os.execvp or os.execv
    env = None
    if sys.platform == 'darwin':
        global _cfg_target, _cfg_target_split
        if _cfg_target is None:
            _cfg_target = sysconfig.get_config_var(
                                  'MACOSX_DEPLOYMENT_TARGET') or ''
            if _cfg_target:
                _cfg_target_split = [int(x) for x in _cfg_target.split('.')]
        if _cfg_target:
            # ensure that the deployment target of build process is not less
            # than that used when the interpreter was built. This ensures
            # extension modules are built with correct compatibility values
            cur_target = os.environ.get('MACOSX_DEPLOYMENT_TARGET', _cfg_target)
            if _cfg_target_split > [int(x) for x in cur_target.split('.')]:
                my_msg = ('$MACOSX_DEPLOYMENT_TARGET mismatch: '
                          'now "%s" but "%s" during configure'
                                % (cur_target, _cfg_target))
                raise DistutilsPlatformError(my_msg)
            env = dict(os.environ,
                       MACOSX_DEPLOYMENT_TARGET=cur_target)
            exec_fn = search_path and os.execvpe or os.execve
    pid = os.fork()

    if pid == 0:  # in the child
        try:
            if env is None:
                exec_fn(executable, cmd)
            else:
                exec_fn(executable, cmd, env)
        except OSError, e:
            if not DEBUG:
                cmd = executable
            sys.stderr.write("unable to execute %r: %s\n" %
                             (cmd, e.strerror))
            os._exit(1)

        if not DEBUG:
            cmd = executable
        sys.stderr.write("unable to execute %r for unknown reasons" % cmd)
        os._exit(1)
    else:   # in the parent
        # Loop until the child either exits or is terminated by a signal
        # (ie. keep waiting if it's merely stopped)
        while 1:
            try:
                pid, status = os.waitpid(pid, 0)
            except OSError, exc:
                import errno
                if exc.errno == errno.EINTR:
                    continue
                if not DEBUG:
                    cmd = executable
                raise DistutilsExecError, \
                      "command %r failed: %s" % (cmd, exc[-1])
            if os.WIFSIGNALED(status):
                if not DEBUG:
                    cmd = executable
                raise DistutilsExecError, \
                      "command %r terminated by signal %d" % \
                      (cmd, os.WTERMSIG(status))

            elif os.WIFEXITED(status):
                exit_status = os.WEXITSTATUS(status)
                if exit_status == 0:
                    return   # hey, it succeeded!
                else:
                    if not DEBUG:
                        cmd = executable
                    raise DistutilsExecError, \
                          "command %r failed with exit status %d" % \
                          (cmd, exit_status)

            elif os.WIFSTOPPED(status):
                continue

            else:
                if not DEBUG:
                    cmd = executable
                raise DistutilsExecError, \
                      "unknown error executing %r: termination status %d" % \
                      (cmd, status)

def find_executable(executable, path=None):
    """Tries to find 'executable' in the directories listed in 'path'.

    A string listing directories separated by 'os.pathsep'; defaults to
    os.environ['PATH'].  Returns the complete filename or None if not found.
    """
    if path is None:
        path = os.environ['PATH']
    paths = path.split(os.pathsep)
    base, ext = os.path.splitext(executable)

    if (sys.platform == 'win32' or os.name == 'os2') and (ext != '.exe'):
        executable = executable + '.exe'

    if not os.path.isfile(executable):
        for p in paths:
            f = os.path.join(p, executable)
            if os.path.isfile(f):
                # the file exists, we have a shot at spawn working
                return f
        return None
    else:
        return executable
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         """Provide access to Python's configuration information.  The specific
configuration variables available depend heavily on the platform and
configuration.  The values may be retrieved using
get_config_var(name), and the list of variables is available via
get_config_vars().keys().  Additional convenience functions are also
available.

Written by:   Fred L. Drake, Jr.
Email:        <fdrake@acm.org>
"""

__revision__ = "$Id$"

import os
import re
import string
import sys

from distutils.errors import DistutilsPlatformError

# These are needed in a couple of spots, so just compute them once.
PREFIX = os.path.normpath(sys.prefix)
EXEC_PREFIX = os.path.normpath(sys.exec_prefix)

# Path to the base directory of the project. On Windows the binary may
# live in project/PCBuild9.  If we're dealing with an x64 Windows build,
# it'll live in project/PCbuild/amd64.
project_base = os.path.dirname(os.path.abspath(sys.executable))
if os.name == "nt" and "pcbuild" in project_base[-8:].lower():
    project_base = os.path.abspath(os.path.join(project_base, os.path.pardir))
# PC/VS7.1
if os.name == "nt" and "\\pc\\v" in project_base[-10:].lower():
    project_base = os.path.abspath(os.path.join(project_base, os.path.pardir,
                                                os.path.pardir))
# PC/AMD64
if os.name == "nt" and "\\pcbuild\\amd64" in project_base[-14:].lower():
    project_base = os.path.abspath(os.path.join(project_base, os.path.pardir,
                                                os.path.pardir))

# set for cross builds
if "_PYTHON_PROJECT_BASE" in os.environ:
    # this is the build directory, at least for posix
    project_base = os.path.normpath(os.environ["_PYTHON_PROJECT_BASE"])

# python_build: (Boolean) if true, we're either building Python or
# building an extension with an un-installed Python, so we use
# different (hard-wired) directories.
# Setup.local is available for Makefile builds including VPATH builds,
# Setup.dist is available on Windows
def _python_build():
    for fn in ("Setup.dist", "Setup.local"):
        if os.path.isfile(os.path.join(project_base, "Modules", fn)):
            return True
    return False
python_build = _python_build()


def get_python_version():
    """Return a string containing the major and minor Python version,
    leaving off the patchlevel.  Sample return values could be '1.5'
    or '2.2'.
    """
    return sys.version[:3]


def get_python_inc(plat_specific=0, prefix=None):
    """Return the directory containing installed Python header files.

    If 'plat_specific' is false (the default), this is the path to the
    non-platform-specific header files, i.e. Python.h and so on;
    otherwise, this is the path to platform-specific header files
    (namely pyconfig.h).

    If 'prefix' is supplied, use it instead of sys.prefix or
    sys.exec_prefix -- i.e., ignore 'plat_specific'.
    """

    if os.name == "posix":
        if python_build:
            buildir = os.path.dirname(sys.executable)
            if plat_specific:
                # python.h is located in the buildir
                inc_dir = buildir
            else:
                # the source dir is relative to the buildir
                srcdir = os.path.abspath(os.path.join(buildir,
                                         get_config_var('srcdir')))
                # Include is located in the srcdir
                inc_dir = os.path.join(srcdir, "Include")
            return inc_dir
        else:
            if not (prefix is None):
                return os.path.join(prefix, "include",
                                    "python" + get_python_version())+(sys.pydebug and "_d" or "")
            if plat_specific:
                return get_config_var('CONFINCLUDEPY')
            else:
                return get_config_var('INCLUDEPY')
    elif os.name == "nt":
        return os.path.join(prefix, "include")
    elif os.name == "os2":
        return os.path.join(prefix, "Include")
    else:
        raise DistutilsPlatformError(
            "I don't know where Python installs its C header files "
            "on platform '%s'" % os.name)


def get_python_lib(plat_specific=0, standard_lib=0, prefix=None):
    """Return the directory containing the Python library (standard or
    site additions).

    If 'plat_specific' is true, return the directory containing
    platform-specific modules, i.e. any module from a non-pure-Python
    module distribution; otherwise, return the platform-shared library
    directory.  If 'standard_lib' is true, return the directory
    containing standard Python library modules; otherwise, return the
    directory for site-specific modules.

    If 'prefix' is supplied, use it instead of sys.prefix or
    sys.exec_prefix -- i.e., ignore 'plat_specific'.
    """
    is_default_prefix = not prefix or os.path.normpath(prefix) in ('/usr', '/usr/local')
    if prefix is None:
        prefix = plat_specific and EXEC_PREFIX or PREFIX

    if os.name == "posix":
        libpython = os.path.join(prefix,
                                 "lib", "python" + get_python_version())
        if standard_lib:
            return libpython
        elif is_default_prefix and 'PYTHONUSERBASE' not in os.environ and 'real_prefix' not in sys.__dict__:
            return os.path.join(libpython, "dist-packages")
        else:
            return os.path.join(libpython, "site-packages")

    elif os.name == "nt":
        if standard_lib:
            return os.path.join(prefix, "Lib")
        else:
            if get_python_version() < "2.2":
                return prefix
            else:
                return os.path.join(prefix, "Lib", "site-packages")

    elif os.name == "os2":
        if standard_lib:
            return os.path.join(prefix, "Lib")
        else:
            return os.path.join(prefix, "Lib", "site-packages")

    else:
        raise DistutilsPlatformError(
            "I don't know where Python installs its library "
            "on platform '%s'" % os.name)



def customize_compiler(compiler):
    """Do any platform-specific customization of a CCompiler instance.

    Mainly needed on Unix, so we can plug in the information that
    varies across Unices and is stored in Python's Makefile.
    """
    if compiler.compiler_type == "unix":
        if sys.platform == "darwin":
            # Perform first-time customization of compiler-related
            # config vars on OS X now that we know we need a compiler.
            # This is primarily to support Pythons from binary
            # installers.  The kind and paths to build tools on
            # the user system may vary significantly from the system
            # that Python itself was built on.  Also the user OS
            # version and build tools may not support the same set
            # of CPU architectures for universal builds.
            global _config_vars
            # Use get_config_var() to ensure _config_vars is initialized.
            if not get_config_var('CUSTOMIZED_OSX_COMPILER'):
                import _osx_support
                _osx_support.customize_compiler(_config_vars)
                _config_vars['CUSTOMIZED_OSX_COMPILER'] = 'True'

        (cc, cxx, opt, cflags, extra_cflags, basecflags,
         ccshared, ldshared, so_ext, ar, ar_flags,
         configure_cppflags, configure_cflags, configure_ldflags) = \
            get_config_vars('CC', 'CXX', 'OPT', 'CFLAGS', 'EXTRA_CFLAGS', 'BASECFLAGS',
                            'CCSHARED', 'LDSHARED', 'SO', 'AR', 'ARFLAGS',
                            'CONFIGURE_CPPFLAGS', 'CONFIGURE_CFLAGS', 'CONFIGURE_LDFLAGS')

        if 'CC' in os.environ:
            newcc = os.environ['CC']
            if (sys.platform == 'darwin'
                    and 'LDSHARED' not in os.environ
                    and ldshared.startswith(cc)):
                # On OS X, if CC is overridden, use that as the default
                #       command for LDSHARED as well
                ldshared = newcc + ldshared[len(cc):]
            cc = newcc
        if 'CXX' in os.environ:
            cxx = os.environ['CXX']
        if 'LDSHARED' in os.environ:
            ldshared = os.environ['LDSHARED']
        if 'CPP' in os.environ:
            cpp = os.environ['CPP']
        else:
            cpp = cc + " -E"           # not always
        if 'LDFLAGS' in os.environ:
            ldshared = ldshared + ' ' + os.environ['LDFLAGS']
        elif configure_ldflags:
            ldshared = ldshared + ' ' + configure_ldflags
        if 'BASECFLAGS' in os.environ:
            basecflags = os.environ['BASECFLAGS']
        if 'OPT' in os.environ:
            opt = os.environ['OPT']
        cflags = ' '.join(str(x) for x in (basecflags, opt, extra_cflags) if x)
        if 'CFLAGS' in os.environ:
            cflags = ' '.join(str(x) for x in (opt, basecflags, os.environ['CFLAGS'], extra_cflags) if x)
            ldshared = ldshared + ' ' + os.environ['CFLAGS']
        elif configure_cflags:
            cflags = ' '.join(str(x) for x in (opt, basecflags, configure_cflags, extra_cflags) if x)
            ldshared = ldshared + ' ' + configure_cflags
        if 'CPPFLAGS' in os.environ:
            cpp = cpp + ' ' + os.environ['CPPFLAGS']
            cflags = cflags + ' ' + os.environ['CPPFLAGS']
            ldshared = ldshared + ' ' + os.environ['CPPFLAGS']
        elif configure_cppflags:
            cpp = cpp + ' ' + configure_cppflags
            cflags = cflags + ' ' + configure_cppflags
            ldshared = ldshared + ' ' + configure_cppflags
        if 'AR' in os.environ:
            ar = os.environ['AR']
        if 'ARFLAGS' in os.environ:
            archiver = ar + ' ' + os.environ['ARFLAGS']
        else:
            archiver = ar + ' ' + ar_flags

        cc_cmd = cc + ' ' + cflags
        compiler.set_executables(
            preprocessor=cpp,
            compiler=cc_cmd,
            compiler_so=cc_cmd + ' ' + ccshared,
            compiler_cxx=cxx,
            linker_so=ldshared,
            linker_exe=cc,
            archiver=archiver)

        compiler.shared_lib_extension = so_ext


def get_config_h_filename():
    """Return full pathname of installed pyconfig.h file."""
    if python_build:
        if os.name == "nt":
            inc_dir = os.path.join(project_base, "PC")
        else:
            inc_dir = project_base
    else:
        inc_dir = get_python_inc(plat_specific=1)
    if get_python_version() < '2.2':
        config_h = 'config.h'
    else:
        # The name of the config.h file changed in 2.2
        config_h = 'pyconfig.h'
    return os.path.join(inc_dir, config_h)


def get_makefile_filename():
    """Return full pathname of installed Makefile from the Python build."""
    if python_build:
        return os.path.join(project_base, "Makefile")
    lib_dir = get_python_lib(plat_specific=1, standard_lib=1)
    return os.path.join(get_config_var('LIBPL'), "Makefile")


def parse_config_h(fp, g=None):
    """Parse a config.h-style file.

    A dictionary containing name/value pairs is returned.  If an
    optional dictionary is passed in as the second argument, it is
    used instead of a new dictionary.
    """
    if g is None:
        g = {}
    define_rx = re.compile("#define ([A-Z][A-Za-z0-9_]+) (.*)\n")
    undef_rx = re.compile("/[*] #undef ([A-Z][A-Za-z0-9_]+) [*]/\n")
    #
    while 1:
        line = fp.readline()
        if not line:
            break
        m = define_rx.match(line)
        if m:
            n, v = m.group(1, 2)
            try: v = int(v)
            except ValueError: pass
            g[n] = v
        else:
            m = undef_rx.match(line)
            if m:
                g[m.group(1)] = 0
    return g


# Regexes needed for parsing Makefile (and similar syntaxes,
# like old-style Setup files).
_variable_rx = re.compile("([a-zA-Z][a-zA-Z0-9_]+)\s*=\s*(.*)")
_findvar1_rx = re.compile(r"\$\(([A-Za-z][A-Za-z0-9_]*)\)")
_findvar2_rx = re.compile(r"\${([A-Za-z][A-Za-z0-9_]*)}")

def parse_makefile(fn, g=None):
    """Parse a Makefile-style file.

    A dictionary containing name/value pairs is returned.  If an
    optional dictionary is passed in as the second argument, it is
    used instead of a new dictionary.
    """
    from distutils.text_file import TextFile
    fp = TextFile(fn, strip_comments=1, skip_blanks=1, join_lines=1)

    if g is None:
        g = {}
    done = {}
    notdone = {}

    while 1:
        line = fp.readline()
        if line is None:  # eof
            break
        m = _variable_rx.match(line)
        if m:
            n, v = m.group(1, 2)
            v = v.strip()
            # `$$' is a literal `$' in make
            tmpv = v.replace('$$', '')

            if "$" in tmpv:
                notdone[n] = v
            else:
                try:
                    v = int(v)
                except ValueError:
                    # insert literal `$'
                    done[n] = v.replace('$$', '$')
                else:
                    done[n] = v

    # do variable interpolation here
    variables = list(notdone.keys())

    # Variables with a 'PY_' prefix in the makefile. These need to
    # be made available without that prefix through sysconfig.
    # Special care is needed to ensure that variable expansion works, even
    # if the expansion uses the name without a prefix.
    renamed_variables = ('CFLAGS', 'LDFLAGS', 'CPPFLAGS')

    while len(variables) > 0:
        for name in tuple(variables):
            value = notdone[name]
            m = _findvar1_rx.search(value) or _findvar2_rx.search(value)
            if m is not None:
                n = m.group(1)
                found = True
                if n in done:
                    item = str(done[n])
                elif n in notdone:
                    # get it on a subsequent round
                    found = False
                elif n in os.environ:
                    # do it like make: fall back to environment
                    item = os.environ[n]

                elif n in renamed_variables:
                    if name.startswith('PY_') and name[3:] in renamed_variables:
                        item = ""

                    elif 'PY_' + n in notdone:
                        found = False

                    else:
                        item = str(done['PY_' + n])

                else:
                    done[n] = item = ""

                if found:
                    after = value[m.end():]
                    value = value[:m.start()] + item + after
                    if "$" in after:
                        notdone[name] = value
                    else:
                        try:
                            value = int(value)
                        except ValueError:
                            done[name] = value.strip()
                        else:
                            done[name] = value
                        variables.remove(name)

                        if name.startswith('PY_') \
                        and name[3:] in renamed_variables:

                            name = name[3:]
                            if name not in done:
                                done[name] = value


            else:
                # bogus variable reference (e.g. "prefix=$/opt/python");
                # just drop it since we can't deal
                done[name] = value
                variables.remove(name)

    # strip spurious spaces
    for k, v in done.items():
        if isinstance(v, str):
            done[k] = v.strip()

    # save the results in the global dictionary
    g.update(done)
    return g


def expand_makefile_vars(s, vars):
    """Expand Makefile-style variables -- "${foo}" or "$(foo)" -- in
    'string' according to 'vars' (a dictionary mapping variable names to
    values).  Variables not present in 'vars' are silently expanded to the
    empty string.  The variable values in 'vars' should not contain further
    variable expansions; if 'vars' is the output of 'parse_makefile()',
    you're fine.  Returns a variable-expanded version of 's'.
    """

    # This algorithm does multiple expansion, so if vars['foo'] contains
    # "${bar}", it will expand ${foo} to ${bar}, and then expand
    # ${bar}... and so forth.  This is fine as long as 'vars' comes from
    # 'parse_makefile()', which takes care of such expansions eagerly,
    # according to make's variable expansion semantics.

    while 1:
        m = _findvar1_rx.search(s) or _findvar2_rx.search(s)
        if m:
            (beg, end) = m.span()
            s = s[0:beg] + vars.get(m.group(1)) + s[end:]
        else:
            break
    return s


_config_vars = None

def _init_posix():
    """Initialize the module as appropriate for POSIX systems."""
    # _sysconfigdata is generated at build time, see the sysconfig module
    from _sysconfigdata import build_time_vars
    global _config_vars
    _config_vars = {}
    _config_vars.update(build_time_vars)


def _init_nt():
    """Initialize the module as appropriate for NT"""
    g = {}
    # set basic install directories
    g['LIBDEST'] = get_python_lib(plat_specific=0, standard_lib=1)
    g['BINLIBDEST'] = get_python_lib(plat_specific=1, standard_lib=1)

    # XXX hmmm.. a normal install puts include files here
    g['INCLUDEPY'] = get_python_inc(plat_specific=0)

    g['SO'] = '.pyd'
    g['EXE'] = ".exe"
    g['VERSION'] = get_python_version().replace(".", "")
    g['BINDIR'] = os.path.dirname(os.path.abspath(sys.executable))

    global _config_vars
    _config_vars = g


def _init_os2():
    """Initialize the module as appropriate for OS/2"""
    g = {}
    # set basic install directories
    g['LIBDEST'] = get_python_lib(plat_specific=0, standard_lib=1)
    g['BINLIBDEST'] = get_python_lib(plat_specific=1, standard_lib=1)

    # XXX hmmm.. a normal install puts include files here
    g['INCLUDEPY'] = get_python_inc(plat_specific=0)

    g['SO'] = '.pyd'
    g['EXE'] = ".exe"

    global _config_vars
    _config_vars = g


def get_config_vars(*args):
    """With no arguments, return a dictionary of all configuration
    variables relevant for the current platform.  Generally this includes
    everything needed to build extensions and install both pure modules and
    extensions.  On Unix, this means every variable defined in Python's
    installed Makefile; on Windows and Mac OS it's a much smaller set.

    With arguments, return a list of values that result from looking up
    each argument in the configuration variable dictionary.
    """
    global _config_vars
    if _config_vars is None:
        func = globals().get("_init_" + os.name)
        if func:
            func()
        else:
            _config_vars = {}

        # Normalized versions of prefix and exec_prefix are handy to have;
        # in fact, these are the standard versions used most places in the
        # Distutils.
        _config_vars['prefix'] = PREFIX
        _config_vars['exec_prefix'] = EXEC_PREFIX

        # OS X platforms require special customization to handle
        # multi-architecture, multi-os-version installers
        if sys.platform == 'darwin':
            import _osx_support
            _osx_support.customize_config_vars(_config_vars)

    if args:
        vals = []
        for name in args:
            vals.append(_config_vars.get(name))
        return vals
    else:
        return _config_vars

def get_config_var(name):
    """Return the value of a single variable using the dictionary
    returned by 'get_config_vars()'.  Equivalent to
    get_config_vars().get(name)
    """
    return get_config_vars().get(name)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                """text_file

provides the TextFile class, which gives an interface to text files
that (optionally) takes care of stripping comments, ignoring blank
lines, and joining lines with backslashes."""

__revision__ = "$Id$"

import sys


class TextFile:

    """Provides a file-like object that takes care of all the things you
       commonly want to do when processing a text file that has some
       line-by-line syntax: strip comments (as long as "#" is your
       comment character), skip blank lines, join adjacent lines by
       escaping the newline (ie. backslash at end of line), strip
       leading and/or trailing whitespace.  All of these are optional
       and independently controllable.

       Provides a 'warn()' method so you can generate warning messages that
       report physical line number, even if the logical line in question
       spans multiple physical lines.  Also provides 'unreadline()' for
       implementing line-at-a-time lookahead.

       Constructor is called as:

           TextFile (filename=None, file=None, **options)

       It bombs (RuntimeError) if both 'filename' and 'file' are None;
       'filename' should be a string, and 'file' a file object (or
       something that provides 'readline()' and 'close()' methods).  It is
       recommended that you supply at least 'filename', so that TextFile
       can include it in warning messages.  If 'file' is not supplied,
       TextFile creates its own using the 'open()' builtin.

       The options are all boolean, and affect the value returned by
       'readline()':
         strip_comments [default: true]
           strip from "#" to end-of-line, as well as any whitespace
           leading up to the "#" -- unless it is escaped by a backslash
         lstrip_ws [default: false]
           strip leading whitespace from each line before returning it
         rstrip_ws [default: true]
           strip trailing whitespace (including line terminator!) from
           each line before returning it
         skip_blanks [default: true}
           skip lines that are empty *after* stripping comments and
           whitespace.  (If both lstrip_ws and rstrip_ws are false,
           then some lines may consist of solely whitespace: these will
           *not* be skipped, even if 'skip_blanks' is true.)
         join_lines [default: false]
           if a backslash is the last non-newline character on a line
           after stripping comments and whitespace, join the following line
           to it to form one "logical line"; if N consecutive lines end
           with a backslash, then N+1 physical lines will be joined to
           form one logical line.
         collapse_join [default: false]
           strip leading whitespace from lines that are joined to their
           predecessor; only matters if (join_lines and not lstrip_ws)

       Note that since 'rstrip_ws' can strip the trailing newline, the
       semantics of 'readline()' must differ from those of the builtin file
       object's 'readline()' method!  In particular, 'readline()' returns
       None for end-of-file: an empty string might just be a blank line (or
       an all-whitespace line), if 'rstrip_ws' is true but 'skip_blanks' is
       not."""

    default_options = { 'strip_comments': 1,
                        'skip_blanks':    1,
                        'lstrip_ws':      0,
                        'rstrip_ws':      1,
                        'join_lines':     0,
                        'collapse_join':  0,
                      }

    def __init__ (self, filename=None, file=None, **options):
        """Construct a new TextFile object.  At least one of 'filename'
           (a string) and 'file' (a file-like object) must be supplied.
           They keyword argument options are described above and affect
           the values returned by 'readline()'."""

        if filename is None and file is None:
            raise RuntimeError, \
                  "you must supply either or both of 'filename' and 'file'"

        # set values for all options -- either from client option hash
        # or fallback to default_options
        for opt in self.default_options.keys():
            if opt in options:
                setattr (self, opt, options[opt])

            else:
                setattr (self, opt, self.default_options[opt])

        # sanity check client option hash
        for opt in options.keys():
            if opt not in self.default_options:
                raise KeyError, "invalid TextFile option '%s'" % opt

        if file is None:
            self.open (filename)
        else:
            self.filename = filename
            self.file = file
            self.current_line = 0       # assuming that file is at BOF!

        # 'linebuf' is a stack of lines that will be emptied before we
        # actually read from the file; it's only populated by an
        # 'unreadline()' operation
        self.linebuf = []


    def open (self, filename):
        """Open a new file named 'filename'.  This overrides both the
           'filename' and 'file' arguments to the constructor."""

        self.filename = filename
        self.file = open (self.filename, 'r')
        self.current_line = 0


    def close (self):
        """Close the current file and forget everything we know about it
           (filename, current line number)."""

        self.file.close ()
        self.file = None
        self.filename = None
        self.current_line = None


    def gen_error (self, msg, line=None):
        outmsg = []
        if line is None:
            line = self.current_line
        outmsg.append(self.filename + ", ")
        if isinstance(line, (list, tuple)):
            outmsg.append("lines %d-%d: " % tuple (line))
        else:
            outmsg.append("line %d: " % line)
        outmsg.append(str(msg))
        return ''.join(outmsg)


    def error (self, msg, line=None):
        raise ValueError, "error: " + self.gen_error(msg, line)

    def warn (self, msg, line=None):
        """Print (to stderr) a warning message tied to the current logical
           line in the current file.  If the current logical line in the
           file spans multiple physical lines, the warning refers to the
           whole range, eg. "lines 3-5".  If 'line' supplied, it overrides
           the current line number; it may be a list or tuple to indicate a
           range of physical lines, or an integer for a single physical
           line."""
        sys.stderr.write("warning: " + self.gen_error(msg, line) + "\n")


    def readline (self):
        """Read and return a single logical line from the current file (or
           from an internal buffer if lines have previously been "unread"
           with 'unreadline()').  If the 'join_lines' option is true, this
           may involve reading multiple physical lines concatenated into a
           single string.  Updates the current line number, so calling
           'warn()' after 'readline()' emits a warning about the physical
           line(s) just read.  Returns None on end-of-file, since the empty
           string can occur if 'rstrip_ws' is true but 'strip_blanks' is
           not."""

        # If any "unread" lines waiting in 'linebuf', return the top
        # one.  (We don't actually buffer read-ahead data -- lines only
        # get put in 'linebuf' if the client explicitly does an
        # 'unreadline()'.
        if self.linebuf:
            line = self.linebuf[-1]
            del self.linebuf[-1]
            return line

        buildup_line = ''

        while 1:
            # read the line, make it None if EOF
            line = self.file.readline()
            if line == '': line = None

            if self.strip_comments and line:

                # Look for the first "#" in the line.  If none, never
                # mind.  If we find one and it's the first character, or
                # is not preceded by "\", then it starts a comment --
                # strip the comment, strip whitespace before it, and
                # carry on.  Otherwise, it's just an escaped "#", so
                # unescape it (and any other escaped "#"'s that might be
                # lurking in there) and otherwise leave the line alone.

                pos = line.find("#")
                if pos == -1:           # no "#" -- no comments
                    pass

                # It's definitely a comment -- either "#" is the first
                # character, or it's elsewhere and unescaped.
                elif pos == 0 or line[pos-1] != "\\":
                    # Have to preserve the trailing newline, because it's
                    # the job of a later step (rstrip_ws) to remove it --
                    # and if rstrip_ws is false, we'd better preserve it!
                    # (NB. this means that if the final line is all comment
                    # and has no trailing newline, we will think that it's
                    # EOF; I think that's OK.)
                    eol = (line[-1] == '\n') and '\n' or ''
                    line = line[0:pos] + eol

                    # If all that's left is whitespace, then skip line
                    # *now*, before we try to join it to 'buildup_line' --
                    # that way constructs like
                    #   hello \\
                    #   # comment that should be ignored
                    #   there
                    # result in "hello there".
                    if line.strip() == "":
                        continue

                else:                   # it's an escaped "#"
                    line = line.replace("\\#", "#")


            # did previous line end with a backslash? then accumulate
            if self.join_lines and buildup_line:
                # oops: end of file
                if line is None:
                    self.warn ("continuation line immediately precedes "
                               "end-of-file")
                    return buildup_line

                if self.collapse_join:
                    line = line.lstrip()
                line = buildup_line + line

                # careful: pay attention to line number when incrementing it
                if isinstance(self.current_line, list):
                    self.current_line[1] = self.current_line[1] + 1
                else:
                    self.current_line = [self.current_line,
                                         self.current_line+1]
            # just an ordinary line, read it as usual
            else:
                if line is None:        # eof
                    return None

                # still have to be careful about incrementing the line number!
                if isinstance(self.current_line, list):
                    self.current_line = self.current_line[1] + 1
                else:
                    self.current_line = self.current_line + 1


            # strip whitespace however the client wants (leading and
            # trailing, or one or the other, or neither)
            if self.lstrip_ws and self.rstrip_ws:
                line = line.strip()
            elif self.lstrip_ws:
                line = line.lstrip()
            elif self.rstrip_ws:
                line = line.rstrip()

            # blank line (whether we rstrip'ed or not)? skip to next line
            # if appropriate
            if (line == '' or line == '\n') and self.skip_blanks:
                continue

            if self.join_lines:
                if line[-1] == '\\':
                    buildup_line = line[:-1]
                    continue

                if line[-2:] == '\\\n':
                    buildup_line = line[0:-2] + '\n'
                    continue

            # well, I guess there's some actual content there: return it
            return line

    # readline ()


    def readlines (self):
        """Read and return the list of all logical lines remaining in the
           current file."""

        lines = []
        while 1:
            line = self.readline()
            if line is None:
                return lines
            lines.append (line)


    def unreadline (self, line):
        """Push 'line' (a string) onto an internal buffer that will be
           checked by future 'readline()' calls.  Handy for implementing
           a parser with line-at-a-time lookahead."""

        self.linebuf.append (line)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      """distutils.unixccompiler

Contains the UnixCCompiler class, a subclass of CCompiler that handles
the "typical" Unix-style command-line C compiler:
  * macros defined with -Dname[=value]
  * macros undefined with -Uname
  * include search directories specified with -Idir
  * libraries specified with -lllib
  * library search directories specified with -Ldir
  * compile handled by 'cc' (or similar) executable with -c option:
    compiles .c to .o
  * link static library handled by 'ar' command (possibly with 'ranlib')
  * link shared library handled by 'cc -shared'
"""

__revision__ = "$Id$"

import os, sys, re
from types import StringType, NoneType

from distutils import sysconfig
from distutils.dep_util import newer
from distutils.ccompiler import \
     CCompiler, gen_preprocess_options, gen_lib_options
from distutils.errors import \
     DistutilsExecError, CompileError, LibError, LinkError
from distutils import log

if sys.platform == 'darwin':
    import _osx_support

# XXX Things not currently handled:
#   * optimization/debug/warning flags; we just use whatever's in Python's
#     Makefile and live with it.  Is this adequate?  If not, we might
#     have to have a bunch of subclasses GNUCCompiler, SGICCompiler,
#     SunCCompiler, and I suspect down that road lies madness.
#   * even if we don't know a warning flag from an optimization flag,
#     we need some way for outsiders to feed preprocessor/compiler/linker
#     flags in to us -- eg. a sysadmin might want to mandate certain flags
#     via a site config file, or a user might want to set something for
#     compiling this module distribution only via the setup.py command
#     line, whatever.  As long as these options come from something on the
#     current system, they can be as system-dependent as they like, and we
#     should just happily stuff them into the preprocessor/compiler/linker
#     options and carry on.


class UnixCCompiler(CCompiler):

    compiler_type = 'unix'

    # These are used by CCompiler in two places: the constructor sets
    # instance attributes 'preprocessor', 'compiler', etc. from them, and
    # 'set_executable()' allows any of these to be set.  The defaults here
    # are pretty generic; they will probably have to be set by an outsider
    # (eg. using information discovered by the sysconfig about building
    # Python extensions).
    executables = {'preprocessor' : None,
                   'compiler'     : ["cc"],
                   'compiler_so'  : ["cc"],
                   'compiler_cxx' : ["cc"],
                   'linker_so'    : ["cc", "-shared"],
                   'linker_exe'   : ["cc"],
                   'archiver'     : ["ar", "-cr"],
                   'ranlib'       : None,
                  }

    if sys.platform[:6] == "darwin":
        executables['ranlib'] = ["ranlib"]

    # Needed for the filename generation methods provided by the base
    # class, CCompiler.  NB. whoever instantiates/uses a particular
    # UnixCCompiler instance should set 'shared_lib_ext' -- we set a
    # reasonable common default here, but it's not necessarily used on all
    # Unices!

    src_extensions = [".c",".C",".cc",".cxx",".cpp",".m"]
    obj_extension = ".o"
    static_lib_extension = ".a"
    shared_lib_extension = ".so"
    dylib_lib_extension = ".dylib"
    static_lib_format = shared_lib_format = dylib_lib_format = "lib%s%s"
    if sys.platform == "cygwin":
        exe_extension = ".exe"

    def preprocess(self, source,
                   output_file=None, macros=None, include_dirs=None,
                   extra_preargs=None, extra_postargs=None):
        ignore, macros, include_dirs = \
            self._fix_compile_args(None, macros, include_dirs)
        pp_opts = gen_preprocess_options(macros, include_dirs)
        pp_args = self.preprocessor + pp_opts
        if output_file:
            pp_args.extend(['-o', output_file])
        if extra_preargs:
            pp_args[:0] = extra_preargs
        if extra_postargs:
            pp_args.extend(extra_postargs)
        pp_args.append(source)

        # We need to preprocess: either we're being forced to, or we're
        # generating output to stdout, or there's a target output file and
        # the source file is newer than the target (or the target doesn't
        # exist).
        if self.force or output_file is None or newer(source, output_file):
            if output_file:
                self.mkpath(os.path.dirname(output_file))
            try:
                self.spawn(pp_args)
            except DistutilsExecError, msg:
                raise CompileError, msg

    def _compile(self, obj, src, ext, cc_args, extra_postargs, pp_opts):
        compiler_so = self.compiler_so
        if sys.platform == 'darwin':
            compiler_so = _osx_support.compiler_fixup(compiler_so,
                                                    cc_args + extra_postargs)
        try:
            self.spawn(compiler_so + cc_args + [src, '-o', obj] +
                       extra_postargs)
        except DistutilsExecError, msg:
            raise CompileError, msg

    def create_static_lib(self, objects, output_libname,
                          output_dir=None, debug=0, target_lang=None):
        objects, output_dir = self._fix_object_args(objects, output_dir)

        output_filename = \
            self.library_filename(output_libname, output_dir=output_dir)

        if self._need_link(objects, output_filename):
            self.mkpath(os.path.dirname(output_filename))
            self.spawn(self.archiver +
                       [output_filename] +
                       objects + self.objects)

            # Not many Unices required ranlib anymore -- SunOS 4.x is, I
            # think the only major Unix that does.  Maybe we need some
            # platform intelligence here to skip ranlib if it's not
            # needed -- or maybe Python's configure script took care of
            # it for us, hence the check for leading colon.
            if self.ranlib:
                try:
                    self.spawn(self.ranlib + [output_filename])
                except DistutilsExecError, msg:
                    raise LibError, msg
        else:
            log.debug("skipping %s (up-to-date)", output_filename)

    def link(self, target_desc, objects,
             output_filename, output_dir=None, libraries=None,
             library_dirs=None, runtime_library_dirs=None,
             export_symbols=None, debug=0, extra_preargs=None,
             extra_postargs=None, build_temp=None, target_lang=None):
        objects, output_dir = self._fix_object_args(objects, output_dir)
        libraries, library_dirs, runtime_library_dirs = \
            self._fix_lib_args(libraries, library_dirs, runtime_library_dirs)
        # filter out standard library paths, which are not explicitely needed
        # for linking
        library_dirs = [dir for dir in library_dirs
                        if not dir in ('/lib', '/lib64', '/usr/lib', '/usr/lib64')]
        runtime_library_dirs = [dir for dir in runtime_library_dirs
                                if not dir in ('/lib', '/lib64', '/usr/lib', '/usr/lib64')]
        lib_opts = gen_lib_options(self, library_dirs, runtime_library_dirs,
                                   libraries)
        if type(output_dir) not in (StringType, NoneType):
            raise TypeError, "'output_dir' must be a string or None"
        if output_dir is not None:
            output_filename = os.path.join(output_dir, output_filename)

        if self._need_link(objects, output_filename):
            ld_args = (objects + self.objects +
                       lib_opts + ['-o', output_filename])
            if debug:
                ld_args[:0] = ['-g']
            if extra_preargs:
                ld_args[:0] = extra_preargs
            if extra_postargs:
                ld_args.extend(extra_postargs)
            self.mkpath(os.path.dirname(output_filename))
            try:
                if target_desc == CCompiler.EXECUTABLE:
                    linker = self.linker_exe[:]
                else:
                    linker = self.linker_so[:]
                if target_lang == "c++" and self.compiler_cxx:
                    # skip over environment variable settings if /usr/bin/env
                    # is used to set up the linker's environment.
                    # This is needed on OSX. Note: this assumes that the
                    # normal and C++ compiler have the same environment
                    # settings.
                    i = 0
                    if os.path.basename(linker[0]) == "env":
                        i = 1
                        while '=' in linker[i]:
                            i = i + 1

                    linker[i] = self.compiler_cxx[i]

                if sys.platform == 'darwin':
                    linker = _osx_support.compiler_fixup(linker, ld_args)

                self.spawn(linker + ld_args)
            except DistutilsExecError, msg:
                raise LinkError, msg
        else:
            log.debug("skipping %s (up-to-date)", output_filename)

    # -- Miscellaneous methods -----------------------------------------
    # These are all used by the 'gen_lib_options() function, in
    # ccompiler.py.

    def library_dir_option(self, dir):
        return "-L" + dir

    def _is_gcc(self, compiler_name):
        return "gcc" in compiler_name or "g++" in compiler_name

    def runtime_library_dir_option(self, dir):
        # XXX Hackish, at the very least.  See Python bug #445902:
        # http://sourceforge.net/tracker/index.php
        #   ?func=detail&aid=445902&group_id=5470&atid=105470
        # Linkers on different platforms need different options to
        # specify that directories need to be added to the list of
        # directories searched for dependencies when a dynamic library
        # is sought.  GCC has to be told to pass the -R option through
        # to the linker, whereas other compilers just know this.
        # Other compilers may need something slightly different.  At
        # this time, there's no way to determine this information from
        # the configuration data stored in the Python installation, so
        # we use this hack.
        compiler = os.path.basename(sysconfig.get_config_var("CC"))
        if sys.platform[:6] == "darwin":
            # MacOSX's linker doesn't understand the -R flag at all
            return "-L" + dir
        elif sys.platform[:5] == "hp-ux":
            if self._is_gcc(compiler):
                return ["-Wl,+s", "-L" + dir]
            return ["+s", "-L" + dir]
        elif sys.platform[:7] == "irix646" or sys.platform[:6] == "osf1V5":
            return ["-rpath", dir]
        elif self._is_gcc(compiler):
            return "-Wl,-R" + dir
        else:
            return "-R" + dir

    def library_option(self, lib):
        return "-l" + lib

    def find_library_file(self, dirs, lib, debug=0):
        shared_f = self.library_filename(lib, lib_type='shared')
        dylib_f = self.library_filename(lib, lib_type='dylib')
        static_f = self.library_filename(lib, lib_type='static')

        if sys.platform == 'darwin':
            # On OSX users can specify an alternate SDK using
            # '-isysroot', calculate the SDK root if it is specified
            # (and use it further on)
            cflags = sysconfig.get_config_var('CFLAGS')
            m = re.search(r'-isysroot\s+(\S+)', cflags)
            if m is None:
                sysroot = '/'
            else:
                sysroot = m.group(1)



        for dir in dirs:
            shared = os.path.join(dir, shared_f)
            dylib = os.path.join(dir, dylib_f)
            static = os.path.join(dir, static_f)

            if sys.platform == 'darwin' and (
                dir.startswith('/System/') or (
                dir.startswith('/usr/') and not dir.startswith('/usr/local/'))):

                shared = os.path.join(sysroot, dir[1:], shared_f)
                dylib = os.path.join(sysroot, dir[1:], dylib_f)
                static = os.path.join(sysroot, dir[1:], static_f)

            # We're second-guessing the linker here, with not much hard
            # data to go on: GCC seems to prefer the shared library, so I'm
            # assuming that *all* Unix C compilers do.  And of course I'm
            # ignoring even GCC's "-static" option.  So sue me.
            if os.path.exists(dylib):
                return dylib
            elif os.path.exists(shared):
                return shared
            elif os.path.exists(static):
                return static

        # Oops, didn't find it in *any* of 'dirs'
        return None
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           """distutils.util

Miscellaneous utility functions -- anything that doesn't fit into
one of the other *util.py modules.
"""

__revision__ = "$Id$"

import sys, os, string, re
from distutils.errors import DistutilsPlatformError
from distutils.dep_util import newer
from distutils.spawn import spawn
from distutils import log
from distutils.errors import DistutilsByteCompileError

def get_platform ():
    """Return a string that identifies the current platform.  This is used
    mainly to distinguish platform-specific build directories and
    platform-specific built distributions.  Typically includes the OS name
    and version and the architecture (as supplied by 'os.uname()'),
    although the exact information included depends on the OS; eg. for IRIX
    the architecture isn't particularly important (IRIX only runs on SGI
    hardware), but for Linux the kernel version isn't particularly
    important.

    Examples of returned values:
       linux-i586
       linux-alpha (?)
       solaris-2.6-sun4u
       irix-5.3
       irix64-6.2

    Windows will return one of:
       win-amd64 (64bit Windows on AMD64 (aka x86_64, Intel64, EM64T, etc)
       win-ia64 (64bit Windows on Itanium)
       win32 (all others - specifically, sys.platform is returned)

    For other non-POSIX platforms, currently just returns 'sys.platform'.
    """
    if os.name == 'nt':
        # sniff sys.version for architecture.
        prefix = " bit ("
        i = string.find(sys.version, prefix)
        if i == -1:
            return sys.platform
        j = string.find(sys.version, ")", i)
        look = sys.version[i+len(prefix):j].lower()
        if look=='amd64':
            return 'win-amd64'
        if look=='itanium':
            return 'win-ia64'
        return sys.platform

    # Set for cross builds explicitly
    if "_PYTHON_HOST_PLATFORM" in os.environ:
        return os.environ["_PYTHON_HOST_PLATFORM"]

    if os.name != "posix" or not hasattr(os, 'uname'):
        # XXX what about the architecture? NT is Intel or Alpha,
        # Mac OS is M68k or PPC, etc.
        return sys.platform

    # Try to distinguish various flavours of Unix

    (osname, host, release, version, machine) = os.uname()

    # Convert the OS name to lowercase, remove '/' characters
    # (to accommodate BSD/OS), and translate spaces (for "Power Macintosh")
    osname = string.lower(osname)
    osname = string.replace(osname, '/', '')
    machine = string.replace(machine, ' ', '_')
    machine = string.replace(machine, '/', '-')

    if osname[:5] == "linux":
        # At least on Linux/Intel, 'machine' is the processor --
        # i386, etc.
        # XXX what about Alpha, SPARC, etc?
        return  "%s-%s" % (osname, machine)
    elif osname[:5] == "sunos":
        if release[0] >= "5":           # SunOS 5 == Solaris 2
            osname = "solaris"
            release = "%d.%s" % (int(release[0]) - 3, release[2:])
            # We can't use "platform.architecture()[0]" because a
            # bootstrap problem. We use a dict to get an error
            # if some suspicious happens.
            bitness = {2147483647:"32bit", 9223372036854775807:"64bit"}
            machine += ".%s" % bitness[sys.maxint]
        # fall through to standard osname-release-machine representation
    elif osname[:4] == "irix":              # could be "irix64"!
        return "%s-%s" % (osname, release)
    elif osname[:3] == "aix":
        return "%s-%s.%s" % (osname, version, release)
    elif osname[:6] == "cygwin":
        osname = "cygwin"
        rel_re = re.compile (r'[\d.]+')
        m = rel_re.match(release)
        if m:
            release = m.group()
    elif osname[:6] == "darwin":
        import _osx_support, distutils.sysconfig
        osname, release, machine = _osx_support.get_platform_osx(
                                        distutils.sysconfig.get_config_vars(),
                                        osname, release, machine)

    return "%s-%s-%s" % (osname, release, machine)

# get_platform ()


def convert_path (pathname):
    """Return 'pathname' as a name that will work on the native filesystem,
    i.e. split it on '/' and put it back together again using the current
    directory separator.  Needed because filenames in the setup script are
    always supplied in Unix style, and have to be converted to the local
    convention before we can actually use them in the filesystem.  Raises
    ValueError on non-Unix-ish systems if 'pathname' either starts or
    ends with a slash.
    """
    if os.sep == '/':
        return pathname
    if not pathname:
        return pathname
    if pathname[0] == '/':
        raise ValueError, "path '%s' cannot be absolute" % pathname
    if pathname[-1] == '/':
        raise ValueError, "path '%s' cannot end with '/'" % pathname

    paths = string.split(pathname, '/')
    while '.' in paths:
        paths.remove('.')
    if not paths:
        return os.curdir
    return os.path.join(*paths)

# convert_path ()


def change_root (new_root, pathname):
    """Return 'pathname' with 'new_root' prepended.  If 'pathname' is
    relative, this is equivalent to "os.path.join(new_root,pathname)".
    Otherwise, it requires making 'pathname' relative and then joining the
    two, which is tricky on DOS/Windows and Mac OS.
    """
    if os.name == 'posix':
        if not os.path.isabs(pathname):
            return os.path.join(new_root, pathname)
        else:
            return os.path.join(new_root, pathname[1:])

    elif os.name == 'nt':
        (drive, path) = os.path.splitdrive(pathname)
        if path[0] == '\\':
            path = path[1:]
        return os.path.join(new_root, path)

    elif os.name == 'os2':
        (drive, path) = os.path.splitdrive(pathname)
        if path[0] == os.sep:
            path = path[1:]
        return os.path.join(new_root, path)

    else:
        raise DistutilsPlatformError, \
              "nothing known about platform '%s'" % os.name


_environ_checked = 0
def check_environ ():
    """Ensure that 'os.environ' has all the environment variables we
    guarantee that users can use in config files, command-line options,
    etc.  Currently this includes:
      HOME - user's home directory (Unix only)
      PLAT - description of the current platform, including hardware
             and OS (see 'get_platform()')
    """
    global _environ_checked
    if _environ_checked:
        return

    if os.name == 'posix' and 'HOME' not in os.environ:
        import pwd
        os.environ['HOME'] = pwd.getpwuid(os.getuid())[5]

    if 'PLAT' not in os.environ:
        os.environ['PLAT'] = get_platform()

    _environ_checked = 1


def subst_vars (s, local_vars):
    """Perform shell/Perl-style variable substitution on 'string'.  Every
    occurrence of '$' followed by a name is considered a variable, and
    variable is substituted by the value found in the 'local_vars'
    dictionary, or in 'os.environ' if it's not in 'local_vars'.
    'os.environ' is first checked/augmented to guarantee that it contains
    certain values: see 'check_environ()'.  Raise ValueError for any
    variables not found in either 'local_vars' or 'os.environ'.
    """
    check_environ()
    def _subst (match, local_vars=local_vars):
        var_name = match.group(1)
        if var_name in local_vars:
            return str(local_vars[var_name])
        else:
            return os.environ[var_name]

    try:
        return re.sub(r'\$([a-zA-Z_][a-zA-Z_0-9]*)', _subst, s)
    except KeyError, var:
        raise ValueError, "invalid variable '$%s'" % var

# subst_vars ()


def grok_environment_error (exc, prefix="error: "):
    # Function kept for backward compatibility.
    # Used to try clever things with EnvironmentErrors,
    # but nowadays str(exception) produces good messages.
    return prefix + str(exc)


# Needed by 'split_quoted()'
_wordchars_re = _squote_re = _dquote_re = None
def _init_regex():
    global _wordchars_re, _squote_re, _dquote_re
    _wordchars_re = re.compile(r'[^\\\'\"%s ]*' % string.whitespace)
    _squote_re = re.compile(r"'(?:[^'\\]|\\.)*'")
    _dquote_re = re.compile(r'"(?:[^"\\]|\\.)*"')

def split_quoted (s):
    """Split a string up according to Unix shell-like rules for quotes and
    backslashes.  In short: words are delimited by spaces, as long as those
    spaces are not escaped by a backslash, or inside a quoted string.
    Single and double quotes are equivalent, and the quote characters can
    be backslash-escaped.  The backslash is stripped from any two-character
    escape sequence, leaving only the escaped character.  The quote
    characters are stripped from any quoted string.  Returns a list of
    words.
    """

    # This is a nice algorithm for splitting up a single string, since it
    # doesn't require character-by-character examination.  It was a little
    # bit of a brain-bender to get it working right, though...
    if _wordchars_re is None: _init_regex()

    s = string.strip(s)
    words = []
    pos = 0

    while s:
        m = _wordchars_re.match(s, pos)
        end = m.end()
        if end == len(s):
            words.append(s[:end])
            break

        if s[end] in string.whitespace: # unescaped, unquoted whitespace: now
            words.append(s[:end])       # we definitely have a word delimiter
            s = string.lstrip(s[end:])
            pos = 0

        elif s[end] == '\\':            # preserve whatever is being escaped;
                                        # will become part of the current word
            s = s[:end] + s[end+1:]
            pos = end+1

        else:
            if s[end] == "'":           # slurp singly-quoted string
                m = _squote_re.match(s, end)
            elif s[end] == '"':         # slurp doubly-quoted string
                m = _dquote_re.match(s, end)
            else:
                raise RuntimeError, \
                      "this can't happen (bad char '%c')" % s[end]

            if m is None:
                raise ValueError, \
                      "bad string (mismatched %s quotes?)" % s[end]

            (beg, end) = m.span()
            s = s[:beg] + s[beg+1:end-1] + s[end:]
            pos = m.end() - 2

        if pos >= len(s):
            words.append(s)
            break

    return words

# split_quoted ()


def execute (func, args, msg=None, verbose=0, dry_run=0):
    """Perform some action that affects the outside world (eg.  by
    writing to the filesystem).  Such actions are special because they
    are disabled by the 'dry_run' flag.  This method takes care of all
    that bureaucracy for you; all you have to do is supply the
    function to call and an argument tuple for it (to embody the
    "external action" being performed), and an optional message to
    print.
    """
    if msg is None:
        msg = "%s%r" % (func.__name__, args)
        if msg[-2:] == ',)':        # correct for singleton tuple
            msg = msg[0:-2] + ')'

    log.info(msg)
    if not dry_run:
        func(*args)


def strtobool (val):
    """Convert a string representation of truth to true (1) or false (0).

    True values are 'y', 'yes', 't', 'true', 'on', and '1'; false values
    are 'n', 'no', 'f', 'false', 'off', and '0'.  Raises ValueError if
    'val' is anything else.
    """
    val = string.lower(val)
    if val in ('y', 'yes', 't', 'true', 'on', '1'):
        return 1
    elif val in ('n', 'no', 'f', 'false', 'off', '0'):
        return 0
    else:
        raise ValueError, "invalid truth value %r" % (val,)


def byte_compile (py_files,
                  optimize=0, force=0,
                  prefix=None, base_dir=None,
                  verbose=1, dry_run=0,
                  direct=None):
    """Byte-compile a collection of Python source files to either .pyc
    or .pyo files in the same directory.  'py_files' is a list of files
    to compile; any files that don't end in ".py" are silently skipped.
    'optimize' must be one of the following:
      0 - don't optimize (generate .pyc)
      1 - normal optimization (like "python -O")
      2 - extra optimization (like "python -OO")
    If 'force' is true, all files are recompiled regardless of
    timestamps.

    The source filename encoded in each bytecode file defaults to the
    filenames listed in 'py_files'; you can modify these with 'prefix' and
    'basedir'.  'prefix' is a string that will be stripped off of each
    source filename, and 'base_dir' is a directory name that will be
    prepended (after 'prefix' is stripped).  You can supply either or both
    (or neither) of 'prefix' and 'base_dir', as you wish.

    If 'dry_run' is true, doesn't actually do anything that would
    affect the filesystem.

    Byte-compilation is either done directly in this interpreter process
    with the standard py_compile module, or indirectly by writing a
    temporary script and executing it.  Normally, you should let
    'byte_compile()' figure out to use direct compilation or not (see
    the source for details).  The 'direct' flag is used by the script
    generated in indirect mode; unless you know what you're doing, leave
    it set to None.
    """
    # nothing is done if sys.dont_write_bytecode is True
    if sys.dont_write_bytecode:
        raise DistutilsByteCompileError('byte-compiling is disabled.')

    # First, if the caller didn't force us into direct or indirect mode,
    # figure out which mode we should be in.  We take a conservative
    # approach: choose direct mode *only* if the current interpreter is
    # in debug mode and optimize is 0.  If we're not in debug mode (-O
    # or -OO), we don't know which level of optimization this
    # interpreter is running with, so we can't do direct
    # byte-compilation and be certain that it's the right thing.  Thus,
    # always compile indirectly if the current interpreter is in either
    # optimize mode, or if either optimization level was requested by
    # the caller.
    if direct is None:
        direct = (__debug__ and optimize == 0)

    # "Indirect" byte-compilation: write a temporary script and then
    # run it with the appropriate flags.
    if not direct:
        try:
            from tempfile import mkstemp
            (script_fd, script_name) = mkstemp(".py")
        except ImportError:
            from tempfile import mktemp
            (script_fd, script_name) = None, mktemp(".py")
        log.info("writing byte-compilation script '%s'", script_name)
        if not dry_run:
            if script_fd is not None:
                script = os.fdopen(script_fd, "w")
            else:
                script = open(script_name, "w")

            script.write("""\
from distutils.util import byte_compile
files = [
""")

            # XXX would be nice to write absolute filenames, just for
            # safety's sake (script should be more robust in the face of
            # chdir'ing before running it).  But this requires abspath'ing
            # 'prefix' as well, and that breaks the hack in build_lib's
            # 'byte_compile()' method that carefully tacks on a trailing
            # slash (os.sep really) to make sure the prefix here is "just
            # right".  This whole prefix business is rather delicate -- the
            # problem is that it's really a directory, but I'm treating it
            # as a dumb string, so trailing slashes and so forth matter.

            #py_files = map(os.path.abspath, py_files)
            #if prefix:
            #    prefix = os.path.abspath(prefix)

            script.write(string.join(map(repr, py_files), ",\n") + "]\n")
            script.write("""
byte_compile(files, optimize=%r, force=%r,
             prefix=%r, base_dir=%r,
             verbose=%r, dry_run=0,
             direct=1)
""" % (optimize, force, prefix, base_dir, verbose))

            script.close()

        cmd = [sys.executable, script_name]
        if optimize == 1:
            cmd.insert(1, "-O")
        elif optimize == 2:
            cmd.insert(1, "-OO")
        spawn(cmd, dry_run=dry_run)
        execute(os.remove, (script_name,), "removing %s" % script_name,
                dry_run=dry_run)

    # "Direct" byte-compilation: use the py_compile module to compile
    # right here, right now.  Note that the script generated in indirect
    # mode simply calls 'byte_compile()' in direct mode, a weird sort of
    # cross-process recursion.  Hey, it works!
    else:
        from py_compile import compile

        for file in py_files:
            if file[-3:] != ".py":
                # This lets us be lazy and not filter filenames in
                # the "install_lib" command.
                continue

            # Terminology from the py_compile module:
            #   cfile - byte-compiled file
            #   dfile - purported source filename (same as 'file' by default)
            cfile = file + (__debug__ and "c" or "o")
            dfile = file
            if prefix:
                if file[:len(prefix)] != prefix:
                    raise ValueError, \
                          ("invalid prefix: filename %r doesn't start with %r"
                           % (file, prefix))
                dfile = dfile[len(prefix):]
            if base_dir:
                dfile = os.path.join(base_dir, dfile)

            cfile_base = os.path.basename(cfile)
            if direct:
                if force or newer(file, cfile):
                    log.info("byte-compiling %s to %s", file, cfile_base)
                    if not dry_run:
                        compile(file, cfile, dfile)
                else:
                    log.debug("skipping byte-compilation of %s to %s",
                              file, cfile_base)

# byte_compile ()

def rfc822_escape (header):
    """Return a version of the string escaped for inclusion in an
    RFC-822 header, by ensuring there are 8 spaces space after each newline.
    """
    lines = string.split(header, '\n')
    header = string.join(lines, '\n' + 8*' ')
    return header
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           #
# distutils/version.py
#
# Implements multiple version numbering conventions for the
# Python Module Distribution Utilities.
#
# $Id$
#

"""Provides classes to represent module version numbers (one class for
each style of version numbering).  There are currently two such classes
implemented: StrictVersion and LooseVersion.

Every version number class implements the following interface:
  * the 'parse' method takes a string and parses it to some internal
    representation; if the string is an invalid version number,
    'parse' raises a ValueError exception
  * the class constructor takes an optional string argument which,
    if supplied, is passed to 'parse'
  * __str__ reconstructs the string that was passed to 'parse' (or
    an equivalent string -- ie. one that will generate an equivalent
    version number instance)
  * __repr__ generates Python code to recreate the version number instance
  * __cmp__ compares the current instance with either another instance
    of the same class or a string (which will be parsed to an instance
    of the same class, thus must follow the same rules)
"""

import string, re
from types import StringType

class Version:
    """Abstract base class for version numbering classes.  Just provides
    constructor (__init__) and reproducer (__repr__), because those
    seem to be the same for all version numbering classes.
    """

    def __init__ (self, vstring=None):
        if vstring:
            self.parse(vstring)

    def __repr__ (self):
        return "%s ('%s')" % (self.__class__.__name__, str(self))


# Interface for version-number classes -- must be implemented
# by the following classes (the concrete ones -- Version should
# be treated as an abstract class).
#    __init__ (string) - create and take same action as 'parse'
#                        (string parameter is optional)
#    parse (string)    - convert a string representation to whatever
#                        internal representation is appropriate for
#                        this style of version numbering
#    __str__ (self)    - convert back to a string; should be very similar
#                        (if not identical to) the string supplied to parse
#    __repr__ (self)   - generate Python code to recreate
#                        the instance
#    __cmp__ (self, other) - compare two version numbers ('other' may
#                        be an unparsed version string, or another
#                        instance of your version class)


class StrictVersion (Version):

    """Version numbering for anal retentives and software idealists.
    Implements the standard interface for version number classes as
    described above.  A version number consists of two or three
    dot-separated numeric components, with an optional "pre-release" tag
    on the end.  The pre-release tag consists of the letter 'a' or 'b'
    followed by a number.  If the numeric components of two version
    numbers are equal, then one with a pre-release tag will always
    be deemed earlier (lesser) than one without.

    The following are valid version numbers (shown in the order that
    would be obtained by sorting according to the supplied cmp function):

        0.4       0.4.0  (these two are equivalent)
        0.4.1
        0.5a1
        0.5b3
        0.5
        0.9.6
        1.0
        1.0.4a3
        1.0.4b1
        1.0.4

    The following are examples of invalid version numbers:

        1
        2.7.2.2
        1.3.a4
        1.3pl1
        1.3c4

    The rationale for this version numbering system will be explained
    in the distutils documentation.
    """

    version_re = re.compile(r'^(\d+) \. (\d+) (\. (\d+))? ([ab](\d+))?$',
                            re.VERBOSE)


    def parse (self, vstring):
        match = self.version_re.match(vstring)
        if not match:
            raise ValueError, "invalid version number '%s'" % vstring

        (major, minor, patch, prerelease, prerelease_num) = \
            match.group(1, 2, 4, 5, 6)

        if patch:
            self.version = tuple(map(string.atoi, [major, minor, patch]))
        else:
            self.version = tuple(map(string.atoi, [major, minor]) + [0])

        if prerelease:
            self.prerelease = (prerelease[0], string.atoi(prerelease_num))
        else:
            self.prerelease = None


    def __str__ (self):

        if self.version[2] == 0:
            vstring = string.join(map(str, self.version[0:2]), '.')
        else:
            vstring = string.join(map(str, self.version), '.')

        if self.prerelease:
            vstring = vstring + self.prerelease[0] + str(self.prerelease[1])

        return vstring


    def __cmp__ (self, other):
        if isinstance(other, StringType):
            other = StrictVersion(other)

        compare = cmp(self.version, other.version)
        if (compare == 0):              # have to compare prerelease

            # case 1: neither has prerelease; they're equal
            # case 2: self has prerelease, other doesn't; other is greater
            # case 3: self doesn't have prerelease, other does: self is greater
            # case 4: both have prerelease: must compare them!

            if (not self.prerelease and not other.prerelease):
                return 0
            elif (self.prerelease and not other.prerelease):
                return -1
            elif (not self.prerelease and other.prerelease):
                return 1
            elif (self.prerelease and other.prerelease):
                return cmp(self.prerelease, other.prerelease)

        else:                           # numeric versions don't match --
            return compare              # prerelease stuff doesn't matter


# end class StrictVersion


# The rules according to Greg Stein:
# 1) a version number has 1 or more numbers separated by a period or by
#    sequences of letters. If only periods, then these are compared
#    left-to-right to determine an ordering.
# 2) sequences of letters are part of the tuple for comparison and are
#    compared lexicographically
# 3) recognize the numeric components may have leading zeroes
#
# The LooseVersion class below implements these rules: a version number
# string is split up into a tuple of integer and string components, and
# comparison is a simple tuple comparison.  This means that version
# numbers behave in a predictable and obvious way, but a way that might
# not necessarily be how people *want* version numbers to behave.  There
# wouldn't be a problem if people could stick to purely numeric version
# numbers: just split on period and compare the numbers as tuples.
# However, people insist on putting letters into their version numbers;
# the most common purpose seems to be:
#   - indicating a "pre-release" version
#     ('alpha', 'beta', 'a', 'b', 'pre', 'p')
#   - indicating a post-release patch ('p', 'pl', 'patch')
# but of course this can't cover all version number schemes, and there's
# no way to know what a programmer means without asking him.
#
# The problem is what to do with letters (and other non-numeric
# characters) in a version number.  The current implementation does the
# obvious and predictable thing: keep them as strings and compare
# lexically within a tuple comparison.  This has the desired effect if
# an appended letter sequence implies something "post-release":
# eg. "0.99" < "0.99pl14" < "1.0", and "5.001" < "5.001m" < "5.002".
#
# However, if letters in a version number imply a pre-release version,
# the "obvious" thing isn't correct.  Eg. you would expect that
# "1.5.1" < "1.5.2a2" < "1.5.2", but under the tuple/lexical comparison
# implemented here, this just isn't so.
#
# Two possible solutions come to mind.  The first is to tie the
# comparison algorithm to a particular set of semantic rules, as has
# been done in the StrictVersion class above.  This works great as long
# as everyone can go along with bondage and discipline.  Hopefully a
# (large) subset of Python module programmers will agree that the
# particular flavour of bondage and discipline provided by StrictVersion
# provides enough benefit to be worth using, and will submit their
# version numbering scheme to its domination.  The free-thinking
# anarchists in the lot will never give in, though, and something needs
# to be done to accommodate them.
#
# Perhaps a "moderately strict" version class could be implemented that
# lets almost anything slide (syntactically), and makes some heuristic
# assumptions about non-digits in version number strings.  This could
# sink into special-case-hell, though; if I was as talented and
# idiosyncratic as Larry Wall, I'd go ahead and implement a class that
# somehow knows that "1.2.1" < "1.2.2a2" < "1.2.2" < "1.2.2pl3", and is
# just as happy dealing with things like "2g6" and "1.13++".  I don't
# think I'm smart enough to do it right though.
#
# In any case, I've coded the test suite for this module (see
# ../test/test_version.py) specifically to fail on things like comparing
# "1.2a2" and "1.2".  That's not because the *code* is doing anything
# wrong, it's because the simple, obvious design doesn't match my
# complicated, hairy expectations for real-world version numbers.  It
# would be a snap to fix the test suite to say, "Yep, LooseVersion does
# the Right Thing" (ie. the code matches the conception).  But I'd rather
# have a conception that matches common notions about version numbers.

class LooseVersion (Version):

    """Version numbering for anarchists and software realists.
    Implements the standard interface for version number classes as
    described above.  A version number consists of a series of numbers,
    separated by either periods or strings of letters.  When comparing
    version numbers, the numeric components will be compared
    numerically, and the alphabetic components lexically.  The following
    are all valid version numbers, in no particular order:

        1.5.1
        1.5.2b2
        161
        3.10a
        8.02
        3.4j
        1996.07.12
        3.2.pl0
        3.1.1.6
        2g6
        11g
        0.960923
        2.2beta29
        1.13++
        5.5.kw
        2.0b1pl0

    In fact, there is no such thing as an invalid version number under
    this scheme; the rules for comparison are simple and predictable,
    but may not always give the results you want (for some definition
    of "want").
    """

    component_re = re.compile(r'(\d+ | [a-z]+ | \.)', re.VERBOSE)

    def __init__ (self, vstring=None):
        if vstring:
            self.parse(vstring)


    def parse (self, vstring):
        # I've given up on thinking I can reconstruct the version string
        # from the parsed tuple -- so I just store the string here for
        # use by __str__
        self.vstring = vstring
        components = filter(lambda x: x and x != '.',
                            self.component_re.split(vstring))
        for i in range(len(components)):
            try:
                components[i] = int(components[i])
            except ValueError:
                pass

        self.version = components


    def __str__ (self):
        return self.vstring


    def __repr__ (self):
        return "LooseVersion ('%s')" % str(self)


    def __cmp__ (self, other):
        if isinstance(other, StringType):
            other = LooseVersion(other)

        return cmp(self.version, other.version)


# end class LooseVersion
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       """Module for parsing and testing package version predicate strings.
"""
import re
import distutils.version
import operator


re_validPackage = re.compile(r"(?i)^\s*([a-z_]\w*(?:\.[a-z_]\w*)*)(.*)")
# (package) (rest)

re_paren = re.compile(r"^\s*\((.*)\)\s*$") # (list) inside of parentheses
re_splitComparison = re.compile(r"^\s*(<=|>=|<|>|!=|==)\s*([^\s,]+)\s*$")
# (comp) (version)


def splitUp(pred):
    """Parse a single version comparison.

    Return (comparison string, StrictVersion)
    """
    res = re_splitComparison.match(pred)
    if not res:
        raise ValueError("bad package restriction syntax: %r" % pred)
    comp, verStr = res.groups()
    return (comp, distutils.version.StrictVersion(verStr))

compmap = {"<": operator.lt, "<=": operator.le, "==": operator.eq,
           ">": operator.gt, ">=": operator.ge, "!=": operator.ne}

class VersionPredicate:
    """Parse and test package version predicates.

    >>> v = VersionPredicate('pyepat.abc (>1.0, <3333.3a1, !=1555.1b3)')

    The `name` attribute provides the full dotted name that is given::

    >>> v.name
    'pyepat.abc'

    The str() of a `VersionPredicate` provides a normalized
    human-readable version of the expression::

    >>> print v
    pyepat.abc (> 1.0, < 3333.3a1, != 1555.1b3)

    The `satisfied_by()` method can be used to determine with a given
    version number is included in the set described by the version
    restrictions::

    >>> v.satisfied_by('1.1')
    True
    >>> v.satisfied_by('1.4')
    True
    >>> v.satisfied_by('1.0')
    False
    >>> v.satisfied_by('4444.4')
    False
    >>> v.satisfied_by('1555.1b3')
    False

    `VersionPredicate` is flexible in accepting extra whitespace::

    >>> v = VersionPredicate(' pat( ==  0.1  )  ')
    >>> v.name
    'pat'
    >>> v.satisfied_by('0.1')
    True
    >>> v.satisfied_by('0.2')
    False

    If any version numbers passed in do not conform to the
    restrictions of `StrictVersion`, a `ValueError` is raised::

    >>> v = VersionPredicate('p1.p2.p3.p4(>=1.0, <=1.3a1, !=1.2zb3)')
    Traceback (most recent call last):
      ...
    ValueError: invalid version number '1.2zb3'

    It the module or package name given does not conform to what's
    allowed as a legal module or package name, `ValueError` is
    raised::

    >>> v = VersionPredicate('foo-bar')
    Traceback (most recent call last):
      ...
    ValueError: expected parenthesized list: '-bar'

    >>> v = VersionPredicate('foo bar (12.21)')
    Traceback (most recent call last):
      ...
    ValueError: expected parenthesized list: 'bar (12.21)'

    """

    def __init__(self, versionPredicateStr):
        """Parse a version predicate string.
        """
        # Fields:
        #    name:  package name
        #    pred:  list of (comparison string, StrictVersion)

        versionPredicateStr = versionPredicateStr.strip()
        if not versionPredicateStr:
            raise ValueError("empty package restriction")
        match = re_validPackage.match(versionPredicateStr)
        if not match:
            raise ValueError("bad package name in %r" % versionPredicateStr)
        self.name, paren = match.groups()
        paren = paren.strip()
        if paren:
            match = re_paren.match(paren)
            if not match:
                raise ValueError("expected parenthesized list: %r" % paren)
            str = match.groups()[0]
            self.pred = [splitUp(aPred) for aPred in str.split(",")]
            if not self.pred:
                raise ValueError("empty parenthesized list in %r"
                                 % versionPredicateStr)
        else:
            self.pred = []

    def __str__(self):
        if self.pred:
            seq = [cond + " " + str(ver) for cond, ver in self.pred]
            return self.name + " (" + ", ".join(seq) + ")"
        else:
            return self.name

    def satisfied_by(self, version):
        """True if version is compatible with all the predicates in self.
        The parameter version must be acceptable to the StrictVersion
        constructor.  It may be either a string or StrictVersion.
        """
        for cond, ver in self.pred:
            if not compmap[cond](version, ver):
                return False
        return True


_provision_rx = None

def split_provision(value):
    """Return the name and optional version number of a provision.

    The version number, if given, will be returned as a `StrictVersion`
    instance, otherwise it will be `None`.

    >>> split_provision('mypkg')
    ('mypkg', None)
    >>> split_provision(' mypkg( 1.2 ) ')
    ('mypkg', StrictVersion ('1.2'))
    """
    global _provision_rx
    if _provision_rx is None:
        _provision_rx = re.compile(
            "([a-zA-Z_]\w*(?:\.[a-zA-Z_]\w*)*)(?:\s*\(\s*([^)\s]+)\s*\))?$")
    value = value.strip()
    m = _provision_rx.match(value)
    if not m:
        raise ValueError("illegal provides specification: %r" % value)
    ver = m.group(2) or None
    if ver:
        ver = distutils.version.StrictVersion(ver)
    return m.group(1), ver
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # This is the Python mapping for interface NodeFilter from
# DOM2-Traversal-Range. It contains only constants.

class NodeFilter:
    """
    This is the DOM2 NodeFilter interface. It contains only constants.
    """
    FILTER_ACCEPT = 1
    FILTER_REJECT = 2
    FILTER_SKIP   = 3

    SHOW_ALL                    = 0xFFFFFFFFL
    SHOW_ELEMENT                = 0x00000001
    SHOW_ATTRIBUTE              = 0x00000002
    SHOW_TEXT                   = 0x00000004
    SHOW_CDATA_SECTION          = 0x00000008
    SHOW_ENTITY_REFERENCE       = 0x00000010
    SHOW_ENTITY                 = 0x00000020
    SHOW_PROCESSING_INSTRUCTION = 0x00000040
    SHOW_COMMENT                = 0x00000080
    SHOW_DOCUMENT               = 0x00000100
    SHOW_DOCUMENT_TYPE          = 0x00000200
    SHOW_DOCUMENT_FRAGMENT      = 0x00000400
    SHOW_NOTATION               = 0x00000800

    def acceptNode(self, node):
        raise NotImplementedError
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       """W3C Document Object Model implementation for Python.

The Python mapping of the Document Object Model is documented in the
Python Library Reference in the section on the xml.dom package.

This package contains the following modules:

minidom -- A simple implementation of the Level 1 DOM with namespace
           support added (based on the Level 2 specification) and other
           minor Level 2 functionality.

pulldom -- DOM builder supporting on-demand tree-building for selected
           subtrees of the document.

"""


class Node:
    """Class giving the NodeType constants."""

    # DOM implementations may use this as a base class for their own
    # Node implementations.  If they don't, the constants defined here
    # should still be used as the canonical definitions as they match
    # the values given in the W3C recommendation.  Client code can
    # safely refer to these values in all tests of Node.nodeType
    # values.

    ELEMENT_NODE                = 1
    ATTRIBUTE_NODE              = 2
    TEXT_NODE                   = 3
    CDATA_SECTION_NODE          = 4
    ENTITY_REFERENCE_NODE       = 5
    ENTITY_NODE                 = 6
    PROCESSING_INSTRUCTION_NODE = 7
    COMMENT_NODE                = 8
    DOCUMENT_NODE               = 9
    DOCUMENT_TYPE_NODE          = 10
    DOCUMENT_FRAGMENT_NODE      = 11
    NOTATION_NODE               = 12


#ExceptionCode
INDEX_SIZE_ERR                 = 1
DOMSTRING_SIZE_ERR             = 2
HIERARCHY_REQUEST_ERR          = 3
WRONG_DOCUMENT_ERR             = 4
INVALID_CHARACTER_ERR          = 5
NO_DATA_ALLOWED_ERR            = 6
NO_MODIFICATION_ALLOWED_ERR    = 7
NOT_FOUND_ERR                  = 8
NOT_SUPPORTED_ERR              = 9
INUSE_ATTRIBUTE_ERR            = 10
INVALID_STATE_ERR              = 11
SYNTAX_ERR                     = 12
INVALID_MODIFICATION_ERR       = 13
NAMESPACE_ERR                  = 14
INVALID_ACCESS_ERR             = 15
VALIDATION_ERR                 = 16


class DOMException(Exception):
    """Abstract base class for DOM exceptions.
    Exceptions with specific codes are specializations of this class."""

    def __init__(self, *args, **kw):
        if self.__class__ is DOMException:
            raise RuntimeError(
                "DOMException should not be instantiated directly")
        Exception.__init__(self, *args, **kw)

    def _get_code(self):
        return self.code


class IndexSizeErr(DOMException):
    code = INDEX_SIZE_ERR

class DomstringSizeErr(DOMException):
    code = DOMSTRING_SIZE_ERR

class HierarchyRequestErr(DOMException):
    code = HIERARCHY_REQUEST_ERR

class WrongDocumentErr(DOMException):
    code = WRONG_DOCUMENT_ERR

class InvalidCharacterErr(DOMException):
    code = INVALID_CHARACTER_ERR

class NoDataAllowedErr(DOMException):
    code = NO_DATA_ALLOWED_ERR

class NoModificationAllowedErr(DOMException):
    code = NO_MODIFICATION_ALLOWED_ERR

class NotFoundErr(DOMException):
    code = NOT_FOUND_ERR

class NotSupportedErr(DOMException):
    code = NOT_SUPPORTED_ERR

class InuseAttributeErr(DOMException):
    code = INUSE_ATTRIBUTE_ERR

class InvalidStateErr(DOMException):
    code = INVALID_STATE_ERR

class SyntaxErr(DOMException):
    code = SYNTAX_ERR

class InvalidModificationErr(DOMException):
    code = INVALID_MODIFICATION_ERR

class NamespaceErr(DOMException):
    code = NAMESPACE_ERR

class InvalidAccessErr(DOMException):
    code = INVALID_ACCESS_ERR

class ValidationErr(DOMException):
    code = VALIDATION_ERR

class UserDataHandler:
    """Class giving the operation constants for UserDataHandler.handle()."""

    # Based on DOM Level 3 (WD 9 April 2002)

    NODE_CLONED   = 1
    NODE_IMPORTED = 2
    NODE_DELETED  = 3
    NODE_RENAMED  = 4

XML_NAMESPACE = "http://www.w3.org/XML/1998/namespace"
XMLNS_NAMESPACE = "http://www.w3.org/2000/xmlns/"
XHTML_NAMESPACE = "http://www.w3.org/1999/xhtml"
EMPTY_NAMESPACE = None
EMPTY_PREFIX = None

from domreg import getDOMImplementation,registerDOMImplementation
                                                                                                  """Registration facilities for DOM. This module should not be used
directly. Instead, the functions getDOMImplementation and
registerDOMImplementation should be imported from xml.dom."""

from xml.dom.minicompat import *  # isinstance, StringTypes

# This is a list of well-known implementations.  Well-known names
# should be published by posting to xml-sig@python.org, and are
# subsequently recorded in this file.

well_known_implementations = {
    'minidom':'xml.dom.minidom',
    '4DOM': 'xml.dom.DOMImplementation',
    }

# DOM implementations not officially registered should register
# themselves with their

registered = {}

def registerDOMImplementation(name, factory):
    """registerDOMImplementation(name, factory)

    Register the factory function with the name. The factory function
    should return an object which implements the DOMImplementation
    interface. The factory function can either return the same object,
    or a new one (e.g. if that implementation supports some
    customization)."""

    registered[name] = factory

def _good_enough(dom, features):
    "_good_enough(dom, features) -> Return 1 if the dom offers the features"
    for f,v in features:
        if not dom.hasFeature(f,v):
            return 0
    return 1

def getDOMImplementation(name = None, features = ()):
    """getDOMImplementation(name = None, features = ()) -> DOM implementation.

    Return a suitable DOM implementation. The name is either
    well-known, the module name of a DOM implementation, or None. If
    it is not None, imports the corresponding module and returns
    DOMImplementation object if the import succeeds.

    If name is not given, consider the available implementations to
    find one with the required feature set. If no implementation can
    be found, raise an ImportError. The features list must be a sequence
    of (feature, version) pairs which are passed to hasFeature."""

    import os
    creator = None
    mod = well_known_implementations.get(name)
    if mod:
        mod = __import__(mod, {}, {}, ['getDOMImplementation'])
        return mod.getDOMImplementation()
    elif name:
        return registered[name]()
    elif "PYTHON_DOM" in os.environ:
        return getDOMImplementation(name = os.environ["PYTHON_DOM"])

    # User did not specify a name, try implementations in arbitrary
    # order, returning the one that has the required features
    if isinstance(features, StringTypes):
        features = _parse_feature_string(features)
    for creator in registered.values():
        dom = creator()
        if _good_enough(dom, features):
            return dom

    for creator in well_known_implementations.keys():
        try:
            dom = getDOMImplementation(name = creator)
        except StandardError: # typically ImportError, or AttributeError
            continue
        if _good_enough(dom, features):
            return dom

    raise ImportError,"no suitable DOM implementation found"

def _parse_feature_string(s):
    features = []
    parts = s.split()
    i = 0
    length = len(parts)
    while i < length:
        feature = parts[i]
        if feature[0] in "0123456789":
            raise ValueError, "bad feature name: %r" % (feature,)
        i = i + 1
        version = None
        if i < length:
            v = parts[i]
            if v[0] in "0123456789":
                i = i + 1
                version = v
        features.append((feature, version))
    return tuple(features)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          """Facility to use the Expat parser to load a minidom instance
from a string or file.

This avoids all the overhead of SAX and pulldom to gain performance.
"""

# Warning!
#
# This module is tightly bound to the implementation details of the
# minidom DOM and can't be used with other DOM implementations.  This
# is due, in part, to a lack of appropriate methods in the DOM (there is
# no way to create Entity and Notation nodes via the DOM Level 2
# interface), and for performance.  The later is the cause of some fairly
# cryptic code.
#
# Performance hacks:
#
#   -  .character_data_handler() has an extra case in which continuing
#      data is appended to an existing Text node; this can be a
#      speedup since pyexpat can break up character data into multiple
#      callbacks even though we set the buffer_text attribute on the
#      parser.  This also gives us the advantage that we don't need a
#      separate normalization pass.
#
#   -  Determining that a node exists is done using an identity comparison
#      with None rather than a truth test; this avoids searching for and
#      calling any methods on the node object if it exists.  (A rather
#      nice speedup is achieved this way as well!)

from xml.dom import xmlbuilder, minidom, Node
from xml.dom import EMPTY_NAMESPACE, EMPTY_PREFIX, XMLNS_NAMESPACE
from xml.parsers import expat
from xml.dom.minidom import _append_child, _set_attribute_node
from xml.dom.NodeFilter import NodeFilter

from xml.dom.minicompat import *

TEXT_NODE = Node.TEXT_NODE
CDATA_SECTION_NODE = Node.CDATA_SECTION_NODE
DOCUMENT_NODE = Node.DOCUMENT_NODE

FILTER_ACCEPT = xmlbuilder.DOMBuilderFilter.FILTER_ACCEPT
FILTER_REJECT = xmlbuilder.DOMBuilderFilter.FILTER_REJECT
FILTER_SKIP = xmlbuilder.DOMBuilderFilter.FILTER_SKIP
FILTER_INTERRUPT = xmlbuilder.DOMBuilderFilter.FILTER_INTERRUPT

theDOMImplementation = minidom.getDOMImplementation()

# Expat typename -> TypeInfo
_typeinfo_map = {
    "CDATA":    minidom.TypeInfo(None, "cdata"),
    "ENUM":     minidom.TypeInfo(None, "enumeration"),
    "ENTITY":   minidom.TypeInfo(None, "entity"),
    "ENTITIES": minidom.TypeInfo(None, "entities"),
    "ID":       minidom.TypeInfo(None, "id"),
    "IDREF":    minidom.TypeInfo(None, "idref"),
    "IDREFS":   minidom.TypeInfo(None, "idrefs"),
    "NMTOKEN":  minidom.TypeInfo(None, "nmtoken"),
    "NMTOKENS": minidom.TypeInfo(None, "nmtokens"),
    }

class ElementInfo(object):
    __slots__ = '_attr_info', '_model', 'tagName'

    def __init__(self, tagName, model=None):
        self.tagName = tagName
        self._attr_info = []
        self._model = model

    def __getstate__(self):
        return self._attr_info, self._model, self.tagName

    def __setstate__(self, state):
        self._attr_info, self._model, self.tagName = state

    def getAttributeType(self, aname):
        for info in self._attr_info:
            if info[1] == aname:
                t = info[-2]
                if t[0] == "(":
                    return _typeinfo_map["ENUM"]
                else:
                    return _typeinfo_map[info[-2]]
        return minidom._no_type

    def getAttributeTypeNS(self, namespaceURI, localName):
        return minidom._no_type

    def isElementContent(self):
        if self._model:
            type = self._model[0]
            return type not in (expat.model.XML_CTYPE_ANY,
                                expat.model.XML_CTYPE_MIXED)
        else:
            return False

    def isEmpty(self):
        if self._model:
            return self._model[0] == expat.model.XML_CTYPE_EMPTY
        else:
            return False

    def isId(self, aname):
        for info in self._attr_info:
            if info[1] == aname:
                return info[-2] == "ID"
        return False

    def isIdNS(self, euri, ename, auri, aname):
        # not sure this is meaningful
        return self.isId((auri, aname))

def _intern(builder, s):
    return builder._intern_setdefault(s, s)

def _parse_ns_name(builder, name):
    assert ' ' in name
    parts = name.split(' ')
    intern = builder._intern_setdefault
    if len(parts) == 3:
        uri, localname, prefix = parts
        prefix = intern(prefix, prefix)
        qname = "%s:%s" % (prefix, localname)
        qname = intern(qname, qname)
        localname = intern(localname, localname)
    else:
        uri, localname = parts
        prefix = EMPTY_PREFIX
        qname = localname = intern(localname, localname)
    return intern(uri, uri), localname, prefix, qname


class ExpatBuilder:
    """Document builder that uses Expat to build a ParsedXML.DOM document
    instance."""

    def __init__(self, options=None):
        if options is None:
            options = xmlbuilder.Options()
        self._options = options
        if self._options.filter is not None:
            self._filter = FilterVisibilityController(self._options.filter)
        else:
            self._filter = None
            # This *really* doesn't do anything in this case, so
            # override it with something fast & minimal.
            self._finish_start_element = id
        self._parser = None
        self.reset()

    def createParser(self):
        """Create a new parser object."""
        return expat.ParserCreate()

    def getParser(self):
        """Return the parser object, creating a new one if needed."""
        if not self._parser:
            self._parser = self.createParser()
            self._intern_setdefault = self._parser.intern.setdefault
            self._parser.buffer_text = True
            self._parser.ordered_attributes = True
            self._parser.specified_attributes = True
            self.install(self._parser)
        return self._parser

    def reset(self):
        """Free all data structures used during DOM construction."""
        self.document = theDOMImplementation.createDocument(
            EMPTY_NAMESPACE, None, None)
        self.curNode = self.document
        self._elem_info = self.document._elem_info
        self._cdata = False

    def install(self, parser):
        """Install the callbacks needed to build the DOM into the parser."""
        # This creates circular references!
        parser.StartDoctypeDeclHandler = self.start_doctype_decl_handler
        parser.StartElementHandler = self.first_element_handler
        parser.EndElementHandler = self.end_element_handler
        parser.ProcessingInstructionHandler = self.pi_handler
        if self._options.entities:
            parser.EntityDeclHandler = self.entity_decl_handler
        parser.NotationDeclHandler = self.notation_decl_handler
        if self._options.comments:
            parser.CommentHandler = self.comment_handler
        if self._options.cdata_sections:
            parser.StartCdataSectionHandler = self.start_cdata_section_handler
            parser.EndCdataSectionHandler = self.end_cdata_section_handler
            parser.CharacterDataHandler = self.character_data_handler_cdata
        else:
            parser.CharacterDataHandler = self.character_data_handler
        parser.ExternalEntityRefHandler = self.external_entity_ref_handler
        parser.XmlDeclHandler = self.xml_decl_handler
        parser.ElementDeclHandler = self.element_decl_handler
        parser.AttlistDeclHandler = self.attlist_decl_handler

    def parseFile(self, file):
        """Parse a document from a file object, returning the document
        node."""
        parser = self.getParser()
        first_buffer = True
        try:
            while 1:
                buffer = file.read(16*1024)
                if not buffer:
                    break
                parser.Parse(buffer, 0)
                if first_buffer and self.document.documentElement:
                    self._setup_subset(buffer)
                first_buffer = False
            parser.Parse("", True)
        except ParseEscape:
            pass
        doc = self.document
        self.reset()
        self._parser = None
        return doc

    def parseString(self, string):
        """Parse a document from a string, returning the document node."""
        parser = self.getParser()
        try:
            parser.Parse(string, True)
            self._setup_subset(string)
        except ParseEscape:
            pass
        doc = self.document
        self.reset()
        self._parser = None
        return doc

    def _setup_subset(self, buffer):
        """Load the internal subset if there might be one."""
        if self.document.doctype:
            extractor = InternalSubsetExtractor()
            extractor.parseString(buffer)
            subset = extractor.getSubset()
            self.document.doctype.internalSubset = subset

    def start_doctype_decl_handler(self, doctypeName, systemId, publicId,
                                   has_internal_subset):
        doctype = self.document.implementation.createDocumentType(
            doctypeName, publicId, systemId)
        doctype.ownerDocument = self.document
        _append_child(self.document, doctype)
        self.document.doctype = doctype
        if self._filter and self._filter.acceptNode(doctype) == FILTER_REJECT:
            self.document.doctype = None
            del self.document.childNodes[-1]
            doctype = None
            self._parser.EntityDeclHandler = None
            self._parser.NotationDeclHandler = None
        if has_internal_subset:
            if doctype is not None:
                doctype.entities._seq = []
                doctype.notations._seq = []
            self._parser.CommentHandler = None
            self._parser.ProcessingInstructionHandler = None
            self._parser.EndDoctypeDeclHandler = self.end_doctype_decl_handler

    def end_doctype_decl_handler(self):
        if self._options.comments:
            self._parser.CommentHandler = self.comment_handler
        self._parser.ProcessingInstructionHandler = self.pi_handler
        if not (self._elem_info or self._filter):
            self._finish_end_element = id

    def pi_handler(self, target, data):
        node = self.document.createProcessingInstruction(target, data)
        _append_child(self.curNode, node)
        if self._filter and self._filter.acceptNode(node) == FILTER_REJECT:
            self.curNode.removeChild(node)

    def character_data_handler_cdata(self, data):
        childNodes = self.curNode.childNodes
        if self._cdata:
            if (  self._cdata_continue
                  and childNodes[-1].nodeType == CDATA_SECTION_NODE):
                childNodes[-1].appendData(data)
                return
            node = self.document.createCDATASection(data)
            self._cdata_continue = True
        elif childNodes and childNodes[-1].nodeType == TEXT_NODE:
            node = childNodes[-1]
            value = node.data + data
            d = node.__dict__
            d['data'] = d['nodeValue'] = value
            return
        else:
            node = minidom.Text()
            d = node.__dict__
            d['data'] = d['nodeValue'] = data
            d['ownerDocument'] = self.document
        _append_child(self.curNode, node)

    def character_data_handler(self, data):
        childNodes = self.curNode.childNodes
        if childNodes and childNodes[-1].nodeType == TEXT_NODE:
            node = childNodes[-1]
            d = node.__dict__
            d['data'] = d['nodeValue'] = node.data + data
            return
        node = minidom.Text()
        d = node.__dict__
        d['data'] = d['nodeValue'] = node.data + data
        d['ownerDocument'] = self.document
        _append_child(self.curNode, node)

    def entity_decl_handler(self, entityName, is_parameter_entity, value,
                            base, systemId, publicId, notationName):
        if is_parameter_entity:
            # we don't care about parameter entities for the DOM
            return
        if not self._options.entities:
            return
        node = self.document._create_entity(entityName, publicId,
                                            systemId, notationName)
        if value is not None:
            # internal entity
            # node *should* be readonly, but we'll cheat
            child = self.document.createTextNode(value)
            node.childNodes.append(child)
        self.document.doctype.entities._seq.append(node)
        if self._filter and self._filter.acceptNode(node) == FILTER_REJECT:
            del self.document.doctype.entities._seq[-1]

    def notation_decl_handler(self, notationName, base, systemId, publicId):
        node = self.document._create_notation(notationName, publicId, systemId)
        self.document.doctype.notations._seq.append(node)
        if self._filter and self._filter.acceptNode(node) == FILTER_ACCEPT:
            del self.document.doctype.notations._seq[-1]

    def comment_handler(self, data):
        node = self.document.createComment(data)
        _append_child(self.curNode, node)
        if self._filter and self._filter.acceptNode(node) == FILTER_REJECT:
            self.curNode.removeChild(node)

    def start_cdata_section_handler(self):
        self._cdata = True
        self._cdata_continue = False

    def end_cdata_section_handler(self):
        self._cdata = False
        self._cdata_continue = False

    def external_entity_ref_handler(self, context, base, systemId, publicId):
        return 1

    def first_element_handler(self, name, attributes):
        if self._filter is None and not self._elem_info:
            self._finish_end_element = id
        self.getParser().StartElementHandler = self.start_element_handler
        self.start_element_handler(name, attributes)

    def start_element_handler(self, name, attributes):
        node = self.document.createElement(name)
        _append_child(self.curNode, node)
        self.curNode = node

        if attributes:
            for i in range(0, len(attributes), 2):
                a = minidom.Attr(attributes[i], EMPTY_NAMESPACE,
                                 None, EMPTY_PREFIX)
                value = attributes[i+1]
                d = a.childNodes[0].__dict__
                d['data'] = d['nodeValue'] = value
                d = a.__dict__
                d['value'] = d['nodeValue'] = value
                d['ownerDocument'] = self.document
                _set_attribute_node(node, a)

        if node is not self.document.documentElement:
            self._finish_start_element(node)

    def _finish_start_element(self, node):
        if self._filter:
            # To be general, we'd have to call isSameNode(), but this
            # is sufficient for minidom:
            if node is self.document.documentElement:
                return
            filt = self._filter.startContainer(node)
            if filt == FILTER_REJECT:
                # ignore this node & all descendents
                Rejecter(self)
            elif filt == FILTER_SKIP:
                # ignore this node, but make it's children become
                # children of the parent node
                Skipper(self)
            else:
                return
            self.curNode = node.parentNode
            node.parentNode.removeChild(node)
            node.unlink()

    # If this ever changes, Namespaces.end_element_handler() needs to
    # be changed to match.
    #
    def end_element_handler(self, name):
        curNode = self.curNode
        self.curNode = curNode.parentNode
        self._finish_end_element(curNode)

    def _finish_end_element(self, curNode):
        info = self._elem_info.get(curNode.tagName)
        if info:
            self._handle_white_text_nodes(curNode, info)
        if self._filter:
            if curNode is self.document.documentElement:
                return
            if self._filter.acceptNode(curNode) == FILTER_REJECT:
                self.curNode.removeChild(curNode)
                curNode.unlink()

    def _handle_white_text_nodes(self, node, info):
        if (self._options.whitespace_in_element_content
            or not info.isElementContent()):
            return

        # We have element type information and should remove ignorable
        # whitespace; identify for text nodes which contain only
        # whitespace.
        L = []
        for child in node.childNodes:
            if child.nodeType == TEXT_NODE and not child.data.strip():
                L.append(child)

        # Remove ignorable whitespace from the tree.
        for child in L:
            node.removeChild(child)

    def element_decl_handler(self, name, model):
        info = self._elem_info.get(name)
        if info is None:
            self._elem_info[name] = ElementInfo(name, model)
        else:
            assert info._model is None
            info._model = model

    def attlist_decl_handler(self, elem, name, type, default, required):
        info = self._elem_info.get(elem)
        if info is None:
            info = ElementInfo(elem)
            self._elem_info[elem] = info
        info._attr_info.append(
            [None, name, None, None, default, 0, type, required])

    def xml_decl_handler(self, version, encoding, standalone):
        self.document.version = version
        self.document.encoding = encoding
        # This is still a little ugly, thanks to the pyexpat API. ;-(
        if standalone >= 0:
            if standalone:
                self.document.standalone = True
            else:
                self.document.standalone = False


# Don't include FILTER_INTERRUPT, since that's checked separately
# where allowed.
_ALLOWED_FILTER_RETURNS = (FILTER_ACCEPT, FILTER_REJECT, FILTER_SKIP)

class FilterVisibilityController(object):
    """Wrapper around a DOMBuilderFilter which implements the checks
    to make the whatToShow filter attribute work."""

    __slots__ = 'filter',

    def __init__(self, filter):
        self.filter = filter

    def startContainer(self, node):
        mask = self._nodetype_mask[node.nodeType]
        if self.filter.whatToShow & mask:
            val = self.filter.startContainer(node)
            if val == FILTER_INTERRUPT:
                raise ParseEscape
            if val not in _ALLOWED_FILTER_RETURNS:
                raise ValueError, \
                      "startContainer() returned illegal value: " + repr(val)
            return val
        else:
            return FILTER_ACCEPT

    def acceptNode(self, node):
        mask = self._nodetype_mask[node.nodeType]
        if self.filter.whatToShow & mask:
            val = self.filter.acceptNode(node)
            if val == FILTER_INTERRUPT:
                raise ParseEscape
            if val == FILTER_SKIP:
                # move all child nodes to the parent, and remove this node
                parent = node.parentNode
                for child in node.childNodes[:]:
                    parent.appendChild(child)
                # node is handled by the caller
                return FILTER_REJECT
            if val not in _ALLOWED_FILTER_RETURNS:
                raise ValueError, \
                      "acceptNode() returned illegal value: " + repr(val)
            return val
        else:
            return FILTER_ACCEPT

    _nodetype_mask = {
        Node.ELEMENT_NODE:                NodeFilter.SHOW_ELEMENT,
        Node.ATTRIBUTE_NODE:              NodeFilter.SHOW_ATTRIBUTE,
        Node.TEXT_NODE:                   NodeFilter.SHOW_TEXT,
        Node.CDATA_SECTION_NODE:          NodeFilter.SHOW_CDATA_SECTION,
        Node.ENTITY_REFERENCE_NODE:       NodeFilter.SHOW_ENTITY_REFERENCE,
        Node.ENTITY_NODE:                 NodeFilter.SHOW_ENTITY,
        Node.PROCESSING_INSTRUCTION_NODE: NodeFilter.SHOW_PROCESSING_INSTRUCTION,
        Node.COMMENT_NODE:                NodeFilter.SHOW_COMMENT,
        Node.DOCUMENT_NODE:               NodeFilter.SHOW_DOCUMENT,
        Node.DOCUMENT_TYPE_NODE:          NodeFilter.SHOW_DOCUMENT_TYPE,
        Node.DOCUMENT_FRAGMENT_NODE:      NodeFilter.SHOW_DOCUMENT_FRAGMENT,
        Node.NOTATION_NODE:               NodeFilter.SHOW_NOTATION,
        }


class FilterCrutch(object):
    __slots__ = '_builder', '_level', '_old_start', '_old_end'

    def __init__(self, builder):
        self._level = 0
        self._builder = builder
        parser = builder._parser
        self._old_start = parser.StartElementHandler
        self._old_end = parser.EndElementHandler
        parser.StartElementHandler = self.start_element_handler
        parser.EndElementHandler = self.end_element_handler

class Rejecter(FilterCrutch):
    __slots__ = ()

    def __init__(self, builder):
        FilterCrutch.__init__(self, builder)
        parser = builder._parser
        for name in ("ProcessingInstructionHandler",
                     "CommentHandler",
                     "CharacterDataHandler",
                     "StartCdataSectionHandler",
                     "EndCdataSectionHandler",
                     "ExternalEntityRefHandler",
                     ):
            setattr(parser, name, None)

    def start_element_handler(self, *args):
        self._level = self._level + 1

    def end_element_handler(self, *args):
        if self._level == 0:
            # restore the old handlers
            parser = self._builder._parser
            self._builder.install(parser)
            parser.StartElementHandler = self._old_start
            parser.EndElementHandler = self._old_end
        else:
            self._level = self._level - 1

class Skipper(FilterCrutch):
    __slots__ = ()

    def start_element_handler(self, *args):
        node = self._builder.curNode
        self._old_start(*args)
        if self._builder.curNode is not node:
            self._level = self._level + 1

    def end_element_handler(self, *args):
        if self._level == 0:
            # We're popping back out of the node we're skipping, so we
            # shouldn't need to do anything but reset the handlers.
            self._builder._parser.StartElementHandler = self._old_start
            self._builder._parser.EndElementHandler = self._old_end
            self._builder = None
        else:
            self._level = self._level - 1
            self._old_end(*args)


# framework document used by the fragment builder.
# Takes a string for the doctype, subset string, and namespace attrs string.

_FRAGMENT_BUILDER_INTERNAL_SYSTEM_ID = \
    "http://xml.python.org/entities/fragment-builder/internal"

_FRAGMENT_BUILDER_TEMPLATE = (
    '''\
<!DOCTYPE wrapper
  %%s [
  <!ENTITY fragment-builder-internal
    SYSTEM "%s">
%%s
]>
<wrapper %%s
>&fragment-builder-internal;</wrapper>'''
    % _FRAGMENT_BUILDER_INTERNAL_SYSTEM_ID)


class FragmentBuilder(ExpatBuilder):
    """Builder which constructs document fragments given XML source
    text and a context node.

    The context node is expected to provide information about the
    namespace declarations which are in scope at the start of the
    fragment.
    """

    def __init__(self, context, options=None):
        if context.nodeType == DOCUMENT_NODE:
            self.originalDocument = context
            self.context = context
        else:
            self.originalDocument = context.ownerDocument
            self.context = context
        ExpatBuilder.__init__(self, options)

    def reset(self):
        ExpatBuilder.reset(self)
        self.fragment = None

    def parseFile(self, file):
        """Parse a document fragment from a file object, returning the
        fragment node."""
        return self.parseString(file.read())

    def parseString(self, string):
        """Parse a document fragment from a string, returning the
        fragment node."""
        self._source = string
        parser = self.getParser()
        doctype = self.originalDocument.doctype
        ident = ""
        if doctype:
            subset = doctype.internalSubset or self._getDeclarations()
            if doctype.publicId:
                ident = ('PUBLIC "%s" "%s"'
                         % (doctype.publicId, doctype.systemId))
            elif doctype.systemId:
                ident = 'SYSTEM "%s"' % doctype.systemId
        else:
            subset = ""
        nsattrs = self._getNSattrs() # get ns decls from node's ancestors
        document = _FRAGMENT_BUILDER_TEMPLATE % (ident, subset, nsattrs)
        try:
            parser.Parse(document, 1)
        except:
            self.reset()
            raise
        fragment = self.fragment
        self.reset()
##         self._parser = None
        return fragment

    def _getDeclarations(self):
        """Re-create the internal subset from the DocumentType node.

        This is only needed if we don't already have the
        internalSubset as a string.
        """
        doctype = self.context.ownerDocument.doctype
        s = ""
        if doctype:
            for i in range(doctype.notations.length):
                notation = doctype.notations.item(i)
                if s:
                    s = s + "\n  "
                s = "%s<!NOTATION %s" % (s, notation.nodeName)
                if notation.publicId:
                    s = '%s PUBLIC "%s"\n             "%s">' \
                        % (s, notation.publicId, notation.systemId)
                else:
                    s = '%s SYSTEM "%s">' % (s, notation.systemId)
            for i in range(doctype.entities.length):
                entity = doctype.entities.item(i)
                if s:
                    s = s + "\n  "
                s = "%s<!ENTITY %s" % (s, entity.nodeName)
                if entity.publicId:
                    s = '%s PUBLIC "%s"\n             "%s"' \
                        % (s, entity.publicId, entity.systemId)
                elif entity.systemId:
                    s = '%s SYSTEM "%s"' % (s, entity.systemId)
                else:
                    s = '%s "%s"' % (s, entity.firstChild.data)
                if entity.notationName:
                    s = "%s NOTATION %s" % (s, entity.notationName)
                s = s + ">"
        return s

    def _getNSattrs(self):
        return ""

    def external_entity_ref_handler(self, context, base, systemId, publicId):
        if systemId == _FRAGMENT_BUILDER_INTERNAL_SYSTEM_ID:
            # this entref is the one that we made to put the subtree
            # in; all of our given input is parsed in here.
            old_document = self.document
            old_cur_node = self.curNode
            parser = self._parser.ExternalEntityParserCreate(context)
            # put the real document back, parse into the fragment to return
            self.document = self.originalDocument
            self.fragment = self.document.createDocumentFragment()
            self.curNode = self.fragment
            try:
                parser.Parse(self._source, 1)
            finally:
                self.curNode = old_cur_node
                self.document = old_document
                self._source = None
            return -1
        else:
            return ExpatBuilder.external_entity_ref_handler(
                self, context, base, systemId, publicId)


class Namespaces:
    """Mix-in class for builders; adds support for namespaces."""

    def _initNamespaces(self):
        # list of (prefix, uri) ns declarations.  Namespace attrs are
        # constructed from this and added to the element's attrs.
        self._ns_ordered_prefixes = []

    def createParser(self):
        """Create a new namespace-handling parser."""
        parser = expat.ParserCreate(namespace_separator=" ")
        parser.namespace_prefixes = True
        return parser

    def install(self, parser):
        """Insert the namespace-handlers onto the parser."""
        ExpatBuilder.install(self, parser)
        if self._options.namespace_declarations:
            parser.StartNamespaceDeclHandler = (
                self.start_namespace_decl_handler)

    def start_namespace_decl_handler(self, prefix, uri):
        """Push this namespace declaration on our storage."""
        self._ns_ordered_prefixes.append((prefix, uri))

    def start_element_handler(self, name, attributes):
        if ' ' in name:
            uri, localname, prefix, qname = _parse_ns_name(self, name)
        else:
            uri = EMPTY_NAMESPACE
            qname = name
            localname = None
            prefix = EMPTY_PREFIX
        node = minidom.Element(qname, uri, prefix, localname)
        node.ownerDocument = self.document
        _append_child(self.curNode, node)
        self.curNode = node

        if self._ns_ordered_prefixes:
            for prefix, uri in self._ns_ordered_prefixes:
                if prefix:
                    a = minidom.Attr(_intern(self, 'xmlns:' + prefix),
                                     XMLNS_NAMESPACE, prefix, "xmlns")
                else:
                    a = minidom.Attr("xmlns", XMLNS_NAMESPACE,
                                     "xmlns", EMPTY_PREFIX)
                d = a.childNodes[0].__dict__
                d['data'] = d['nodeValue'] = uri
                d = a.__dict__
                d['value'] = d['nodeValue'] = uri
                d['ownerDocument'] = self.document
                _set_attribute_node(node, a)
            del self._ns_ordered_prefixes[:]

        if attributes:
            _attrs = node._attrs
            _attrsNS = node._attrsNS
            for i in range(0, len(attributes), 2):
                aname = attributes[i]
                value = attributes[i+1]
                if ' ' in aname:
                    uri, localname, prefix, qname = _parse_ns_name(self, aname)
                    a = minidom.Attr(qname, uri, localname, prefix)
                    _attrs[qname] = a
                    _attrsNS[(uri, localname)] = a
                else:
                    a = minidom.Attr(aname, EMPTY_NAMESPACE,
                                     aname, EMPTY_PREFIX)
                    _attrs[aname] = a
                    _attrsNS[(EMPTY_NAMESPACE, aname)] = a
                d = a.childNodes[0].__dict__
                d['data'] = d['nodeValue'] = value
                d = a.__dict__
                d['ownerDocument'] = self.document
                d['value'] = d['nodeValue'] = value
                d['ownerElement'] = node

    if __debug__:
        # This only adds some asserts to the original
        # end_element_handler(), so we only define this when -O is not
        # used.  If changing one, be sure to check the other to see if
        # it needs to be changed as well.
        #
        def end_element_handler(self, name):
            curNode = self.curNode
            if ' ' in name:
                uri, localname, prefix, qname = _parse_ns_name(self, name)
                assert (curNode.namespaceURI == uri
                        and curNode.localName == localname
                        and curNode.prefix == prefix), \
                        "element stack messed up! (namespace)"
            else:
                assert curNode.nodeName == name, \
                       "element stack messed up - bad nodeName"
                assert curNode.namespaceURI == EMPTY_NAMESPACE, \
                       "element stack messed up - bad namespaceURI"
            self.curNode = curNode.parentNode
            self._finish_end_element(curNode)


class ExpatBuilderNS(Namespaces, ExpatBuilder):
    """Document builder that supports namespaces."""

    def reset(self):
        ExpatBuilder.reset(self)
        self._initNamespaces()


class FragmentBuilderNS(Namespaces, FragmentBuilder):
    """Fragment builder that supports namespaces."""

    def reset(self):
        FragmentBuilder.reset(self)
        self._initNamespaces()

    def _getNSattrs(self):
        """Return string of namespace attributes from this element and
        ancestors."""
        # XXX This needs to be re-written to walk the ancestors of the
        # context to build up the namespace information from
        # declarations, elements, and attributes found in context.
        # Otherwise we have to store a bunch more data on the DOM
        # (though that *might* be more reliable -- not clear).
        attrs = ""
        context = self.context
        L = []
        while context:
            if hasattr(context, '_ns_prefix_uri'):
                for prefix, uri in context._ns_prefix_uri.items():
                    # add every new NS decl from context to L and attrs string
                    if prefix in L:
                        continue
                    L.append(prefix)
                    if prefix:
                        declname = "xmlns:" + prefix
                    else:
                        declname = "xmlns"
                    if attrs:
                        attrs = "%s\n    %s='%s'" % (attrs, declname, uri)
                    else:
                        attrs = " %s='%s'" % (declname, uri)
            context = context.parentNode
        return attrs


class ParseEscape(Exception):
    """Exception raised to short-circuit parsing in InternalSubsetExtractor."""
    pass

class InternalSubsetExtractor(ExpatBuilder):
    """XML processor which can rip out the internal document type subset."""

    subset = None

    def getSubset(self):
        """Return the internal subset as a string."""
        return self.subset

    def parseFile(self, file):
        try:
            ExpatBuilder.parseFile(self, file)
        except ParseEscape:
            pass

    def parseString(self, string):
        try:
            ExpatBuilder.parseString(self, string)
        except ParseEscape:
            pass

    def install(self, parser):
        parser.StartDoctypeDeclHandler = self.start_doctype_decl_handler
        parser.StartElementHandler = self.start_element_handler

    def start_doctype_decl_handler(self, name, publicId, systemId,
                                   has_internal_subset):
        if has_internal_subset:
            parser = self.getParser()
            self.subset = []
            parser.DefaultHandler = self.subset.append
            parser.EndDoctypeDeclHandler = self.end_doctype_decl_handler
        else:
            raise ParseEscape()

    def end_doctype_decl_handler(self):
        s = ''.join(self.subset).replace('\r\n', '\n').replace('\r', '\n')
        self.subset = s
        raise ParseEscape()

    def start_element_handler(self, name, attrs):
        raise ParseEscape()


def parse(file, namespaces=True):
    """Parse a document, returning the resulting Document node.

    'file' may be either a file name or an open file object.
    """
    if namespaces:
        builder = ExpatBuilderNS()
    else:
        builder = ExpatBuilder()

    if isinstance(file, StringTypes):
        fp = open(file, 'rb')
        try:
            result = builder.parseFile(fp)
        finally:
            fp.close()
    else:
        result = builder.parseFile(file)
    return result


def parseString(string, namespaces=True):
    """Parse a document from a string, returning the resulting
    Document node.
    """
    if namespaces:
        builder = ExpatBuilderNS()
    else:
        builder = ExpatBuilder()
    return builder.parseString(string)


def parseFragment(file, context, namespaces=True):
    """Parse a fragment of a document, given the context from which it
    was originally extracted.  context should be the parent of the
    node(s) which are in the fragment.

    'file' may be either a file name or an open file object.
    """
    if namespaces:
        builder = FragmentBuilderNS(context)
    else:
        builder = FragmentBuilder(context)

    if isinstance(file, StringTypes):
        fp = open(file, 'rb')
        try:
            result = builder.parseFile(fp)
        finally:
            fp.close()
    else:
        result = builder.parseFile(file)
    return result


def parseFragmentString(string, context, namespaces=True):
    """Parse a fragment of a document from a string, given the context
    from which it was originally extracted.  context should be the
    parent of the node(s) which are in the fragment.
    """
    if namespaces:
        builder = FragmentBuilderNS(context)
    else:
        builder = FragmentBuilder(context)
    return builder.parseString(string)


def makeBuilder(options):
    """Create a builder based on an Options object."""
    if options.namespaces:
        return ExpatBuilderNS(options)
    else:
        return ExpatBuilder(options)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  """Python version compatibility support for minidom."""

# This module should only be imported using "import *".
#
# The following names are defined:
#
#   NodeList      -- lightest possible NodeList implementation
#
#   EmptyNodeList -- lightest possible NodeList that is guaranteed to
#                    remain empty (immutable)
#
#   StringTypes   -- tuple of defined string types
#
#   defproperty   -- function used in conjunction with GetattrMagic;
#                    using these together is needed to make them work
#                    as efficiently as possible in both Python 2.2+
#                    and older versions.  For example:
#
#                        class MyClass(GetattrMagic):
#                            def _get_myattr(self):
#                                return something
#
#                        defproperty(MyClass, "myattr",
#                                    "return some value")
#
#                    For Python 2.2 and newer, this will construct a
#                    property object on the class, which avoids
#                    needing to override __getattr__().  It will only
#                    work for read-only attributes.
#
#                    For older versions of Python, inheriting from
#                    GetattrMagic will use the traditional
#                    __getattr__() hackery to achieve the same effect,
#                    but less efficiently.
#
#                    defproperty() should be used for each version of
#                    the relevant _get_<property>() function.

__all__ = ["NodeList", "EmptyNodeList", "StringTypes", "defproperty"]

import xml.dom

try:
    unicode
except NameError:
    StringTypes = type(''),
else:
    StringTypes = type(''), type(unicode(''))


class NodeList(list):
    __slots__ = ()

    def item(self, index):
        if 0 <= index < len(self):
            return self[index]

    def _get_length(self):
        return len(self)

    def _set_length(self, value):
        raise xml.dom.NoModificationAllowedErr(
            "attempt to modify read-only attribute 'length'")

    length = property(_get_length, _set_length,
                      doc="The number of nodes in the NodeList.")

    def __getstate__(self):
        return list(self)

    def __setstate__(self, state):
        self[:] = state


class EmptyNodeList(tuple):
    __slots__ = ()

    def __add__(self, other):
        NL = NodeList()
        NL.extend(other)
        return NL

    def __radd__(self, other):
        NL = NodeList()
        NL.extend(other)
        return NL

    def item(self, index):
        return None

    def _get_length(self):
        return 0

    def _set_length(self, value):
        raise xml.dom.NoModificationAllowedErr(
            "attempt to modify read-only attribute 'length'")

    length = property(_get_length, _set_length,
                      doc="The number of nodes in the NodeList.")


def defproperty(klass, name, doc):
    get = getattr(klass, ("_get_" + name)).im_func
    def set(self, value, name=name):
        raise xml.dom.NoModificationAllowedErr(
            "attempt to modify read-only attribute " + repr(name))
    assert not hasattr(klass, "_set_" + name), \
           "expected not to find _set_" + name
    prop = property(get, set, doc=doc)
    setattr(klass, name, prop)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              import xml.sax
import xml.sax.handler
import types

try:
    _StringTypes = [types.StringType, types.UnicodeType]
except AttributeError:
    _StringTypes = [types.StringType]

START_ELEMENT = "START_ELEMENT"
END_ELEMENT = "END_ELEMENT"
COMMENT = "COMMENT"
START_DOCUMENT = "START_DOCUMENT"
END_DOCUMENT = "END_DOCUMENT"
PROCESSING_INSTRUCTION = "PROCESSING_INSTRUCTION"
IGNORABLE_WHITESPACE = "IGNORABLE_WHITESPACE"
CHARACTERS = "CHARACTERS"

class PullDOM(xml.sax.ContentHandler):
    _locator = None
    document = None

    def __init__(self, documentFactory=None):
        from xml.dom import XML_NAMESPACE
        self.documentFactory = documentFactory
        self.firstEvent = [None, None]
        self.lastEvent = self.firstEvent
        self.elementStack = []
        self.push = self.elementStack.append
        try:
            self.pop = self.elementStack.pop
        except AttributeError:
            # use class' pop instead
            pass
        self._ns_contexts = [{XML_NAMESPACE:'xml'}] # contains uri -> prefix dicts
        self._current_context = self._ns_contexts[-1]
        self.pending_events = []

    def pop(self):
        result = self.elementStack[-1]
        del self.elementStack[-1]
        return result

    def setDocumentLocator(self, locator):
        self._locator = locator

    def startPrefixMapping(self, prefix, uri):
        if not hasattr(self, '_xmlns_attrs'):
            self._xmlns_attrs = []
        self._xmlns_attrs.append((prefix or 'xmlns', uri))
        self._ns_contexts.append(self._current_context.copy())
        self._current_context[uri] = prefix or None

    def endPrefixMapping(self, prefix):
        self._current_context = self._ns_contexts.pop()

    def startElementNS(self, name, tagName , attrs):
        # Retrieve xml namespace declaration attributes.
        xmlns_uri = 'http://www.w3.org/2000/xmlns/'
        xmlns_attrs = getattr(self, '_xmlns_attrs', None)
        if xmlns_attrs is not None:
            for aname, value in xmlns_attrs:
                attrs._attrs[(xmlns_uri, aname)] = value
            self._xmlns_attrs = []
        uri, localname = name
        if uri:
            # When using namespaces, the reader may or may not
            # provide us with the original name. If not, create
            # *a* valid tagName from the current context.
            if tagName is None:
                prefix = self._current_context[uri]
                if prefix:
                    tagName = prefix + ":" + localname
                else:
                    tagName = localname
            if self.document:
                node = self.document.createElementNS(uri, tagName)
            else:
                node = self.buildDocument(uri, tagName)
        else:
            # When the tagname is not prefixed, it just appears as
            # localname
            if self.document:
                node = self.document.createElement(localname)
            else:
                node = self.buildDocument(None, localname)

        for aname,value in attrs.items():
            a_uri, a_localname = aname
            if a_uri == xmlns_uri:
                if a_localname == 'xmlns':
                    qname = a_localname
                else:
                    qname = 'xmlns:' + a_localname
                attr = self.document.createAttributeNS(a_uri, qname)
                node.setAttributeNodeNS(attr)
            elif a_uri:
                prefix = self._current_context[a_uri]
                if prefix:
                    qname = prefix + ":" + a_localname
                else:
                    qname = a_localname
                attr = self.document.createAttributeNS(a_uri, qname)
                node.setAttributeNodeNS(attr)
            else:
                attr = self.document.createAttribute(a_localname)
                node.setAttributeNode(attr)
            attr.value = value

        self.lastEvent[1] = [(START_ELEMENT, node), None]
        self.lastEvent = self.lastEvent[1]
        self.push(node)

    def endElementNS(self, name, tagName):
        self.lastEvent[1] = [(END_ELEMENT, self.pop()), None]
        self.lastEvent = self.lastEvent[1]

    def startElement(self, name, attrs):
        if self.document:
            node = self.document.createElement(name)
        else:
            node = self.buildDocument(None, name)

        for aname,value in attrs.items():
            attr = self.document.createAttribute(aname)
            attr.value = value
            node.setAttributeNode(attr)

        self.lastEvent[1] = [(START_ELEMENT, node), None]
        self.lastEvent = self.lastEvent[1]
        self.push(node)

    def endElement(self, name):
        self.lastEvent[1] = [(END_ELEMENT, self.pop()), None]
        self.lastEvent = self.lastEvent[1]

    def comment(self, s):
        if self.document:
            node = self.document.createComment(s)
            self.lastEvent[1] = [(COMMENT, node), None]
            self.lastEvent = self.lastEvent[1]
        else:
            event = [(COMMENT, s), None]
            self.pending_events.append(event)

    def processingInstruction(self, target, data):
        if self.document:
            node = self.document.createProcessingInstruction(target, data)
            self.lastEvent[1] = [(PROCESSING_INSTRUCTION, node), None]
            self.lastEvent = self.lastEvent[1]
        else:
            event = [(PROCESSING_INSTRUCTION, target, data), None]
            self.pending_events.append(event)

    def ignorableWhitespace(self, chars):
        node = self.document.createTextNode(chars)
        self.lastEvent[1] = [(IGNORABLE_WHITESPACE, node), None]
        self.lastEvent = self.lastEvent[1]

    def characters(self, chars):
        node = self.document.createTextNode(chars)
        self.lastEvent[1] = [(CHARACTERS, node), None]
        self.lastEvent = self.lastEvent[1]

    def startDocument(self):
        if self.documentFactory is None:
            import xml.dom.minidom
            self.documentFactory = xml.dom.minidom.Document.implementation

    def buildDocument(self, uri, tagname):
        # Can't do that in startDocument, since we need the tagname
        # XXX: obtain DocumentType
        node = self.documentFactory.createDocument(uri, tagname, None)
        self.document = node
        self.lastEvent[1] = [(START_DOCUMENT, node), None]
        self.lastEvent = self.lastEvent[1]
        self.push(node)
        # Put everything we have seen so far into the document
        for e in self.pending_events:
            if e[0][0] == PROCESSING_INSTRUCTION:
                _,target,data = e[0]
                n = self.document.createProcessingInstruction(target, data)
                e[0] = (PROCESSING_INSTRUCTION, n)
            elif e[0][0] == COMMENT:
                n = self.document.createComment(e[0][1])
                e[0] = (COMMENT, n)
            else:
                raise AssertionError("Unknown pending event ",e[0][0])
            self.lastEvent[1] = e
            self.lastEvent = e
        self.pending_events = None
        return node.firstChild

    def endDocument(self):
        self.lastEvent[1] = [(END_DOCUMENT, self.document), None]
        self.pop()

    def clear(self):
        "clear(): Explicitly release parsing structures"
        self.document = None

class ErrorHandler:
    def warning(self, exception):
        print exception
    def error(self, exception):
        raise exception
    def fatalError(self, exception):
        raise exception

class DOMEventStream:
    def __init__(self, stream, parser, bufsize):
        self.stream = stream
        self.parser = parser
        self.bufsize = bufsize
        if not hasattr(self.parser, 'feed'):
            self.getEvent = self._slurp
        self.reset()

    def reset(self):
        self.pulldom = PullDOM()
        # This content handler relies on namespace support
        self.parser.setFeature(xml.sax.handler.feature_namespaces, 1)
        self.parser.setContentHandler(self.pulldom)

    def __getitem__(self, pos):
        rc = self.getEvent()
        if rc:
            return rc
        raise IndexError

    def next(self):
        rc = self.getEvent()
        if rc:
            return rc
        raise StopIteration

    def __iter__(self):
        return self

    def expandNode(self, node):
        event = self.getEvent()
        parents = [node]
        while event:
            token, cur_node = event
            if cur_node is node:
                return
            if token != END_ELEMENT:
                parents[-1].appendChild(cur_node)
            if token == START_ELEMENT:
                parents.append(cur_node)
            elif token == END_ELEMENT:
                del parents[-1]
            event = self.getEvent()

    def getEvent(self):
        # use IncrementalParser interface, so we get the desired
        # pull effect
        if not self.pulldom.firstEvent[1]:
            self.pulldom.lastEvent = self.pulldom.firstEvent
        while not self.pulldom.firstEvent[1]:
            buf = self.stream.read(self.bufsize)
            if not buf:
                self.parser.close()
                return None
            self.parser.feed(buf)
        rc = self.pulldom.firstEvent[1][0]
        self.pulldom.firstEvent[1] = self.pulldom.firstEvent[1][1]
        return rc

    def _slurp(self):
        """ Fallback replacement for getEvent() using the
            standard SAX2 interface, which means we slurp the
            SAX events into memory (no performance gain, but
            we are compatible to all SAX parsers).
        """
        self.parser.parse(self.stream)
        self.getEvent = self._emit
        return self._emit()

    def _emit(self):
        """ Fallback replacement for getEvent() that emits
            the events that _slurp() read previously.
        """
        rc = self.pulldom.firstEvent[1][0]
        self.pulldom.firstEvent[1] = self.pulldom.firstEvent[1][1]
        return rc

    def clear(self):
        """clear(): Explicitly release parsing objects"""
        self.pulldom.clear()
        del self.pulldom
        self.parser = None
        self.stream = None

class SAX2DOM(PullDOM):

    def startElementNS(self, name, tagName , attrs):
        PullDOM.startElementNS(self, name, tagName, attrs)
        curNode = self.elementStack[-1]
        parentNode = self.elementStack[-2]
        parentNode.appendChild(curNode)

    def startElement(self, name, attrs):
        PullDOM.startElement(self, name, attrs)
        curNode = self.elementStack[-1]
        parentNode = self.elementStack[-2]
        parentNode.appendChild(curNode)

    def processingInstruction(self, target, data):
        PullDOM.processingInstruction(self, target, data)
        node = self.lastEvent[0][1]
        parentNode = self.elementStack[-1]
        parentNode.appendChild(node)

    def ignorableWhitespace(self, chars):
        PullDOM.ignorableWhitespace(self, chars)
        node = self.lastEvent[0][1]
        parentNode = self.elementStack[-1]
        parentNode.appendChild(node)

    def characters(self, chars):
        PullDOM.characters(self, chars)
        node = self.lastEvent[0][1]
        parentNode = self.elementStack[-1]
        parentNode.appendChild(node)


default_bufsize = (2 ** 14) - 20

def parse(stream_or_string, parser=None, bufsize=None):
    if bufsize is None:
        bufsize = default_bufsize
    if type(stream_or_string) in _StringTypes:
        stream = open(stream_or_string)
    else:
        stream = stream_or_string
    if not parser:
        parser = xml.sax.make_parser()
    return DOMEventStream(stream, parser, bufsize)

def parseString(string, parser=None):
    try:
        from cStringIO import StringIO
    except ImportError:
        from StringIO import StringIO

    bufsize = len(string)
    buf = StringIO(string)
    if not parser:
        parser = xml.sax.make_parser()
    return DOMEventStream(buf, parser, bufsize)
                                                                                                                                                                                                                                                                                                                          """Implementation of the DOM Level 3 'LS-Load' feature."""

import copy
import xml.dom

from xml.dom.NodeFilter import NodeFilter


__all__ = ["DOMBuilder", "DOMEntityResolver", "DOMInputSource"]


class Options:
    """Features object that has variables set for each DOMBuilder feature.

    The DOMBuilder class uses an instance of this class to pass settings to
    the ExpatBuilder class.
    """

    # Note that the DOMBuilder class in LoadSave constrains which of these
    # values can be set using the DOM Level 3 LoadSave feature.

    namespaces = 1
    namespace_declarations = True
    validation = False
    external_parameter_entities = True
    external_general_entities = True
    external_dtd_subset = True
    validate_if_schema = False
    validate = False
    datatype_normalization = False
    create_entity_ref_nodes = True
    entities = True
    whitespace_in_element_content = True
    cdata_sections = True
    comments = True
    charset_overrides_xml_encoding = True
    infoset = False
    supported_mediatypes_only = False

    errorHandler = None
    filter = None


class DOMBuilder:
    entityResolver = None
    errorHandler = None
    filter = None

    ACTION_REPLACE = 1
    ACTION_APPEND_AS_CHILDREN = 2
    ACTION_INSERT_AFTER = 3
    ACTION_INSERT_BEFORE = 4

    _legal_actions = (ACTION_REPLACE, ACTION_APPEND_AS_CHILDREN,
                      ACTION_INSERT_AFTER, ACTION_INSERT_BEFORE)

    def __init__(self):
        self._options = Options()

    def _get_entityResolver(self):
        return self.entityResolver
    def _set_entityResolver(self, entityResolver):
        self.entityResolver = entityResolver

    def _get_errorHandler(self):
        return self.errorHandler
    def _set_errorHandler(self, errorHandler):
        self.errorHandler = errorHandler

    def _get_filter(self):
        return self.filter
    def _set_filter(self, filter):
        self.filter = filter

    def setFeature(self, name, state):
        if self.supportsFeature(name):
            state = state and 1 or 0
            try:
                settings = self._settings[(_name_xform(name), state)]
            except KeyError:
                raise xml.dom.NotSupportedErr(
                    "unsupported feature: %r" % (name,))
            else:
                for name, value in settings:
                    setattr(self._options, name, value)
        else:
            raise xml.dom.NotFoundErr("unknown feature: " + repr(name))

    def supportsFeature(self, name):
        return hasattr(self._options, _name_xform(name))

    def canSetFeature(self, name, state):
        key = (_name_xform(name), state and 1 or 0)
        return key in self._settings

    # This dictionary maps from (feature,value) to a list of
    # (option,value) pairs that should be set on the Options object.
    # If a (feature,value) setting is not in this dictionary, it is
    # not supported by the DOMBuilder.
    #
    _settings = {
        ("namespace_declarations", 0): [
            ("namespace_declarations", 0)],
        ("namespace_declarations", 1): [
            ("namespace_declarations", 1)],
        ("validation", 0): [
            ("validation", 0)],
        ("external_general_entities", 0): [
            ("external_general_entities", 0)],
        ("external_general_entities", 1): [
            ("external_general_entities", 1)],
        ("external_parameter_entities", 0): [
            ("external_parameter_entities", 0)],
        ("external_parameter_entities", 1): [
            ("external_parameter_entities", 1)],
        ("validate_if_schema", 0): [
            ("validate_if_schema", 0)],
        ("create_entity_ref_nodes", 0): [
            ("create_entity_ref_nodes", 0)],
        ("create_entity_ref_nodes", 1): [
            ("create_entity_ref_nodes", 1)],
        ("entities", 0): [
            ("create_entity_ref_nodes", 0),
            ("entities", 0)],
        ("entities", 1): [
            ("entities", 1)],
        ("whitespace_in_element_content", 0): [
            ("whitespace_in_element_content", 0)],
        ("whitespace_in_element_content", 1): [
            ("whitespace_in_element_content", 1)],
        ("cdata_sections", 0): [
            ("cdata_sections", 0)],
        ("cdata_sections", 1): [
            ("cdata_sections", 1)],
        ("comments", 0): [
            ("comments", 0)],
        ("comments", 1): [
            ("comments", 1)],
        ("charset_overrides_xml_encoding", 0): [
            ("charset_overrides_xml_encoding", 0)],
        ("charset_overrides_xml_encoding", 1): [
            ("charset_overrides_xml_encoding", 1)],
        ("infoset", 0): [],
        ("infoset", 1): [
            ("namespace_declarations", 0),
            ("validate_if_schema", 0),
            ("create_entity_ref_nodes", 0),
            ("entities", 0),
            ("cdata_sections", 0),
            ("datatype_normalization", 1),
            ("whitespace_in_element_content", 1),
            ("comments", 1),
            ("charset_overrides_xml_encoding", 1)],
        ("supported_mediatypes_only", 0): [
            ("supported_mediatypes_only", 0)],
        ("namespaces", 0): [
            ("namespaces", 0)],
        ("namespaces", 1): [
            ("namespaces", 1)],
    }

    def getFeature(self, name):
        xname = _name_xform(name)
        try:
            return getattr(self._options, xname)
        except AttributeError:
            if name == "infoset":
                options = self._options
                return (options.datatype_normalization
                        and options.whitespace_in_element_content
                        and options.comments
                        and options.charset_overrides_xml_encoding
                        and not (options.namespace_declarations
                                 or options.validate_if_schema
                                 or options.create_entity_ref_nodes
                                 or options.entities
                                 or options.cdata_sections))
            raise xml.dom.NotFoundErr("feature %s not known" % repr(name))

    def parseURI(self, uri):
        if self.entityResolver:
            input = self.entityResolver.resolveEntity(None, uri)
        else:
            input = DOMEntityResolver().resolveEntity(None, uri)
        return self.parse(input)

    def parse(self, input):
        options = copy.copy(self._options)
        options.filter = self.filter
        options.errorHandler = self.errorHandler
        fp = input.byteStream
        if fp is None and options.systemId:
            import urllib2
            fp = urllib2.urlopen(input.systemId)
        return self._parse_bytestream(fp, options)

    def parseWithContext(self, input, cnode, action):
        if action not in self._legal_actions:
            raise ValueError("not a legal action")
        raise NotImplementedError("Haven't written this yet...")

    def _parse_bytestream(self, stream, options):
        import xml.dom.expatbuilder
        builder = xml.dom.expatbuilder.makeBuilder(options)
        return builder.parseFile(stream)


def _name_xform(name):
    return name.lower().replace('-', '_')


class DOMEntityResolver(object):
    __slots__ = '_opener',

    def resolveEntity(self, publicId, systemId):
        assert systemId is not None
        source = DOMInputSource()
        source.publicId = publicId
        source.systemId = systemId
        source.byteStream = self._get_opener().open(systemId)

        # determine the encoding if the transport provided it
        source.encoding = self._guess_media_encoding(source)

        # determine the base URI is we can
        import posixpath, urlparse
        parts = urlparse.urlparse(systemId)
        scheme, netloc, path, params, query, fragment = parts
        # XXX should we check the scheme here as well?
        if path and not path.endswith("/"):
            path = posixpath.dirname(path) + "/"
            parts = scheme, netloc, path, params, query, fragment
            source.baseURI = urlparse.urlunparse(parts)

        return source

    def _get_opener(self):
        try:
            return self._opener
        except AttributeError:
            self._opener = self._create_opener()
            return self._opener

    def _create_opener(self):
        import urllib2
        return urllib2.build_opener()

    def _guess_media_encoding(self, source):
        info = source.byteStream.info()
        if "Content-Type" in info:
            for param in info.getplist():
                if param.startswith("charset="):
                    return param.split("=", 1)[1].lower()


class DOMInputSource(object):
    __slots__ = ('byteStream', 'characterStream', 'stringData',
                 'encoding', 'publicId', 'systemId', 'baseURI')

    def __init__(self):
        self.byteStream = None
        self.characterStream = None
        self.stringData = None
        self.encoding = None
        self.publicId = None
        self.systemId = None
        self.baseURI = None

    def _get_byteStream(self):
        return self.byteStream
    def _set_byteStream(self, byteStream):
        self.byteStream = byteStream

    def _get_characterStream(self):
        return self.characterStream
    def _set_characterStream(self, characterStream):
        self.characterStream = characterStream

    def _get_stringData(self):
        return self.stringData
    def _set_stringData(self, data):
        self.stringData = data

    def _get_encoding(self):
        return self.encoding
    def _set_encoding(self, encoding):
        self.encoding = encoding

    def _get_publicId(self):
        return self.publicId
    def _set_publicId(self, publicId):
        self.publicId = publicId

    def _get_systemId(self):
        return self.systemId
    def _set_systemId(self, systemId):
        self.systemId = systemId

    def _get_baseURI(self):
        return self.baseURI
    def _set_baseURI(self, uri):
        self.baseURI = uri


class DOMBuilderFilter:
    """Element filter which can be used to tailor construction of
    a DOM instance.
    """

    # There's really no need for this class; concrete implementations
    # should just implement the endElement() and startElement()
    # methods as appropriate.  Using this makes it easy to only
    # implement one of them.

    FILTER_ACCEPT = 1
    FILTER_REJECT = 2
    FILTER_SKIP = 3
    FILTER_INTERRUPT = 4

    whatToShow = NodeFilter.SHOW_ALL

    def _get_whatToShow(self):
        return self.whatToShow

    def acceptNode(self, element):
        return self.FILTER_ACCEPT

    def startContainer(self, element):
        return self.FILTER_ACCEPT

del NodeFilter


class DocumentLS:
    """Mixin to create documents that conform to the load/save spec."""

    async = False

    def _get_async(self):
        return False
    def _set_async(self, async):
        if async:
            raise xml.dom.NotSupportedErr(
                "asynchronous document loading is not supported")

    def abort(self):
        # What does it mean to "clear" a document?  Does the
        # documentElement disappear?
        raise NotImplementedError(
            "haven't figured out what this means yet")

    def load(self, uri):
        raise NotImplementedError("haven't written this yet")

    def loadXML(self, source):
        raise NotImplementedError("haven't written this yet")

    def saveXML(self, snode):
        if snode is None:
            snode = self
        elif snode.ownerDocument is not self:
            raise xml.dom.WrongDocumentErr()
        return snode.toxml()


class DOMImplementationLS:
    MODE_SYNCHRONOUS = 1
    MODE_ASYNCHRONOUS = 2

    def createDOMBuilder(self, mode, schemaType):
        if schemaType is not None:
            raise xml.dom.NotSupportedErr(
                "schemaType not yet supported")
        if mode == self.MODE_SYNCHRONOUS:
            return DOMBuilder()
        if mode == self.MODE_ASYNCHRONOUS:
            raise xml.dom.NotSupportedErr(
                "asynchronous builders are not supported")
        raise ValueError("unknown value for mode")

    def createDOMWriter(self):
        raise NotImplementedError(
            "the writer interface hasn't been written yet!")

    def createDOMInputSource(self):
        return DOMInputSource()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               #
# ElementTree
# $Id: ElementInclude.py 3375 2008-02-13 08:05:08Z fredrik $
#
# limited xinclude support for element trees
#
# history:
# 2003-08-15 fl   created
# 2003-11-14 fl   fixed default loader
#
# Copyright (c) 2003-2004 by Fredrik Lundh.  All rights reserved.
#
# fredrik@pythonware.com
# http://www.pythonware.com
#
# --------------------------------------------------------------------
# The ElementTree toolkit is
#
# Copyright (c) 1999-2008 by Fredrik Lundh
#
# By obtaining, using, and/or copying this software and/or its
# associated documentation, you agree that you have read, understood,
# and will comply with the following terms and conditions:
#
# Permission to use, copy, modify, and distribute this software and
# its associated documentation for any purpose and without fee is
# hereby granted, provided that the above copyright notice appears in
# all copies, and that both that copyright notice and this permission
# notice appear in supporting documentation, and that the name of
# Secret Labs AB or the author not be used in advertising or publicity
# pertaining to distribution of the software without specific, written
# prior permission.
#
# SECRET LABS AB AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD
# TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANT-
# ABILITY AND FITNESS.  IN NO EVENT SHALL SECRET LABS AB OR THE AUTHOR
# BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY
# DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
# WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
# ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE
# OF THIS SOFTWARE.
# --------------------------------------------------------------------

# Licensed to PSF under a Contributor Agreement.
# See http://www.python.org/psf/license for licensing details.

##
# Limited XInclude support for the ElementTree package.
##

import copy
from . import ElementTree

XINCLUDE = "{http://www.w3.org/2001/XInclude}"

XINCLUDE_INCLUDE = XINCLUDE + "include"
XINCLUDE_FALLBACK = XINCLUDE + "fallback"

##
# Fatal include error.

class FatalIncludeError(SyntaxError):
    pass

##
# Default loader.  This loader reads an included resource from disk.
#
# @param href Resource reference.
# @param parse Parse mode.  Either "xml" or "text".
# @param encoding Optional text encoding.
# @return The expanded resource.  If the parse mode is "xml", this
#    is an ElementTree instance.  If the parse mode is "text", this
#    is a Unicode string.  If the loader fails, it can return None
#    or raise an IOError exception.
# @throws IOError If the loader fails to load the resource.

def default_loader(href, parse, encoding=None):
    with open(href) as file:
        if parse == "xml":
            data = ElementTree.parse(file).getroot()
        else:
            data = file.read()
            if encoding:
                data = data.decode(encoding)
    return data

##
# Expand XInclude directives.
#
# @param elem Root element.
# @param loader Optional resource loader.  If omitted, it defaults
#     to {@link default_loader}.  If given, it should be a callable
#     that implements the same interface as <b>default_loader</b>.
# @throws FatalIncludeError If the function fails to include a given
#     resource, or if the tree contains malformed XInclude elements.
# @throws IOError If the function fails to load a given resource.

def include(elem, loader=None):
    if loader is None:
        loader = default_loader
    # look for xinclude elements
    i = 0
    while i < len(elem):
        e = elem[i]
        if e.tag == XINCLUDE_INCLUDE:
            # process xinclude directive
            href = e.get("href")
            parse = e.get("parse", "xml")
            if parse == "xml":
                node = loader(href, parse)
                if node is None:
                    raise FatalIncludeError(
                        "cannot load %r as %r" % (href, parse)
                        )
                node = copy.copy(node)
                if e.tail:
                    node.tail = (node.tail or "") + e.tail
                elem[i] = node
            elif parse == "text":
                text = loader(href, parse, e.get("encoding"))
                if text is None:
                    raise FatalIncludeError(
                        "cannot load %r as %r" % (href, parse)
                        )
                if i:
                    node = elem[i-1]
                    node.tail = (node.tail or "") + text + (e.tail or "")
                else:
                    elem.text = (elem.text or "") + text + (e.tail or "")
                del elem[i]
                continue
            else:
                raise FatalIncludeError(
                    "unknown parse type in xi:include tag (%r)" % parse
                )
        elif e.tag == XINCLUDE_FALLBACK:
            raise FatalIncludeError(
                "xi:fallback tag must be child of xi:include (%r)" % e.tag
                )
        else:
            include(e, loader)
        i = i + 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #
# ElementTree
# $Id: ElementPath.py 3375 2008-02-13 08:05:08Z fredrik $
#
# limited xpath support for element trees
#
# history:
# 2003-05-23 fl   created
# 2003-05-28 fl   added support for // etc
# 2003-08-27 fl   fixed parsing of periods in element names
# 2007-09-10 fl   new selection engine
# 2007-09-12 fl   fixed parent selector
# 2007-09-13 fl   added iterfind; changed findall to return a list
# 2007-11-30 fl   added namespaces support
# 2009-10-30 fl   added child element value filter
#
# Copyright (c) 2003-2009 by Fredrik Lundh.  All rights reserved.
#
# fredrik@pythonware.com
# http://www.pythonware.com
#
# --------------------------------------------------------------------
# The ElementTree toolkit is
#
# Copyright (c) 1999-2009 by Fredrik Lundh
#
# By obtaining, using, and/or copying this software and/or its
# associated documentation, you agree that you have read, understood,
# and will comply with the following terms and conditions:
#
# Permission to use, copy, modify, and distribute this software and
# its associated documentation for any purpose and without fee is
# hereby granted, provided that the above copyright notice appears in
# all copies, and that both that copyright notice and this permission
# notice appear in supporting documentation, and that the name of
# Secret Labs AB or the author not be used in advertising or publicity
# pertaining to distribution of the software without specific, written
# prior permission.
#
# SECRET LABS AB AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD
# TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANT-
# ABILITY AND FITNESS.  IN NO EVENT SHALL SECRET LABS AB OR THE AUTHOR
# BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY
# DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
# WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
# ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE
# OF THIS SOFTWARE.
# --------------------------------------------------------------------

# Licensed to PSF under a Contributor Agreement.
# See http://www.python.org/psf/license for licensing details.

##
# Implementation module for XPath support.  There's usually no reason
# to import this module directly; the <b>ElementTree</b> does this for
# you, if needed.
##

import re

xpath_tokenizer_re = re.compile(
    "("
    "'[^']*'|\"[^\"]*\"|"
    "::|"
    "//?|"
    "\.\.|"
    "\(\)|"
    "[/.*:\[\]\(\)@=])|"
    "((?:\{[^}]+\})?[^/\[\]\(\)@=\s]+)|"
    "\s+"
    )

def xpath_tokenizer(pattern, namespaces=None):
    for token in xpath_tokenizer_re.findall(pattern):
        tag = token[1]
        if tag and tag[0] != "{" and ":" in tag:
            try:
                prefix, uri = tag.split(":", 1)
                if not namespaces:
                    raise KeyError
                yield token[0], "{%s}%s" % (namespaces[prefix], uri)
            except KeyError:
                raise SyntaxError("prefix %r not found in prefix map" % prefix)
        else:
            yield token

def get_parent_map(context):
    parent_map = context.parent_map
    if parent_map is None:
        context.parent_map = parent_map = {}
        for p in context.root.iter():
            for e in p:
                parent_map[e] = p
    return parent_map

def prepare_child(next, token):
    tag = token[1]
    def select(context, result):
        for elem in result:
            for e in elem:
                if e.tag == tag:
                    yield e
    return select

def prepare_star(next, token):
    def select(context, result):
        for elem in result:
            for e in elem:
                yield e
    return select

def prepare_self(next, token):
    def select(context, result):
        for elem in result:
            yield elem
    return select

def prepare_descendant(next, token):
    token = next()
    if token[0] == "*":
        tag = "*"
    elif not token[0]:
        tag = token[1]
    else:
        raise SyntaxError("invalid descendant")
    def select(context, result):
        for elem in result:
            for e in elem.iter(tag):
                if e is not elem:
                    yield e
    return select

def prepare_parent(next, token):
    def select(context, result):
        # FIXME: raise error if .. is applied at toplevel?
        parent_map = get_parent_map(context)
        result_map = {}
        for elem in result:
            if elem in parent_map:
                parent = parent_map[elem]
                if parent not in result_map:
                    result_map[parent] = None
                    yield parent
    return select

def prepare_predicate(next, token):
    # FIXME: replace with real parser!!! refs:
    # http://effbot.org/zone/simple-iterator-parser.htm
    # http://javascript.crockford.com/tdop/tdop.html
    signature = []
    predicate = []
    while 1:
        token = next()
        if token[0] == "]":
            break
        if token[0] and token[0][:1] in "'\"":
            token = "'", token[0][1:-1]
        signature.append(token[0] or "-")
        predicate.append(token[1])
    signature = "".join(signature)
    # use signature to determine predicate type
    if signature == "@-":
        # [@attribute] predicate
        key = predicate[1]
        def select(context, result):
            for elem in result:
                if elem.get(key) is not None:
                    yield elem
        return select
    if signature == "@-='":
        # [@attribute='value']
        key = predicate[1]
        value = predicate[-1]
        def select(context, result):
            for elem in result:
                if elem.get(key) == value:
                    yield elem
        return select
    if signature == "-" and not re.match("\d+$", predicate[0]):
        # [tag]
        tag = predicate[0]
        def select(context, result):
            for elem in result:
                if elem.find(tag) is not None:
                    yield elem
        return select
    if signature == "-='" and not re.match("\d+$", predicate[0]):
        # [tag='value']
        tag = predicate[0]
        value = predicate[-1]
        def select(context, result):
            for elem in result:
                for e in elem.findall(tag):
                    if "".join(e.itertext()) == value:
                        yield elem
                        break
        return select
    if signature == "-" or signature == "-()" or signature == "-()-":
        # [index] or [last()] or [last()-index]
        if signature == "-":
            index = int(predicate[0]) - 1
        else:
            if predicate[0] != "last":
                raise SyntaxError("unsupported function")
            if signature == "-()-":
                try:
                    index = int(predicate[2]) - 1
                except ValueError:
                    raise SyntaxError("unsupported expression")
            else:
                index = -1
        def select(context, result):
            parent_map = get_parent_map(context)
            for elem in result:
                try:
                    parent = parent_map[elem]
                    # FIXME: what if the selector is "*" ?
                    elems = list(parent.findall(elem.tag))
                    if elems[index] is elem:
                        yield elem
                except (IndexError, KeyError):
                    pass
        return select
    raise SyntaxError("invalid predicate")

ops = {
    "": prepare_child,
    "*": prepare_star,
    ".": prepare_self,
    "..": prepare_parent,
    "//": prepare_descendant,
    "[": prepare_predicate,
    }

_cache = {}

class _SelectorContext:
    parent_map = None
    def __init__(self, root):
        self.root = root

# --------------------------------------------------------------------

##
# Generate all matching objects.

def iterfind(elem, path, namespaces=None):
    # compile selector pattern
    if path[-1:] == "/":
        path = path + "*" # implicit all (FIXME: keep this?)
    try:
        selector = _cache[path]
    except KeyError:
        if len(_cache) > 100:
            _cache.clear()
        if path[:1] == "/":
            raise SyntaxError("cannot use absolute path on element")
        next = iter(xpath_tokenizer(path, namespaces)).next
        token = next()
        selector = []
        while 1:
            try:
                selector.append(ops[token[0]](next, token))
            except StopIteration:
                raise SyntaxError("invalid path")
            try:
                token = next()
                if token[0] == "/":
                    token = next()
            except StopIteration:
                break
        _cache[path] = selector
    # execute selector pattern
    result = [elem]
    context = _SelectorContext(elem)
    for select in selector:
        result = select(context, result)
    return result

##
# Find first matching object.

def find(elem, path, namespaces=None):
    try:
        return iterfind(elem, path, namespaces).next()
    except StopIteration:
        return None

##
# Find all matching objects.

def findall(elem, path, namespaces=None):
    return list(iterfind(elem, path, namespaces))

##
# Find text for first matching object.

def findtext(elem, path, default=None, namespaces=None):
    try:
        elem = iterfind(elem, path, namespaces).next()
        return elem.text or ""
    except StopIteration:
        return default
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             #
# ElementTree
# $Id: ElementTree.py 3440 2008-07-18 14:45:01Z fredrik $
#
# light-weight XML support for Python 2.3 and later.
#
# history (since 1.2.6):
# 2005-11-12 fl   added tostringlist/fromstringlist helpers
# 2006-07-05 fl   merged in selected changes from the 1.3 sandbox
# 2006-07-05 fl   removed support for 2.1 and earlier
# 2007-06-21 fl   added deprecation/future warnings
# 2007-08-25 fl   added doctype hook, added parser version attribute etc
# 2007-08-26 fl   added new serializer code (better namespace handling, etc)
# 2007-08-27 fl   warn for broken /tag searches on tree level
# 2007-09-02 fl   added html/text methods to serializer (experimental)
# 2007-09-05 fl   added method argument to tostring/tostringlist
# 2007-09-06 fl   improved error handling
# 2007-09-13 fl   added itertext, iterfind; assorted cleanups
# 2007-12-15 fl   added C14N hooks, copy method (experimental)
#
# Copyright (c) 1999-2008 by Fredrik Lundh.  All rights reserved.
#
# fredrik@pythonware.com
# http://www.pythonware.com
#
# --------------------------------------------------------------------
# The ElementTree toolkit is
#
# Copyright (c) 1999-2008 by Fredrik Lundh
#
# By obtaining, using, and/or copying this software and/or its
# associated documentation, you agree that you have read, understood,
# and will comply with the following terms and conditions:
#
# Permission to use, copy, modify, and distribute this software and
# its associated documentation for any purpose and without fee is
# hereby granted, provided that the above copyright notice appears in
# all copies, and that both that copyright notice and this permission
# notice appear in supporting documentation, and that the name of
# Secret Labs AB or the author not be used in advertising or publicity
# pertaining to distribution of the software without specific, written
# prior permission.
#
# SECRET LABS AB AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD
# TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANT-
# ABILITY AND FITNESS.  IN NO EVENT SHALL SECRET LABS AB OR THE AUTHOR
# BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY
# DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
# WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
# ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE
# OF THIS SOFTWARE.
# --------------------------------------------------------------------

# Licensed to PSF under a Contributor Agreement.
# See http://www.python.org/psf/license for licensing details.

__all__ = [
    # public symbols
    "Comment",
    "dump",
    "Element", "ElementTree",
    "fromstring", "fromstringlist",
    "iselement", "iterparse",
    "parse", "ParseError",
    "PI", "ProcessingInstruction",
    "QName",
    "SubElement",
    "tostring", "tostringlist",
    "TreeBuilder",
    "VERSION",
    "XML",
    "XMLParser", "XMLTreeBuilder",
    ]

VERSION = "1.3.0"

##
# The <b>Element</b> type is a flexible container object, designed to
# store hierarchical data structures in memory. The type can be
# described as a cross between a list and a dictionary.
# <p>
# Each element has a number of properties associated with it:
# <ul>
# <li>a <i>tag</i>. This is a string identifying what kind of data
# this element represents (the element type, in other words).</li>
# <li>a number of <i>attributes</i>, stored in a Python dictionary.</li>
# <li>a <i>text</i> string.</li>
# <li>an optional <i>tail</i> string.</li>
# <li>a number of <i>child elements</i>, stored in a Python sequence</li>
# </ul>
#
# To create an element instance, use the {@link #Element} constructor
# or the {@link #SubElement} factory function.
# <p>
# The {@link #ElementTree} class can be used to wrap an element
# structure, and convert it from and to XML.
##

import sys
import re
import warnings


class _SimpleElementPath(object):
    # emulate pre-1.2 find/findtext/findall behaviour
    def find(self, element, tag, namespaces=None):
        for elem in element:
            if elem.tag == tag:
                return elem
        return None
    def findtext(self, element, tag, default=None, namespaces=None):
        elem = self.find(element, tag)
        if elem is None:
            return default
        return elem.text or ""
    def iterfind(self, element, tag, namespaces=None):
        if tag[:3] == ".//":
            for elem in element.iter(tag[3:]):
                yield elem
        for elem in element:
            if elem.tag == tag:
                yield elem
    def findall(self, element, tag, namespaces=None):
        return list(self.iterfind(element, tag, namespaces))

try:
    from . import ElementPath
except ImportError:
    ElementPath = _SimpleElementPath()

##
# Parser error.  This is a subclass of <b>SyntaxError</b>.
# <p>
# In addition to the exception value, an exception instance contains a
# specific exception code in the <b>code</b> attribute, and the line and
# column of the error in the <b>position</b> attribute.

class ParseError(SyntaxError):
    pass

# --------------------------------------------------------------------

##
# Checks if an object appears to be a valid element object.
#
# @param An element instance.
# @return A true value if this is an element object.
# @defreturn flag

def iselement(element):
    # FIXME: not sure about this; might be a better idea to look
    # for tag/attrib/text attributes
    return isinstance(element, Element) or hasattr(element, "tag")

##
# Element class.  This class defines the Element interface, and
# provides a reference implementation of this interface.
# <p>
# The element name, attribute names, and attribute values can be
# either ASCII strings (ordinary Python strings containing only 7-bit
# ASCII characters) or Unicode strings.
#
# @param tag The element name.
# @param attrib An optional dictionary, containing element attributes.
# @param **extra Additional attributes, given as keyword arguments.
# @see Element
# @see SubElement
# @see Comment
# @see ProcessingInstruction

class Element(object):
    # <tag attrib>text<child/>...</tag>tail

    ##
    # (Attribute) Element tag.

    tag = None

    ##
    # (Attribute) Element attribute dictionary.  Where possible, use
    # {@link #Element.get},
    # {@link #Element.set},
    # {@link #Element.keys}, and
    # {@link #Element.items} to access
    # element attributes.

    attrib = None

    ##
    # (Attribute) Text before first subelement.  This is either a
    # string or the value None.  Note that if there was no text, this
    # attribute may be either None or an empty string, depending on
    # the parser.

    text = None

    ##
    # (Attribute) Text after this element's end tag, but before the
    # next sibling element's start tag.  This is either a string or
    # the value None.  Note that if there was no text, this attribute
    # may be either None or an empty string, depending on the parser.

    tail = None # text after end tag, if any

    # constructor

    def __init__(self, tag, attrib={}, **extra):
        attrib = attrib.copy()
        attrib.update(extra)
        self.tag = tag
        self.attrib = attrib
        self._children = []

    def __repr__(self):
        return "<Element %s at 0x%x>" % (repr(self.tag), id(self))

    ##
    # Creates a new element object of the same type as this element.
    #
    # @param tag Element tag.
    # @param attrib Element attributes, given as a dictionary.
    # @return A new element instance.

    def makeelement(self, tag, attrib):
        return self.__class__(tag, attrib)

    ##
    # (Experimental) Copies the current element.  This creates a
    # shallow copy; subelements will be shared with the original tree.
    #
    # @return A new element instance.

    def copy(self):
        elem = self.makeelement(self.tag, self.attrib)
        elem.text = self.text
        elem.tail = self.tail
        elem[:] = self
        return elem

    ##
    # Returns the number of subelements.  Note that this only counts
    # full elements; to check if there's any content in an element, you
    # have to check both the length and the <b>text</b> attribute.
    #
    # @return The number of subelements.

    def __len__(self):
        return len(self._children)

    def __nonzero__(self):
        warnings.warn(
            "The behavior of this method will change in future versions.  "
            "Use specific 'len(elem)' or 'elem is not None' test instead.",
            FutureWarning, stacklevel=2
            )
        return len(self._children) != 0 # emulate old behaviour, for now

    ##
    # Returns the given subelement, by index.
    #
    # @param index What subelement to return.
    # @return The given subelement.
    # @exception IndexError If the given element does not exist.

    def __getitem__(self, index):
        return self._children[index]

    ##
    # Replaces the given subelement, by index.
    #
    # @param index What subelement to replace.
    # @param element The new element value.
    # @exception IndexError If the given element does not exist.

    def __setitem__(self, index, element):
        # if isinstance(index, slice):
        #     for elt in element:
        #         assert iselement(elt)
        # else:
        #     assert iselement(element)
        self._children[index] = element

    ##
    # Deletes the given subelement, by index.
    #
    # @param index What subelement to delete.
    # @exception IndexError If the given element does not exist.

    def __delitem__(self, index):
        del self._children[index]

    ##
    # Adds a subelement to the end of this element.  In document order,
    # the new element will appear after the last existing subelement (or
    # directly after the text, if it's the first subelement), but before
    # the end tag for this element.
    #
    # @param element The element to add.

    def append(self, element):
        # assert iselement(element)
        self._children.append(element)

    ##
    # Appends subelements from a sequence.
    #
    # @param elements A sequence object with zero or more elements.
    # @since 1.3

    def extend(self, elements):
        # for element in elements:
        #     assert iselement(element)
        self._children.extend(elements)

    ##
    # Inserts a subelement at the given position in this element.
    #
    # @param index Where to insert the new subelement.

    def insert(self, index, element):
        # assert iselement(element)
        self._children.insert(index, element)

    ##
    # Removes a matching subelement.  Unlike the <b>find</b> methods,
    # this method compares elements based on identity, not on tag
    # value or contents.  To remove subelements by other means, the
    # easiest way is often to use a list comprehension to select what
    # elements to keep, and use slice assignment to update the parent
    # element.
    #
    # @param element What element to remove.
    # @exception ValueError If a matching element could not be found.

    def remove(self, element):
        # assert iselement(element)
        self._children.remove(element)

    ##
    # (Deprecated) Returns all subelements.  The elements are returned
    # in document order.
    #
    # @return A list of subelements.
    # @defreturn list of Element instances

    def getchildren(self):
        warnings.warn(
            "This method will be removed in future versions.  "
            "Use 'list(elem)' or iteration over elem instead.",
            DeprecationWarning, stacklevel=2
            )
        return self._children

    ##
    # Finds the first matching subelement, by tag name or path.
    #
    # @param path What element to look for.
    # @keyparam namespaces Optional namespace prefix map.
    # @return The first matching element, or None if no element was found.
    # @defreturn Element or None

    def find(self, path, namespaces=None):
        return ElementPath.find(self, path, namespaces)

    ##
    # Finds text for the first matching subelement, by tag name or path.
    #
    # @param path What element to look for.
    # @param default What to return if the element was not found.
    # @keyparam namespaces Optional namespace prefix map.
    # @return The text content of the first matching element, or the
    #     default value no element was found.  Note that if the element
    #     is found, but has no text content, this method returns an
    #     empty string.
    # @defreturn string

    def findtext(self, path, default=None, namespaces=None):
        return ElementPath.findtext(self, path, default, namespaces)

    ##
    # Finds all matching subelements, by tag name or path.
    #
    # @param path What element to look for.
    # @keyparam namespaces Optional namespace prefix map.
    # @return A list or other sequence containing all matching elements,
    #    in document order.
    # @defreturn list of Element instances

    def findall(self, path, namespaces=None):
        return ElementPath.findall(self, path, namespaces)

    ##
    # Finds all matching subelements, by tag name or path.
    #
    # @param path What element to look for.
    # @keyparam namespaces Optional namespace prefix map.
    # @return An iterator or sequence containing all matching elements,
    #    in document order.
    # @defreturn a generated sequence of Element instances

    def iterfind(self, path, namespaces=None):
        return ElementPath.iterfind(self, path, namespaces)

    ##
    # Resets an element.  This function removes all subelements, clears
    # all attributes, and sets the <b>text</b> and <b>tail</b> attributes
    # to None.

    def clear(self):
        self.attrib.clear()
        self._children = []
        self.text = self.tail = None

    ##
    # Gets an element attribute.  Equivalent to <b>attrib.get</b>, but
    # some implementations may handle this a bit more efficiently.
    #
    # @param key What attribute to look for.
    # @param default What to return if the attribute was not found.
    # @return The attribute value, or the default value, if the
    #     attribute was not found.
    # @defreturn string or None

    def get(self, key, default=None):
        return self.attrib.get(key, default)

    ##
    # Sets an element attribute.  Equivalent to <b>attrib[key] = value</b>,
    # but some implementations may handle this a bit more efficiently.
    #
    # @param key What attribute to set.
    # @param value The attribute value.

    def set(self, key, value):
        self.attrib[key] = value

    ##
    # Gets a list of attribute names.  The names are returned in an
    # arbitrary order (just like for an ordinary Python dictionary).
    # Equivalent to <b>attrib.keys()</b>.
    #
    # @return A list of element attribute names.
    # @defreturn list of strings

    def keys(self):
        return self.attrib.keys()

    ##
    # Gets element attributes, as a sequence.  The attributes are
    # returned in an arbitrary order.  Equivalent to <b>attrib.items()</b>.
    #
    # @return A list of (name, value) tuples for all attributes.
    # @defreturn list of (string, string) tuples

    def items(self):
        return self.attrib.items()

    ##
    # Creates a tree iterator.  The iterator loops over this element
    # and all subelements, in document order, and returns all elements
    # with a matching tag.
    # <p>
    # If the tree structure is modified during iteration, new or removed
    # elements may or may not be included.  To get a stable set, use the
    # list() function on the iterator, and loop over the resulting list.
    #
    # @param tag What tags to look for (default is to return all elements).
    # @return An iterator containing all the matching elements.
    # @defreturn iterator

    def iter(self, tag=None):
        if tag == "*":
            tag = None
        if tag is None or self.tag == tag:
            yield self
        for e in self._children:
            for e in e.iter(tag):
                yield e

    # compatibility
    def getiterator(self, tag=None):
        # Change for a DeprecationWarning in 1.4
        warnings.warn(
            "This method will be removed in future versions.  "
            "Use 'elem.iter()' or 'list(elem.iter())' instead.",
            PendingDeprecationWarning, stacklevel=2
        )
        return list(self.iter(tag))

    ##
    # Creates a text iterator.  The iterator loops over this element
    # and all subelements, in document order, and returns all inner
    # text.
    #
    # @return An iterator containing all inner text.
    # @defreturn iterator

    def itertext(self):
        tag = self.tag
        if not isinstance(tag, basestring) and tag is not None:
            return
        if self.text:
            yield self.text
        for e in self:
            for s in e.itertext():
                yield s
            if e.tail:
                yield e.tail

# compatibility
_Element = _ElementInterface = Element

##
# Subelement factory.  This function creates an element instance, and
# appends it to an existing element.
# <p>
# The element name, attribute names, and attribute values can be
# either 8-bit ASCII strings or Unicode strings.
#
# @param parent The parent element.
# @param tag The subelement name.
# @param attrib An optional dictionary, containing element attributes.
# @param **extra Additional attributes, given as keyword arguments.
# @return An element instance.
# @defreturn Element

def SubElement(parent, tag, attrib={}, **extra):
    attrib = attrib.copy()
    attrib.update(extra)
    element = parent.makeelement(tag, attrib)
    parent.append(element)
    return element

##
# Comment element factory.  This factory function creates a special
# element that will be serialized as an XML comment by the standard
# serializer.
# <p>
# The comment string can be either an 8-bit ASCII string or a Unicode
# string.
#
# @param text A string containing the comment string.
# @return An element instance, representing a comment.
# @defreturn Element

def Comment(text=None):
    element = Element(Comment)
    element.text = text
    return element

##
# PI element factory.  This factory function creates a special element
# that will be serialized as an XML processing instruction by the standard
# serializer.
#
# @param target A string containing the PI target.
# @param text A string containing the PI contents, if any.
# @return An element instance, representing a PI.
# @defreturn Element

def ProcessingInstruction(target, text=None):
    element = Element(ProcessingInstruction)
    element.text = target
    if text:
        element.text = element.text + " " + text
    return element

PI = ProcessingInstruction

##
# QName wrapper.  This can be used to wrap a QName attribute value, in
# order to get proper namespace handling on output.
#
# @param text A string containing the QName value, in the form {uri}local,
#     or, if the tag argument is given, the URI part of a QName.
# @param tag Optional tag.  If given, the first argument is interpreted as
#     an URI, and this argument is interpreted as a local name.
# @return An opaque object, representing the QName.

class QName(object):
    def __init__(self, text_or_uri, tag=None):
        if tag:
            text_or_uri = "{%s}%s" % (text_or_uri, tag)
        self.text = text_or_uri
    def __str__(self):
        return self.text
    def __hash__(self):
        return hash(self.text)
    def __cmp__(self, other):
        if isinstance(other, QName):
            return cmp(self.text, other.text)
        return cmp(self.text, other)

# --------------------------------------------------------------------

##
# ElementTree wrapper class.  This class represents an entire element
# hierarchy, and adds some extra support for serialization to and from
# standard XML.
#
# @param element Optional root element.
# @keyparam file Optional file handle or file name.  If given, the
#     tree is initialized with the contents of this XML file.

class ElementTree(object):

    def __init__(self, element=None, file=None):
        # assert element is None or iselement(element)
        self._root = element # first node
        if file:
            self.parse(file)

    ##
    # Gets the root element for this tree.
    #
    # @return An element instance.
    # @defreturn Element

    def getroot(self):
        return self._root

    ##
    # Replaces the root element for this tree.  This discards the
    # current contents of the tree, and replaces it with the given
    # element.  Use with care.
    #
    # @param element An element instance.

    def _setroot(self, element):
        # assert iselement(element)
        self._root = element

    ##
    # Loads an external XML document into this element tree.
    #
    # @param source A file name or file object.  If a file object is
    #     given, it only has to implement a <b>read(n)</b> method.
    # @keyparam parser An optional parser instance.  If not given, the
    #     standard {@link XMLParser} parser is used.
    # @return The document root element.
    # @defreturn Element
    # @exception ParseError If the parser fails to parse the document.

    def parse(self, source, parser=None):
        close_source = False
        if not hasattr(source, "read"):
            source = open(source, "rb")
            close_source = True
        try:
            if not parser:
                parser = XMLParser(target=TreeBuilder())
            while 1:
                data = source.read(65536)
                if not data:
                    break
                parser.feed(data)
            self._root = parser.close()
            return self._root
        finally:
            if close_source:
                source.close()

    ##
    # Creates a tree iterator for the root element.  The iterator loops
    # over all elements in this tree, in document order.
    #
    # @param tag What tags to look for (default is to return all elements)
    # @return An iterator.
    # @defreturn iterator

    def iter(self, tag=None):
        # assert self._root is not None
        return self._root.iter(tag)

    # compatibility
    def getiterator(self, tag=None):
        # Change for a DeprecationWarning in 1.4
        warnings.warn(
            "This method will be removed in future versions.  "
            "Use 'tree.iter()' or 'list(tree.iter())' instead.",
            PendingDeprecationWarning, stacklevel=2
        )
        return list(self.iter(tag))

    ##
    # Same as getroot().find(path), starting at the root of the
    # tree.
    #
    # @param path What element to look for.
    # @keyparam namespaces Optional namespace prefix map.
    # @return The first matching element, or None if no element was found.
    # @defreturn Element or None

    def find(self, path, namespaces=None):
        # assert self._root is not None
        if path[:1] == "/":
            path = "." + path
            warnings.warn(
                "This search is broken in 1.3 and earlier, and will be "
                "fixed in a future version.  If you rely on the current "
                "behaviour, change it to %r" % path,
                FutureWarning, stacklevel=2
                )
        return self._root.find(path, namespaces)

    ##
    # Same as getroot().findtext(path), starting at the root of the tree.
    #
    # @param path What element to look for.
    # @param default What to return if the element was not found.
    # @keyparam namespaces Optional namespace prefix map.
    # @return The text content of the first matching element, or the
    #     default value no element was found.  Note that if the element
    #     is found, but has no text content, this method returns an
    #     empty string.
    # @defreturn string

    def findtext(self, path, default=None, namespaces=None):
        # assert self._root is not None
        if path[:1] == "/":
            path = "." + path
            warnings.warn(
                "This search is broken in 1.3 and earlier, and will be "
                "fixed in a future version.  If you rely on the current "
                "behaviour, change it to %r" % path,
                FutureWarning, stacklevel=2
                )
        return self._root.findtext(path, default, namespaces)

    ##
    # Same as getroot().findall(path), starting at the root of the tree.
    #
    # @param path What element to look for.
    # @keyparam namespaces Optional namespace prefix map.
    # @return A list or iterator containing all matching elements,
    #    in document order.
    # @defreturn list of Element instances

    def findall(self, path, namespaces=None):
        # assert self._root is not None
        if path[:1] == "/":
            path = "." + path
            warnings.warn(
                "This search is broken in 1.3 and earlier, and will be "
                "fixed in a future version.  If you rely on the current "
                "behaviour, change it to %r" % path,
                FutureWarning, stacklevel=2
                )
        return self._root.findall(path, namespaces)

    ##
    # Finds all matching subelements, by tag name or path.
    # Same as getroot().iterfind(path).
    #
    # @param path What element to look for.
    # @keyparam namespaces Optional namespace prefix map.
    # @return An iterator or sequence containing all matching elements,
    #    in document order.
    # @defreturn a generated sequence of Element instances

    def iterfind(self, path, namespaces=None):
        # assert self._root is not None
        if path[:1] == "/":
            path = "." + path
            warnings.warn(
                "This search is broken in 1.3 and earlier, and will be "
                "fixed in a future version.  If you rely on the current "
                "behaviour, change it to %r" % path,
                FutureWarning, stacklevel=2
                )
        return self._root.iterfind(path, namespaces)

    ##
    # Writes the element tree to a file, as XML.
    #
    # @def write(file, **options)
    # @param file A file name, or a file object opened for writing.
    # @param **options Options, given as keyword arguments.
    # @keyparam encoding Optional output encoding (default is US-ASCII).
    # @keyparam xml_declaration Controls if an XML declaration should
    #     be added to the file.  Use False for never, True for always,
    #     None for only if not US-ASCII or UTF-8.  None is default.
    # @keyparam default_namespace Sets the default XML namespace (for "xmlns").
    # @keyparam method Optional output method ("xml", "html", "text" or
    #     "c14n"; default is "xml").

    def write(self, file_or_filename,
              # keyword arguments
              encoding=None,
              xml_declaration=None,
              default_namespace=None,
              method=None):
        # assert self._root is not None
        if not method:
            method = "xml"
        elif method not in _serialize:
            # FIXME: raise an ImportError for c14n if ElementC14N is missing?
            raise ValueError("unknown method %r" % method)
        if hasattr(file_or_filename, "write"):
            file = file_or_filename
        else:
            file = open(file_or_filename, "wb")
        write = file.write
        if not encoding:
            if method == "c14n":
                encoding = "utf-8"
            else:
                encoding = "us-ascii"
        elif xml_declaration or (xml_declaration is None and
                                 encoding not in ("utf-8", "us-ascii")):
            if method == "xml":
                write("<?xml version='1.0' encoding='%s'?>\n" % encoding)
        if method == "text":
            _serialize_text(write, self._root, encoding)
        else:
            qnames, namespaces = _namespaces(
                self._root, encoding, default_namespace
                )
            serialize = _serialize[method]
            serialize(write, self._root, encoding, qnames, namespaces)
        if file_or_filename is not file:
            file.close()

    def write_c14n(self, file):
        # lxml.etree compatibility.  use output method instead
        return self.write(file, method="c14n")

# --------------------------------------------------------------------
# serialization support

def _namespaces(elem, encoding, default_namespace=None):
    # identify namespaces used in this tree

    # maps qnames to *encoded* prefix:local names
    qnames = {None: None}

    # maps uri:s to prefixes
    namespaces = {}
    if default_namespace:
        namespaces[default_namespace] = ""

    def encode(text):
        return text.encode(encoding)

    def add_qname(qname):
        # calculate serialized qname representation
        try:
            if qname[:1] == "{":
                uri, tag = qname[1:].rsplit("}", 1)
                prefix = namespaces.get(uri)
                if prefix is None:
                    prefix = _namespace_map.get(uri)
                    if prefix is None:
                        prefix = "ns%d" % len(namespaces)
                    if prefix != "xml":
                        namespaces[uri] = prefix
                if prefix:
                    qnames[qname] = encode("%s:%s" % (prefix, tag))
                else:
                    qnames[qname] = encode(tag) # default element
            else:
                if default_namespace:
                    # FIXME: can this be handled in XML 1.0?
                    raise ValueError(
                        "cannot use non-qualified names with "
                        "default_namespace option"
                        )
                qnames[qname] = encode(qname)
        except TypeError:
            _raise_serialization_error(qname)

    # populate qname and namespaces table
    try:
        iterate = elem.iter
    except AttributeError:
        iterate = elem.getiterator # cET compatibility
    for elem in iterate():
        tag = elem.tag
        if isinstance(tag, QName):
            if tag.text not in qnames:
                add_qname(tag.text)
        elif isinstance(tag, basestring):
            if tag not in qnames:
                add_qname(tag)
        elif tag is not None and tag is not Comment and tag is not PI:
            _raise_serialization_error(tag)
        for key, value in elem.items():
            if isinstance(key, QName):
                key = key.text
            if key not in qnames:
                add_qname(key)
            if isinstance(value, QName) and value.text not in qnames:
                add_qname(value.text)
        text = elem.text
        if isinstance(text, QName) and text.text not in qnames:
            add_qname(text.text)
    return qnames, namespaces

def _serialize_xml(write, elem, encoding, qnames, namespaces):
    tag = elem.tag
    text = elem.text
    if tag is Comment:
        write("<!--%s-->" % _encode(text, encoding))
    elif tag is ProcessingInstruction:
        write("<?%s?>" % _encode(text, encoding))
    else:
        tag = qnames[tag]
        if tag is None:
            if text:
                write(_escape_cdata(text, encoding))
            for e in elem:
                _serialize_xml(write, e, encoding, qnames, None)
        else:
            write("<" + tag)
            items = elem.items()
            if items or namespaces:
                if namespaces:
                    for v, k in sorted(namespaces.items(),
                                       key=lambda x: x[1]):  # sort on prefix
                        if k:
                            k = ":" + k
                        write(" xmlns%s=\"%s\"" % (
                            k.encode(encoding),
                            _escape_attrib(v, encoding)
                            ))
                for k, v in sorted(items):  # lexical order
                    if isinstance(k, QName):
                        k = k.text
                    if isinstance(v, QName):
                        v = qnames[v.text]
                    else:
                        v = _escape_attrib(v, encoding)
                    write(" %s=\"%s\"" % (qnames[k], v))
            if text or len(elem):
                write(">")
                if text:
                    write(_escape_cdata(text, encoding))
                for e in elem:
                    _serialize_xml(write, e, encoding, qnames, None)
                write("</" + tag + ">")
            else:
                write(" />")
    if elem.tail:
        write(_escape_cdata(elem.tail, encoding))

HTML_EMPTY = ("area", "base", "basefont", "br", "col", "frame", "hr",
              "img", "input", "isindex", "link", "meta", "param")

try:
    HTML_EMPTY = set(HTML_EMPTY)
except NameError:
    pass

def _serialize_html(write, elem, encoding, qnames, namespaces):
    tag = elem.tag
    text = elem.text
    if tag is Comment:
        write("<!--%s-->" % _escape_cdata(text, encoding))
    elif tag is ProcessingInstruction:
        write("<?%s?>" % _escape_cdata(text, encoding))
    else:
        tag = qnames[tag]
        if tag is None:
            if text:
                write(_escape_cdata(text, encoding))
            for e in elem:
                _serialize_html(write, e, encoding, qnames, None)
        else:
            write("<" + tag)
            items = elem.items()
            if items or namespaces:
                if namespaces:
                    for v, k in sorted(namespaces.items(),
                                       key=lambda x: x[1]):  # sort on prefix
                        if k:
                            k = ":" + k
                        write(" xmlns%s=\"%s\"" % (
                            k.encode(encoding),
                            _escape_attrib(v, encoding)
                            ))
                for k, v in sorted(items):  # lexical order
                    if isinstance(k, QName):
                        k = k.text
                    if isinstance(v, QName):
                        v = qnames[v.text]
                    else:
                        v = _escape_attrib_html(v, encoding)
                    # FIXME: handle boolean attributes
                    write(" %s=\"%s\"" % (qnames[k], v))
            write(">")
            ltag = tag.lower()
            if text:
                if ltag == "script" or ltag == "style":
                    write(_encode(text, encoding))
                else:
                    write(_escape_cdata(text, encoding))
            for e in elem:
                _serialize_html(write, e, encoding, qnames, None)
            if ltag not in HTML_EMPTY:
                write("</" + tag + ">")
    if elem.tail:
        write(_escape_cdata(elem.tail, encoding))

def _serialize_text(write, elem, encoding):
    for part in elem.itertext():
        write(part.encode(encoding))
    if elem.tail:
        write(elem.tail.encode(encoding))

_serialize = {
    "xml": _serialize_xml,
    "html": _serialize_html,
    "text": _serialize_text,
# this optional method is imported at the end of the module
#   "c14n": _serialize_c14n,
}

##
# Registers a namespace prefix.  The registry is global, and any
# existing mapping for either the given prefix or the namespace URI
# will be removed.
#
# @param prefix Namespace prefix.
# @param uri Namespace uri.  Tags and attributes in this namespace
#     will be serialized with the given prefix, if at all possible.
# @exception ValueError If the prefix is reserved, or is otherwise
#     invalid.

def register_namespace(prefix, uri):
    if re.match("ns\d+$", prefix):
        raise ValueError("Prefix format reserved for internal use")
    for k, v in _namespace_map.items():
        if k == uri or v == prefix:
            del _namespace_map[k]
    _namespace_map[uri] = prefix

_namespace_map = {
    # "well-known" namespace prefixes
    "http://www.w3.org/XML/1998/namespace": "xml",
    "http://www.w3.org/1999/xhtml": "html",
    "http://www.w3.org/1999/02/22-rdf-syntax-ns#": "rdf",
    "http://schemas.xmlsoap.org/wsdl/": "wsdl",
    # xml schema
    "http://www.w3.org/2001/XMLSchema": "xs",
    "http://www.w3.org/2001/XMLSchema-instance": "xsi",
    # dublin core
    "http://purl.org/dc/elements/1.1/": "dc",
}

def _raise_serialization_error(text):
    raise TypeError(
        "cannot serialize %r (type %s)" % (text, type(text).__name__)
        )

def _encode(text, encoding):
    try:
        return text.encode(encoding, "xmlcharrefreplace")
    except (TypeError, AttributeError):
        _raise_serialization_error(text)

def _escape_cdata(text, encoding):
    # escape character data
    try:
        # it's worth avoiding do-nothing calls for strings that are
        # shorter than 500 character, or so.  assume that's, by far,
        # the most common case in most applications.
        if "&" in text:
            text = text.replace("&", "&amp;")
        if "<" in text:
            text = text.replace("<", "&lt;")
        if ">" in text:
            text = text.replace(">", "&gt;")
        return text.encode(encoding, "xmlcharrefreplace")
    except (TypeError, AttributeError):
        _raise_serialization_error(text)

def _escape_attrib(text, encoding):
    # escape attribute value
    try:
        if "&" in text:
            text = text.replace("&", "&amp;")
        if "<" in text:
            text = text.replace("<", "&lt;")
        if ">" in text:
            text = text.replace(">", "&gt;")
        if "\"" in text:
            text = text.replace("\"", "&quot;")
        if "\n" in text:
            text = text.replace("\n", "&#10;")
        return text.encode(encoding, "xmlcharrefreplace")
    except (TypeError, AttributeError):
        _raise_serialization_error(text)

def _escape_attrib_html(text, encoding):
    # escape attribute value
    try:
        if "&" in text:
            text = text.replace("&", "&amp;")
        if ">" in text:
            text = text.replace(">", "&gt;")
        if "\"" in text:
            text = text.replace("\"", "&quot;")
        return text.encode(encoding, "xmlcharrefreplace")
    except (TypeError, AttributeError):
        _raise_serialization_error(text)

# --------------------------------------------------------------------

##
# Generates a string representation of an XML element, including all
# subelements.
#
# @param element An Element instance.
# @keyparam encoding Optional output encoding (default is US-ASCII).
# @keyparam method Optional output method ("xml", "html", "text" or
#     "c14n"; default is "xml").
# @return An encoded string containing the XML data.
# @defreturn string

def tostring(element, encoding=None, method=None):
    class dummy:
        pass
    data = []
    file = dummy()
    file.write = data.append
    ElementTree(element).write(file, encoding, method=method)
    return "".join(data)

##
# Generates a string representation of an XML element, including all
# subelements.  The string is returned as a sequence of string fragments.
#
# @param element An Element instance.
# @keyparam encoding Optional output encoding (default is US-ASCII).
# @keyparam method Optional output method ("xml", "html", "text" or
#     "c14n"; default is "xml").
# @return A sequence object containing the XML data.
# @defreturn sequence
# @since 1.3

def tostringlist(element, encoding=None, method=None):
    class dummy:
        pass
    data = []
    file = dummy()
    file.write = data.append
    ElementTree(element).write(file, encoding, method=method)
    # FIXME: merge small fragments into larger parts
    return data

##
# Writes an element tree or element structure to sys.stdout.  This
# function should be used for debugging only.
# <p>
# The exact output format is implementation dependent.  In this
# version, it's written as an ordinary XML file.
#
# @param elem An element tree or an individual element.

def dump(elem):
    # debugging
    if not isinstance(elem, ElementTree):
        elem = ElementTree(elem)
    elem.write(sys.stdout)
    tail = elem.getroot().tail
    if not tail or tail[-1] != "\n":
        sys.stdout.write("\n")

# --------------------------------------------------------------------
# parsing

##
# Parses an XML document into an element tree.
#
# @param source A filename or file object containing XML data.
# @param parser An optional parser instance.  If not given, the
#     standard {@link XMLParser} parser is used.
# @return An ElementTree instance

def parse(source, parser=None):
    tree = ElementTree()
    tree.parse(source, parser)
    return tree

##
# Parses an XML document into an element tree incrementally, and reports
# what's going on to the user.
#
# @param source A filename or file object containing XML data.
# @param events A list of events to report back.  If omitted, only "end"
#     events are reported.
# @param parser An optional parser instance.  If not given, the
#     standard {@link XMLParser} parser is used.
# @return A (event, elem) iterator.

def iterparse(source, events=None, parser=None):
    close_source = False
    if not hasattr(source, "read"):
        source = open(source, "rb")
        close_source = True
    if not parser:
        parser = XMLParser(target=TreeBuilder())
    return _IterParseIterator(source, events, parser, close_source)

class _IterParseIterator(object):

    def __init__(self, source, events, parser, close_source=False):
        self._file = source
        self._close_file = close_source
        self._events = []
        self._index = 0
        self._error = None
        self.root = self._root = None
        self._parser = parser
        # wire up the parser for event reporting
        parser = self._parser._parser
        append = self._events.append
        if events is None:
            events = ["end"]
        for event in events:
            if event == "start":
                try:
                    parser.ordered_attributes = 1
                    parser.specified_attributes = 1
                    def handler(tag, attrib_in, event=event, append=append,
                                start=self._parser._start_list):
                        append((event, start(tag, attrib_in)))
                    parser.StartElementHandler = handler
                except AttributeError:
                    def handler(tag, attrib_in, event=event, append=append,
                                start=self._parser._start):
                        append((event, start(tag, attrib_in)))
                    parser.StartElementHandler = handler
            elif event == "end":
                def handler(tag, event=event, append=append,
                            end=self._parser._end):
                    append((event, end(tag)))
                parser.EndElementHandler = handler
            elif event == "start-ns":
                def handler(prefix, uri, event=event, append=append):
                    try:
                        uri = (uri or "").encode("ascii")
                    except UnicodeError:
                        pass
                    append((event, (prefix or "", uri or "")))
                parser.StartNamespaceDeclHandler = handler
            elif event == "end-ns":
                def handler(prefix, event=event, append=append):
                    append((event, None))
                parser.EndNamespaceDeclHandler = handler
            else:
                raise ValueError("unknown event %r" % event)

    def next(self):
        while 1:
            try:
                item = self._events[self._index]
                self._index += 1
                return item
            except IndexError:
                pass
            if self._error:
                e = self._error
                self._error = None
                raise e
            if self._parser is None:
                self.root = self._root
                if self._close_file:
                    self._file.close()
                raise StopIteration
            # load event buffer
            del self._events[:]
            self._index = 0
            data = self._file.read(16384)
            if data:
                try:
                    self._parser.feed(data)
                except SyntaxError as exc:
                    self._error = exc
            else:
                self._root = self._parser.close()
                self._parser = None

    def __iter__(self):
        return self

##
# Parses an XML document from a string constant.  This function can
# be used to embed "XML literals" in Python code.
#
# @param source A string containing XML data.
# @param parser An optional parser instance.  If not given, the
#     standard {@link XMLParser} parser is used.
# @return An Element instance.
# @defreturn Element

def XML(text, parser=None):
    if not parser:
        parser = XMLParser(target=TreeBuilder())
    parser.feed(text)
    return parser.close()

##
# Parses an XML document from a string constant, and also returns
# a dictionary which maps from element id:s to elements.
#
# @param source A string containing XML data.
# @param parser An optional parser instance.  If not given, the
#     standard {@link XMLParser} parser is used.
# @return A tuple containing an Element instance and a dictionary.
# @defreturn (Element, dictionary)

def XMLID(text, parser=None):
    if not parser:
        parser = XMLParser(target=TreeBuilder())
    parser.feed(text)
    tree = parser.close()
    ids = {}
    for elem in tree.iter():
        id = elem.get("id")
        if id:
            ids[id] = elem
    return tree, ids

##
# Parses an XML document from a string constant.  Same as {@link #XML}.
#
# @def fromstring(text)
# @param source A string containing XML data.
# @return An Element instance.
# @defreturn Element

fromstring = XML

##
# Parses an XML document from a sequence of string fragments.
#
# @param sequence A list or other sequence containing XML data fragments.
# @param parser An optional parser instance.  If not given, the
#     standard {@link XMLParser} parser is used.
# @return An Element instance.
# @defreturn Element
# @since 1.3

def fromstringlist(sequence, parser=None):
    if not parser:
        parser = XMLParser(target=TreeBuilder())
    for text in sequence:
        parser.feed(text)
    return parser.close()

# --------------------------------------------------------------------

##
# Generic element structure builder.  This builder converts a sequence
# of {@link #TreeBuilder.start}, {@link #TreeBuilder.data}, and {@link
# #TreeBuilder.end} method calls to a well-formed element structure.
# <p>
# You can use this class to build an element structure using a custom XML
# parser, or a parser for some other XML-like format.
#
# @param element_factory Optional element factory.  This factory
#    is called to create new Element instances, as necessary.

class TreeBuilder(object):

    def __init__(self, element_factory=None):
        self._data = [] # data collector
        self._elem = [] # element stack
        self._last = None # last element
        self._tail = None # true if we're after an end tag
        if element_factory is None:
            element_factory = Element
        self._factory = element_factory

    ##
    # Flushes the builder buffers, and returns the toplevel document
    # element.
    #
    # @return An Element instance.
    # @defreturn Element

    def close(self):
        assert len(self._elem) == 0, "missing end tags"
        assert self._last is not None, "missing toplevel element"
        return self._last

    def _flush(self):
        if self._data:
            if self._last is not None:
                text = "".join(self._data)
                if self._tail:
                    assert self._last.tail is None, "internal error (tail)"
                    self._last.tail = text
                else:
                    assert self._last.text is None, "internal error (text)"
                    self._last.text = text
            self._data = []

    ##
    # Adds text to the current element.
    #
    # @param data A string.  This should be either an 8-bit string
    #    containing ASCII text, or a Unicode string.

    def data(self, data):
        self._data.append(data)

    ##
    # Opens a new element.
    #
    # @param tag The element name.
    # @param attrib A dictionary containing element attributes.
    # @return The opened element.
    # @defreturn Element

    def start(self, tag, attrs):
        self._flush()
        self._last = elem = self._factory(tag, attrs)
        if self._elem:
            self._elem[-1].append(elem)
        self._elem.append(elem)
        self._tail = 0
        return elem

    ##
    # Closes the current element.
    #
    # @param tag The element name.
    # @return The closed element.
    # @defreturn Element

    def end(self, tag):
        self._flush()
        self._last = self._elem.pop()
        assert self._last.tag == tag,\
               "end tag mismatch (expected %s, got %s)" % (
                   self._last.tag, tag)
        self._tail = 1
        return self._last

##
# Element structure builder for XML source data, based on the
# <b>expat</b> parser.
#
# @keyparam target Target object.  If omitted, the builder uses an
#     instance of the standard {@link #TreeBuilder} class.
# @keyparam html Predefine HTML entities.  This flag is not supported
#     by the current implementation.
# @keyparam encoding Optional encoding.  If given, the value overrides
#     the encoding specified in the XML file.
# @see #ElementTree
# @see #TreeBuilder

class XMLParser(object):

    def __init__(self, html=0, target=None, encoding=None):
        try:
            from xml.parsers import expat
        except ImportError:
            try:
                import pyexpat as expat
            except ImportError:
                raise ImportError(
                    "No module named expat; use SimpleXMLTreeBuilder instead"
                    )
        parser = expat.ParserCreate(encoding, "}")
        if target is None:
            target = TreeBuilder()
        # underscored names are provided for compatibility only
        self.parser = self._parser = parser
        self.target = self._target = target
        self._error = expat.error
        self._names = {} # name memo cache
        # callbacks
        parser.DefaultHandlerExpand = self._default
        parser.StartElementHandler = self._start
        parser.EndElementHandler = self._end
        parser.CharacterDataHandler = self._data
        # optional callbacks
        parser.CommentHandler = self._comment
        parser.ProcessingInstructionHandler = self._pi
        # let expat do the buffering, if supported
        try:
            self._parser.buffer_text = 1
        except AttributeError:
            pass
        # use new-style attribute handling, if supported
        try:
            self._parser.ordered_attributes = 1
            self._parser.specified_attributes = 1
            parser.StartElementHandler = self._start_list
        except AttributeError:
            pass
        self._doctype = None
        self.entity = {}
        try:
            self.version = "Expat %d.%d.%d" % expat.version_info
        except AttributeError:
            pass # unknown

    def _raiseerror(self, value):
        err = ParseError(value)
        err.code = value.code
        err.position = value.lineno, value.offset
        raise err

    def _fixtext(self, text):
        # convert text string to ascii, if possible
        try:
            return text.encode("ascii")
        except UnicodeError:
            return text

    def _fixname(self, key):
        # expand qname, and convert name string to ascii, if possible
        try:
            name = self._names[key]
        except KeyError:
            name = key
            if "}" in name:
                name = "{" + name
            self._names[key] = name = self._fixtext(name)
        return name

    def _start(self, tag, attrib_in):
        fixname = self._fixname
        fixtext = self._fixtext
        tag = fixname(tag)
        attrib = {}
        for key, value in attrib_in.items():
            attrib[fixname(key)] = fixtext(value)
        return self.target.start(tag, attrib)

    def _start_list(self, tag, attrib_in):
        fixname = self._fixname
        fixtext = self._fixtext
        tag = fixname(tag)
        attrib = {}
        if attrib_in:
            for i in range(0, len(attrib_in), 2):
                attrib[fixname(attrib_in[i])] = fixtext(attrib_in[i+1])
        return self.target.start(tag, attrib)

    def _data(self, text):
        return self.target.data(self._fixtext(text))

    def _end(self, tag):
        return self.target.end(self._fixname(tag))

    def _comment(self, data):
        try:
            comment = self.target.comment
        except AttributeError:
            pass
        else:
            return comment(self._fixtext(data))

    def _pi(self, target, data):
        try:
            pi = self.target.pi
        except AttributeError:
            pass
        else:
            return pi(self._fixtext(target), self._fixtext(data))

    def _default(self, text):
        prefix = text[:1]
        if prefix == "&":
            # deal with undefined entities
            try:
                self.target.data(self.entity[text[1:-1]])
            except KeyError:
                from xml.parsers import expat
                err = expat.error(
                    "undefined entity %s: line %d, column %d" %
                    (text, self._parser.ErrorLineNumber,
                    self._parser.ErrorColumnNumber)
                    )
                err.code = 11 # XML_ERROR_UNDEFINED_ENTITY
                err.lineno = self._parser.ErrorLineNumber
                err.offset = self._parser.ErrorColumnNumber
                raise err
        elif prefix == "<" and text[:9] == "<!DOCTYPE":
            self._doctype = [] # inside a doctype declaration
        elif self._doctype is not None:
            # parse doctype contents
            if prefix == ">":
                self._doctype = None
                return
            text = text.strip()
            if not text:
                return
            self._doctype.append(text)
            n = len(self._doctype)
            if n > 2:
                type = self._doctype[1]
                if type == "PUBLIC" and n == 4:
                    name, type, pubid, system = self._doctype
                elif type == "SYSTEM" and n == 3:
                    name, type, system = self._doctype
                    pubid = None
                else:
                    return
                if pubid:
                    pubid = pubid[1:-1]
                if hasattr(self.target, "doctype"):
                    self.target.doctype(name, pubid, system[1:-1])
                elif self.doctype is not self._XMLParser__doctype:
                    # warn about deprecated call
                    self._XMLParser__doctype(name, pubid, system[1:-1])
                    self.doctype(name, pubid, system[1:-1])
                self._doctype = None

    ##
    # (Deprecated) Handles a doctype declaration.
    #
    # @param name Doctype name.
    # @param pubid Public identifier.
    # @param system System identifier.

    def doctype(self, name, pubid, system):
        """This method of XMLParser is deprecated."""
        warnings.warn(
            "This method of XMLParser is deprecated.  Define doctype() "
            "method on the TreeBuilder target.",
            DeprecationWarning,
            )

    # sentinel, if doctype is redefined in a subclass
    __doctype = doctype

    ##
    # Feeds data to the parser.
    #
    # @param data Encoded data.

    def feed(self, data):
        try:
            self._parser.Parse(data, 0)
        except self._error, v:
            self._raiseerror(v)

    ##
    # Finishes feeding data to the parser.
    #
    # @return An element structure.
    # @defreturn Element

    def close(self):
        try:
            self._parser.Parse("", 1) # end of data
        except self._error, v:
            self._raiseerror(v)
        tree = self.target.close()
        del self.target, self._parser # get rid of circular references
        return tree

# compatibility
XMLTreeBuilder = XMLParser

# workaround circular import.
try:
    from ElementC14N import _serialize_c14n
    _serialize["c14n"] = _serialize_c14n
except ImportError:
    pass
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # $Id: __init__.py 3375 2008-02-13 08:05:08Z fredrik $
# elementtree package

# --------------------------------------------------------------------
# The ElementTree toolkit is
#
# Copyright (c) 1999-2008 by Fredrik Lundh
#
# By obtaining, using, and/or copying this software and/or its
# associated documentation, you agree that you have read, understood,
# and will comply with the following terms and conditions:
#
# Permission to use, copy, modify, and distribute this software and
# its associated documentation for any purpose and without fee is
# hereby granted, provided that the above copyright notice appears in
# all copies, and that both that copyright notice and this permission
# notice appear in supporting documentation, and that the name of
# Secret Labs AB or the author not be used in advertising or publicity
# pertaining to distribution of the software without specific, written
# prior permission.
#
# SECRET LABS AB AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD
# TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANT-
# ABILITY AND FITNESS.  IN NO EVENT SHALL SECRET LABS AB OR THE AUTHOR
# BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY
# DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
# WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
# ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE
# OF THIS SOFTWARE.
# --------------------------------------------------------------------

# Licensed to PSF under a Contributor Agreement.
# See http://www.python.org/psf/license for licensing details.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            # Wrapper module for _elementtree

from _elementtree import *
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  """Python interfaces to XML parsers.

This package contains one module:

expat -- Python wrapper for James Clark's Expat parser, with namespace
         support.

"""
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         """Interface to the Expat non-validating XML parser."""
__version__ = '$Revision: 17640 $'

from pyexpat import *
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              """Simple API for XML (SAX) implementation for Python.

This module provides an implementation of the SAX 2 interface;
information about the Java version of the interface can be found at
http://www.megginson.com/SAX/.  The Python version of the interface is
documented at <...>.

This package contains the following modules:

handler -- Base classes and constants which define the SAX 2 API for
           the 'client-side' of SAX for Python.

saxutils -- Implementation of the convenience classes commonly used to
            work with SAX.

xmlreader -- Base classes and constants which define the SAX 2 API for
             the parsers used with SAX for Python.

expatreader -- Driver that allows use of the Expat parser with SAX.
"""

from xmlreader import InputSource
from handler import ContentHandler, ErrorHandler
from _exceptions import SAXException, SAXNotRecognizedException, \
                        SAXParseException, SAXNotSupportedException, \
                        SAXReaderNotAvailable


def parse(source, handler, errorHandler=ErrorHandler()):
    parser = make_parser()
    parser.setContentHandler(handler)
    parser.setErrorHandler(errorHandler)
    parser.parse(source)

def parseString(string, handler, errorHandler=ErrorHandler()):
    try:
        from cStringIO import StringIO
    except ImportError:
        from StringIO import StringIO

    if errorHandler is None:
        errorHandler = ErrorHandler()
    parser = make_parser()
    parser.setContentHandler(handler)
    parser.setErrorHandler(errorHandler)

    inpsrc = InputSource()
    inpsrc.setByteStream(StringIO(string))
    parser.parse(inpsrc)

# this is the parser list used by the make_parser function if no
# alternatives are given as parameters to the function

default_parser_list = ["xml.sax.expatreader"]

# tell modulefinder that importing sax potentially imports expatreader
_false = 0
if _false:
    import xml.sax.expatreader

import os, sys
if "PY_SAX_PARSER" in os.environ:
    default_parser_list = os.environ["PY_SAX_PARSER"].split(",")
del os

_key = "python.xml.sax.parser"
if sys.platform[:4] == "java" and sys.registry.containsKey(_key):
    default_parser_list = sys.registry.getProperty(_key).split(",")


def make_parser(parser_list = []):
    """Creates and returns a SAX parser.

    Creates the first parser it is able to instantiate of the ones
    given in the list created by doing parser_list +
    default_parser_list.  The lists must contain the names of Python
    modules containing both a SAX parser and a create_parser function."""

    for parser_name in parser_list + default_parser_list:
        try:
            return _create_parser(parser_name)
        except ImportError,e:
            import sys
            if parser_name in sys.modules:
                # The parser module was found, but importing it
                # failed unexpectedly, pass this exception through
                raise
        except SAXReaderNotAvailable:
            # The parser module detected that it won't work properly,
            # so try the next one
            pass

    raise SAXReaderNotAvailable("No parsers found", None)

# --- Internal utility methods used by make_parser

if sys.platform[ : 4] == "java":
    def _create_parser(parser_name):
        from org.python.core import imp
        drv_module = imp.importName(parser_name, 0, globals())
        return drv_module.create_parser()

else:
    def _create_parser(parser_name):
        drv_module = __import__(parser_name,{},{},['create_parser'])
        return drv_module.create_parser()

del sys
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   """Different kinds of SAX Exceptions"""
import sys
if sys.platform[:4] == "java":
    from java.lang import Exception
del sys

# ===== SAXEXCEPTION =====

class SAXException(Exception):
    """Encapsulate an XML error or warning. This class can contain
    basic error or warning information from either the XML parser or
    the application: you can subclass it to provide additional
    functionality, or to add localization. Note that although you will
    receive a SAXException as the argument to the handlers in the
    ErrorHandler interface, you are not actually required to raise
    the exception; instead, you can simply read the information in
    it."""

    def __init__(self, msg, exception=None):
        """Creates an exception. The message is required, but the exception
        is optional."""
        self._msg = msg
        self._exception = exception
        Exception.__init__(self, msg)

    def getMessage(self):
        "Return a message for this exception."
        return self._msg

    def getException(self):
        "Return the embedded exception, or None if there was none."
        return self._exception

    def __str__(self):
        "Create a string representation of the exception."
        return self._msg

    def __getitem__(self, ix):
        """Avoids weird error messages if someone does exception[ix] by
        mistake, since Exception has __getitem__ defined."""
        raise AttributeError("__getitem__")


# ===== SAXPARSEEXCEPTION =====

class SAXParseException(SAXException):
    """Encapsulate an XML parse error or warning.

    This exception will include information for locating the error in
    the original XML document. Note that although the application will
    receive a SAXParseException as the argument to the handlers in the
    ErrorHandler interface, the application is not actually required
    to raise the exception; instead, it can simply read the
    information in it and take a different action.

    Since this exception is a subclass of SAXException, it inherits
    the ability to wrap another exception."""

    def __init__(self, msg, exception, locator):
        "Creates the exception. The exception parameter is allowed to be None."
        SAXException.__init__(self, msg, exception)
        self._locator = locator

        # We need to cache this stuff at construction time.
        # If this exception is raised, the objects through which we must
        # traverse to get this information may be deleted by the time
        # it gets caught.
        self._systemId = self._locator.getSystemId()
        self._colnum = self._locator.getColumnNumber()
        self._linenum = self._locator.getLineNumber()

    def getColumnNumber(self):
        """The column number of the end of the text where the exception
        occurred."""
        return self._colnum

    def getLineNumber(self):
        "The line number of the end of the text where the exception occurred."
        return self._linenum

    def getPublicId(self):
        "Get the public identifier of the entity where the exception occurred."
        return self._locator.getPublicId()

    def getSystemId(self):
        "Get the system identifier of the entity where the exception occurred."
        return self._systemId

    def __str__(self):
        "Create a string representation of the exception."
        sysid = self.getSystemId()
        if sysid is None:
            sysid = "<unknown>"
        linenum = self.getLineNumber()
        if linenum is None:
            linenum = "?"
        colnum = self.getColumnNumber()
        if colnum is None:
            colnum = "?"
        return "%s:%s:%s: %s" % (sysid, linenum, colnum, self._msg)


# ===== SAXNOTRECOGNIZEDEXCEPTION =====

class SAXNotRecognizedException(SAXException):
    """Exception class for an unrecognized identifier.

    An XMLReader will raise this exception when it is confronted with an
    unrecognized feature or property. SAX applications and extensions may
    use this class for similar purposes."""


# ===== SAXNOTSUPPORTEDEXCEPTION =====

class SAXNotSupportedException(SAXException):
    """Exception class for an unsupported operation.

    An XMLReader will raise this exception when a service it cannot
    perform is requested (specifically setting a state or value). SAX
    applications and extensions may use this class for similar
    purposes."""

# ===== SAXNOTSUPPORTEDEXCEPTION =====

class SAXReaderNotAvailable(SAXNotSupportedException):
    """Exception class for a missing driver.

    An XMLReader module (driver) should raise this exception when it
    is first imported, e.g. when a support module cannot be imported.
    It also may be raised during parsing, e.g. if executing an external
    program is not permitted."""
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               """
SAX driver for the pyexpat C module.  This driver works with
pyexpat.__version__ == '2.22'.
"""

version = "0.20"

from xml.sax._exceptions import *
from xml.sax.handler import feature_validation, feature_namespaces
from xml.sax.handler import feature_namespace_prefixes
from xml.sax.handler import feature_external_ges, feature_external_pes
from xml.sax.handler import feature_string_interning
from xml.sax.handler import property_xml_string, property_interning_dict

# xml.parsers.expat does not raise ImportError in Jython
import sys
if sys.platform[:4] == "java":
    raise SAXReaderNotAvailable("expat not available in Java", None)
del sys

try:
    from xml.parsers import expat
except ImportError:
    raise SAXReaderNotAvailable("expat not supported", None)
else:
    if not hasattr(expat, "ParserCreate"):
        raise SAXReaderNotAvailable("expat not supported", None)
from xml.sax import xmlreader, saxutils, handler

AttributesImpl = xmlreader.AttributesImpl
AttributesNSImpl = xmlreader.AttributesNSImpl

# If we're using a sufficiently recent version of Python, we can use
# weak references to avoid cycles between the parser and content
# handler, otherwise we'll just have to pretend.
try:
    import _weakref
except ImportError:
    def _mkproxy(o):
        return o
else:
    import weakref
    _mkproxy = weakref.proxy
    del weakref, _weakref

# --- ExpatLocator

class ExpatLocator(xmlreader.Locator):
    """Locator for use with the ExpatParser class.

    This uses a weak reference to the parser object to avoid creating
    a circular reference between the parser and the content handler.
    """
    def __init__(self, parser):
        self._ref = _mkproxy(parser)

    def getColumnNumber(self):
        parser = self._ref
        if parser._parser is None:
            return None
        return parser._parser.ErrorColumnNumber

    def getLineNumber(self):
        parser = self._ref
        if parser._parser is None:
            return 1
        return parser._parser.ErrorLineNumber

    def getPublicId(self):
        parser = self._ref
        if parser is None:
            return None
        return parser._source.getPublicId()

    def getSystemId(self):
        parser = self._ref
        if parser is None:
            return None
        return parser._source.getSystemId()


# --- ExpatParser

class ExpatParser(xmlreader.IncrementalParser, xmlreader.Locator):
    """SAX driver for the pyexpat C module."""

    def __init__(self, namespaceHandling=0, bufsize=2**16-20):
        xmlreader.IncrementalParser.__init__(self, bufsize)
        self._source = xmlreader.InputSource()
        self._parser = None
        self._namespaces = namespaceHandling
        self._lex_handler_prop = None
        self._parsing = 0
        self._entity_stack = []
        self._external_ges = 1
        self._interning = None

    # XMLReader methods

    def parse(self, source):
        "Parse an XML document from a URL or an InputSource."
        source = saxutils.prepare_input_source(source)

        self._source = source
        self.reset()
        self._cont_handler.setDocumentLocator(ExpatLocator(self))
        xmlreader.IncrementalParser.parse(self, source)

    def prepareParser(self, source):
        if source.getSystemId() is not None:
            base = source.getSystemId()
            if isinstance(base, unicode):
                base = base.encode('utf-8')
            self._parser.SetBase(base)

    # Redefined setContentHandler to allow changing handlers during parsing

    def setContentHandler(self, handler):
        xmlreader.IncrementalParser.setContentHandler(self, handler)
        if self._parsing:
            self._reset_cont_handler()

    def getFeature(self, name):
        if name == feature_namespaces:
            return self._namespaces
        elif name == feature_string_interning:
            return self._interning is not None
        elif name in (feature_validation, feature_external_pes,
                      feature_namespace_prefixes):
            return 0
        elif name == feature_external_ges:
            return self._external_ges
        raise SAXNotRecognizedException("Feature '%s' not recognized" % name)

    def setFeature(self, name, state):
        if self._parsing:
            raise SAXNotSupportedException("Cannot set features while parsing")

        if name == feature_namespaces:
            self._namespaces = state
        elif name == feature_external_ges:
            self._external_ges = state
        elif name == feature_string_interning:
            if state:
                if self._interning is None:
                    self._interning = {}
            else:
                self._interning = None
        elif name == feature_validation:
            if state:
                raise SAXNotSupportedException(
                    "expat does not support validation")
        elif name == feature_external_pes:
            if state:
                raise SAXNotSupportedException(
                    "expat does not read external parameter entities")
        elif name == feature_namespace_prefixes:
            if state:
                raise SAXNotSupportedException(
                    "expat does not report namespace prefixes")
        else:
            raise SAXNotRecognizedException(
                "Feature '%s' not recognized" % name)

    def getProperty(self, name):
        if name == handler.property_lexical_handler:
            return self._lex_handler_prop
        elif name == property_interning_dict:
            return self._interning
        elif name == property_xml_string:
            if self._parser:
                if hasattr(self._parser, "GetInputContext"):
                    return self._parser.GetInputContext()
                else:
                    raise SAXNotRecognizedException(
                        "This version of expat does not support getting"
                        " the XML string")
            else:
                raise SAXNotSupportedException(
                    "XML string cannot be returned when not parsing")
        raise SAXNotRecognizedException("Property '%s' not recognized" % name)

    def setProperty(self, name, value):
        if name == handler.property_lexical_handler:
            self._lex_handler_prop = value
            if self._parsing:
                self._reset_lex_handler_prop()
        elif name == property_interning_dict:
            self._interning = value
        elif name == property_xml_string:
            raise SAXNotSupportedException("Property '%s' cannot be set" %
                                           name)
        else:
            raise SAXNotRecognizedException("Property '%s' not recognized" %
                                            name)

    # IncrementalParser methods

    def feed(self, data, isFinal = 0):
        if not self._parsing:
            self.reset()
            self._parsing = 1
            self._cont_handler.startDocument()

        try:
            # The isFinal parameter is internal to the expat reader.
            # If it is set to true, expat will check validity of the entire
            # document. When feeding chunks, they are not normally final -
            # except when invoked from close.
            self._parser.Parse(data, isFinal)
        except expat.error, e:
            exc = SAXParseException(expat.ErrorString(e.code), e, self)
            # FIXME: when to invoke error()?
            self._err_handler.fatalError(exc)

    def close(self):
        if self._entity_stack:
            # If we are completing an external entity, do nothing here
            return
        self.feed("", isFinal = 1)
        self._cont_handler.endDocument()
        self._parsing = 0
        # break cycle created by expat handlers pointing to our methods
        self._parser = None

    def _reset_cont_handler(self):
        self._parser.ProcessingInstructionHandler = \
                                    self._cont_handler.processingInstruction
        self._parser.CharacterDataHandler = self._cont_handler.characters

    def _reset_lex_handler_prop(self):
        lex = self._lex_handler_prop
        parser = self._parser
        if lex is None:
            parser.CommentHandler = None
            parser.StartCdataSectionHandler = None
            parser.EndCdataSectionHandler = None
            parser.StartDoctypeDeclHandler = None
            parser.EndDoctypeDeclHandler = None
        else:
            parser.CommentHandler = lex.comment
            parser.StartCdataSectionHandler = lex.startCDATA
            parser.EndCdataSectionHandler = lex.endCDATA
            parser.StartDoctypeDeclHandler = self.start_doctype_decl
            parser.EndDoctypeDeclHandler = lex.endDTD

    def reset(self):
        if self._namespaces:
            self._parser = expat.ParserCreate(self._source.getEncoding(), " ",
                                              intern=self._interning)
            self._parser.namespace_prefixes = 1
            self._parser.StartElementHandler = self.start_element_ns
            self._parser.EndElementHandler = self.end_element_ns
        else:
            self._parser = expat.ParserCreate(self._source.getEncoding(),
                                              intern = self._interning)
            self._parser.StartElementHandler = self.start_element
            self._parser.EndElementHandler = self.end_element

        self._reset_cont_handler()
        self._parser.UnparsedEntityDeclHandler = self.unparsed_entity_decl
        self._parser.NotationDeclHandler = self.notation_decl
        self._parser.StartNamespaceDeclHandler = self.start_namespace_decl
        self._parser.EndNamespaceDeclHandler = self.end_namespace_decl

        self._decl_handler_prop = None
        if self._lex_handler_prop:
            self._reset_lex_handler_prop()
#         self._parser.DefaultHandler =
#         self._parser.DefaultHandlerExpand =
#         self._parser.NotStandaloneHandler =
        self._parser.ExternalEntityRefHandler = self.external_entity_ref
        try:
            self._parser.SkippedEntityHandler = self.skipped_entity_handler
        except AttributeError:
            # This pyexpat does not support SkippedEntity
            pass
        self._parser.SetParamEntityParsing(
            expat.XML_PARAM_ENTITY_PARSING_UNLESS_STANDALONE)

        self._parsing = 0
        self._entity_stack = []

    # Locator methods

    def getColumnNumber(self):
        if self._parser is None:
            return None
        return self._parser.ErrorColumnNumber

    def getLineNumber(self):
        if self._parser is None:
            return 1
        return self._parser.ErrorLineNumber

    def getPublicId(self):
        return self._source.getPublicId()

    def getSystemId(self):
        return self._source.getSystemId()

    # event handlers
    def start_element(self, name, attrs):
        self._cont_handler.startElement(name, AttributesImpl(attrs))

    def end_element(self, name):
        self._cont_handler.endElement(name)

    def start_element_ns(self, name, attrs):
        pair = name.split()
        if len(pair) == 1:
            # no namespace
            pair = (None, name)
        elif len(pair) == 3:
            pair = pair[0], pair[1]
        else:
            # default namespace
            pair = tuple(pair)

        newattrs = {}
        qnames = {}
        for (aname, value) in attrs.items():
            parts = aname.split()
            length = len(parts)
            if length == 1:
                # no namespace
                qname = aname
                apair = (None, aname)
            elif length == 3:
                qname = "%s:%s" % (parts[2], parts[1])
                apair = parts[0], parts[1]
            else:
                # default namespace
                qname = parts[1]
                apair = tuple(parts)

            newattrs[apair] = value
            qnames[apair] = qname

        self._cont_handler.startElementNS(pair, None,
                                          AttributesNSImpl(newattrs, qnames))

    def end_element_ns(self, name):
        pair = name.split()
        if len(pair) == 1:
            pair = (None, name)
        elif len(pair) == 3:
            pair = pair[0], pair[1]
        else:
            pair = tuple(pair)

        self._cont_handler.endElementNS(pair, None)

    # this is not used (call directly to ContentHandler)
    def processing_instruction(self, target, data):
        self._cont_handler.processingInstruction(target, data)

    # this is not used (call directly to ContentHandler)
    def character_data(self, data):
        self._cont_handler.characters(data)

    def start_namespace_decl(self, prefix, uri):
        self._cont_handler.startPrefixMapping(prefix, uri)

    def end_namespace_decl(self, prefix):
        self._cont_handler.endPrefixMapping(prefix)

    def start_doctype_decl(self, name, sysid, pubid, has_internal_subset):
        self._lex_handler_prop.startDTD(name, pubid, sysid)

    def unparsed_entity_decl(self, name, base, sysid, pubid, notation_name):
        self._dtd_handler.unparsedEntityDecl(name, pubid, sysid, notation_name)

    def notation_decl(self, name, base, sysid, pubid):
        self._dtd_handler.notationDecl(name, pubid, sysid)

    def external_entity_ref(self, context, base, sysid, pubid):
        if not self._external_ges:
            return 1

        source = self._ent_handler.resolveEntity(pubid, sysid)
        source = saxutils.prepare_input_source(source,
                                               self._source.getSystemId() or
                                               "")

        self._entity_stack.append((self._parser, self._source))
        self._parser = self._parser.ExternalEntityParserCreate(context)
        self._source = source

        try:
            xmlreader.IncrementalParser.parse(self, source)
        except:
            return 0  # FIXME: save error info here?

        (self._parser, self._source) = self._entity_stack[-1]
        del self._entity_stack[-1]
        return 1

    def skipped_entity_handler(self, name, is_pe):
        if is_pe:
            # The SAX spec requires to report skipped PEs with a '%'
            name = '%'+name
        self._cont_handler.skippedEntity(name)

# ---

def create_parser(*args, **kwargs):
    return ExpatParser(*args, **kwargs)

# ---

if __name__ == "__main__":
    import xml.sax.saxutils
    p = create_parser()
    p.setContentHandler(xml.sax.saxutils.XMLGenerator())
    p.setErrorHandler(xml.sax.ErrorHandler())
    p.parse("http://www.ibiblio.org/xml/examples/shakespeare/hamlet.xml")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             """
This module contains the core classes of version 2.0 of SAX for Python.
This file provides only default classes with absolutely minimum
functionality, from which drivers and applications can be subclassed.

Many of these classes are empty and are included only as documentation
of the interfaces.

$Id$
"""

version = '2.0beta'

#============================================================================
#
# HANDLER INTERFACES
#
#============================================================================

# ===== ERRORHANDLER =====

class ErrorHandler:
    """Basic interface for SAX error handlers.

    If you create an object that implements this interface, then
    register the object with your XMLReader, the parser will call the
    methods in your object to report all warnings and errors. There
    are three levels of errors available: warnings, (possibly)
    recoverable errors, and unrecoverable errors. All methods take a
    SAXParseException as the only parameter."""

    def error(self, exception):
        "Handle a recoverable error."
        raise exception

    def fatalError(self, exception):
        "Handle a non-recoverable error."
        raise exception

    def warning(self, exception):
        "Handle a warning."
        print exception


# ===== CONTENTHANDLER =====

class ContentHandler:
    """Interface for receiving logical document content events.

    This is the main callback interface in SAX, and the one most
    important to applications. The order of events in this interface
    mirrors the order of the information in the document."""

    def __init__(self):
        self._locator = None

    def setDocumentLocator(self, locator):
        """Called by the parser to give the application a locator for
        locating the origin of document events.

        SAX parsers are strongly encouraged (though not absolutely
        required) to supply a locator: if it does so, it must supply
        the locator to the application by invoking this method before
        invoking any of the other methods in the DocumentHandler
        interface.

        The locator allows the application to determine the end
        position of any document-related event, even if the parser is
        not reporting an error. Typically, the application will use
        this information for reporting its own errors (such as
        character content that does not match an application's
        business rules). The information returned by the locator is
        probably not sufficient for use with a search engine.

        Note that the locator will return correct information only
        during the invocation of the events in this interface. The
        application should not attempt to use it at any other time."""
        self._locator = locator

    def startDocument(self):
        """Receive notification of the beginning of a document.

        The SAX parser will invoke this method only once, before any
        other methods in this interface or in DTDHandler (except for
        setDocumentLocator)."""

    def endDocument(self):
        """Receive notification of the end of a document.

        The SAX parser will invoke this method only once, and it will
        be the last method invoked during the parse. The parser shall
        not invoke this method until it has either abandoned parsing
        (because of an unrecoverable error) or reached the end of
        input."""

    def startPrefixMapping(self, prefix, uri):
        """Begin the scope of a prefix-URI Namespace mapping.

        The information from this event is not necessary for normal
        Namespace processing: the SAX XML reader will automatically
        replace prefixes for element and attribute names when the
        http://xml.org/sax/features/namespaces feature is true (the
        default).

        There are cases, however, when applications need to use
        prefixes in character data or in attribute values, where they
        cannot safely be expanded automatically; the
        start/endPrefixMapping event supplies the information to the
        application to expand prefixes in those contexts itself, if
        necessary.

        Note that start/endPrefixMapping events are not guaranteed to
        be properly nested relative to each-other: all
        startPrefixMapping events will occur before the corresponding
        startElement event, and all endPrefixMapping events will occur
        after the corresponding endElement event, but their order is
        not guaranteed."""

    def endPrefixMapping(self, prefix):
        """End the scope of a prefix-URI mapping.

        See startPrefixMapping for details. This event will always
        occur after the corresponding endElement event, but the order
        of endPrefixMapping events is not otherwise guaranteed."""

    def startElement(self, name, attrs):
        """Signals the start of an element in non-namespace mode.

        The name parameter contains the raw XML 1.0 name of the
        element type as a string and the attrs parameter holds an
        instance of the Attributes class containing the attributes of
        the element."""

    def endElement(self, name):
        """Signals the end of an element in non-namespace mode.

        The name parameter contains the name of the element type, just
        as with the startElement event."""

    def startElementNS(self, name, qname, attrs):
        """Signals the start of an element in namespace mode.

        The name parameter contains the name of the element type as a
        (uri, localname) tuple, the qname parameter the raw XML 1.0
        name used in the source document, and the attrs parameter
        holds an instance of the Attributes class containing the
        attributes of the element.

        The uri part of the name tuple is None for elements which have
        no namespace."""

    def endElementNS(self, name, qname):
        """Signals the end of an element in namespace mode.

        The name parameter contains the name of the element type, just
        as with the startElementNS event."""

    def characters(self, content):
        """Receive notification of character data.

        The Parser will call this method to report each chunk of
        character data. SAX parsers may return all contiguous
        character data in a single chunk, or they may split it into
        several chunks; however, all of the characters in any single
        event must come from the same external entity so that the
        Locator provides useful information."""

    def ignorableWhitespace(self, whitespace):
        """Receive notification of ignorable whitespace in element content.

        Validating Parsers must use this method to report each chunk
        of ignorable whitespace (see the W3C XML 1.0 recommendation,
        section 2.10): non-validating parsers may also use this method
        if they are capable of parsing and using content models.

        SAX parsers may return all contiguous whitespace in a single
        chunk, or they may split it into several chunks; however, all
        of the characters in any single event must come from the same
        external entity, so that the Locator provides useful
        information."""

    def processingInstruction(self, target, data):
        """Receive notification of a processing instruction.

        The Parser will invoke this method once for each processing
        instruction found: note that processing instructions may occur
        before or after the main document element.

        A SAX parser should never report an XML declaration (XML 1.0,
        section 2.8) or a text declaration (XML 1.0, section 4.3.1)
        using this method."""

    def skippedEntity(self, name):
        """Receive notification of a skipped entity.

        The Parser will invoke this method once for each entity
        skipped. Non-validating processors may skip entities if they
        have not seen the declarations (because, for example, the
        entity was declared in an external DTD subset). All processors
        may skip external entities, depending on the values of the
        http://xml.org/sax/features/external-general-entities and the
        http://xml.org/sax/features/external-parameter-entities
        properties."""


# ===== DTDHandler =====

class DTDHandler:
    """Handle DTD events.

    This interface specifies only those DTD events required for basic
    parsing (unparsed entities and attributes)."""

    def notationDecl(self, name, publicId, systemId):
        "Handle a notation declaration event."

    def unparsedEntityDecl(self, name, publicId, systemId, ndata):
        "Handle an unparsed entity declaration event."


# ===== ENTITYRESOLVER =====

class EntityResolver:
    """Basic interface for resolving entities. If you create an object
    implementing this interface, then register the object with your
    Parser, the parser will call the method in your object to
    resolve all external entities. Note that DefaultHandler implements
    this interface with the default behaviour."""

    def resolveEntity(self, publicId, systemId):
        """Resolve the system identifier of an entity and return either
        the system identifier to read from as a string, or an InputSource
        to read from."""
        return systemId


#============================================================================
#
# CORE FEATURES
#
#============================================================================

feature_namespaces = "http://xml.org/sax/features/namespaces"
# true: Perform Namespace processing (default).
# false: Optionally do not perform Namespace processing
#        (implies namespace-prefixes).
# access: (parsing) read-only; (not parsing) read/write

feature_namespace_prefixes = "http://xml.org/sax/features/namespace-prefixes"
# true: Report the original prefixed names and attributes used for Namespace
#       declarations.
# false: Do not report attributes used for Namespace declarations, and
#        optionally do not report original prefixed names (default).
# access: (parsing) read-only; (not parsing) read/write

feature_string_interning = "http://xml.org/sax/features/string-interning"
# true: All element names, prefixes, attribute names, Namespace URIs, and
#       local names are interned using the built-in intern function.
# false: Names are not necessarily interned, although they may be (default).
# access: (parsing) read-only; (not parsing) read/write

feature_validation = "http://xml.org/sax/features/validation"
# true: Report all validation errors (implies external-general-entities and
#       external-parameter-entities).
# false: Do not report validation errors.
# access: (parsing) read-only; (not parsing) read/write

feature_external_ges = "http://xml.org/sax/features/external-general-entities"
# true: Include all external general (text) entities.
# false: Do not include external general entities.
# access: (parsing) read-only; (not parsing) read/write

feature_external_pes = "http://xml.org/sax/features/external-parameter-entities"
# true: Include all external parameter entities, including the external
#       DTD subset.
# false: Do not include any external parameter entities, even the external
#        DTD subset.
# access: (parsing) read-only; (not parsing) read/write

all_features = [feature_namespaces,
                feature_namespace_prefixes,
                feature_string_interning,
                feature_validation,
                feature_external_ges,
                feature_external_pes]


#============================================================================
#
# CORE PROPERTIES
#
#============================================================================

property_lexical_handler = "http://xml.org/sax/properties/lexical-handler"
# data type: xml.sax.sax2lib.LexicalHandler
# description: An optional extension handler for lexical events like comments.
# access: read/write

property_declaration_handler = "http://xml.org/sax/properties/declaration-handler"
# data type: xml.sax.sax2lib.DeclHandler
# description: An optional extension handler for DTD-related events other
#              than notations and unparsed entities.
# access: read/write

property_dom_node = "http://xml.org/sax/properties/dom-node"
# data type: org.w3c.dom.Node
# description: When parsing, the current DOM node being visited if this is
#              a DOM iterator; when not parsing, the root DOM node for
#              iteration.
# access: (parsing) read-only; (not parsing) read/write

property_xml_string = "http://xml.org/sax/properties/xml-string"
# data type: String
# description: The literal string of characters that was the source for
#              the current event.
# access: read-only

property_encoding = "http://www.python.org/sax/properties/encoding"
# data type: String
# description: The name of the encoding to assume for input data.
# access: write: set the encoding, e.g. established by a higher-level
#                protocol. May change during parsing (e.g. after
#                processing a META tag)
#         read:  return the current encoding (possibly established through
#                auto-detection.
# initial value: UTF-8
#

property_interning_dict = "http://www.python.org/sax/properties/interning-dict"
# data type: Dictionary
# description: The dictionary used to intern common strings in the document
# access: write: Request that the parser uses a specific dictionary, to
#                allow interning across different documents
#         read:  return the current interning dictionary, or None
#

all_properties = [property_lexical_handler,
                  property_dom_node,
                  property_declaration_handler,
                  property_xml_string,
                  property_encoding,
                  property_interning_dict]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               """\
A library of useful helper classes to the SAX classes, for the
convenience of application and driver writers.
"""

import os, urlparse, urllib, types
import io
import sys
import handler
import xmlreader

try:
    _StringTypes = [types.StringType, types.UnicodeType]
except AttributeError:
    _StringTypes = [types.StringType]

def __dict_replace(s, d):
    """Replace substrings of a string using a dictionary."""
    for key, value in d.items():
        s = s.replace(key, value)
    return s

def escape(data, entities={}):
    """Escape &, <, and > in a string of data.

    You can escape other strings of data by passing a dictionary as
    the optional entities parameter.  The keys and values must all be
    strings; each key will be replaced with its corresponding value.
    """

    # must do ampersand first
    data = data.replace("&", "&amp;")
    data = data.replace(">", "&gt;")
    data = data.replace("<", "&lt;")
    if entities:
        data = __dict_replace(data, entities)
    return data

def unescape(data, entities={}):
    """Unescape &amp;, &lt;, and &gt; in a string of data.

    You can unescape other strings of data by passing a dictionary as
    the optional entities parameter.  The keys and values must all be
    strings; each key will be replaced with its corresponding value.
    """
    data = data.replace("&lt;", "<")
    data = data.replace("&gt;", ">")
    if entities:
        data = __dict_replace(data, entities)
    # must do ampersand last
    return data.replace("&amp;", "&")

def quoteattr(data, entities={}):
    """Escape and quote an attribute value.

    Escape &, <, and > in a string of data, then quote it for use as
    an attribute value.  The \" character will be escaped as well, if
    necessary.

    You can escape other strings of data by passing a dictionary as
    the optional entities parameter.  The keys and values must all be
    strings; each key will be replaced with its corresponding value.
    """
    entities = entities.copy()
    entities.update({'\n': '&#10;', '\r': '&#13;', '\t':'&#9;'})
    data = escape(data, entities)
    if '"' in data:
        if "'" in data:
            data = '"%s"' % data.replace('"', "&quot;")
        else:
            data = "'%s'" % data
    else:
        data = '"%s"' % data
    return data


def _gettextwriter(out, encoding):
    if out is None:
        import sys
        out = sys.stdout

    if isinstance(out, io.RawIOBase):
        buffer = io.BufferedIOBase(out)
        # Keep the original file open when the TextIOWrapper is
        # destroyed
        buffer.close = lambda: None
    else:
        # This is to handle passed objects that aren't in the
        # IOBase hierarchy, but just have a write method
        buffer = io.BufferedIOBase()
        buffer.writable = lambda: True
        buffer.write = out.write
        try:
            # TextIOWrapper uses this methods to determine
            # if BOM (for UTF-16, etc) should be added
            buffer.seekable = out.seekable
            buffer.tell = out.tell
        except AttributeError:
            pass
    # wrap a binary writer with TextIOWrapper
    return _UnbufferedTextIOWrapper(buffer, encoding=encoding,
                                   errors='xmlcharrefreplace',
                                   newline='\n')


class _UnbufferedTextIOWrapper(io.TextIOWrapper):
    def write(self, s):
        super(_UnbufferedTextIOWrapper, self).write(s)
        self.flush()


class XMLGenerator(handler.ContentHandler):

    def __init__(self, out=None, encoding="iso-8859-1"):
        handler.ContentHandler.__init__(self)
        out = _gettextwriter(out, encoding)
        self._write = out.write
        self._flush = out.flush
        self._ns_contexts = [{}] # contains uri -> prefix dicts
        self._current_context = self._ns_contexts[-1]
        self._undeclared_ns_maps = []
        self._encoding = encoding

    def _qname(self, name):
        """Builds a qualified name from a (ns_url, localname) pair"""
        if name[0]:
            # Per http://www.w3.org/XML/1998/namespace, The 'xml' prefix is
            # bound by definition to http://www.w3.org/XML/1998/namespace.  It
            # does not need to be declared and will not usually be found in
            # self._current_context.
            if 'http://www.w3.org/XML/1998/namespace' == name[0]:
                return 'xml:' + name[1]
            # The name is in a non-empty namespace
            prefix = self._current_context[name[0]]
            if prefix:
                # If it is not the default namespace, prepend the prefix
                return prefix + ":" + name[1]
        # Return the unqualified name
        return name[1]

    # ContentHandler methods

    def startDocument(self):
        self._write(u'<?xml version="1.0" encoding="%s"?>\n' %
                        self._encoding)

    def endDocument(self):
        self._flush()

    def startPrefixMapping(self, prefix, uri):
        self._ns_contexts.append(self._current_context.copy())
        self._current_context[uri] = prefix
        self._undeclared_ns_maps.append((prefix, uri))

    def endPrefixMapping(self, prefix):
        self._current_context = self._ns_contexts[-1]
        del self._ns_contexts[-1]

    def startElement(self, name, attrs):
        self._write(u'<' + name)
        for (name, value) in attrs.items():
            self._write(u' %s=%s' % (name, quoteattr(value)))
        self._write(u'>')

    def endElement(self, name):
        self._write(u'</%s>' % name)

    def startElementNS(self, name, qname, attrs):
        self._write(u'<' + self._qname(name))

        for prefix, uri in self._undeclared_ns_maps:
            if prefix:
                self._write(u' xmlns:%s="%s"' % (prefix, uri))
            else:
                self._write(u' xmlns="%s"' % uri)
        self._undeclared_ns_maps = []

        for (name, value) in attrs.items():
            self._write(u' %s=%s' % (self._qname(name), quoteattr(value)))
        self._write(u'>')

    def endElementNS(self, name, qname):
        self._write(u'</%s>' % self._qname(name))

    def characters(self, content):
        if not isinstance(content, unicode):
            content = unicode(content, self._encoding)
        self._write(escape(content))

    def ignorableWhitespace(self, content):
        if not isinstance(content, unicode):
            content = unicode(content, self._encoding)
        self._write(content)

    def processingInstruction(self, target, data):
        self._write(u'<?%s %s?>' % (target, data))


class XMLFilterBase(xmlreader.XMLReader):
    """This class is designed to sit between an XMLReader and the
    client application's event handlers.  By default, it does nothing
    but pass requests up to the reader and events on to the handlers
    unmodified, but subclasses can override specific methods to modify
    the event stream or the configuration requests as they pass
    through."""

    def __init__(self, parent = None):
        xmlreader.XMLReader.__init__(self)
        self._parent = parent

    # ErrorHandler methods

    def error(self, exception):
        self._err_handler.error(exception)

    def fatalError(self, exception):
        self._err_handler.fatalError(exception)

    def warning(self, exception):
        self._err_handler.warning(exception)

    # ContentHandler methods

    def setDocumentLocator(self, locator):
        self._cont_handler.setDocumentLocator(locator)

    def startDocument(self):
        self._cont_handler.startDocument()

    def endDocument(self):
        self._cont_handler.endDocument()

    def startPrefixMapping(self, prefix, uri):
        self._cont_handler.startPrefixMapping(prefix, uri)

    def endPrefixMapping(self, prefix):
        self._cont_handler.endPrefixMapping(prefix)

    def startElement(self, name, attrs):
        self._cont_handler.startElement(name, attrs)

    def endElement(self, name):
        self._cont_handler.endElement(name)

    def startElementNS(self, name, qname, attrs):
        self._cont_handler.startElementNS(name, qname, attrs)

    def endElementNS(self, name, qname):
        self._cont_handler.endElementNS(name, qname)

    def characters(self, content):
        self._cont_handler.characters(content)

    def ignorableWhitespace(self, chars):
        self._cont_handler.ignorableWhitespace(chars)

    def processingInstruction(self, target, data):
        self._cont_handler.processingInstruction(target, data)

    def skippedEntity(self, name):
        self._cont_handler.skippedEntity(name)

    # DTDHandler methods

    def notationDecl(self, name, publicId, systemId):
        self._dtd_handler.notationDecl(name, publicId, systemId)

    def unparsedEntityDecl(self, name, publicId, systemId, ndata):
        self._dtd_handler.unparsedEntityDecl(name, publicId, systemId, ndata)

    # EntityResolver methods

    def resolveEntity(self, publicId, systemId):
        return self._ent_handler.resolveEntity(publicId, systemId)

    # XMLReader methods

    def parse(self, source):
        self._parent.setContentHandler(self)
        self._parent.setErrorHandler(self)
        self._parent.setEntityResolver(self)
        self._parent.setDTDHandler(self)
        self._parent.parse(source)

    def setLocale(self, locale):
        self._parent.setLocale(locale)

    def getFeature(self, name):
        return self._parent.getFeature(name)

    def setFeature(self, name, state):
        self._parent.setFeature(name, state)

    def getProperty(self, name):
        return self._parent.getProperty(name)

    def setProperty(self, name, value):
        self._parent.setProperty(name, value)

    # XMLFilter methods

    def getParent(self):
        return self._parent

    def setParent(self, parent):
        self._parent = parent

# --- Utility functions

def prepare_input_source(source, base = ""):
    """This function takes an InputSource and an optional base URL and
    returns a fully resolved InputSource object ready for reading."""

    if type(source) in _StringTypes:
        source = xmlreader.InputSource(source)
    elif hasattr(source, "read"):
        f = source
        source = xmlreader.InputSource()
        source.setByteStream(f)
        if hasattr(f, "name"):
            source.setSystemId(f.name)

    if source.getByteStream() is None:
        try:
            sysid = source.getSystemId()
            basehead = os.path.dirname(os.path.normpath(base))
            encoding = sys.getfilesystemencoding()
            if isinstance(sysid, unicode):
                if not isinstance(basehead, unicode):
                    try:
                        basehead = basehead.decode(encoding)
                    except UnicodeDecodeError:
                        sysid = sysid.encode(encoding)
            else:
                if isinstance(basehead, unicode):
                    try:
                        sysid = sysid.decode(encoding)
                    except UnicodeDecodeError:
                        basehead = basehead.encode(encoding)
            sysidfilename = os.path.join(basehead, sysid)
            isfile = os.path.isfile(sysidfilename)
        except UnicodeError:
            isfile = False
        if isfile:
            source.setSystemId(sysidfilename)
            f = open(sysidfilename, "rb")
        else:
            source.setSystemId(urlparse.urljoin(base, source.getSystemId()))
            f = urllib.urlopen(source.getSystemId())

        source.setByteStream(f)

    return source
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            """An XML Reader is the SAX 2 name for an XML parser. XML Parsers
should be based on this code. """

import handler

from _exceptions import SAXNotSupportedException, SAXNotRecognizedException


# ===== XMLREADER =====

class XMLReader:
    """Interface for reading an XML document using callbacks.

    XMLReader is the interface that an XML parser's SAX2 driver must
    implement. This interface allows an application to set and query
    features and properties in the parser, to register event handlers
    for document processing, and to initiate a document parse.

    All SAX interfaces are assumed to be synchronous: the parse
    methods must not return until parsing is complete, and readers
    must wait for an event-handler callback to return before reporting
    the next event."""

    def __init__(self):
        self._cont_handler = handler.ContentHandler()
        self._dtd_handler = handler.DTDHandler()
        self._ent_handler = handler.EntityResolver()
        self._err_handler = handler.ErrorHandler()

    def parse(self, source):
        "Parse an XML document from a system identifier or an InputSource."
        raise NotImplementedError("This method must be implemented!")

    def getContentHandler(self):
        "Returns the current ContentHandler."
        return self._cont_handler

    def setContentHandler(self, handler):
        "Registers a new object to receive document content events."
        self._cont_handler = handler

    def getDTDHandler(self):
        "Returns the current DTD handler."
        return self._dtd_handler

    def setDTDHandler(self, handler):
        "Register an object to receive basic DTD-related events."
        self._dtd_handler = handler

    def getEntityResolver(self):
        "Returns the current EntityResolver."
        return self._ent_handler

    def setEntityResolver(self, resolver):
        "Register an object to resolve external entities."
        self._ent_handler = resolver

    def getErrorHandler(self):
        "Returns the current ErrorHandler."
        return self._err_handler

    def setErrorHandler(self, handler):
        "Register an object to receive error-message events."
        self._err_handler = handler

    def setLocale(self, locale):
        """Allow an application to set the locale for errors and warnings.

        SAX parsers are not required to provide localization for errors
        and warnings; if they cannot support the requested locale,
        however, they must raise a SAX exception. Applications may
        request a locale change in the middle of a parse."""
        raise SAXNotSupportedException("Locale support not implemented")

    def getFeature(self, name):
        "Looks up and returns the state of a SAX2 feature."
        raise SAXNotRecognizedException("Feature '%s' not recognized" % name)

    def setFeature(self, name, state):
        "Sets the state of a SAX2 feature."
        raise SAXNotRecognizedException("Feature '%s' not recognized" % name)

    def getProperty(self, name):
        "Looks up and returns the value of a SAX2 property."
        raise SAXNotRecognizedException("Property '%s' not recognized" % name)

    def setProperty(self, name, value):
        "Sets the value of a SAX2 property."
        raise SAXNotRecognizedException("Property '%s' not recognized" % name)

class IncrementalParser(XMLReader):
    """This interface adds three extra methods to the XMLReader
    interface that allow XML parsers to support incremental
    parsing. Support for this interface is optional, since not all
    underlying XML parsers support this functionality.

    When the parser is instantiated it is ready to begin accepting
    data from the feed method immediately. After parsing has been
    finished with a call to close the reset method must be called to
    make the parser ready to accept new data, either from feed or
    using the parse method.

    Note that these methods must _not_ be called during parsing, that
    is, after parse has been called and before it returns.

    By default, the class also implements the parse method of the XMLReader
    interface using the feed, close and reset methods of the
    IncrementalParser interface as a convenience to SAX 2.0 driver
    writers."""

    def __init__(self, bufsize=2**16):
        self._bufsize = bufsize
        XMLReader.__init__(self)

    def parse(self, source):
        import saxutils
        source = saxutils.prepare_input_source(source)

        self.prepareParser(source)
        file = source.getByteStream()
        buffer = file.read(self._bufsize)
        while buffer != "":
            self.feed(buffer)
            buffer = file.read(self._bufsize)
        self.close()

    def feed(self, data):
        """This method gives the raw XML data in the data parameter to
        the parser and makes it parse the data, emitting the
        corresponding events. It is allowed for XML constructs to be
        split across several calls to feed.

        feed may raise SAXException."""
        raise NotImplementedError("This method must be implemented!")

    def prepareParser(self, source):
        """This method is called by the parse implementation to allow
        the SAX 2.0 driver to prepare itself for parsing."""
        raise NotImplementedError("prepareParser must be overridden!")

    def close(self):
        """This method is called when the entire XML document has been
        passed to the parser through the feed method, to notify the
        parser that there are no more data. This allows the parser to
        do the final checks on the document and empty the internal
        data buffer.

        The parser will not be ready to parse another document until
        the reset method has been called.

        close may raise SAXException."""
        raise NotImplementedError("This method must be implemented!")

    def reset(self):
        """This method is called after close has been called to reset
        the parser so that it is ready to parse new documents. The
        results of calling parse or feed after close without calling
        reset are undefined."""
        raise NotImplementedError("This method must be implemented!")

# ===== LOCATOR =====

class Locator:
    """Interface for associating a SAX event with a document
    location. A locator object will return valid results only during
    calls to DocumentHandler methods; at any other time, the
    results are unpredictable."""

    def getColumnNumber(self):
        "Return the column number where the current event ends."
        return -1

    def getLineNumber(self):
        "Return the line number where the current event ends."
        return -1

    def getPublicId(self):
        "Return the public identifier for the current event."
        return None

    def getSystemId(self):
        "Return the system identifier for the current event."
        return None

# ===== INPUTSOURCE =====

class InputSource:
    """Encapsulation of the information needed by the XMLReader to
    read entities.

    This class may include information about the public identifier,
    system identifier, byte stream (possibly with character encoding
    information) and/or the character stream of an entity.

    Applications will create objects of this class for use in the
    XMLReader.parse method and for returning from
    EntityResolver.resolveEntity.

    An InputSource belongs to the application, the XMLReader is not
    allowed to modify InputSource objects passed to it from the
    application, although it may make copies and modify those."""

    def __init__(self, system_id = None):
        self.__system_id = system_id
        self.__public_id = None
        self.__encoding  = None
        self.__bytefile  = None
        self.__charfile  = None

    def setPublicId(self, public_id):
        "Sets the public identifier of this InputSource."
        self.__public_id = public_id

    def getPublicId(self):
        "Returns the public identifier of this InputSource."
        return self.__public_id

    def setSystemId(self, system_id):
        "Sets the system identifier of this InputSource."
        self.__system_id = system_id

    def getSystemId(self):
        "Returns the system identifier of this InputSource."
        return self.__system_id

    def setEncoding(self, encoding):
        """Sets the character encoding of this InputSource.

        The encoding must be a string acceptable for an XML encoding
        declaration (see section 4.3.3 of the XML recommendation).

        The encoding attribute of the InputSource is ignored if the
        InputSource also contains a character stream."""
        self.__encoding = encoding

    def getEncoding(self):
        "Get the character encoding of this InputSource."
        return self.__encoding

    def setByteStream(self, bytefile):
        """Set the byte stream (a Python file-like object which does
        not perform byte-to-character conversion) for this input
        source.

        The SAX parser will ignore this if there is also a character
        stream specified, but it will use a byte stream in preference
        to opening a URI connection itself.

        If the application knows the character encoding of the byte
        stream, it should set it with the setEncoding method."""
        self.__bytefile = bytefile

    def getByteStream(self):
        """Get the byte stream for this input source.

        The getEncoding method will return the character encoding for
        this byte stream, or None if unknown."""
        return self.__bytefile

    def setCharacterStream(self, charfile):
        """Set the character stream for this input source. (The stream
        must be a Python 2.0 Unicode-wrapped file-like that performs
        conversion to Unicode strings.)

        If there is a character stream specified, the SAX parser will
        ignore any byte stream and will not attempt to open a URI
        connection to the system identifier."""
        self.__charfile = charfile

    def getCharacterStream(self):
        "Get the character stream for this input source."
        return self.__charfile

# ===== ATTRIBUTESIMPL =====

class AttributesImpl:

    def __init__(self, attrs):
        """Non-NS-aware implementation.

        attrs should be of the form {name : value}."""
        self._attrs = attrs

    def getLength(self):
        return len(self._attrs)

    def getType(self, name):
        return "CDATA"

    def getValue(self, name):
        return self._attrs[name]

    def getValueByQName(self, name):
        return self._attrs[name]

    def getNameByQName(self, name):
        if not name in self._attrs:
            raise KeyError, name
        return name

    def getQNameByName(self, name):
        if not name in self._attrs:
            raise KeyError, name
        return name

    def getNames(self):
        return self._attrs.keys()

    def getQNames(self):
        return self._attrs.keys()

    def __len__(self):
        return len(self._attrs)

    def __getitem__(self, name):
        return self._attrs[name]

    def keys(self):
        return self._attrs.keys()

    def has_key(self, name):
        return name in self._attrs

    def __contains__(self, name):
        return name in self._attrs

    def get(self, name, alternative=None):
        return self._attrs.get(name, alternative)

    def copy(self):
        return self.__class__(self._attrs)

    def items(self):
        return self._attrs.items()

    def values(self):
        return self._attrs.values()

# ===== ATTRIBUTESNSIMPL =====

class AttributesNSImpl(AttributesImpl):

    def __init__(self, attrs, qnames):
        """NS-aware implementation.

        attrs should be of the form {(ns_uri, lname): value, ...}.
        qnames of the form {(ns_uri, lname): qname, ...}."""
        self._attrs = attrs
        self._qnames = qnames

    def getValueByQName(self, name):
        for (nsname, qname) in self._qnames.items():
            if qname == name:
                return self._attrs[nsname]

        raise KeyError, name

    def getNameByQName(self, name):
        for (nsname, qname) in self._qnames.items():
            if qname == name:
                return nsname

        raise KeyError, name

    def getQNameByName(self, name):
        return self._qnames[name]

    def getQNames(self):
        return self._qnames.values()

    def copy(self):
        return self.__class__(self._attrs, self._qnames)


def _test():
    XMLReader()
    IncrementalParser()
    Locator()

if __name__ == "__main__":
    _test()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        """Core XML support for Python.

This package contains four sub-packages:

dom -- The W3C Document Object Model.  This supports DOM Level 1 +
       Namespaces.

parsers -- Python wrappers for XML parsers (currently only supports Expat).

sax -- The Simple API for XML, developed by XML-Dev, led by David
       Megginson and ported to Python by Lars Marius Garshol.  This
       supports the SAX 2 API.

etree -- The ElementTree XML library.  This is a subset of the full
       ElementTree XML release.

"""


__all__ = ["dom", "parsers", "sax", "etree"]

_MINIMUM_XMLPLUS_VERSION = (0, 8, 4)


try:
    import _xmlplus
except ImportError:
    pass
else:
    try:
        v = _xmlplus.version_info
    except AttributeError:
        # _xmlplus is too old; ignore it
        pass
    else:
        if v >= _MINIMUM_XMLPLUS_VERSION:
            import sys
            _xmlplus.__path__.extend(__path__)
            sys.modules[__name__] = _xmlplus
        else:
            del v
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #
# Support for the API of the multiprocessing package using threads
#
# multiprocessing/dummy/__init__.py
#
# Copyright (c) 2006-2008, R Oudkerk
# All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
# 3. Neither the name of author nor the names of any contributors may be
#    used to endorse or promote products derived from this software
#    without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS "AS IS" AND
# ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
# ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
# FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
# OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
# HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
# LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
# OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
# SUCH DAMAGE.
#

__all__ = [
    'Process', 'current_process', 'active_children', 'freeze_support',
    'Lock', 'RLock', 'Semaphore', 'BoundedSemaphore', 'Condition',
    'Event', 'Queue', 'Manager', 'Pipe', 'Pool', 'JoinableQueue'
    ]

#
# Imports
#

import threading
import sys
import weakref
import array
import itertools

from multiprocessing import TimeoutError, cpu_count
from multiprocessing.dummy.connection import Pipe
from threading import Lock, RLock, Semaphore, BoundedSemaphore
from threading import Event
from Queue import Queue

#
#
#

class DummyProcess(threading.Thread):

    def __init__(self, group=None, target=None, name=None, args=(), kwargs={}):
        threading.Thread.__init__(self, group, target, name, args, kwargs)
        self._pid = None
        self._children = weakref.WeakKeyDictionary()
        self._start_called = False
        self._parent = current_process()

    def start(self):
        assert self._parent is current_process()
        self._start_called = True
        if hasattr(self._parent, '_children'):
            self._parent._children[self] = None
        threading.Thread.start(self)

    @property
    def exitcode(self):
        if self._start_called and not self.is_alive():
            return 0
        else:
            return None

#
#
#

class Condition(threading._Condition):
    notify_all = threading._Condition.notify_all.im_func

#
#
#

Process = DummyProcess
current_process = threading.current_thread
current_process()._children = weakref.WeakKeyDictionary()

def active_children():
    children = current_process()._children
    for p in list(children):
        if not p.is_alive():
            children.pop(p, None)
    return list(children)

def freeze_support():
    pass

#
#
#

class Namespace(object):
    def __init__(self, **kwds):
        self.__dict__.update(kwds)
    def __repr__(self):
        items = self.__dict__.items()
        temp = []
        for name, value in items:
            if not name.startswith('_'):
                temp.append('%s=%r' % (name, value))
        temp.sort()
        return 'Namespace(%s)' % str.join(', ', temp)

dict = dict
list = list

def Array(typecode, sequence, lock=True):
    return array.array(typecode, sequence)

class Value(object):
    def __init__(self, typecode, value, lock=True):
        self._typecode = typecode
        self._value = value
    def _get(self):
        return self._value
    def _set(self, value):
        self._value = value
    value = property(_get, _set)
    def __repr__(self):
        return '<%s(%r, %r)>'%(type(self).__name__,self._typecode,self._value)

def Manager():
    return sys.modules[__name__]

def shutdown():
    pass

def Pool(processes=None, initializer=None, initargs=()):
    from multiprocessing.pool import ThreadPool
    return ThreadPool(processes, initializer, initargs)

JoinableQueue = Queue
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0x0012</span></div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor">#define EEPROM_FLASH_VERSION          0x0032</span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="preprocessor">#define EEPROM_CHECKSUM_REG           0x003F</span></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="preprocessor">#define E1000_EEPROM_CFG_DONE         0x00040000   </span><span class="comment">/* MNG config cycle done */</span><span class="preprocessor"></span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="preprocessor">#define E1000_EEPROM_CFG_DONE_PORT_1  0x00080000   </span><span class="comment">/* ...for second port */</span><span class="preprocessor"></span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">/* Word definitions for ID LED Settings */</span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="preprocessor">#define ID_LED_RESERVED_0000 0x0000</span></div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="preprocessor">#define ID_LED_RESERVED_FFFF 0xFFFF</span></div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="preprocessor">#define ID_LED_RESERVED_82573  0xF746</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="preprocessor">#define ID_LED_DEFAULT_82573   0x1811</span></div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="preprocessor">#define ID_LED_DEFAULT       ((ID_LED_OFF1_ON2 &lt;&lt; 12) | \</span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="preprocessor">                              (ID_LED_OFF1_OFF2 &lt;&lt; 8) | \</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="preprocessor">                              (ID_LED_DEF1_DEF2 &lt;&lt; 4) | \</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="preprocessor">                              (ID_LED_DEF1_DEF2))</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="preprocessor">#define ID_LED_DEFAULT_ICH8LAN  ((ID_LED_DEF1_DEF2 &lt;&lt; 12) | \</span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="preprocessor">                                 (ID_LED_DEF1_OFF2 &lt;&lt;  8) | \</span></div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="preprocessor">                                 (ID_LED_DEF1_ON2  &lt;&lt;  4) | \</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="preprocessor">                                 (ID_LED_DEF1_DEF2))</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="preprocessor">#define ID_LED_DEF1_DEF2     0x1</span></div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="preprocessor">#define ID_LED_DEF1_ON2      0x2</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="preprocessor">#define ID_LED_DEF1_OFF2     0x3</span></div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="preprocessor">#define ID_LED_ON1_DEF2      0x4</span></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="preprocessor">#define ID_LED_ON1_ON2       0x5</span></div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="preprocessor">#define ID_LED_ON1_OFF2      0x6</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="preprocessor">#define ID_LED_OFF1_DEF2     0x7</span></div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="preprocessor">#define ID_LED_OFF1_ON2      0x8</span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="preprocessor">#define ID_LED_OFF1_OFF2     0x9</span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="preprocessor">#define IGP_ACTIVITY_LED_MASK   0xFFFFF0FF</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="preprocessor">#define IGP_ACTIVITY_LED_ENABLE 0x0300</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="preprocessor">#define IGP_LED3_MODE           0x07000000</span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">/* Mask bits for SERDES amplitude adjustment in Word 6 of the EEPROM */</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="preprocessor">#define EEPROM_SERDES_AMPLITUDE_MASK  0x000F</span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment">/* Mask bit for PHY class in Word 7 of the EEPROM */</span></div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="preprocessor">#define EEPROM_PHY_CLASS_A   0x8000</span></div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment">/* Mask bits for fields in Word 0x0a of the EEPROM */</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="preprocessor">#define EEPROM_WORD0A_ILOS   0x0010</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="preprocessor">#define EEPROM_WORD0A_SWDPIO 0x01E0</span></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="preprocessor">#define EEPROM_WORD0A_LRST   0x0200</span></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="preprocessor">#define EEPROM_WORD0A_FD     0x0400</span></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="preprocessor">#define EEPROM_WORD0A_66MHZ  0x0800</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">/* Mask bits for fields in Word 0x0f of the EEPROM */</span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="preprocessor">#define EEPROM_WORD0F_PAUSE_MASK 0x3000</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="preprocessor">#define EEPROM_WORD0F_PAUSE      0x1000</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="preprocessor">#define EEPROM_WORD0F_ASM_DIR    0x2000</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="preprocessor">#define EEPROM_WORD0F_ANE        0x0800</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="preprocessor">#define EEPROM_WORD0F_SWPDIO_EXT 0x00F0</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="preprocessor">#define EEPROM_WORD0F_LPLU       0x0001</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">/* Mask bits for fields in Word 0x10/0x20 of the EEPROM */</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="preprocessor">#define EEPROM_WORD1020_GIGA_DISABLE         0x0010</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="preprocessor">#define EEPROM_WORD1020_GIGA_DISABLE_NON_D0A 0x0008</span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">/* Mask bits for fields in Word 0x1a of the EEPROM */</span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="preprocessor">#define EEPROM_WORD1A_ASPM_MASK  0x000C</span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">/* For checksumming, the sum of all words in the EEPROM should equal 0xBABA. */</span></div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="preprocessor">#define EEPROM_SUM 0xBABA</span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">/* EEPROM Map defines (WORD OFFSETS)*/</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="preprocessor">#define EEPROM_NODE_ADDRESS_BYTE_0 0</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="preprocessor">#define EEPROM_PBA_BYTE_1          8</span></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="preprocessor">#define EEPROM_RESERVED_WORD          0xFFFF</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">/* EEPROM Map Sizes (Byte Counts) */</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="preprocessor">#define PBA_SIZE 4</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">/* Collision related configuration parameters */</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="preprocessor">#define E1000_COLLISION_THRESHOLD       15</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="preprocessor">#define E1000_CT_SHIFT                  4</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">/* Collision distance is a 0-based value that applies to</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment"> * half-duplex-capable hardware only. */</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="preprocessor">#define E1000_COLLISION_DISTANCE        63</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="preprocessor">#define E1000_COLLISION_DISTANCE_82542  64</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="preprocessor">#define E1000_FDX_COLLISION_DISTANCE    E1000_COLLISION_DISTANCE</span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="preprocessor">#define E1000_HDX_COLLISION_DISTANCE    E1000_COLLISION_DISTANCE</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="preprocessor">#define E1000_COLD_SHIFT                12</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">/* Number of Transmit and Receive Descriptors must be a multiple of 8 */</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="preprocessor">#define REQ_TX_DESCRIPTOR_MULTIPLE  8</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="preprocessor">#define REQ_RX_DESCRIPTOR_MULTIPLE  8</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">/* Default values for the transmit IPG register */</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="preprocessor">#define DEFAULT_82542_TIPG_IPGT        10</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="preprocessor">#define DEFAULT_82543_TIPG_IPGT_FIBER  9</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="preprocessor">#define DEFAULT_82543_TIPG_IPGT_COPPER 8</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="preprocessor">#define E1000_TIPG_IPGT_MASK  0x000003FF</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="preprocessor">#define E1000_TIPG_IPGR1_MASK 0x000FFC00</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="preprocessor">#define E1000_TIPG_IPGR2_MASK 0x3FF00000</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="preprocessor">#define DEFAULT_82542_TIPG_IPGR1 2</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="preprocessor">#define DEFAULT_82543_TIPG_IPGR1 8</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="preprocessor">#define E1000_TIPG_IPGR1_SHIFT  10</span></div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="preprocessor">#define DEFAULT_82542_TIPG_IPGR2 10</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="preprocessor">#define DEFAULT_82543_TIPG_IPGR2 6</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="preprocessor">#define DEFAULT_80003ES2LAN_TIPG_IPGR2 7</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="preprocessor">#define E1000_TIPG_IPGR2_SHIFT  20</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="preprocessor">#define DEFAULT_80003ES2LAN_TIPG_IPGT_10_100 0x00000009</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="preprocessor">#define DEFAULT_80003ES2LAN_TIPG_IPGT_1000   0x00000008</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="preprocessor">#define E1000_TXDMAC_DPP 0x00000001</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">/* Adaptive IFS defines */</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="preprocessor">#define TX_THRESHOLD_START     8</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="preprocessor">#define TX_THRESHOLD_INCREMENT 10</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="preprocessor">#define TX_THRESHOLD_DECREMENT 1</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="preprocessor">#define TX_THRESHOLD_STOP      190</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="preprocessor">#define TX_THRESHOLD_DISABLE   0</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="preprocessor">#define TX_THRESHOLD_TIMER_MS  10000</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="preprocessor">#define MIN_NUM_XMITS          1000</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="preprocessor">#define IFS_MAX                80</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="preprocessor">#define IFS_STEP               10</span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="preprocessor">#define IFS_MIN                40</span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="preprocessor">#define IFS_RATIO              4</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">/* Extended Configuration Control and Size */</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_PCIE_WRITE_ENABLE 0x00000001</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_PHY_WRITE_ENABLE  0x00000002</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_D_UD_ENABLE       0x00000004</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_D_UD_LATENCY      0x00000008</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_D_UD_OWNER        0x00000010</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_MDIO_SW_OWNERSHIP 0x00000020</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_MDIO_HW_OWNERSHIP 0x00000040</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_EXT_CNF_POINTER   0x0FFF0000</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_SIZE_EXT_PHY_LENGTH    0x000000FF</span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_SIZE_EXT_DOCK_LENGTH   0x0000FF00</span></div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_SIZE_EXT_PCIE_LENGTH   0x00FF0000</span></div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_LCD_WRITE_ENABLE  0x00000001</span></div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="preprocessor">#define E1000_EXTCNF_CTRL_SWFLAG            0x00000020</span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">/* PBA constants */</span></div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="preprocessor">#define E1000_PBA_8K 0x0008    </span><span class="comment">/* 8KB, default Rx allocation */</span><span class="preprocessor"></span></div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="preprocessor">#define E1000_PBA_12K 0x000C    </span><span class="comment">/* 12KB, default Rx allocation */</span><span class="preprocessor"></span></div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="preprocessor">#define E1000_PBA_16K 0x0010    </span><span class="comment">/* 16KB, default TX allocation */</span><span class="preprocessor"></span></div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="preprocessor">#define E1000_PBA_22K 0x0016</span></div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="preprocessor">#define E1000_PBA_24K 0x0018</span></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="preprocessor">#define E1000_PBA_30K 0x001E</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="preprocessor">#define E1000_PBA_32K 0x0020</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="preprocessor">#define E1000_PBA_34K 0x0022</span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="preprocessor">#define E1000_PBA_38K 0x0026</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="preprocessor">#define E1000_PBA_40K 0x0028</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="preprocessor">#define E1000_PBA_48K 0x0030    </span><span class="comment">/* 48KB, default RX allocation */</span><span class="preprocessor"></span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="preprocessor">#define E1000_PBS_16K E1000_PBA_16K</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">/* Flow Control Constants */</span></div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="preprocessor">#define FLOW_CONTROL_ADDRESS_LOW  0x00C28001</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="preprocessor">#define FLOW_CONTROL_ADDRESS_HIGH 0x00000100</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="preprocessor">#define FLOW_CONTROL_TYPE         0x8808</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="comment">/* The historical defaults for the flow control values are given below. */</span></div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="preprocessor">#define FC_DEFAULT_HI_THRESH        (0x8000)    </span><span class="comment">/* 32KB */</span><span class="preprocessor"></span></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="preprocessor">#define FC_DEFAULT_LO_THRESH        (0x4000)    </span><span class="comment">/* 16KB */</span><span class="preprocessor"></span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="preprocessor">#define FC_DEFAULT_TX_TIMER         (0x100)     </span><span class="comment">/* ~130 us */</span><span class="preprocessor"></span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">/* PCIX Config space */</span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="preprocessor">#define PCIX_COMMAND_REGISTER    0xE6</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="preprocessor">#define PCIX_STATUS_REGISTER_LO  0xE8</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="preprocessor">#define PCIX_STATUS_REGISTER_HI  0xEA</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="preprocessor">#define PCIX_COMMAND_MMRBC_MASK      0x000C</span></div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="preprocessor">#define PCIX_COMMAND_MMRBC_SHIFT     0x2</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="preprocessor">#define PCIX_STATUS_HI_MMRBC_MASK    0x0060</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="preprocessor">#define PCIX_STATUS_HI_MMRBC_SHIFT   0x5</span></div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="preprocessor">#define PCIX_STATUS_HI_MMRBC_4K      0x3</span></div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="preprocessor">#define PCIX_STATUS_HI_MMRBC_2K      0x2</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">/* Number of bits required to shift right the &quot;pause&quot; bits from the</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment"> * EEPROM (bits 13:12) to the &quot;pause&quot; (bits 8:7) field in the TXCW register.</span></div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="preprocessor">#define PAUSE_SHIFT 5</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment">/* Number of bits required to shift left the &quot;SWDPIO&quot; bits from the</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment"> * EEPROM (bits 8:5) to the &quot;SWDPIO&quot; (bits 25:22) field in the CTRL register.</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="preprocessor">#define SWDPIO_SHIFT 17</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">/* Number of bits required to shift left the &quot;SWDPIO_EXT&quot; bits from the</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment"> * EEPROM word F (bits 7:4) to the bits 11:8 of The Extended CTRL register.</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="preprocessor">#define SWDPIO__EXT_SHIFT 4</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment">/* Number of bits required to shift left the &quot;ILOS&quot; bit from the EEPROM</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment"> * (bit 4) to the &quot;ILOS&quot; (bit 7) field in the CTRL register.</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="preprocessor">#define ILOS_SHIFT  3</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="preprocessor">#define RECEIVE_BUFFER_ALIGN_SIZE  (256)</span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="comment">/* Number of milliseconds we wait for auto-negotiation to complete */</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="preprocessor">#define LINK_UP_TIMEOUT             500</span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">/* Number of 100 microseconds we wait for PCI Express master disable */</span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="preprocessor">#define MASTER_DISABLE_TIMEOUT      800</span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="comment">/* Number of milliseconds we wait for Eeprom auto read bit done after MAC reset */</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="preprocessor">#define AUTO_READ_DONE_TIMEOUT      10</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment">/* Number of milliseconds we wait for PHY configuration done after MAC reset */</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="preprocessor">#define PHY_CFG_TIMEOUT             100</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="preprocessor">#define E1000_TX_BUFFER_SIZE ((uint32_t)1514)</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">/* The carrier extension symbol, as received by the NIC. */</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="preprocessor">#define CARRIER_EXTENSION   0x0F</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment">/* TBI_ACCEPT macro definition:</span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment"> * This macro requires:</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment"> *      adapter = a pointer to struct e1000_hw</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment"> *      status = the 8 bit status field of the RX descriptor with EOP set</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment"> *      error = the 8 bit error field of the RX descriptor with EOP set</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment"> *      length = the sum of all the length fields of the RX descriptors that</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment"> *               make up the current frame</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment"> *      last_byte = the last byte of the frame DMAed by the hardware</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment"> *      max_frame_length = the maximum frame length we want to accept.</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment"> *      min_frame_length = the minimum frame length we want to accept.</span></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment"> * This macro is a conditional that should be used in the interrupt</span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment"> * handler&#39;s Rx processing routine when RxErrors have been detected.</span></div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="comment"> * Typical use:</span></div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="comment"> *  ...</span></div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="comment"> *  if (TBI_ACCEPT) {</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment"> *      accept_frame = TRUE;</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="comment"> *      e1000_tbi_adjust_stats(adapter, MacAddress);</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="comment"> *      frame_length--;</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="comment"> *  } else {</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment"> *      accept_frame = FALSE;</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment"> *  }</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment"> *  ...</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="preprocessor">#define TBI_ACCEPT(adapter, status, errors, length, last_byte) \</span></div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="preprocessor">    ((adapter)-&gt;tbi_compatibility_on &amp;&amp; \</span></div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="preprocessor">     (((errors) &amp; E1000_RXD_ERR_FRAME_ERR_MASK) == E1000_RXD_ERR_CE) &amp;&amp; \</span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="preprocessor">     ((last_byte) == CARRIER_EXTENSION) &amp;&amp; \</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="preprocessor">     (((status) &amp; E1000_RXD_STAT_VP) ? \</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="preprocessor">          (((length) &gt; ((adapter)-&gt;min_frame_size - VLAN_TAG_SIZE)) &amp;&amp; \</span></div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="preprocessor">           ((length) &lt;= ((adapter)-&gt;max_frame_size + 1))) : \</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="preprocessor">          (((length) &gt; (adapter)-&gt;min_frame_size) &amp;&amp; \</span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="preprocessor">           ((length) &lt;= ((adapter)-&gt;max_frame_size + VLAN_TAG_SIZE + 1)))))</span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment">/* Structures, enums, and macros for the PHY */</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment">/* Bit definitions for the Management Data IO (MDIO) and Management Data</span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="comment"> * Clock (MDC) pins in the Device Control Register.</span></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="preprocessor">#define E1000_CTRL_PHY_RESET_DIR  E1000_CTRL_SWDPIO0</span></div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="preprocessor">#define E1000_CTRL_PHY_RESET      E1000_CTRL_SWDPIN0</span></div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="preprocessor">#define E1000_CTRL_MDIO_DIR       E1000_CTRL_SWDPIO2</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="preprocessor">#define E1000_CTRL_MDIO           E1000_CTRL_SWDPIN2</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="preprocessor">#define E1000_CTRL_MDC_DIR        E1000_CTRL_SWDPIO3</span></div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="preprocessor">#define E1000_CTRL_MDC            E1000_CTRL_SWDPIN3</span></div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="preprocessor">#define E1000_CTRL_PHY_RESET_DIR4 E1000_CTRL_EXT_SDP4_DIR</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="preprocessor">#define E1000_CTRL_PHY_RESET4     E1000_CTRL_EXT_SDP4_DATA</span></div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">/* PHY 1000 MII Register/Bit Definitions */</span></div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">/* PHY Registers defined by IEEE */</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="preprocessor">#define PHY_CTRL         0x00 </span><span class="comment">/* Control Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="preprocessor">#define PHY_STATUS       0x01 </span><span class="comment">/* Status Regiser */</span><span class="preprocessor"></span></div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="preprocessor">#define PHY_ID1          0x02 </span><span class="comment">/* Phy Id Reg (word 1) */</span><span class="preprocessor"></span></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="preprocessor">#define PHY_ID2          0x03 </span><span class="comment">/* Phy Id Reg (word 2) */</span><span class="preprocessor"></span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="preprocessor">#define PHY_AUTONEG_ADV  0x04 </span><span class="comment">/* Autoneg Advertisement */</span><span class="preprocessor"></span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="preprocessor">#define PHY_LP_ABILITY   0x05 </span><span class="comment">/* Link Partner Ability (Base Page) */</span><span class="preprocessor"></span></div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="preprocessor">#define PHY_AUTONEG_EXP  0x06 </span><span class="comment">/* Autoneg Expansion Reg */</span><span class="preprocessor"></span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="preprocessor">#define PHY_NEXT_PAGE_TX 0x07 </span><span class="comment">/* Next Page TX */</span><span class="preprocessor"></span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="preprocessor">#define PHY_LP_NEXT_PAGE 0x08 </span><span class="comment">/* Link Partner Next Page */</span><span class="preprocessor"></span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="preprocessor">#define PHY_1000T_CTRL   0x09 </span><span class="comment">/* 1000Base-T Control Reg */</span><span class="preprocessor"></span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="preprocessor">#define PHY_1000T_STATUS 0x0A </span><span class="comment">/* 1000Base-T Status Reg */</span><span class="preprocessor"></span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="preprocessor">#define PHY_EXT_STATUS   0x0F </span><span class="comment">/* Extended Status Reg */</span><span class="preprocessor"></span></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="preprocessor">#define MAX_PHY_REG_ADDRESS        0x1F  </span><span class="comment">/* 5 bit address bus (0-0x1F) */</span><span class="preprocessor"></span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="preprocessor">#define MAX_PHY_MULTI_PAGE_REG     0xF   </span><span class="comment">/* Registers equal on all pages */</span><span class="preprocessor"></span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">/* M88E1000 Specific Registers */</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="preprocessor">#define M88E1000_PHY_SPEC_CTRL     0x10  </span><span class="comment">/* PHY Specific Control Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="preprocessor">#define M88E1000_PHY_SPEC_STATUS   0x11  </span><span class="comment">/* PHY Specific Status Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="preprocessor">#define M88E1000_INT_ENABLE        0x12  </span><span class="comment">/* Interrupt Enable Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="preprocessor">#define M88E1000_INT_STATUS        0x13  </span><span class="comment">/* Interrupt Status Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="preprocessor">#define M88E1000_EXT_PHY_SPEC_CTRL 0x14  </span><span class="comment">/* Extended PHY Specific Control */</span><span class="preprocessor"></span></div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="preprocessor">#define M88E1000_RX_ERR_CNTR       0x15  </span><span class="comment">/* Receive Error Counter */</span><span class="preprocessor"></span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="preprocessor">#define M88E1000_PHY_EXT_CTRL      0x1A  </span><span class="comment">/* PHY extend control register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="preprocessor">#define M88E1000_PHY_PAGE_SELECT   0x1D  </span><span class="comment">/* Reg 29 for page number setting */</span><span class="preprocessor"></span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="preprocessor">#define M88E1000_PHY_GEN_CONTROL   0x1E  </span><span class="comment">/* Its meaning depends on reg 29 */</span><span class="preprocessor"></span></div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="preprocessor">#define M88E1000_PHY_VCO_REG_BIT8  0x100 </span><span class="comment">/* Bits 8 &amp; 11 are adjusted for */</span><span class="preprocessor"></span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="preprocessor">#define M88E1000_PHY_VCO_REG_BIT11 0x800    </span><span class="comment">/* improved BER performance */</span><span class="preprocessor"></span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="preprocessor">#define IGP01E1000_IEEE_REGS_PAGE  0x0000</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="preprocessor">#define IGP01E1000_IEEE_RESTART_AUTONEG 0x3300</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="preprocessor">#define IGP01E1000_IEEE_FORCE_GIGA      0x0140</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment">/* IGP01E1000 Specific Registers */</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_PORT_CONFIG 0x10 </span><span class="comment">/* PHY Specific Port Config Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_PORT_STATUS 0x11 </span><span class="comment">/* PHY Specific Status Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_PORT_CTRL   0x12 </span><span class="comment">/* PHY Specific Control Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_LINK_HEALTH 0x13 </span><span class="comment">/* PHY Link Health Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="preprocessor">#define IGP01E1000_GMII_FIFO       0x14 </span><span class="comment">/* GMII FIFO Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_CHANNEL_QUALITY 0x15 </span><span class="comment">/* PHY Channel Quality Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="preprocessor">#define IGP02E1000_PHY_POWER_MGMT      0x19</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_PAGE_SELECT     0x1F </span><span class="comment">/* PHY Page Select Core Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="comment">/* IGP01E1000 AGC Registers - stores the cable length values*/</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_A        0x1172</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_B        0x1272</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_C        0x1472</span></div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_D        0x1872</span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment">/* IGP02E1000 AGC Registers for cable length values */</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="preprocessor">#define IGP02E1000_PHY_AGC_A        0x11B1</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="preprocessor">#define IGP02E1000_PHY_AGC_B        0x12B1</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="preprocessor">#define IGP02E1000_PHY_AGC_C        0x14B1</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="preprocessor">#define IGP02E1000_PHY_AGC_D        0x18B1</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">/* IGP01E1000 DSP Reset Register */</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_DSP_RESET   0x1F33</span></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_DSP_SET     0x1F71</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_DSP_FFE     0x1F35</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_CHANNEL_NUM    4</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="preprocessor">#define IGP02E1000_PHY_CHANNEL_NUM    4</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_PARAM_A    0x1171</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_PARAM_B    0x1271</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_PARAM_C    0x1471</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_AGC_PARAM_D    0x1871</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_EDAC_MU_INDEX        0xC000</span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_EDAC_SIGN_EXT_9_BITS 0x8000</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_ANALOG_TX_STATE      0x2890</span></div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_ANALOG_CLASS_A       0x2000</span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_FORCE_ANALOG_ENABLE  0x0004</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_DSP_FFE_CM_CP        0x0069</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_DSP_FFE_DEFAULT      0x002A</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">/* IGP01E1000 PCS Initialization register - stores the polarity status when</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="comment"> * speed = 1000 Mbps. */</span></div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_PCS_INIT_REG  0x00B4</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="preprocessor">#define IGP01E1000_PHY_PCS_CTRL_REG  0x00B5</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="preprocessor">#define IGP01E1000_ANALOG_REGS_PAGE  0x20C0</span></div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment">/* Bits...</span></div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="comment"> * 15-5: page</span></div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="comment"> * 4-0: register offset</span></div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="preprocessor">#define GG82563_PAGE_SHIFT        5</span></div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="preprocessor">#define GG82563_REG(page, reg)    \</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="preprocessor">        (((page) &lt;&lt; GG82563_PAGE_SHIFT) | ((reg) &amp; MAX_PHY_REG_ADDRESS))</span></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="preprocessor">#define GG82563_MIN_ALT_REG       30</span></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;<span class="comment">/* GG82563 Specific Registers */</span></div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="preprocessor">#define GG82563_PHY_SPEC_CTRL           \</span></div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="preprocessor">        GG82563_REG(0, 16) </span><span class="comment">/* PHY Specific Control */</span><span class="preprocessor"></span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="preprocessor">#define GG82563_PHY_SPEC_STATUS         \</span></div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="preprocessor">        GG82563_REG(0, 17) </span><span class="comment">/* PHY Specific Status */</span><span class="preprocessor"></span></div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="preprocessor">#define GG82563_PHY_INT_ENABLE          \</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="preprocessor">        GG82563_REG(0, 18) </span><span class="comment">/* Interrupt Enable */</span><span class="preprocessor"></span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="preprocessor">#define GG82563_PHY_SPEC_STATUS_2       \</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="preprocessor">        GG82563_REG(0, 19) </span><span class="comment">/* PHY Specific Status 2 */</span><span class="preprocessor"></span></div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;<span class="preprocessor">#define GG82563_PHY_RX_ERR_CNTR         \</span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="preprocessor">        GG82563_REG(0, 21) </span><span class="comment">/* Receive Error Counter */</span><span class="preprocessor"></span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="preprocessor">#define GG82563_PHY_PAGE_SELECT         \</span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="preprocessor">        GG82563_REG(0, 22) </span><span class="comment">/* Page Select */</span><span class="preprocessor"></span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="preprocessor">#define GG82563_PHY_SPEC_CTRL_2         \</span></div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="preprocessor">        GG82563_REG(0, 26) </span><span class="comment">/* PHY Specific Control 2 */</span><span class="preprocessor"></span></div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="preprocessor">#define GG82563_PHY_PAGE_SELECT_ALT     \</span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="preprocessor">        GG82563_REG(0, 29) </span><span class="comment">/* Alternate Page Select */</span><span class="preprocessor"></span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="preprocessor">#define GG82563_PHY_TEST_CLK_CTRL       \</span></div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="preprocessor">        GG82563_REG(0, 30) </span><span class="comment">/* Test Clock Control (use reg. 29 to select) */</span><span class="preprocessor"></span></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="preprocessor">#define GG82563_PHY_MAC_SPEC_CTRL       \</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="preprocessor">        GG82563_REG(2, 21) </span><span class="comment">/* MAC Specific Control Register */</span><span class="preprocessor"></span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="preprocessor">#define GG82563_PHY_MAC_SPEC_CTRL_2     \</span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span Package: ncurses-term
Status: install ok unpacked
Priority: standard
Section: misc
Installed-Size: 2187
Maintainer: Craig Small <csmall@debian.org>
Architecture: all
Multi-Arch: foreign
Source: ncurses
Version: 5.9+20140913-1+deb8u3
Config-Version: 5.9+20140913-1
Replaces: bogl-bterm (<< 0.1.18-7), mlterm-common (<< 3.0.2-1), ncurses-base (<< 5.7+20100313-1), suckless-tools (<< 39)
Breaks: bogl-bterm (<< 0.1.18-7), mlterm-common (<< 3.0.2-1), suckless-tools (<< 39)
Description: additional terminal type definitions
 The ncurses library routines are a terminal-independent method of
 updating character screens with reasonable optimization.
 .
 This package contains all of the numerous terminal definitions not found in
 the ncurses-base package.
Homepage: http://invisible-island.net/ncurses/
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 -----BEGIN CERTIFICATE-----
MIICqDCCAi2gAwIBAgIQIW4zpcvTiKRvKQe0JzzE2DAKBggqhkjOPQQDAzCBlDEL
MAkGA1UEBhMCVVMxHTAbBgNVBAoTFFN5bWFudGVjIENvcnBvcmF0aW9uMR8wHQYD
VQQLExZTeW1hbnRlYyBUcnVzdCBOZXR3b3JrMUUwQwYDVQQDEzxTeW1hbnRlYyBD
bGFzcyAxIFB1YmxpYyBQcmltYXJ5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5IC0g
RzQwHhcNMTExMDA1MDAwMDAwWhcNMzgwMTE4MjM1OTU5WjCBlDELMAkGA1UEBhMC
VVMxHTAbBgNVBAoTFFN5bWFudGVjIENvcnBvcmF0aW9uMR8wHQYDVQQLExZTeW1h
bnRlYyBUcnVzdCBOZXR3b3JrMUUwQwYDVQQDEzxTeW1hbnRlYyBDbGFzcyAxIFB1
YmxpYyBQcmltYXJ5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5IC0gRzQwdjAQBgcq
hkjOPQIBBgUrgQQAIgNiAATXZrUb266zYO5G6ohjdTsqlG3zXxL24w+etgoUU0hS
yNw6s8tIICYSTvqJhNTfkeQpfSgB2dsYQ2mhH7XThhbcx39nI9/fMTGDAzVwsUu3
yBe7UcvclBfb6gk7dhLeqrWjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8E
BTADAQH/MB0GA1UdDgQWBBRlwI0l9Qy6l3eQP54u4Fr1ztXh5DAKBggqhkjOPQQD
AwNpADBmAjEApa7jRlP4mDbjIvouKEkN7jB+M/PsP3FezFWJeJmssv3cHFwzjim5
axfIEWi13IMHAjEAnMhE2mnCNsNUGRCFAtqdR+9B52wmnQk9922Q0QVEL7C8g5No
8gxFSTm/mQQc0xCg
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -----BEGIN CERTIFICATE-----
MIIEGjCCAwICEQCbfgZJoz5iudXukEhxKe9XMA0GCSqGSIb3DQEBBQUAMIHKMQsw
CQYDVQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZl
cmlTaWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWdu
LCBJbmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlT
aWduIENsYXNzIDMgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3Jp
dHkgLSBHMzAeFw05OTEwMDEwMDAwMDBaFw0zNjA3MTYyMzU5NTlaMIHKMQswCQYD
VQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZlcmlT
aWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWduLCBJ
bmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlTaWdu
IENsYXNzIDMgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkg
LSBHMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMu6nFL8eB8aHm8b
N3O9+MlrlBIwT/A2R/XQkQr1F8ilYcEWQE37imGQ5XYgwREGfassbqb1EUGO+i2t
KmFZpGcmTNDovFJbcCAEWNF6yaRpvIMXZK0Fi7zQWM6NjPXr8EJJC52XJ2cybuGu
kxUccLwgTS8Y3pKI6GyFVxEa6X7jJhFUokWWVYPKMIno3Nij7SqAP395ZVc+FSBm
CC+Vk7+qRy+oRpfwEuL+wgorUeZ25rdGt+INpsyow0xZVYnm6FNcHOqd8GIWC6fJ
Xwzw3sJ2zq/3avL6QaaiMxTJ5Xpj055iN9WFZZ4O5lMkdBteHRJTW8cs54NJOxWu
imi5V5cCAwEAATANBgkqhkiG9w0BAQUFAAOCAQEAERSWwauSCPc/L8my/uRan2Te
2yFPhpk0djZX3dAVL8WtfxUfN2JzPtTnX84XA9s1+ivbrmAJXx5fj267Cz3qWhMe
DGBvtcC1IyIuBwvLqXTLR7sdwdela8wv0kL9Sd2nic9TutoAWii/gt/4uhMdUIaC
/Y4wjylGsB49Ndo4YhYYSq3mtlFs3q9i6wHQHiT+eo8SGhJouPtmmRQURVyu565p
F4ErWjfJXir0xuKhXFSbplQAz/DxwceYMBo7Nhbbo27q/a2ywtrvAkcTisDxszGt
TxzhT5yvDwyd93gN2PQ1VoDat20Xj50egWTh/sVFuq1ruQp6Tk9LhO5L8X3dEQ==
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -----BEGIN CERTIFICATE-----
MIIFtzCCA5+gAwIBAgICBQkwDQYJKoZIhvcNAQEFBQAwRTELMAkGA1UEBhMCQk0x
GTAXBgNVBAoTEFF1b1ZhZGlzIExpbWl0ZWQxGzAZBgNVBAMTElF1b1ZhZGlzIFJv
b3QgQ0EgMjAeFw0wNjExMjQxODI3MDBaFw0zMTExMjQxODIzMzNaMEUxCzAJBgNV
BAYTAkJNMRkwFwYDVQQKExBRdW9WYWRpcyBMaW1pdGVkMRswGQYDVQQDExJRdW9W
YWRpcyBSb290IENBIDIwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQCa
GMpLlA0ALa8DKYrwD4HIrkwZhR0In6spRIXzL4GtMh6QRr+jhiYaHv5+HBg6XJxg
Fyo6dIMzMH1hVBHL7avg5tKifvVrbxi3Cgst/ek+7wrGsxDp3MJGF/hd/aTa/55J
WpzmM+Yklvc/ulsrHHo1wtZn/qtmUIttKGAr79dgw8eTvI02kfN/+NsRE8Scd3bB
rrcCaoF6qUWD4gXmuVbBlDePSHFjIuwXZQeVikvfj8ZaCuWw419eaxGrDPmF60Tp
+ARz8un+XJiM9XOva7R+zdRcAitMOeGylZUtQofX1bOQQ7dsE/He3fbE+Ik/0XX1
ksOR1YqI0JDs3G3eicJlcZaLDQP9nL9bFqyS2+r+eXyt66/3FsvbzSUr5R/7mp/i
Ucw6UwxI5g69ybR2BlLmEROFcmMDBOAENisgGQLodKcftslWZvB1JdxnwQ5hYIiz
PtGo/KPaHbDRsSNU30R2be1B2MGyIrZTHN81Hdyhdyox5C315eXbyOD/5YDXC2Og
/zOhD7osFRXql7PSorW+8oyWHhqPHWykYTe5hnMz15eWniN9gqRMgeKh0bpnX5UH
oycR7hYQe7xFSkyyBNKr79X9DFHOUGoIMfmR2gyPZFwDwzqLID9ujWc9Otb+fVuI
yV77zGHcizN300QyNQliBJIWENieJ0f7OyHj+OsdWwIDAQABo4GwMIGtMA8GA1Ud
EwEB/wQFMAMBAf8wCwYDVR0PBAQDAgEGMB0GA1UdDgQWBBQahGK8SEwzJQTU7tD2
A8QZRtGUazBuBgNVHSMEZzBlgBQahGK8SEwzJQTU7tD2A8QZRtGUa6FJpEcwRTEL
MAkGA1UEBhMCQk0xGTAXBgNVBAoTEFF1b1ZhZGlzIExpbWl0ZWQxGzAZBgNVBAMT
ElF1b1ZhZGlzIFJvb3QgQ0EgMoICBQkwDQYJKoZIhvcNAQEFBQADggIBAD4KFk2f
BluornFdLwUvZ+YTRYPENvbzwCYMDbVHZF34tHLJRqUDGCdViXh9duqWNIAXINzn
g/iN/Ae42l9NLmeyhP3ZRPx3UIHmfLTJDQtyU/h2BwdBR5YM++CCJpNVjP4iH2Bl
fF/nJrP3MpCYUNQ3cVX2kiF495V5+vgtJodmVjB3pjd4M1IQWK4/YY7yarHvGH5K
WWPKjaJW1acvvFYfzznB4vsKqBUsfU16Y8Zsl0Q80m/DShcK+JDSV6IZUaUtl0Ha
B0+pUNqQjZRG4T7wlP0QADj1O+hA4bRuVhogzG9Yje0uRY/W6ZM/57Es3zrWIozc
hLsib9D45MY56QSIPMO661V6bYCZJPVsAfv4l7CUW+v90m/xd2gNNWQjrLhVoQPR
TUIZ3Ph1WVaj+ahJefivDrkRoHy3au000LYmYjgahwz46P0u05B/B5EqHdZ+XIWD
mbA4CD/pXvk1B+TJYm5Xf6dQlfe6yJvmjqIBxdZmv3lh8zwc4bmCXF2gw+nYSL0Z
ohEUGW6yhhtoPkg3Goi3XZZenMfvJ2II4pEZXNLxId26F0KCl3GBUzGpn/Z9Yr9y
4aOTHcyKJloJONDO1w2AFrR4pTqHTI2KpdVGl/IsELm8VCLAAVBpQ570su9t+Oza
8eOx79+Rj1QqCyXBJhnEUhAFZdWCEOrCMc0u
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -----BEGIN CERTIFICATE-----
MIIEGjCCAwICEQCLW3VWhFSFCwDPrzhIzrGkMA0GCSqGSIb3DQEBBQUAMIHKMQsw
CQYDVQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZl
cmlTaWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWdu
LCBJbmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlT
aWduIENsYXNzIDEgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3Jp
dHkgLSBHMzAeFw05OTEwMDEwMDAwMDBaFw0zNjA3MTYyMzU5NTlaMIHKMQswCQYD
VQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZlcmlT
aWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWduLCBJ
bmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlTaWdu
IENsYXNzIDEgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkg
LSBHMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN2E1Lm0+afY8wR4
nN493GwTFtl63SRRZsDHJlkNrAYIwpTRMx/wgzUfbhvI3qpuFU5UJ+/EbRrsC+MO
8ESlV8dAWB6jRx9x7GD2bZTIGDnt/kIYVt/kTEkQeE4BdjVjEjbdZrwBBDajVWjV
ojYJrKshJlQGrT/KFOCsyq0GHZXi+J3x4GD/wn91K0zM2v6HmSHquv4+VNfSWXjb
PG7PoBMAGrgnoeS+Z5bKoMWznN3JdZ7rMJpfo83ZrngZPyPpXNspva1VyBtUjGP2
6KbqxzcSXKMpHgLZ2x87tNcPVkeBFQRKr4Mn0cVYiMHd9qqnoxjaaKptEVHhv2Vr
n5Z20T0CAwEAATANBgkqhkiG9w0BAQUFAAOCAQEAq2aN17O6x5q25lXQBfGfMY1a
qtmqRiYPce2lrVNWYgFHKkTp/j90CxObufRNG7LRX7K20ohcs5/Ny9Sn2WCVhDr4
wTcdYcrnsMXlkdpUpqwxga6X3s0IrLjAl4B/bnKk52kTlWUfxJM8/XmPBNQ+T+r3
ns7NZ3xPZQL/kYVUc8f/NveGLezQXk//EZ9yBta4GvFMDSZl4kSAHsef493oCtrs
pSCAaWihT37ha88HQfqDjrw43bAuEbFrskLMmrz5SCJ5ShkPshw+IHTZasO+8ih4
E1Z5T21Q6huwtVexN2ZYI/PcD98Kh8TvhgXVOBRgmaNL3gaWcSzy27YfpO8/7g==
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -----BEGIN CERTIFICATE-----
MIIDuzCCAqOgAwIBAgIDBETAMA0GCSqGSIb3DQEBBQUAMH4xCzAJBgNVBAYTAlBM
MSIwIAYDVQQKExlVbml6ZXRvIFRlY2hub2xvZ2llcyBTLkEuMScwJQYDVQQLEx5D
ZXJ0dW0gQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxIjAgBgNVBAMTGUNlcnR1bSBU
cnVzdGVkIE5ldHdvcmsgQ0EwHhcNMDgxMDIyMTIwNzM3WhcNMjkxMjMxMTIwNzM3
WjB+MQswCQYDVQQGEwJQTDEiMCAGA1UEChMZVW5pemV0byBUZWNobm9sb2dpZXMg
Uy5BLjEnMCUGA1UECxMeQ2VydHVtIENlcnRpZmljYXRpb24gQXV0aG9yaXR5MSIw
IAYDVQQDExlDZXJ0dW0gVHJ1c3RlZCBOZXR3b3JrIENBMIIBIjANBgkqhkiG9w0B
AQEFAAOCAQ8AMIIBCgKCAQEA4/t9o3K6wvDJFIf1awFO4W5AB7ptJ11/91sts1rH
UV+rpDKmYYe2bg+G0jACl/jXaVehGDldamR5xgFZrDwxSjh80gTSSyjoIF87B6LM
TXPb865Px1bVWqeWifrzq2jUI4ZZJ88JJ7ysbnKDHDBy3+Ci6dLhdHUZvSqeexVU
BBvXQzmtVSjF4hq79MDkrjhJM8x2hZ85RdKknvISjFH4fOQtf/WsX+sWn7Et0brM
kUJ3TCXJkDhv2/DM+44el1k+1WBO5gUo7Ul5E0u6SNsv+XLTOcr+H9g0cvW0QM8x
AcPs3hEtF10fuFDRXhmnad4HMyjKUJX5p1TLVIZQRan5SQIDAQABo0IwQDAPBgNV
HRMBAf8EBTADAQH/MB0GA1UdDgQWBBQIds3LB/8k9sXN7buQvOKEN0Z19zAOBgNV
HQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQEFBQADggEBAKaorSLOAT2mo/9i0Eidi15y
sHhE49wcrwn9I0j6vSrEuVUEtRCjjSfeC4Jj0O7eDDd5QVsisrCaQVymcODU0HfL
I9MA4GxWL+FpDQ3Zqr8hgVDZBqWo/5U30Kr+4rP1mS1FhIrlQgnXdAIv94nYmem8
J9RHjboNRhx3zxSkHLmkMcScKHQDNP8zGSal6Q10tz6XxnboJ5ajZt3hrvJBW8qY
VoNzcOSGGtIxQbovvi0TWnZvTuhOgQ4/WwMioBK+ZlgRSssDxLQqKi2WF+A5VLxI
03YnnZotBqbJ7DnSq9ufmgsnAjUpsUCV5/nonFWIGUbWtzT1fs45mtk48VH3Tyw=
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -----BEGIN CERTIFICATE-----
MIIDjjCCAnagAwIBAgIQAzrx5qcRqaC7KGSxHQn65TANBgkqhkiG9w0BAQsFADBh
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBH
MjAeFw0xMzA4MDExMjAwMDBaFw0zODAxMTUxMjAwMDBaMGExCzAJBgNVBAYTAlVT
MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5j
b20xIDAeBgNVBAMTF0RpZ2lDZXJ0IEdsb2JhbCBSb290IEcyMIIBIjANBgkqhkiG
9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuzfNNNx7a8myaJCtSnX/RrohCgiN9RlUyfuI
2/Ou8jqJkTx65qsGGmvPrC3oXgkkRLpimn7Wo6h+4FR1IAWsULecYxpsMNzaHxmx
1x7e/dfgy5SDN67sH0NO3Xss0r0upS/kqbitOtSZpLYl6ZtrAGCSYP9PIUkY92eQ
q2EGnI/yuum06ZIya7XzV+hdG82MHauVBJVJ8zUtluNJbd134/tJS7SsVQepj5Wz
tCO7TG1F8PapspUwtP1MVYwnSlcUfIKdzXOS0xZKBgyMUNGPHgm+F6HmIcr9g+UQ
vIOlCsRnKPZzFBQ9RnbDhxSJITRNrw9FDKZJobq7nMWxM4MphQIDAQABo0IwQDAP
BgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwIBhjAdBgNVHQ4EFgQUTiJUIBiV
5uNu5g/6+rkS7QYXjzkwDQYJKoZIhvcNAQELBQADggEBAGBnKJRvDkhj6zHd6mcY
1Yl9PMWLSn/pvtsrF9+wX3N3KjITOYFnQoQj8kVnNeyIv/iPsGEMNKSuIEyExtv4
NeF22d+mQrvHRAiGfzZ0JFrabA0UWTW98kndth/Jsw1HKj2ZL7tcu7XUIOGZX1NG
Fdtom/DzMNU+MeKNhJ7jitralj41E6Vf8PlwUHBHQRFXGU7Aj64GxJUTFy8bJZ91
8rGOmaFvE7FBcf6IKshPECBV1/MUReXgRPTqh5Uykw7+U0b6LJ3/iyK5S9kJRaTe
pLiaWN0bfVKfjllDiIGknibVb63dDcY3fe0Dkhvld1927jyNxF1WW6LZZm6zNTfl
MrY=
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -----BEGIN CERTIFICATE-----
MIIDWjCCAkKgAwIBAgIBADANBgkqhkiG9w0BAQUFADBQMQswCQYDVQQGEwJKUDEY
MBYGA1UEChMPU0VDT00gVHJ1c3QubmV0MScwJQYDVQQLEx5TZWN1cml0eSBDb21t
dW5pY2F0aW9uIFJvb3RDQTEwHhcNMDMwOTMwMDQyMDQ5WhcNMjMwOTMwMDQyMDQ5
WjBQMQswCQYDVQQGEwJKUDEYMBYGA1UEChMPU0VDT00gVHJ1c3QubmV0MScwJQYD
VQQLEx5TZWN1cml0eSBDb21tdW5pY2F0aW9uIFJvb3RDQTEwggEiMA0GCSqGSIb3
DQEBAQUAA4IBDwAwggEKAoIBAQCzs/5/022x7xZ8V6UMbXaKL0u/ZPtM7orw8yl8
9f/uKuDp6bpbZCKamm8sOiZpUQWZJtzVHGpxxpp9Hp3dfGzGjGdnSj74cbAZJ6kJ
DKaVv0uMDPpVmDvY6CKhS3E4eayXkmmziX7qIWgGmBSWh9JhNrxtJ1aeV+7AwFb9
Ms+k2Y7CI9eNqPPYJayX5HA49LY6tJ07lyZDo6G8SVlyTCMwhwFY9k6+HGhWZq/N
QV3Is00qVUarH9oe4kA92819uZKAnDfdDJZkndwi92SL32HeFZRSFaB9UslLqCHJ
xrHty8OVYNEP8Ktw+N/LTX7s1vqr2b1/VPKl6Xn62dZ2JChzAgMBAAGjPzA9MB0G
A1UdDgQWBBSgc0mZaNyFW2XjmygvV5+9M7wHSDALBgNVHQ8EBAMCAQYwDwYDVR0T
AQH/BAUwAwEB/zANBgkqhkiG9w0BAQUFAAOCAQEAaECpqLvkT115swW1F7NgE+vG
kl3g0dNq/vu+m22/xwVtWSDEHPC32oRYAmP6SBbvT6UL90qY8j+eG61Ha2POCEfr
Uj94nK9NrvjVT8+amCoQQTlSxN3Zmw7vkwGusi7KaEIkQmywszo+zenaSMQVy+n5
Bw+SUEmK3TGXX8npN6o7WWWXlDLJs58+OmJYxUmtYg5xpTKqL8aJdkNAExNnPaJU
JRDL8Try2frbSVa7pv6nQTXD4IhhyYjH3zYQIphZ6rBK+1YWc26sTfcioU+tHXot
RSflMMFe8toTyyVCUZVHA4xsIcx0Qu1T/zOLjw9XARYvz6buyXAiFL39vmwLAw==
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -----BEGIN CERTIFICATE-----
MIIC+TCCAoCgAwIBAgINAKaLeSkAAAAAUNCR+TAKBggqhkjOPQQDAzCBvzELMAkG
A1UEBhMCVVMxFjAUBgNVBAoTDUVudHJ1c3QsIEluYy4xKDAmBgNVBAsTH1NlZSB3
d3cuZW50cnVzdC5uZXQvbGVnYWwtdGVybXMxOTA3BgNVBAsTMChjKSAyMDEyIEVu
dHJ1c3QsIEluYy4gLSBmb3IgYXV0aG9yaXplZCB1c2Ugb25seTEzMDEGA1UEAxMq
RW50cnVzdCBSb290IENlcnRpZmljYXRpb24gQXV0aG9yaXR5IC0gRUMxMB4XDTEy
MTIxODE1MjUzNloXDTM3MTIxODE1NTUzNlowgb8xCzAJBgNVBAYTAlVTMRYwFAYD
VQQKEw1FbnRydXN0LCBJbmMuMSgwJgYDVQQLEx9TZWUgd3d3LmVudHJ1c3QubmV0
L2xlZ2FsLXRlcm1zMTkwNwYDVQQLEzAoYykgMjAxMiBFbnRydXN0LCBJbmMuIC0g
Zm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxMzAxBgNVBAMTKkVudHJ1c3QgUm9vdCBD
ZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEVDMTB2MBAGByqGSM49AgEGBSuBBAAi
A2IABIQTydC6bUF74mzQ61VfZgIaJPRbiWlH47jCffHyAsWfoPZb1YsGGYZPUxBt
ByQnoaD41UcZYUx9ypMn6nQM72+WCf5j7HBdNq1nd67JnXxVRDqiY1Ef9eNi1KlH
Bz7MIKNCMEAwDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0O
BBYEFLdj5xrdjekIplWDpOBqUEFlEUJJMAoGCCqGSM49BAMDA2cAMGQCMGF52OVC
R98crlOZF7ZvHH3hvxGU0QOIdeSNiaSKd0bebWHvAvX7td/M/k7//qnmpwIwW5nX
hTcGtXsI/esni0qU+eH6p44mCOh8kmhtc9hvJqwhAriZtyZBWyVgrtBIGu4G
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -----BEGIN CERTIFICATE-----
MIIF2TCCA8GgAwIBAgIQHp4o6Ejy5e/DfEoeWhhntjANBgkqhkiG9w0BAQsFADBk
MQswCQYDVQQGEwJjaDERMA8GA1UEChMIU3dpc3Njb20xJTAjBgNVBAsTHERpZ2l0
YWwgQ2VydGlmaWNhdGUgU2VydmljZXMxGzAZBgNVBAMTElN3aXNzY29tIFJvb3Qg
Q0EgMjAeFw0xMTA2MjQwODM4MTRaFw0zMTA2MjUwNzM4MTRaMGQxCzAJBgNVBAYT
AmNoMREwDwYDVQQKEwhTd2lzc2NvbTElMCMGA1UECxMcRGlnaXRhbCBDZXJ0aWZp
Y2F0ZSBTZXJ2aWNlczEbMBkGA1UEAxMSU3dpc3Njb20gUm9vdCBDQSAyMIICIjAN
BgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAlUJOhJ1R5tMJ6HJaI2nbeHCOFvEr
jw0DzpPMLgAIe6szjPTpQOYXTKueuEcUMncy3SgM3hhLX3af+Dk7/E6J2HzFZ++r
0rk0X2s682Q2zsKwzxNoysjL67XiPS4h3+os1OD5cJZM/2pYmLcX5BtS5X4HAB1f
2uY+lQS3aYg5oUFgJWFLlTloYhyxCwWJwDaCFCE/rtuh/bxvHGCGtlOUSbkrRsVP
ACu/obvLP+DHVxxX6NZp+MEkUp2IVd3Chy50I9AU/SpHWrumnf2U5NGKpV+GY3aF
y6//SSj8gO1MedK75MDvAe5QQQg1I3ArqRa0jG6F6bYRzzHdUyYb3y1aSgJA/MTA
tukxGggo5WDDH8SQjhBiYEQN7Aq+VRhxLKX0srwVYv8c474d2h5Xszx+zYIdkeNL
6yxSNLCK/RJOlrDrcH+eOfdmQrGrrFLadkBXeyq96G4DsguAhYidDMfCd7Camlf0
uPoTXGiTOmekl9AbmbeGMktg2M7v0Ax/lZ9vh0+Hio5fCHyqW/xavqGRn1V9TrAL
acywlKinh/LTSlDcX3KwFnUey7QYYpqwpzmqm59m2I2mbJYV4+by+PGDYmy7Velh
k6M99bFXi08jsJvllGov34zflVEpYKELKeRcVVi3qPyZ7iVNTA6z00yPhOgpD/0Q
VAKFyPnlw4vP5w8CAwEAAaOBhjCBgzAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0hBBYw
FDASBgdghXQBUwIBBgdghXQBUwIBMBIGA1UdEwEB/wQIMAYBAf8CAQcwHQYDVR0O
BBYEFE0mICKJS9PVpAqhb97iEoHF8TwuMB8GA1UdIwQYMBaAFE0mICKJS9PVpAqh
b97iEoHF8TwuMA0GCSqGSIb3DQEBCwUAA4ICAQAyCrKkG8t9voJXiblqf/P0wS4R
fbgZPnm3qKhyN2abGu2sEzsOv2LwnN+ee6FTSA5BesogpxcbtnjsQJHzQq0Qw1zv
/2BZf82Fo4s9SBwlAjxnffUy6S8w5X2lejjQ82YqZh6NM4OKb3xuqFp1mrjX2lhI
REeoTPpMSQpKwhI3qEAMw8jh0FcNlzKVxzqfl9NX+Ave5XLzo9v/tdhZsnPdTSpx
srpJ9csc1fV5yJmz/MFMdOO0vSk3FQQoHt5FRnDsr7p4DooqzgB53MBfGWcsa0vv
aGgLQ+OswWIJ76bdZWGgr4RVSJFSHMYlkSrQwSIjYVmvRRGFHQEkNI/Ps/8XciAT
woCqISxxOQ7Qj1zB09GOInJGTB2Wrk9xseEFKZZZ9LuedT3PDTcNYtsmjGOpI99n
Bjx8Oto0QuFmtEYE3saWmA9LSHokMnWRn6z3aOkquVVlzl1h0ydw2Df+n7mvoC5W
t6NlUe07qxS/TFED6F+KBZvuim6c779o+sjaC+NCydAXFJy3SuCvkychVSa1ZC+N
8f+mQAWFBVzKBxlcCxMoTFh/wqXvRdpg065lYZ1Tg3TCrvJcwhbtkj6EPnNgiLx2
9CzP0H1907he0ZESEOnN3col49XtmS++dYFLJPlFRpTJKSFTnCZFqhMX5OfNeOI5
wSsSnqaeG8XmDtkx2Q==
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -----BEGIN CERTIFICATE-----
MIIDljCCAn6gAwIBAgIQC5McOtY5Z+pnI7/Dr5r0SzANBgkqhkiG9w0BAQsFADBl
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSQwIgYDVQQDExtEaWdpQ2VydCBBc3N1cmVkIElEIFJv
b3QgRzIwHhcNMTMwODAxMTIwMDAwWhcNMzgwMTE1MTIwMDAwWjBlMQswCQYDVQQG
EwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNl
cnQuY29tMSQwIgYDVQQDExtEaWdpQ2VydCBBc3N1cmVkIElEIFJvb3QgRzIwggEi
MA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDZ5ygvUj82ckmIkzTz+GoeMVSA
n61UQbVH35ao1K+ALbkKz3X9iaV9JPrjIgwrvJUXCzO/GU1BBpAAvQxNEP4Htecc
biJVMWWXvdMX0h5i89vqbFCMP4QMls+3ywPgym2hFEwbid3tALBSfK+RbLE4E9Hp
EgjAALAcKxHad3A2m67OeYfcgnDmCXRwVWmvo2ifv922ebPynXApVfSr/5Vh88lA
bx3RvpO704gqu52/clpWcTs/1PPRCv4o76Pu2ZmvA9OPYLfykqGxvYmJHzDNw6Yu
YjOuFgJ3RFrngQo8p0Quebg/BLxcoIfhG69Rjs3sLPr4/m3wOnyqi+RnlTGNAgMB
AAGjQjBAMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgGGMB0GA1UdDgQW
BBTOw0q5mVXyuNtgv6l+vVa1lzan1jANBgkqhkiG9w0BAQsFAAOCAQEAyqVVjOPI
QW5pJ6d1Ee88hjZv0p3GeDgdaZaikmkuOGybfQTUiaWxMTeKySHMq2zNixya1r9I
0jJmwYrA8y8678Dj1JGG0VDjA9tzd29KOVPt3ibHtX2vK0LRdWLjSisCx1BL4Gni
lmwORGYQRI+tBev4eaymG+g3NJ1TyWGqolKvSnAWhsI6yLETcDbYz+70CjTVW0z9
B5yiutkBclzzTcHdDrEcDcRjvq30FPuJ7KJBDkzMyFdA0G4Dqs0MjomZmWzwPDCv
ON9vvKO+KSAnq3T/EyJ43pdSVR6DtVQgA+6uwE9W3jfMw3+qBCe703e4YtsXfJwo
IhNzbM8m9Yop5w==
-----END CERTIFICATE-----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         L` @    c                                           --   *                     %   : `dfeDe4ESTUUC                                                   "  \       --      !  
                 %   : @D$R"$$#2"""d%                                                                                                      ::                                                                                                                                                                               pppp ABE                 p"uf#     pud     pud     zdd    pu^    p!ua!     p"ub"                                                                                                                                                                                                                                     puz                                                                                                                                                                                                                                                                                                                                                                                                                                                                g CSUEWAPg 	DTUFWAPg AQRBTAPgDSUEVAPg AQRCTAPg CTUEWAPg AQRBTAPg CRTDVAPg DSUEWAPg DUVFWAPg ETVFWAPg CSTEVAPg EUVGXAPg EUVGWAP                            m ; L\h p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u` @    c     SD3242D_0655a00-
                 D          ,,   *                   %   : `dfeDe4ESTUUC                                                   "  \       --      !  
                 %   : @D$R"$$#2"""d%                                            LVdxp jiiiiiiijjj  FF               Lh                LXh        NV^        pppp @FABE0681257     LP^h^^^a!LP`h"bbb` NVaf"bb"``p"uf#     pud     pud     zdd    JZPZ\ZhZ    J[P[\[h[    pu^    p!ua!     p"ub"     L\]haaaa!LP]haaaa!NV]faa!  pu\     pu\     pu\     z\\                                    LVdxpjN ILNKPGOif JMNKPIQi} GIKGLELi        i HJLHMCJi        i{        i_ GJLHL@G                                                                                                                                                                                                                                                                                                                                                jACDBFAPjBDFCGAPjCEFDGAP                                                                                                                                                                                      b ; L\h p                         s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   L` @    c                                           --   *                     %   : `dfeDe4ESTUUC                                                   "  \       --      !  
                 %   : @D$R"$$#2"""d%                                                                                                      ::                                                                                                                                                                               pppp ABE                 p"uf#     pud     pud     zdd    pu^    p!ua!     p"ub"                                                                                                                                                                                                                                     puz                                                                                                                                                                                                                                                                                                                                                                                                                                                                g CSUEWAPg 	DTUFWAPg AQRBTAPgDSUEVAPg AQRCTAPg CTUEWAPg AQRBTAPg CRTDVAPg DSUEWAPg DUVFWAPg ETVFWAPg CSTEVAPg EUVGXAPg EUVGWAP                            m ; L\h p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         W  <hQ    W W   [ W         W W         W W         W W         W W         W <W         $W W         8W W         LW  W         `W 	 W         tW 
 W         W h |W         W h W         W   W         W  W         hQ  W         mF     
@ XmF    @ X     @  s0   2aH&}UD=?`m
Xd$  )P K D-  ;@P  Hm[@P@@       D H L P T \ h             @ D    D                                                                                                                                                                                                                                                                                                                              1   A  A  A   Q   1 1 1  A A A A  Q Q  A A A A  Q Q  A A A  Q Q Q Q a a   2 Q  a a      # B B  R R      # # #  3 3 3 3 3 C C C S S S S 	S 
S S S S S S S S S c c c c                                                                                                                                                                            $ ( , 0 4 8 < @ D H L P T X \ ` d h l p t x |                                            $ ( , 0 4 8 < @ D H L P T X \ ` d h l p t x |                                              "        %      $    H               >                                               0 k
   #@ D                   #                    u
(      <_jK            owo3/Sjc xdF<                 j                                          !b  ?9u 'dG>3l @`@ a@                            &y                                                                   99                                                                   t?
    ~D@  D$ 4 P$M T L 6   8    Nd       j                    @  D  H  L  @  A  B  B  B  @  @  @  A   B  B  B  B  |B  B  B  B  B   $ < P   , 0 @ d d     < L T          , 4 8 < @ H L P T X \ p x                                         $ ( 4 8 L T X \ ` d h l p    @ D H L                   $ ( , 0 4 8 < @ D H L P T            $ , 0 4 8 <      H L    @ `    8>       @+ H
2  @4  @      :     .j r    @l.-~^]93  AZ8         
       ""!     !P  0P   D  @  
  >  P  ! -yA!  A!  !           $  %       @ !A #& ' ) , . 0# 3  5! 7A 9B ;( =c ?b BE C, GL M Rn Tn Tn T                                                                                                                                    p|      W H
2  h  @      :     .j r    @m.-~^`93  AZ8    0     
       ""!     !P  0P   D  @  
  }
  P  ! -yA!  A!  !           $  %       @ !A #& ' ) , . 0# 3  5! 7A 9B ;( =c ?b BE C, GL M Rn Tn Tn T                                                                                                                                `         OH2   }  @      :     .j r    @m.~^`93  AZ0         
   @    DD     #U  0P    D  
> 
    	  P  9 -9  9  !            
#    #  " !#" ' "+""/%"4*":,">*$AJ$FL$Jl$Ml&Rl(VkH[lJ`ljelnjporvvvvvvv                                                                                                                                0  h  `      'H2  >  @      :     .j r    @l.~^]93  AZ0      
   
   @    DD     #U  0P    D  
> 
      P  9 -9  9  !            
#    #  " !#" ' "+""/%"4*":,">*$AJ$FL$Jl$Ml&Rl(VkH[lJ`ljelnjporvvvvvvv                                                                                                                                0 p  A      $      $ ( 4 8 @ D H P X \ ` d h l t   $ D ` d h l           0 H P t x | X                 $ ( , 0 4 8 < @ D H L P T X \ ` d h l p t x |                                 BDIFFa          	(           	>        	*  9  	*  q  	      W                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /  T  U U  T/ 2/xU U M ,N `     t  (M U  U R 0U 0/HB   ZO   1[O   X X xX X DW W |U U U X Y  Y lY HY A_INIT() FAILED.
  ///	8/////00/``/@@/  /  /  /  /==6a 1`ab
 vI cd@Kj& #Oe #a     * /`A 1fAc"c$"(g
 h
 `x $,
i$+eJ (3F    "c&"#V| f- (3/d|Qf" XBEBEMv +D0800EAE/56A AfH1cd2#,REE00S2 Av/D:0F /h0EAE/ 7|f`
(:% /(c/&fMl/+/+/+6A QfX%
+bB0i/jF! : N 31D  ADDDDDDDDD	D
DDDfDF!`b:bI "9 D3f/]6A f+	R A9g  J
 I 
D1C  ACCCCC
C
C
C
C	
C

CCC3/1J/13Df/16A 
bR;qf' vJj	|DW=vJjDW=|fcfC`/YJj|WLP`(: K"K3Df/ZW/-p/-4 6a qfb f
`T  	)	*)3g3"U&?&*H&JQ&jZ&zF  (|`$j+3`t%-
g/-
////j /J/ /(75/ D//@8/e;1fCQ`L%: C[l//0/
/?/(qfU'iff /	U"3V-
/$1h (/k6A h//l%|Qhak!fy"y2BBybB0r 8 :22I&IfYa"(%F {""f2fN2 f),6S92e9 2e92FiF6A 	BrTPX1wdPBY/i/	fE  5v*S 3i`h/)`E =v*S
3j/j`E
=/@1C 1C/IC	C
1CCBD@H1BC"" (1"C 6 !g/48< /14Mf+ / 4/+e 6A lRB UPX1@o mnC1P@/&/S /N/ ]T/)AA p/ AA1AA q/AAf"*%B~BAB/P <r -
/,
R vz wv
 
y/r :'7BV BU/z2DBV v$J	 	'BV BU V/ND@@6A G$ 00/e[R]/ *  1/ 9181W3YaH

"x1*'a arv	 F/NQqpAqKQk
 % /J1q 
   /_e
Ry|} /G1~ 1!/P1,Pd/&d/:Z2/taX![/RB<B PAB?	BBf"AwV=F/|%-
f///P4kU$(-
F  Qs'e-
J|4 /-
eYe\4/Y6A AtQ`$%$) $% $1u  "c,av/	"#-/	$xp1
=J|/Z1  	 /9b`/T!t",uw/qj/i,  )-Vm	`(% "/J/TQt%X *%<* x/X)   yv   
"C 3%z`/3/$""2"(0"/p"<1t 2#c)/0t(/*/D1~}|{zB/Tb9rR2"/l1g/H!	(2 "(/
g/\A 1)&&"  	C /\r,	L `D  C pf D bE/[ 6a Qx&/!  E%g8 &'t&7F&G'&Wfg 8x K{ (	/-W/-/
g '7*N f/G7FV'fFGF/<K f/:x+ '/>/E"ig3/
0b!2)r/
a                                                                                                                                                                                                                                                                                                                                                                                                                          y` @    c        SD3121D_0163a02-                       I       --                                                                                               "  V       --                                                                                          p                                 sss  ??                                                                                                                                                                               pppp ABE                 p"uf#     pud     pud     zdd    pu^    p!ua!     p"ub"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        c` @    c        SD3211D_0021a00-                 D  I       ,,                        !                                                                     "  V       --         
                !                                                                LVdxp yy y y x y x y y/y.y,  FF               Lh                LXh        NV^        p        ppp @FABE0681257     LP^h^^^a!LP`h"bbb` NVaf"bb"``p"uf#     pud     pud     zdd    JZPZ\ZhZ    J[P[\[h[    pu^    p!ua!     p"ub"     L\]haaaa!LP]haaaa!NV]faa!  pu\     pu\     pu\     z\\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       y` @    c        SD3121D_0163a02-                       I       --                                                                                               "  V       --                                                                                          p                                 sss  ??                                                                                                                                                                               pppp ABE                 p"uf#     pud     pud     zdd    pu^    p!ua!     p"ub"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     W 0W         W hW         W W         W W         W W         W LW         W LxW         W  xW          W 	 xW         4W 
 xW         HW X  W         \W X W         pW  W         W  W         DQ  W         }F 
P PmF P P    @ maz&}UD=?
Xd$  ) K D-  ;@  H    @P@ @  D H L P T \             @ D   D                                                                                                                                                                                                                                                  !  !  !  !  "  "  "  "  "  "  " " " 2 2 2 2 2 2 2 " " 2 2 2 " " " 2 2 2 " " " 2 2 2 " 2 2 2 2 " " " 2 2 2 B B B R R R b b b b b b b b b b b b c c c c c c c c c c c c c                                                                                                                                                    $ ( , 0 4 8 < @ D H L P T X \ ` d h l p t x |                                            $ ( , 0 4 8 < @ D H L P T X \ ` d h l p t x |                                                %      $    H               >                                           0 k
   <#@ D                   #                    u
(      <_jK            owo3/Sjc xdF<     !b   ?9u 'dG>3l @`@ a@                            &y  9                                    9                                9  99   @ "  3C "D DFfw@  D H f l L 6     j                 @  D  H  L  A  B  B  @  @  @  A   B  B  B  B  |B  B  B  B   $ < P   , 0 d d     < L T          , 4 8 < @ H L P T X \ p x                       $ ( 4 8 L T X \ ` d h l p x |    @ D H L                       $ ( , 0 4 8 < @ D H L P T        $     H L    @ `    8>       @+ H
2  @4  @      :     .j r    @l.-~^]93 / @Z8         
       ""     !L  0P   D  @0 
  >  P  y!                   
 $
 ( 
 *  /" 2$ 6@ :` =a @ D H K N R V Z \ \ \ \ \ \ \   	"&*+ "-$0&1(m*q.r036788888888    p|      W H
2  h  @      :     .j r    @m.-~^`93 / @Z8    0     
       ""     !L  0P   D  @0 
  )}
  P  y!                   
 $
 ( 
 *  /" 2$ 6@ :` =a @ D H K N R V Z \ \ \ \ \ \ \   	"&*+ "-$0&1(m*q.r036788888888`         OH2   }  @      :     .j r    @m.~^`93 / @Z0         
   @    DD     #[  0P    D      
    '&	  P  y!    "   . " . %+ / 5/<>A>H	?MK?S	Z_eJkrw} "   ." .%+/5/<>A>H	?MK?S	Z_eJkrw}0  h  `      'H2  >  @      :     .j r    @l.~^]93 / @Z0      
   
   @    DD     #[  0P    D      
      P  y!    "   . " . %+ / 5/<>A>H	?MK?S	Z_eJkrw} "   ." .%+/5/<>A>H	?MK?S	Z_eJkrw}0 p  A      $      $ ( 4 8 @ D H P X \ ` d h l t   $ D ` d h l           0 H P t X             $ ( , 0 4 8 < @ D H L P T X \ ` d h l p t x |                                 lW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 .  T  LV NV  T.LV XNV |NV .B   ZO   1[O   ,P HP P O N tO \NV tNV NV P P P Q P.\..	t  ....  .@@.  .  .  .  .  .  .6a ! 
 vI "  a j& "aj e  -
6A 1("X
%? 
\ e! ()., x 
	|  JJv +00JAJ  6A A t 	7|$:% .' 6a 91 s ]
rb=vJz
|Dg=vJzDg=.i2P:5Jz|g (:L K"K3Df.)p.).)4..6a  YPTEW8&&)Z(|%-
 .-
 . 78./Q u L=
%: [%:l..	.i6a aDYffe .D"3V#-
.A 1 ( .|.. %qA-9R  [ 8 &Jr:e9e
+3 ;6A AQ $%$).D$% $1	  "c,a
.	"#-.	$xp1
=J|.Z1  	 .9b`.!",	.qj.i,  )-Vm	 (% ".J.HQ%X *%<* .X)   v   
"C 3%z`..$""2"(0".p"1 2#c).0(.O.`1B.Tb9rR2".|A 1.$!	(2 "(.
.8A 1)&&"  	C .r,	L `D  C pf D bE.[ 6a Q&.!  E%8 &'t&7F&G'&Wfg 8x K{ (	.-W.-.
g '7*N f.G7FV'fFGF.<K f.:x+ '.>.E"ig3.`A b!2)r.
a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               SGMT    PT     T PU  U  T1[O  ZO U U U T U PU  >  U U P{ { U U U TT U U LT T 0g U 8g Df `b U U  ~ \_ U _     U RT U U U U U U U lU U   U  $U LU HU  T p1T PT p 0q @@  XU  U U wU 8k q q  U $U  U /U XU {U U U Lt U T T T v 8v Ds t dv I U      @@?            ~    } hw (w w  } (| < x  x x { y | ~  ~ ~ ~ U 8U   U      ,  t     P         T $T  L  @ ` P  U U |      *T    @      > U 4  H  H    
H   	H  H           HRT H    !B c0@P`p)Jk1s2R"RBrb9{Zb$C4  dtDTjK(	S6r&0vfVF[z8HXhx@a(#8Hi
+ZJzjqP
3:*yX;l|L\",<`A*hI~n^N>2.Qp:Yx-No 0 P%@Fpg`=^"25BRwbVrnO,4$ftGd$TD_~<&6WfvvF4VLm/DXeHx'h8(}\?uJTZ7jz
*:.lM&|ld\EL<,>]|n6~UNt^.>Test still running, forcing stop, please try again  
    U PU  U L               \     8    l   @   ] 4  o6a ! 
 vI " a j& z"k e 6A QBR2%I3B%2eI"e   6A aB&R&82f)-
    foT('-M
1o.	  ]"%1    "]
o !Q	A
1 q
C i'4#   J B "$WoHdo5a o-C X&5)F  )9&o|()MR e)xD h)ypci)9ToJHVo{  oX'( (o ')"o4A Z2jZV(RzUU6a$;grS k$; $: yC$
 op
oX{!K	2k%

zB 2(coUoDi%oa6xb%]
F6e (coLro1"SMo81BM@*@\@@0DU0PPP"0  @"   o6oD h(  ,+%B D"G vBooDa I!I)9hX-2@3<  E h`CC B@FCI@fztUX l -
o=6A L(7(
oPL,aQ + LIR B %:oL\]ADfTJDgDeDd$DadDcdTK<[%x TLL,%; koT!r
" ' 'lo`+"o`b	_= 'ht\%of``1Pfskv ]
oYW
ooweK3D$	 (ove 6a Aeod1  
   K'%XSo  _WooHY#" idC=*< `Sv
 '
oKF2 ^nn^ ohLC K o9o-odZWo  Wwo(o=oLy}Y=V&7]Woo<CS	o| o
+mZ$ 
ZS		V.!)S sF	F
)Y		 I 	V  
co9 ,Q*PR (; +* ,(;Y!  &&+)&;K&KQ&[+fk	uVgo	aF!
uoMT o9F4L! (;o
<, l(;yA o{,cUk1o}
1o*wyp+C
o[oFo=eu%xAFo$*o\f
%oIo4Q	
1GoBm!%1    zy	x f%!181(j+KfK!F oBK3DA1 # 14!20iK"K3g	#__{oS 6AotA q"b&%BG9RW?EoF 2fpK9p=9p#9pI9p)
o 3 &o	'o"
# <Q# A 	a X-vb"2R
R",- !Z$Z:ZfZPZ|V o(   % # ",GX!"  "i F  e ##f  $%oo$oN" #oFo	|o|B'04 PD C  Bgo	(	
%ooH]&a)v HA2 U@3000t`32 " #0  o
0)@E)R	 me0CF  C#fv xAR fpU0PPtURoX%oX3	o\ o\oF\o0*o0X5)o0o0*o0	o0o0hy	pcio20Q+o,o,2eo,o	,+o,R&o,o,o,,(oJ,-"hs*KKco\%oZ!*oZ"+e6 %Fo[2o["(c.o[o*%oL%"e2* @ 5%e .oOo\*h,o(/+*%AB eAoo# o
oo oeo*o
o-7-o^R BQ0a rp B&: *A1DODNDIDKdDLT>\^DMfJY7(SGEE rDGDMDLDODNL<T>T?<[2%T@o@&;o@o@3EEE AE6A 1*4##X
+F& 'mo	=;o<%&RB q5Zap' 'hj%%#	RU\,PP1Us!oK"D$pT-K"Woo+B!*D
@l"bGBbB oh
rJ 3y
  2j : ` V3% e6a M(\[!
oST

V (,Q*q U';UoU*';,oP	&M	&K~fkuvo	\B	B
"j

J
V
D  DoUu['T6o47LoJoJF,l8';J9o5o.McU!,-	CoUod8un6A :(o "v  io|Zoooha 2A:?
$ *" "  1
	
k0I
Y	V	o|oM.$oM
"oW  1ZFo:
 RB
	J (oBohoj;(oZoodb HKo<G ! ":L 1:=># 6oMo7
1o8#o,#Loo#  ?1@ QBACr!A9i74eofof%~"z3W o>D j(fo6E! 1;"oe"FoV
;o(oZIib{`C  }@C#hjgo&XoX]IL,H@pta rI &;oaJLo:A\\oHK5%U"oR,     X*(  V%Boaf'oPF oFhL,e!V#oO+oT1J"cola  A  $: !LRVL,$:2Ro3J\X<B$B&B'CCB%R C <[CMCL,R,$;N :+L:PO!L (o`o!8oEoEoEoEozqJ'g go6*%%59@a ]
&;o W
oR+(&orK*og%fC	C
o0a -fD1 #o<#G+oo(o(<o(#G;o	(A &f#
(o'%o
6AoI6A % tQ(coN  ot:" f*J*%":  o:o* 6 Reo
?Se'TZoo^,o1: K!1#A VUqXWQa#o#oyQY$o o	 A[H(oA	
"BBBBBB	B
BoT[8HBB@XARB	PhAbB
`xArB)o| 
H =
%2DGo|%o*oj  0 [
KIII I-
oX[(o>oT[\ 
rkq1]:"oOoQmH*]0D e[\GI i
Fo@a oo}o!3 Na1H:oo
To	]oe1"VI1q]X*pU q^=p{[o1\!@WY{)G*)
1, Iou!oCF*1("IF1	1o\[ !ovq^a\1!0A(A HAL2LBL"LA_@X="eoPARJAJJ@AJ p `   
@#=
:X	VX1![@#G
ooo[; p `oV` No
  
*o)q[ 
o-1!0(A2I HA@XA"IBIA_RI@X\=	a5@mff "%	o+PARJAJJ@AJ  i
@#=
:XVu o	TX
e1![@#GoGoG` H    *oop@B2To1[)8)H)XAoX  )
 A AAAA"H AHHHKLL"L L%o[_.oQ AA"K AKKKK AAA"L LoW{`  L`  YoioohRq\a[B!boz G- , 	V)	o+wjo	b  ,"o(  " gmQ  Lo',o"ocj, L|	
F   37-"  bo (olAof
oo
]o"o ac  d+   ke  k	  rhfLWqbo3Rfo8ob,  go{o"op![(oo
 , lA 1obc,$o'$!f o!$$oo`o Z9[(K g  o	lo0A[1 oE`o8lmkjihjjjjjj#;oPn1pvutsrqo 2rbRB9"w1x[9oT]1ya eBE &8E XVEb:&xQ&)&&9olB[R IB("o,oq 1\ioUo8o	Bi  )o@o]ooDy("o^$$o^z"oV(($  1 oTAy]H	  oTMS -
 oSo$z8o5o.A:"i$o0o\
  1Yoc
 ` J 
,o4&):f
, F$ooa qy("a:P
&o[:"o\	]	Hi8cG	(o\]HcF (oLV#olop Ay!8a:2I ovo
|
3 3001\\^oJF o]V^  od p M ]
o	S&)f +*o\o'f*,!o7o4 f.RUP Kf>o ;V
	,% &orolRa &3

Fo Mo,KoB&:&3,L IIE9e o9eyoBoLwwoo|(o|yA:	$))o*opo'
oC$o$o5$oo ay(oQo%:oooA:$))o oYoX$ol
$oGosos o
T{+"$Q+$+%QQoKo1yAo^"oodoRVXLa p &;] B"]]]Jr]F oXX2";UPRAU  -RnR]" (oZ(oo"(+o;o 1iony-!;&o_&, o+o& &+'+( +)(i \J' \oB HhY -VoX8co"AyHR$Y"doLo"$rdYoq6A o2#oroR (;o<: S C (oJ6a Q 1o1B#@@t  2#%:00t dy: (
jo;%o	Z6a fWo	I|	f*o2J oj  *o  *o*  oI(do
odqo#oy!o)")o0owMow!owo*,   "jol
|"ozo!yVo o}{~ZZZZjjjjjjjj#j$j"jjj'j(jj&1ox1y9bBR"2oDzHo)y#+	k)y	VF  I9	2koxo'h (Go(ro	P1y,9+%o/o  @ .zj	 F    
oIod1 Ay# -
* 
+j#ojo$(#A$ 2R"BoQoNay[o|o|Kq ' RI*KoBI+Ko o[
= dI,own
	,o
:o4:(o7oo
 o !y((o<Ay
)8<L ('	,]L )(Q:&f"#f%,oF oo}%oof3oo)oy,r,o ,$o[	jjo,1y8ccc c!"c%co0V!o`Bo|
obK1"fc s$"f$ooD "~oh;o
K" "o	D 
A!-2. 2NB$/I>2~@"012N"}  ^	Am  	-N 8o?o,o%oKoIo
eoq,`p   XUUoY`cpfo @ T @ DPD QoeoD @QR v%o/aDpx FoLfo7rf,o\  of	o	@ @ UsooPRf,o4	oJ	oL('f;&BfK	f2	F	6f
f"i-	A $o>)Q&q&"$&28fB%
 i$Ro5o_oo ooo3oT1 &))#dKoZ#cKo?J!#ooo	!A $dKoM2K!oo~2KAoD 2Ma9o$,oXU oAo'2do$oR%UU oIYo8! "#j :):M!(o`Ho "o$o6ot coY+w"o) o j*:	+LAo
fo\o09ooW +Na,g oo f(J9XoW1 #ol#o baD-#o
RIa#  oFooAV$o
=)$RIAo	t r$o:$oH%o?$o? ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              L` @    c                                           --   *                     %   : `dfeDe4ESTUUC                                                   "  \       --      !  
                 %   : @D$R"$$#2"""d%                                                                                                      ::                                                                                                                                                                               pppp ABE                 p"uf#     pud     pud     zdd    pu^    p!ua!     p"ub"                                                                                                                                                                                                                                     puz                                                                                                                                                                                                                                                                                                                                                                                                                                                                g CSUEWAPg 	DTUFWAPg AQRBTAPgDSUEVAPg AQRCTAPg CTUEWAPg AQRBTAPg CRTDVAPg DSUEWAPg DUVFWAPg ETVFWAPg CSTEVAPg EUVGXAPg EUVGWAP                            m ; L\h p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u` @    c     SD3242D_0655a00-
                 D          ,,   *                   %   : `dfeDe4ESTUUC                                                   "  \       --      !  
                 %   : @D$R"$$#2"""d%                                            LVdxp jiiiiiiijjj  FF               Lh                LXh        NV^        pppp @FABE0681257     LP^h^^^a!LP`h"bbb` NVaf"bb"``p"uf#     pud     pud     zdd    JZPZ\ZhZ    J[P[\[h[    pu^    p!ua!     p"ub"     L\]haaaa!LP]haaaa!NV]faa!  pu\     pu\     pu\     z\\                                    LVdxpjN ILNKPGOif JMNKPIQi} GIKGLELi        i HJLHMCJi        i{        i_ GJLHL@G                                                                                                                                                                                                                                                                                                                                                jACDBFAPjBDFCGAPjCEFDGAP                                                                                                                                                                                      b ; L\h p                         s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   L` @    c                                           --   *                     %   : `dfeDe4ESTUUC                                                   "  \       --      !  
                 %   : @D$R"$$#2"""d%                                                                                                      ::                                                                                                                                                                               pppp ABE                 p"uf#     pud     pud     zdd    pu^    p!ua!     p"ub"                                                                                                                                                                                                                                     puz                                                                                                                                                                                                                                                                                                                                                                                                                                                                g CSUEWAPg 	DTUFWAPg AQRBTAPgDSUEVAPg AQRCTAPg CTUEWAPg AQRBTAPg CRTDVAPg DSUEWAPg DUVFWAPg ETVFWAPg CSTEVAPg EUVGXAPg EUVGWAP                            m ; L\h p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         SGMT    PT T     T  U 0U  T2T T2T 9 ; P{ { `     t  z U  U | 0U TPT     U 0U  ] :  .6a 1 
 vI # a j& #jj   -
  6A 1A)C$
 .	. x $,
i$+eJ (3F    "c&"#V| f- (3.g.h|Q" XBEBEMv +D0800EAE.AH1d2#,REE00S2 Av.D:0F .h0EAE. 7| 
(;% .(c.&Ml.+.+.+6A QX%
+bB0
.jF! : N 31D  ADDDDDDDDD	D
DDDfDF! b:bI ": D3f.]6A +	R A9g  J
 I 
D1C  ACCCCC
C
C
C
C	
C

CCC3.1J.13Df.16A 
bR;q' vJj	|DW=vJjDW=|fcfC`.YJj|WLP (; K"K3Df.ZW.-p.-4 6a qb f
`T  	)	*)3g3"U&?&*H&JQ&jZ&zF  (|`$j+3`t%-
g.-
.... .J. .(75. D..@8.e;1CQ L%; C[l..0.
.?.(qU'iff .	U"3V.A6A 1 ( . ..l%|Qa!y"y2BBybB0r 8 :22I&IfYa"(%F {""f2fN2 f),6S92e9 2e92FiF6A 	BrTPX1wdPBY.i.	fE  5v*S 3i`h.)`E =v*S
3j.j`E
=.@1C 1C.IC	C
1CCBD@H1BC"" (1"C 6 !.48< .14Mf+ . 4.+e 6A RB UPX1@ C1P@.&.S .N  6a ]T.)AA . AA1AA .AA"*%B~BAB.P <.^-
.,
R vz wv
 
y.r :'7BV BU.z2DBV v$J	 	'BV BU V.ND@@6A G$ 00.e[R]. *  1. 9181W3YaH

"x1*'a arv	 F.NQqpAqKQk
 % .J1q 
   ._e
Ry|} .G1~ 1!.P1,Pd.&d.:Z2.taX![.RB<B PAB?	BBf"AwV=F.|%-
f...P4kU$(-
F  Q'e-
J|4 .-
eYe\4 ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      W  W         W  W         W  W         W  W         hQ  W         2aH&2aH&D H    tW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
             0  	            @        `  `     J       J      X       Y      g       h      v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   # NVRAM file for BCM943430WLSELG
# 2.4 GHz, 20 MHz BW mode

# The following parameter values are just placeholders, need to be updated.
manfid=0x2d0
prodid=0x0726
vendid=0x14e4
devid=0x43e2
boardtype=0x0726
boardrev=0x1202
boardnum=22
macaddr=00:90:4c:c5:12:38
sromrev=11
boardflags=0x00404201
boardflags3=0x08000000
xtalfreq=37400
#xtalfreq=19200
nocrc=1
ag0=255
aa2g=1
ccode=ALL

pa0itssit=0x20
extpagain2g=0

#PA parameters for 2.4GHz, measured at CHIP OUTPUT
pa2ga0=-168,7161,-820
AvVmid_c0=0x0,0xc8
cckpwroffset0=5

# PPR params
maxp2ga0=84
txpwrbckof=6
cckbw202gpo=0
legofdmbw202gpo=0x66111111
mcsbw202gpo=0x77711111
propbw202gpo=0xdd

# OFDM IIR :
ofdmdigfilttype=18
ofdmdigfilttypebe=18
# PAPD mode:
papdmode=1
papdvalidtest=1
pacalidx2g=32
papdepsoffset=-36
papdendidx=61

il0macaddr=00:90:4c:c5:12:38
wl0id=0x431b

deadman_to=0xffffffff
# muxenab: 0x1 for UART enable, 0x2 for GPIOs, 0x8 for JTAG
muxenab=0x1
# CLDO PWM voltage settings - 0x4 - 1.1 volt
#cldo_pwm=0x4

#VCO freq 326.4MHz
spurconfig=0x3 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          P   H    P  
 P  
, 0   $ 0         t     	  :          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                       H	                   x   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@- @ ` p  				@-   @`Do`  @/xG  @-    @/6   // R  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G      &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    xH&k(\[ D    &rJ !` qHQ``qOY87oH Y2   (	kHi  !C   %fO(9Y .dH Y &   aH Y`H Y
 (	WHUO?8h((PO8h( SOC(9YQH Y  (GH h((;(FCNCHN8EhNAh &Hy (<& %A<Hh@HY(?H Y '=H Y<H Y (:H Y (& C1HY(0H Y /+O  9Y*H Y"H@hG2 @B - O9YO8"HHq8BhyCJ2q &H8@hh 6BH !!& -H !`A``` ( 0     
      d < ( x P    @  I HapG  pG    pG  pGpG  pG  pG  HI@AApG       !H@pG  pGIH!pG     !bpG!cpGJI:   
      !HAc !AbpG!Hj@pG  pG!b!AcpG!pG!cpGH !!pG  IpG    Hy!@pG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @    pGI pG@  !bpG!HapG!	  ` !A`H!A`
!`L     IB     X038IK
CI`#Kb*JbJb  HbHjHj  CHj  
IjC	CpG     xG  @-  @/    =     Q   i  -   Y  !          I   y  9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             P   H    P  
 P  
, 0   $ 0         t     	  :          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                       (	    x              x x   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@- @ ` p  				@-   @`Do`  @/xG  @-    @/6   // Ry  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G |     &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    yH&k(\[ D    &sM !)` rHi``rOY87pH Y2   (	lHi  !C   %gO(9Y .eH Y &   bH YaHy!@	YOVH8 h((RH h( TOC(9YRH Y  (IH h((;(FENDMN=hhNih &Hy (<& %ACO=H9Yh(@H Y   >H Y=Hy!@<H Y (& C(9Y2H Y  (-O  9Y+H Y#H@hH4 @B -"O9YO8"H 0Ip9JhyCJ02q &I9Hhh 6BI   1 & -I  `H``` ( /       
      d < (   P  @  I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGJI:   
      !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGH !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapG!	  ` !A`H!A`
!`L     IB    x X038IK
CI`#Kb*JbJb  HbHjHj  CHj  
IjC	CpGx     xG  @-  @/  m  1     E   ]  %   M            =                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   P   H    P  
 P  
, 0   $ 0         t     	  :          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                     <      x         <     x p   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@-  @ ` p  				@-   @`Do`  @/xG  @-    @/6   // R  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G      &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    MH&k(\[ D    &GJ !` FHQ``FMY(7DH Y2  (	AHi  !C   %<O(9Y .:H Y &   7H Y0H.O?8h(( .OC(9Y ,H Y  ("H h(($O  9Y#H YH@hI  `H``` (OH9Yh(H Y   H YH Y (& C(9Y
H Y  (  x   
      d < ( P  @  I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGJI:f   
 x     !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGH !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapGxG  @-E  @/    } 5         q     e =  = = = -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          P   H    P  
 P  
, 0   $ 0         t     	  :          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                     <      x         <     x p   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@-  @ ` p  				@-   @`Do`  @/xG  @-    @/6   // R  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G      &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    MH&k(\[ D    &GJ !` FHQ``FMY(7DH Y2  (	AHi  !C   %<O(9Y .:H Y &   7H Y0H.O?8h(( .OC(9Y ,H Y  ("H h(($O  9Y#H YH@hI  `H``` (OH9Yh(H Y   H YH Y (& C(9Y
H Y  (  x   
      d < ( P  @  I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGJI:f   
 x     !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGH !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapGxG  @-E  @/    } 5         q     e =  = = = -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          P   H    P  
 P  
, 0   $ 0         t     	  :          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                     <      x         <     x p   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@-  @ ` p  				@-   @`Do`  @/xG  @-    @/6   // R  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G      &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    MH&k(\[ D    &GJ !` FHQ``FMY(7DH Y2  (	AHi  !C   %<O(9Y .:H Y &   7H Y0H.O?8h(( .OC(9Y ,H Y  ("H h(($O  9Y#H YH@hI  `H``` (OH9Yh(H Y   H YH Y (& C(9Y
H Y  (  x   
      d < ( P  @  I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGJI:f   
 x     !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGH !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapGxG  @-E  @/    } 5         q     e =  = = = -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           H   @    P  
, 0   $ 0         t     	  ;          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                     <      x         <     x p   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@-  @ ` p  				@-   @`Do`  @/xG  @-    @/6   // R  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G      &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    MH&k(\[ D    &GJ !` FHQ``FMY(7DH Y2  (	AHi  !C   %<O(9Y .:H Y &   7H Y0H.O?8h(( .OC(9Y ,H Y  ("H h(($O  9Y#H YH@hI  `H``` (OH9Yh(H Y   H YH Y (& C(9Y
H Y  (  x   
      d < ( P  @  I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGJI:f   
 x     !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGH !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapGxG  @-E  @/    } 5         q     e =  = = = -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  P   H    P  
 P  
, 0   $ 0         t     	  :          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                     <      x         <     x p   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@-  @ ` p  				@-   @`Do`  @/xG  @-    @/6   // R  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G      &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    MH&k(\[ D    &GJ !` FHQ``FMY(7DH Y2  (	AHi  !C   %<O(9Y .:H Y &   7H Y0H.O?8h(( .OC(9Y ,H Y  ("H h(($O  9Y#H YH@hI  `H``` (OH9Yh(H Y   H YH Y (& C(9Y
H Y  (  x   
      d < ( P  @  I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGJI:f   
 x     !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGH !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapGxG  @-E  @/    } 5         q     e =  = = = -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              	           P   H    P  
 P  
, 0   $ 0         t     	  :          @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   <   <   T                       	   	               	 x   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@-( @ ` p  				@-   @`Do`  @/xG  @-    @/6   // R  xG  @-P  @  xG    S  xG    /	 xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G      &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    H&k %(#\[ D  &}J}I	i)yI 1`M`xH`xOY8.wH Y)   (	rHi  !C   %nO(9Y .kH Y &   iH YhH Y (
_H[O7?8h((VO78h( YOC(9YWH Y  (MH0 h((<(HHNHM6hhNNih &Hy (>& %CAH0hFHY(DH Y 'CH YBH Y (@H Y (& C7HY(5H Y /1O  9Y/H Y&H0@h98 @B -%O9Y!O8HJ 2ChryCK03q &H@hh 06BHJ  ! 2!& -H !0`A``` ( $    	   	  
  	    d	 <	 (	 x	 P	  @  I HapG  pG    pG  pGpG  pG  pG  HI@AApG       !H@pG  pGIH!pG     !bpG!cpGJI:   
 	     !HAc !AbpG!Hj@pG  pG!b!AcpG!pG!cpGH !H!pG  	   IH	pG  	 HI @y!@pG	   H!H !!pG  	   IJ	apG	   IJ	HapG	   I pG@  I@  pG  @    pGI pG@  !bpG!HapG!	  ` !A`H!A`
!`L `   IB `  	 X038IKJCI`#Kb*JbJb  HbHjHj  CHj  
IjC	CpG	     xG  @-  @/   = i    Q }    % Y     M %  % % %    I u    9 e                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          T   L    P  
 P  
0 0   ( 0 $$           t     x: `    l     @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   T   T   l                     P  	       	        	   `           P      p   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@- @ ` p  				@-   @`Do`  @/xG  @-    @/6   // Re  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G d     &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    VH& h(\[ D   &OO !9` NHy``NMY(5LH Y0  (	IHi  !C   %DO(9Y .BH Y &   (7O   :H Y3H?"  9  (8h(( C-HY(,H Y ("O8h(($HY  #H Yxh~O  8`x``` (HOYh(H Y 'H YH Y (& CHY(
H Y /  l      
      x H 0 ` K`ab @*o I@1`h (`pG       ` I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGp$M "	K4 ! (@ X@ @ 1) .h2BpPp pH	NhEh<"1(   ") 1" p   
      !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGpG  H  hBIR @9iiIH   @  
 pG  I`H!@8Aa !apG  @ pG  H !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapGpL #&hx l@ 4Y1`@3Bp   xG  @-   @/i 9    e  A   1  ] 1    = E %    9  5     } =   ) i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            T   L    P  
 P  
0 0   ( 0 $$           t     8 :      l     @ P  
p  T
 @ P 	PP`V((n ( (pDpD 0 0B p   `  R  0  @ 	@@PU(^A (pD   T   T   l                     P  	       	        	               P      p   pGpG GGGG G(G0G8GxG   R    
0 \ 004 B040c  
 Rt  :1 S  
  ,4 R<0*h  ,8 R80*`  ,< R40*X  xG  /xG  P<   @
0 `@- @ ` p  				@-   @`Do`  @/xG  @-    @/6   // Re  xG  @-P  @  xG    S  xG    / xG  @-  R  :P(P(P(P(  R"*P(P( H H@0$0$// D0$$ D0$$/   G d     &HiFxD          !     !b    Aab !     !b     !b     c                (1G      G     xG   V4/	   &  xG  /xG  @- @/ G    VH& h(\[ D   &OO !9` NHy``NMY(5LH Y0  (	IHi  !C   %DO(9Y .BH Y &   (7O   :H Y3H?"  9  (8h(( C-HY(,H Y ("O8h(($HY  #H Yxh~O  8`x``` (HOYh(H Y 'H YH Y (& CHY(
H Y /  l      
      x H 0 ` K`ab @*o I@1`h (`pG         I HapG  pG    pGpG  pG  pG  HI@AApG       !H@pGIH!pG     !bpG!cpGp$M "	K4 ! (@ X@ @ 1) .h2BpPp pH	NhEh<"1(   ") 1" p   
      !HAc !AbpG!Hj@pG!b!AcpG!pG!cpGpG  H  hBIR @9iiIH   @  
 pG  I`H!@8Aa !apG  @ pG  H !!pG  IpG    H! !!pG  IapG    IHapG    I pG@  I@  pG  @  I pG@  !bpG!HapGpL #&hx l@ 4Y1`@3Bp   xG  @-   @/i 9    e  A   1  ] 1    = E %    9  5     } =   ) i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           You are about to report a bug on a firmware package.
This package does not contain any drivers and is probably not responsible
for the bug you have found.

If you want to report a bug in a Linux kernel module, use the 'modinfo'
command to find where it is installed and then give the filename to
'reportbug'.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           The binary firmware may be downloaded from
http://git.kernel.org/?p=linux/kernel/git/firmware/linux-firmware.git

Files: libertas/libertas/*, libertas/mwl8k/*
Copyright: Marvell International Ltd.
License: Binary redistribution (Marvell 1)
 All rights reserved.
 .
 Redistribution. Redistribution and use in binary form, without
 modification, are permitted provided that the following conditions are
 met:
 .
 * Redistributions must reproduce the above copyright notice and the
   following disclaimer in the documentation and/or other materials
   provided with the distribution.
 .
 * Neither the name of Marvell International Ltd. nor the names of its
   suppliers may be used to endorse or promote products derived from
   this software without specific prior written permission.
 .
 * No reverse engineering, decompilation, or disassembly of this
   software is permitted.
 .
 Limited patent license. Marvell International Ltd. grants a
 world-wide, royalty-free, non-exclusive license under patents it now
 or hereafter owns or controls to make, have made, use, import, offer
 to sell and sell ("Utilize") this software, but solely to the extent
 that any such patent is necessary to Utilize the software alone, or in
 combination with an operating system licensed under an approved Open
 Source license as listed by the Open Source Initiative at
 http://opensource.org/licenses. The patent license shall not apply to
 any other combinations which include this software. No hardware per se
 is licensed hereunder.
 .
 DISCLAIMER. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
 CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
 BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
 INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
 OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
 TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
 USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
 DAMAGE.

Files: libertas/lbtf_usb.bin, libertas/libertas/usb8388_olpc.bin
Copyright: 2006, One Laptop per Child and Marvell Corporation.
License: Binary redistribution (Marvell 2)
 All rights reserved.
 .
 Redistribution.  Redistribution and use in binary form, without 
 modification, are permitted provided that the following conditions are 
 met:
 .
 * Redistributions must reproduce the above copyright notice and the 
   following disclaimer in the documentation and/or other materials 
   provided with the distribution.
 * Neither the name of Marvell Corporation nor the names of its suppliers 
   may be used to endorse or promote products derived from this software 
   without specific prior written permission.
 * No reverse engineering, decompilation, or disassembly of this software 
   is permitted.
 * You may not use or attempt to use this software in conjunction with
   any product that is offered by a third party as a replacement,
   substitute or alternative to a Marvell Product where a Marvell Product
   is defined as a proprietary wireless LAN embedded client solution of
   Marvell or a Marvell Affiliate.
 .
 DISCLAIMER.  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND 
 CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, 
 BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND 
 FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE 
 COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, 
 INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, 
 BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS 
 OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND 
 ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR 
 TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE 
 USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH 
 DAMAGE.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ms5eE f{XR-Je-@Hreh4ns#D2L6#il/0_!$zC&?,&D<(#3FK*$H70q6 d`nItl Z4]4& oS!ywb#a[}h x@d<$H[{}sqGRk$3xBM`%?	Sm ,`!d-qBqoG`Z S&C$HMBEP%AC)&^G-4&m*`8 e,6uw`;}tDzyp|3=!w@Gy*~V
ci}L>a4~6athnPA)i4jV&+^m4fJ@ZQ5|0P#K1\	c@r=4fW}82"Dcd;Tb IK$ps5|_'e:|d< JY\Su38&O`\y*;SX<'(N4x"?oqz."9=O3 EZr?iJ1;2XY	xW8{(;#:D\ -W2q=BT\%&_	&&KkR=^b~(@|j-*%dk@-`KOGtqNjrL`rmGpWIoJyvK5[nhm<!ppzTK3W +}w\u\~,/ZpQp5j3U,h7~EDL<}\n@|RR))?Vx_VL^R%	Ar\g&i6{(2a s	1|ID<}xpk@O1>f8OaJsvh>W|NArwY]t<	teU
?87&Wb*w &P6ibVv'E Y6F-w|Y=p@`jGdp{d#['[j0B} 3uoSHoP@@U_}iyq4Xq@-ZvF~[U<orWk)zl49	
\0X
`>:#JkkdH`H'Q*}/Y@}| D@h45 #8Q=D6I,qhl;4,Yl(,4FbOarq)cORq\_zr-D'R?8|*1B#,l{: 9\-@~_a2`Iv<W\FnyB)&  <#QTq>Ks0O6a:C=Eg8{I!6O,qy!6ECK0:Ly=]yS'o!G M6@FnPt!JoF4
9)-?DI8=`<+Q?{6I q`"^BykBC p+ 6'i!d_lhCF;%	?j1:Y^
I(8,oD=i]tjDEA=83%99YM7M}:X4v]iK
;BBCXdtcR9k@4gAt3t
,{Z(*WG/^	`Qd~
5:V_z+v?NDvvQqtU|j\#C	(7+gphygf6Sc:FU|&zf\$Zp(1815)X!Mi^|clk-vwz);5RM xLu(+_}'T<s`	^[0*&_&6&5V1=j|`5ROK lzV|mUnBjF 7PF;\mES2;71Q#lT=x:Dgn3.
t9[3;]@kcNVgx/k*uDE YCn,[E/VO2IV3!VnptGOqzZ.!Xx,rT$$<B]!m^xJMox"pb_":(f!%NOR'( r@UhA:r8'%V8.*,%C!5:L )b+#d9XDV5.'9"\Ny,]TH-]ebrhp7BWecC`46Ix^Dn,kP	@QcMC^Q\=VdiU{@Z%5 +<JdG\Zg w*K6(Eg9ABFwt-lC1VUoSTZyB q)|bb%wJAXv	]]cZzMCs ;o(efD$C-(WWdwg2`Y"X("!!}4WsO)}Bs_|1h=.&;&gNjj Wn!\`ZZ'ddsu\kRUUa~4X`fbw7VoE9H+)ke@$6zckYM\nY3WC,|x,c1y> `	[ [Ls"t8)@5VQ2 D9, e/-~$|zSCicRo ydGg[\zI)k: *D:Wp:^"o_Y+qa@ (K;HTj?B(otybU,=)JqtU:jd3?ci9 U8>XE"@]} 7	v;"{e{_F9T+<@"(Xm-qC9@DiVI7u_VRU-L/UM{J!911Psu)+=nku8cT
>Qu}Ur  JwWZG0{3"/l\q:FKEu98UW) OYn!O1&iP[FMU;`5uefuLRVMn&`K\g5Dc:`!YxG#E'Xcti^8EB({SA$nWg#/>?a8?gi\7[
k80qhvn7H.M_S<)}OmLKm|@2 Y<;P{h;Cwwnp7kMoe,iZalW\J$9^P]mC%3E.$P[Ue{mp' wZu`(eXBC?~>OKd]=2/.0@
/[Y[(7Lb-y2>FXLkLv:13x)suTwu/CWR%\ma	^N]V)N+)Z[<(@ C<
"Qn=J`^,Y'x8(CPn58iVeMEp_q4uOJuJ'zZ[-X\qx@BjV\H^=+*L)mdaPZ3J7b;e6@8++w@8zpO"'p^aV+]`/3miLI(<vdl1;o?.p::@bp\.I<Sq}SZJ)rF_.oEG7i{nHrR`; vLW0=q$.[#!2)
[E|o_n;Do.&C	/42:p}riYK8+R	D/$
U~AG9a2 'yE)pWy0Z8xQ}c9kM@TOd*5(CLnnz$HVh9(7lJ6telR+JLf*|w,:ds\G[;80Z-S_"g&k0<"!sK$I#$XaC 6$$!N~Y4d(H^S"!PSfPU{DSO~
ig;Gj?(-V|qG )YZzW8jgWbGgbrcet]8~w+p*qxQvS`E U;(?{	I]z&_z]$A=Ij4Pb	Cc#>lDBc5lknoNCQ6>@d85T=k{6T'!k!gjkWa]Ckq/RI
vT)\-]W1[f>	l`}wsHv73(9C]RCU:SKZ5 J]XJ:,Le9>Mf0_VJd MfYO;Wm-fYs|&DV"^*lWpuOe_k_EjEnV6Xin@D'~/3CR"uvm]p7#ZE>1&8| ~QKg\
9&d9wlwx4gm@v+aK^HyG
1X3N -Q<"iO MhrN7%Sh
Da8tCRJ&FBmXdW
zTt<t:}?rP^TC)kUb}yoEgpW0q@x2c&o[3KcA<LJA AD\x0M6u^<J]=9:`hluY_tT.,,:
*H0I%ftP9DPdBOe<]4?L8IOiX4c?L6WAfDS/ iY&FcSl^2RlJ]_q0.++hyiEQbK]*MU*"fbju*`sZ,W*;Q~IX$&Y2=	/.)E/zZDF~h$gLqRGk	 *0-6smm^?Vs6_r@1KkEE<~_:uu~6X.6_g
Db9Y"'t: tr0@M`D"Vgas|W$AHrS7b.paCw2xh\%0!2?Xo_rV7+),)`R/41M|N}LLwh~,="B1_:QkqKPY.B+i?Hw5_B$q%gU9_iQ18_fwCQ~[4>GDWHyA8zIEzcb?n`N5$p;kgx6s$^.^=`XVF6]a"-T~4>.n|!cq5; H+({-YI1JI[Om
S6=|2pQ[IPc,J&J5c!RV,DMg9vqr*bFB,:pBs0">;0sY3eHw=	r%}ykz S~:v*},-sf aaO%+6% \}y	{Uzk^&?sZs\y`gftsaU55G	w=_> 7A>1"P.<8a;8w<z,yI1R?ina"l0RlIs4AF3lZ}{
eSy ;D(^p/y|	~=3}J[$i\@-{%uzsG"UpkA"/`&M0MUS 6#0CL^{v.rHkmu)oh%~k\y 2C/UC}Ju'/xs3il.GjH%2.D,FfhA oqgtZTrGF`E.	%0\SGQ*
A~stO }~vV,P~]l@7,7\{n`jgP9Dk\WE!6j>(ZIH{X&i7vn.8O9tb*Cn=bg-Hwl5a`^T*@#0Le,+sPY&4+",x_/2WA @|h~"=]	LN{[?q#R[.&WG}%|U9onoD(q+^lU<U]*_:#LAFq `dBCGM3!^pv !/f85H k4hO JU()E]uOS TM(NB/5\29&\&L7^oqs3@W	zjUxZ"rFv4}-.N1l:	T,c	irQe ro?
'g_1@`RNql	q1}WN#[~Sy6@e-mG|p~D`EB,dp=-sPf1g}+Mv])MqG[#-8
gr;:p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Package: firmware-libertas
Status: install reinstreq half-installed
Priority: optional
Section: non-free/kernel
Installed-Size: 5010
Maintainer: Debian Kernel Team <debian-kernel@lists.debian.org>
Architecture: all
Multi-Arch: foreign
Source: firmware-nonfree
Version: 0.43+rpi5
Config-Version: 0.43+rpi5
Replaces: libertas-firmware
Provides: libertas-firmware
Suggests: initramfs-tools
Breaks: libertas-firmware (<< 9.70.7.p0.0-2)
Description: Binary firmware for Marvell Libertas 8xxx wireless cards
 This package contains the binary firmware for wireless network cards with
 Marvell Libertas 8xxx chips supported by the libertas_cs, libertas_sdio,
 libertas_spi, libertas_tf_usb, mwifiex_sdio, mwifiex_usb, mwl8k and
 usb8xxx drivers.
 .
 Contents:
  * USB8388 'Thinfirm' firmware (lbtf_usb.bin)
  * CF8381 main code (libertas/cf8381.bin)
  * CF8381 boot code (libertas/cf8381_helper.bin)
  * CF8385 main code (libertas/cf8385.bin, libertas_cs.fw)
  * CF8385 boot code (libertas/cf8385_helper.bin, libertas_cs_helper.fw)
  * GSPI8686 main code, version 9.x (libertas/gspi8686_v9.bin,
    libertas/gspi8686.bin)
  * GSPI8686 boot code, version 9.x (libertas/gspi8686_v9_helper.bin,
    libertas/gspi8686_hlp.bin)
  * GSPI8688 main code (libertas/gspi8688.bin)
  * GSPI8688 boot code (libertas/gspi8688_helper.bin)
  * SD8385 main code (libertas/sd8385.bin, sd8385.bin)
  * SD8385 boot code (libertas/sd8385_helper.bin, sd8385_helper.bin)
  * SD8686 main code, version 8.x (libertas/sd8686_v8.bin, sd8686.bin)
  * SD8686 boot code, version 8.x (libertas/sd8686_v8_helper.bin,
    sd8686_helper.bin)
  * SD8686 main code, version 9.x (libertas/sd8686_v9.bin)
  * SD8686 boot code, version 9.x (libertas/sd8686_v9_helper.bin)
  * USB8388 OLPC firmware, version 5.110.22.p23
    (libertas/usb8388_olpc.bin)
  * USB8388 firmware, version 5.x (libertas/usb8388_v5.bin, usb8388.bin)
  * USB8388 firmware, version 9.x (libertas/usb8388_v9.bin)
  * USB8682 firmware (libertas/usb8682.bin)
  * PCIE8897 firmware, version 15.69.2.p11 (WLAN) / 15.28.2.p11 (BT)
    (mrvl/pcie8897_uapsta.bin)
  * SD8688 main code (mrvl/sd8688.bin, sd8688.bin, libertas/sd8688.bin)
  * SD8688 boot code (mrvl/sd8688_helper.bin, sd8688_helper.bin,
    libertas/sd8688_helper.bin)
  * SD8787 firmware, version 14.66.9.p96 (mrvl/sd8787_uapsta.bin)
  * SD8797 firmware, version 14.66.11.p151 (mrvl/sd8797_uapsta.bin)
  * SD8897 firmware, version 15.69.2.p11 (WLAN) / 15.28.2.p11 (BT)
    (mrvl/sd8897_uapsta.bin)
  * USB8797 firmware, version 14.69.11.p179 (mrvl/usb8797_uapsta.bin)
  * MWL8366 main code (mwl8k/fmimage_8366.fw)
  * MWL8366 AP-mode main code (mwl8k/fmimage_8366_ap-2.fw)
  * MWL8366 AP-mode main code, version 5.2.8.16
    (mwl8k/fmimage_8366_ap-3.fw)
  * MWL8687 main code (mwl8k/fmimage_8687.fw)
  * MWL8764 AP-mode firmware, version 7.4.0.9
    (mwl8k/fmimage_8764_ap-1.fw)
  * MWL8366 boot code (mwl8k/helper_8366.fw)
  * MWL8687 boot code (mwl8k/helper_8687.fw)
Homepage: http://git.kernel.org/?p=linux/kernel/git/firmware/linux-firmware.git
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /.
/lib
/lib/firmware
/lib/firmware/libertas
/lib/firmware/libertas/sd8385.bin
/lib/firmware/libertas/gspi8688.bin
/lib/firmware/libertas/usb8388_olpc.bin
/lib/firmware/libertas/cf8385.bin
/lib/firmware/libertas/sd8686_v9_helper.bin
/lib/firmware/libertas/usb8388_v9.bin
/lib/firmware/libertas/gspi8686_v9.bin
/lib/firmware/libertas/sd8686_v8_helper.bin
/lib/firmware/libertas/usb8388_v5.bin
/lib/firmware/libertas/cf8385_helper.bin
/lib/firmware/libertas/sd8385_helper.bin
/lib/firmware/libertas/gspi8686_v9_helper.bin
/lib/firmware/libertas/cf8381_helper.bin
/lib/firmware/libertas/sd8686_v8.bin
/lib/firmware/libertas/cf8381.bin
/lib/firmware/libertas/gspi8688_helper.bin
/lib/firmware/libertas/usb8682.bin
/lib/firmware/libertas/sd8686_v9.bin
/lib/firmware/mrvl
/lib/firmware/mrvl/usb8797_uapsta.bin
/lib/firmware/mrvl/sd8897_uapsta.bin
/lib/firmware/mrvl/sd8787_uapsta.bin
/lib/firmware/mrvl/sd8688.bin
/lib/firmware/mrvl/sd8797_uapsta.bin
/lib/firmware/mrvl/pcie8897_uapsta.bin
/lib/firmware/mrvl/sd8688_helper.bin
/lib/firmware/mwl8k
/lib/firmware/mwl8k/fmimage_8687.fw
/lib/firmware/mwl8k/fmimage_8764_ap-1.fw
/lib/firmware/mwl8k/helper_8366.fw
/lib/firmware/mwl8k/fmimage_8366_ap-2.fw
/lib/firmware/mwl8k/helper_8687.fw
/lib/firmware/mwl8k/fmimage_8366_ap-3.fw
/lib/firmware/mwl8k/fmimage_8366.fw
/lib/firmware/lbtf_usb.bin
/usr
/usr/share
/usr/share/bug
/usr/share/bug/firmware-libertas
/usr/share/bug/firmware-libertas/presubj
/usr/share/doc
/usr/share/doc/firmware-libertas
/usr/share/doc/firmware-libertas/copyright
/usr/share/doc/firmware-libertas/changelog.gz
/lib/firmware/sd8385.bin
/lib/firmware/sd8686_helper.bin
/lib/firmware/libertas_cs.fw
/lib/firmware/libertas/gspi8686_hlp.bin
/lib/firmware/libertas/gspi8686.bin
/lib/firmware/libertas/sd8688.bin
/lib/firmware/libertas/sd8688_helper.bin
/lib/firmware/usb8388.bin
/lib/firmware/libertas_cs_helper.fw
/lib/firmware/sd8385_helper.bin
/lib/firmware/sd8686.bin
/lib/firmware/sd8688.bin
/lib/firmware/sd8688_helper.bin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            696cedb8e76ecc0cda9f9b0d3972c64d  lib/firmware/mt7601u.bin
99bce75086ea635a2f8288d9b835f787  lib/firmware/rt2561.bin
2878d5eaa4ff907d4df36a834915aa53  lib/firmware/rt2561s.bin
9998485bc152cf0f39dd61a33b92ad9b  lib/firmware/rt2661.bin
75a1da3caa0b1c95e81dfba207f834c6  lib/firmware/rt2860.bin
36c944c3138125605d28c0a3a1338be9  lib/firmware/rt2870.bin
9a10bd0220c3e36ad966b6eab929b2f1  lib/firmware/rt3071.bin
f8d8051e24cd4c8c298bc84c7309fe1a  lib/firmware/rt3290.bin
bd733372ae21a010bf8a5511d7711c2d  lib/firmware/rt73.bin
8dbcc0513822473f1ebe02dcf31dcc01  usr/share/bug/firmware-ralink/presubj
9d1bb4c46b043d3f68b964951a742238  usr/share/doc/firmware-ralink/changelog.gz
9a1b8990d6127f7af631e118676c2295  usr/share/doc/firmware-ralink/copyright
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "" uu"0 ?  D&  ^ 0:& 4T"4D&0'0SC'0CS&0'0SC'0CSCC0:" 0:& 4T"4D&T`'0SC'0SC'0CS'0CSCC0:" 0:CC&0\4D&T`'0SC'0S0C+'0CS'0CS'T04TO,0:4T'T04TO05S" 0:&0<4D'0SC'0SC&T`CCSC0:"4T" 0:'0CS'0CS&T`SSCC4D0:" )~ 5~ 0:&  4T"4D&T`, '0SC'0SCCC0:"0^	" & 	4TU4D&0'0SC'0CS&0'0SC'0CSCS0:0:"&0, !u5u)	)~ 0:SC4D"4T"r@_!-  3 !"01PQ3RG`  U 
 0""! 3T$!4!D3T$,4!3T$-4!-!"! 1`	\	m!-"u1 TTT> !-"~+}
O4 !4!4!44tDDD@ D!-" TTT T!-"~+}
O!-"-#!"# !-"-% T  
t !  	 tqD !"! T0'& !-"! ,!-"!-"!-"0
JBP@D $5t$5$5$5tKd`d`D$5$5t$5$	5t%5@`$3x33V$4~ DThTHV$4~ DThTHVE`p$4~ DPE`$	5D$
5$5-T?$
5x$5D"4 +`f443u +$5443u +$5443u +$54$34x+43u $5443u +$5443u +$54D@ DD44DDD"$>$<$>"    t   4D0
P	0	"/uuuu1u+"."N  
t ttt 0t	tH
tt tt   DuI uJ"u1 
t D "1 
t".t!t"0:'00TD
0D
TTD0:0	~ "~"0:P&'0SC'0SCSC0:PHT`>T'0CS'0CSSC0:)~ 5~ "	4$534$53	
u u`0	$51`$54$53}| $5$51``$54$53u{$"5|0}u{$(5|0}u{4$53$-5?$5|0}u{$"5|0}u{$(5|0}u{$.5$/54$53$050	A$051`~ ~N1`~  0~ ~  $15"$05D@04$53 $15"4$530;4$53e+pu+4$53~"V34".34"
4$53p:4343 dPh43dPh43dd@ 43
434$53 0P,4343
 
x~"V34 d@~"433543~"0433".e4pe3p"34"1dpA@C P ~+}
O'@		/"Ou/"'Pu/"	/"PQU0*~0 
t Dt D T 4DDDPC~0|0}u{0u  T T 
t@M P8~0|} u{ t 
 T TP%'T T T P-~0|} u{ t 
T T"(."  )"u/33@" u/3@P""(p8"""%5"ptptsth`sPV @z {`z {ThTH=| V+:ThTH| VL`c 
\z {x33$>=| Vx33+:x33$>=| VL`t+:".``=`]p$` u." 
0D @E?`u.J(W"0vDBEu."~ "@E?p!fmE0u.2~ "." 
0,D fmEu."@E?p0
u.2"." t 
0	24E3p"43434E3p".P 
 0A4E3p"43434E3p".P43"@PD~0|} u{ t 
 TT0T  	/PH~0|} u{ t 
 TT 'Pu/"T	/"xuL%@)T$3TD @VF @ 
~`T?0	T`T%`@P-"T~0|} u{ t 
	/"PP" T tD'Pu/"~0|} u{ t 
	T/"00tuu000pEpEp#! `4D"4X42tuu4d`pEpEp#! `4D"4D "nPr43 d@~  4$53dP4$53{t D u/"u".34/%$%4tP_P%0/p   3#x2)pc0tt0)0tt0)0tt0)0tt0)"PS0| %50| %5/0/5/"$>L`A$>dd@$>c"nPO4$534$534$53~  
t@ D@ 
tO 0tu/"uJ I @JJpIL K @LLpK 2d@dP"d@dP"dPd@""`At.4!#t.4!0t.4! t"
 t" d@~    tQ D"0</p8"."N"."N340	"0D0t0t6/Dn`	@"~)tE-t/>tA-t/> dLp"! 3T$4!5~"03!-"0$p,,Pt3O04T'ToN"4D4T4 T""P TT"$>$<$>"@ ? @@@p?2nP"~0|} u{ t 
	/"`	p"~0u{"}!(tA%(2tE%("! `""0"~* 
ODD"40t    "t6/00t	"00t	" `  tQ D"0* 
00` 
t""0* 
00p 
t""4D4T TT" t4T4Xt00t"$0H`l 
	33T T?OD"0tT"" 
0t T"" 
0t T"" 
0t@ T"" 
0t T""0t T""RST@   @??(! 4$530""0@t2tt"xj 	Bd0d%3"0@t2t" DD@"nP	/" 
0t"" 
0t ""40t" "?@"0<D"0x"JEIp"LEKp"x"uuA"IJ"KL"      ."                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 CPY"1TX"#1" pV 0 1 5 x6 @ APHQQRQSQTUV=pcqr7s[tu,  p<UX0t}}V 0
}V%@DDVA"pZO"O"%PDD"%PTT"%@U`pT
puNuOpTpd` uNuO '"p$G"%@U`B%$]WptG%WptH%WV%@U`BGd`Gd`Gd	`Gd
`Gd`GpT:G	:FG
:FV"pp_pU'OpppV0"p')p^)0G''("%@U`BppWV%@U`BppWV WXY(uX<0uX03uX$5ruX5
uXX0DTDTNOu:%tttOD@u<WVp4t1t&%@U`}Vp$V ,/t@pWTp2pp@5p3Wpp3@Wp2O tttp3p3Wpp3P"p2O tttp3 ,/tV%@U`	}Vrp$JWV_p$p]WVt0 ,/TWE]pV`*p%D,t"%Op`%WVt"T`NEO$t_T-*p0_ 0_T00*pu**lm_0lmlmGdp!0Klm*p0LL*pu**lmG	D :d`:lmG
:lm:plm i^ h k^ j m^ lu.@ ih&0hF^  FT~~ o$sr kj&0jF^  FT~~ o$ut ml&Gd
p"0lF:F4F 0&0lF^  FT~~ o$qp ,0@d2`qwpv.T?.wv0S..E]//.GdpG(0G')TCT`$`$p88F080G''Gd`Gd`	Gd	`V(0G')T:`"`%`-$`I$`$pPFT?u$:98>F0F0T80P~ ~  O$89F098890G''Gd`	Gd`(0G')T:` `!`+$`E$`$pJFT?u)9:F09-F0T80P~ ~  O$9F0990G''("0Q`G`e$`	IYuUT #4  TuQ	IPpu0	I Tp  TuQ	IPp	D0	@7d"`	@t
X0 0 ttt(p)p+p"(TT+TX0%p<*`TT<*`TE<TDuTDX0$%@  0OTTu0uUQ	Ppu0Q0`QY0@B0"0QY}@BR`H`%$`
[%@DD
uRuUX0$T  uRuU
[T`
[DTXT`p(p)tp"+(DDDtX0 0 ttttDDRU0	}AB0"KLD
 


 
`
  HCJBL^Gd`HTCJTBLT^GdpaSC\ICKBM^GdpMITCKTBMT^Gdp0CTDC&Gd`GC^uB	GCTD0CKL*BTCTO_`"u0EW0t tp/$`0`B$`G`U$!p`U$``$p}(}$pP/@>Ud`Up}	/A)U/ pGpDHpE/pp20E`2u0EZ0X
T`TX0Y
P`PYS0`F0E]2p*0Cp(p)p*0 p(p)p*"0EQ0 	K0 
N0 N0   	 +E,`00pU'pO')p^)0G''("`-t.4pt.4pt.4p""G)T'TEE'")0GEE("CE !SF+,BQRUtt"ptptsth``((t.4p""u0ET2G$`$`$@p"t"Sp0`	M0MFOEN`OOpN"t
X ""G t"tX X"uuu"0Ec p 0C"`"`""&tu&
"&tu&"xu_t.4p"< s
0 "
^	e>g hSi"""""""                                                                                                                                                %f(2}34"Hk0 P"0 X0L0@ /t0	t" 2pV
16PJQSRSSSTUVAdmpqr|st  2p<ptVp2+ 0}VtpVp2+VA"pT
puNuOpTpd` uNuO '"p$G"%$]WptG%WptH%WVtpVp2+Gd`Gd`Gd	`Gd
`Gd`GpT:G	:FG
:FV"pp_pU'OpppV0&p')p^)0G''(Vp2+p*u=u>/WVtpVp2+ppWVtpVp2+ppWVtpVp2+ WXY(uX<0uX03uX$5ruX5
uXX0DTDTNOu:u<WVp4t1t&\Z[p0*tpVp2+p$VtpVp2+ ,/t@pTWTp2pW@Bp3Wpp3@qp2O XT`ttp3p3Wpp3P/p2O XT`ttp3pp2O XT`tt ,/tVtp"p$JWVtpV`ypp$p\WVtp0Z[Z[pV`D;p$p]WVt0 ,/TWE]pV`p%D"">E=`
>>p
=u=u>>E=`*pt%/4L`z~TD~/ %$ tM>LVWL%W5VWWpVV@~D~t%/4L///Sp0`	M0MFOEN`OOpN""B"00pU'pO')p^)0G''(0`W(TW\dp!W0TDW01[[p+Z'W0\pTD[[pZD"t
X "tX X"KLD
 |\ &`7  HCJBL^Gd`HTCJTBLT^GdpaSC\ICKBM^GdpMITCKTBMT^Gdp0CTDC&Gd`GC^uB	GCTD0CKL%BTCTO_`"G$`$`$@p""T`NEO$t_T-%p0_ 0_T00%pu%%lm_0lmlmGdp!0Klm%p0LL%pu%%lmG	D :d`:lmG
:lm:plm i^ h k^ j m^ lu.@ ih&0hF^  FT~~ o$sr kj&0jF^  FT~~ o$ut ml&Gd
p"0lF:F4F 0&0lF^  FT~~ o$qp ,0@d2`qwpv.T?.wv0S..E]//.GdpG(0G')TCT`$`$p88F080G''Gd`Gd`	Gd	`{(0G')T:`"`%`-$`I$`$pPFT?u$:98>F0F0T80P~ ~  O$89F098890G''Gd`	Gd`(0G')T:` `!`+$`E$`$pJFT?u)9:F09-F0T80P~ ~  O$9F0990G''("G)T'TEE'")0GEE("PY"TX"bQ`H`f$`OYuUT #4 >TuQOPpubO Tp >TuQOPpJ0F7d"pyt~t
(p)p+p"(TT+TX0<*`TT<*`TE<TTubuUQ	PpubQb`QYb@b"0QY}@R``uRuUDXT`p(p)tp"+(DDDtX0 ttttHDDRU0	}A0"`-t.4pt.4pt.4p""""p*0Mp(p)p*b p(p)p*0Jp$D"""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      %XXZu\"\LpDt0 ,@$`$`$`$p    #""$`$`.$`=$pS 0" 	 7 0"  $ 0"   #0" !  78"0	  TpW	 Dt:0 & Wp Wd"`W	t:"0G D<`4@$`$`$`$p" 0" 0" 0" #0Wt T@@$` $`0$`@$pV 0W 	 : 0W  & 0W   #0W !  78't@<8:79P!@D78 <0S<"0t @D0 't@t@ "80 & ;p$;p$u@65u$u;u$6:59@60 '$ 00"0t t!u$=560 '$ 00"% 6:59 ;"6:6595"ut	tl
tt t%t1" " "0D0	"$u% &u' (0T`CST?D@S?S$0CS&("$u% &u' ($0CT?D@SS?0CS&("0CT?D@SS?0T`
T`CS"KTJ	08090:0;0T`G`$`$			o08090:0;"Kd`qKDECpP  %$$%PI~ Lt@%$4u+{}$T$LKJKKpJ
_$$TpD%DC C}}tU}U~*}0KJ
_"}tU}U~*"G4~0}5~07~0"tU""	`````$p||
|||oT04TLC4~07                                                                                                                                                                                                                                                                                                                                                                                                                                                                 )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [",  u0E	0t  tp`$`0`B$`G`U$!p`U$``$p}(}$pP`@>Ud`Up}	`A)U`7 pGpD%pE`7pp20E2u0E0X
T`TX0Y
P`PYS0`F0E2}0E0 	0 
0 0 " 	 +E,`CE !SF+,BQRUtt"J`p"$4"ptptsth``t.4p""u0E2 "G t"uuu"0E p 0C"`"`""`$""xucz`"&tu&
"&tu&"t.4p"0 s
(;<89bc"B0 0 M"" 7pV013456@+ABPQRSTU)V|dpqrst  7au3*u0u1"T"p<1UX0t}}V71 0
}V712@DDVA"pZO"O"2P7DD"2P7TT"2@U`7pT
puNuOpTpd` uNuO '"p$G"2@U`%$]WptG%WptH%WV712@U`Gd`Gd`Gd	`Gd
`Gd`GpT:G	:FG
:FV7"pp_pU'OpppV70"p')p^)0G''("p$u5u64WV712@U`ppWV712@U`ppWV71 WXY(uX<0uX03uX$5ruX5
uXX0DTDTNOu:2tttOD@u<WV7p4t1t&12@U`}V7p$V71 ,/t@pTWTp2pW@Bp3Wpp3@qp2O XT`ttp3p3Wpp3P/p2O XT`ttp3pp2O XT`tt ,/tV712@U`	}V7rp$JWV7_p$p]WV7t0 ,/TWE]pV`*p%D,t"2Op`2WV7t""6E5`
66p
5u5u66E5` t%44L`z~TD~4 %$ tM>LVWL%W5VWWpVV@~D~t%44L444Spw0`	M0MFOEN`OOpN0I0}|Pt@3}2P	T3-@00- $	TDa"30	D"""00pU'pO')p^)0G''("t
X "tX X"KLD zvV   `1  |HCJBL^Gd`|HTCJTBLT^GdpaSC\ICKBM^GdpMITCKTBMT^Gdp0CTDC&Gd`GC^uB	GCTD0CKL*BTCTO_`"G$`$`$@p""T`NEO$t_T-*p0_ 0_T00*pu**lm_0lmlmGdp!0Klm*p0LL*pu**lmG	D :d`:lmG
:lm:plm i^ h k^ j m^ lu.@ ih&0hF^  FT~~ o$sr kj&0jF^  FT~~ o$ut ml&Gd
p"0lF:F4F 0&0lF^  FT~~ o$qp ,0@d2`qwpv.T?.wv0S..E]//.GdpG(0G')TCT`$`$p88F080G''Gd`Gd`	Gd	`u(0G')T:`"`%`-$`I$`$pPFT?u$:98>F0F0T80P~ ~  O$89F098890G''Gd`	Gd`(0G')T:` `!`+$`E$`$pJFT?u)9:F09-F0T80P~ ~  O$9F0990G''("G)T'TEE'")0GEE("PY"TX"aQ`J`k$`YuU T #4 8TuQPpua Tp 8 TuQPp 07d"`t
X0 0 ttt(p)p+p"(TT+TX02p<*`TT<*`TE<T DuT DX0/2@  0OTTuauUQ	PpuaQa`QY a@a"0QY}@R`H`%$`2@DD
uRuUX0/T =uRuUT`D TXT`p(p)tp"+(DDDtX0 0 tttt DDRU0	}A0"`-t.4pt.4pt.4p""""p*0Cp(p)p*a p(p)p*""0w7 l(bac%cu$ 4aecp}(| } -<PDceb`%c4ct(bat"%P%$.%$$ut%4mp%$% T`%*@%*"                                                                                                                                                                                                                      "p-"" Cuu"@!- ?    ^ o  M!p"01PQR`   
 0"+"! 3T$!4!D3T$,4!3T$-4!-!"! 1`!-"u1 TTT> !-"~+}
4 !4'!4'!4'4tDDD@ D!-" TTT T!-"~+}
!-"-#!" !-"-% T  
t !  	 tqD !"! T0'&b!-"! ,!-"!-"!-"1dpA@4P ~+}

@		G/"	du/"
Pu/"	G/"PQ
0*~0) 
t Dt D T 4DDDPC
~0|0}u{0u ) T T 
t@M 	%P8
~0|}~u{ t 
) T T	OP%

T T T P-
~0|}~u{ t 
T T"(."  )"u/33@" u/3@P""(p8"""%5"ptptsth`s.``=`]p$`. .u." 
0D @E?`.u.("0vDUUu."~ E"@E?p!50u.2~ E"." 
0,D 5u."@E?p0
u.2E"."	%@PD~0|}~u{ t 
) TT0T  	G/	:PH~0|}~u{ t 
) TT 
Pu/"T	G/"/uuuu1u+"."N  
t ttt 0t	tH
tt tt   DuI uJ"P-
xT~0|}~u{ t 
	G/"	OPP
x T tD
Pu/"~0|}~u{ t 
	GT/"0:\P&'0SC'0SCSC0:QPHT`>T'0CS'0CSSC0:)~ p5~ w"Pr43 d@~  4$53dP4$53{t D u/"u".34/%$4te	P 	P%0/p (  3#20D0t0t6/Dn`	@"0* 
00` 
t""0* 
00p 
t""0tT"" 
0t"" 
0t T"" 
0t T"" 
0t "" 
0t@ T"" 
0t T""0t T""4 +`f443u +3$5'443u +3$5'443u +3$5'4$34x+43u 3$54'43u +3$54'43u +3$54'D@ DD44DDD"4D4T4 T""P TT" DD@"4D4T TT"0"~* 
DD"	4$534$53	
u u90	$51`$54$53}| $5$51``$54$53u{$"5|0}u{$(5|0}u{4$53$-5?$5|0}u{$"5|0}u{$(5|0}u{$.5$/54$53$050	A$051`~ ~N1`~  0~ ~  $15"$05D@04$53 $15"PV @z {`z {ThTHu| +:ThTH| L`c 
\z {x33$>u| x33+:x33$>u| L`t+:"`	p
"~0u{
" d@~    tQ D" `  tQ D"0<D"4$530"" t 
0	24E3p"43434E3p"P 
 0A4E3p"43434E3p"P43"4$530;4$53e+pu+4$53~">34".34"
4$53p:4343 dP(43dP(43dd@ 43
434$53 P,4343
 
8~">34 d@~"43B43~"043B".e4pe3p"34"d@dP"d@dP"dPd@""0x"0d%3""`At.4!#t.4!0t.4! t"
 t"0
JBP@D $5t$5$5$5td`d`D$5$5t$5$	5t%5@`$3x33$4~ ThTH$4~ ThTHE`p$4~ PE`$	5D$
5$5-T?$
5x$5D"00tuu000pEpEp! `4D"4X42tuu4d`pEpEp! `4D"4D " t4T4Xt00t"PS0| %50| %5/0/5/"! 3T$4!~"0B!-"0? YAj   0:& 4T"4D&0'0SC'0CS&0'0SC'0CSCC0:" 0:& 4T"4D&T`'0SC'0SC'0CS'0CSCC0:" 0:CC&0\4D&T`'0SC'0S0C+'0CS'0CS'T04TO,0:4T'T04TO05S" 0:&0<4D'0SC'0SC&T`CCSC0:"4T" 0:'0CS'0CS&T`SSCC4D0:" 9)~ p5~ w0:&  4T"4D&T`, '0SC'0SCCC0:"0" & 	4TU4D&0'0SC'0CS&0'0SC'0CSCS0:0:"&0, !9u5u)	)~ p0:SC4D"4T"0$p,,Pt3O04T'ToN")pc0tt0)0tt0)0tt0)0tt0)"$>L`A$>dd@$>q"PO4$534$534$53~ ) 
t@ D@ 
tO 0tu/"0:'00TD
0D
TTD0:0	~ p"~p"uJ I @JJpIL K @LLpK 20</p8"."N"."N340+	G"~)tE-t/>tA-t/> dLp"  t   4D0
QP0k"$>$<$>"$>$<$>"@ ? @@@p?g2P"~0|}~u{ t 
	G/"!(tA%(2tE%("! `""40t    "t6/00t	"00t	"$0H`l 
	33T T?OD"1 
t".t!t"RST@   @??(! 0@t2tt"u1 
t D "g` 	/0@t2t"P	G/"40t"xuL "?@g"JEIp"LEKp"uuA"IJ"KL"      ."                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   `(2}"'#"i0 q"0 X0L0@ /t0	t" pV
16PGQPRPSPTUV>piqrKsptg  p<ptVp 0}VtpVpVA"pT
puNuOpTpd` uNuO '"p$G"%$]WptG%WptH%WVtpVpGd`Gd`Gd	`Gd
`Gd`GpT:G	:FG
:FV"pp_pU'OpppV0&p')p^)0G''(VpppWVtpVpppWVtpVp WXY(uX<0uX03uX$5ruX5
uXX0DTDTNOu:u<WVp4t1t&\Z[p0tpVpp$VtpVp ,/t@pTWTp2pW@Bp3Wpp3@qp2O XT`ttp3p3Wpp3P/p2O XT`ttp3pp2O XT`tt ,/tVtp"p$JWVtpV`ypp$p\WVtp0Z[Z[pV`D;p$p]WVt0 ,/TWE]pV`p%D""Sp0`	M0MFOEN`OOpN""B"00pU'pO')p^)0G''(0`W(TW\dp!W0TDW01[[p+Z'W0\pTD[[pZD"t
X "tX X"KLD
 }' G`X  HCJBL^Gd`HTCJTBLT^GdpaSC\ICKBM^GdpMITCKTBMT^Gdp0CTDC&Gd`GC^uB	GCTD0CKL%BTCTO_`"G$`$`$@p"4"T`NEO$t_T-%p0_ 0_T00%pu%%lm_0lmlmGdp!0Klm%p0LL%pu%%lmG	D :d`:lmG
:lm:plm i^ h k^ j m^ lu.@ ih&0hF^  FT~~ o$sr kj&0jF^  FT~~ o$ut ml&Gd
p"0lF:F4F 0&0lF^  FT~~ o$qp ,0@d2`qwpv.T?.wv0S..E]//.GdpG(0G')TCT`$`$p88F080G'.'.Gd`Gd`	Gd	`(0G')T:`"`%`-$`I$`$pPFT?u$:98>F0F0T80P~ ~  O$89F098890G''.Gd`	Gd`3(0G')T:` `!`+$`E$`$pJFT?u)9:F09-F0T80P~ ~  O$9F0990G''("G)T'TEE'")0GEE("PY"TX"bQ`H`f$`pYuUT #4 _TuQpPpubp Tp _TuQpPpk0g7d"pyt~t
(p)p+p"(TT+TX0<*`TT<*`TE<TTubuUQ	PpubQb`QYb@=b"0QY}@=R``:uRuUDXT`p(p)tp"+(DDDtX0 tttt*DDRU0	}A=0"`-t.4pt.4pt.4p""""p*0Mp(p)p*b p(p)p*0Jp$D"""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     8(2}34"Hk0 P"0 X0L0@ /t0	t" 2pV
16PJQSRSSSTUVAdmpqr|st  2p<ptVp2+ 0}VtpVp2+VA"pT
puNuOpTpd` uNuO '"p$G"%$]WptG%WptH%WVtpVp2+Gd`Gd`Gd	`Gd
`Gd`GpT:G	:FG
:FV"pp_pU'OpppV0&p')p^)0G''(Vp2+p*u=u>/WVtpVp2+ppWVtpVp2+ppWVtpVp2+ WXY(uX<0uX03uX$5ruX5
uXX0DTDTNOu:u<WVp4t1t&\Z[p0*tpVp2+p$VtpVp2+ ,/t@pTWTp2pW@Bp3Wpp3@qp2O XT`ttp3p3Wpp3P/p2O XT`ttp3pp2O XT`tt ,/tVtp"p$JWVtpV`ypp$p\WVtp0Z[Z[pV`D;p$p]WVt0 ,/TWE]pV`p%D"">E=`
>>p
=u=u>>E=`*pt%/4L`z~TD~/ %$ tM>LVWL%W5VWWpVV@~D~t%/4L///Sp0`	M0MFOEN`OOpN""B"00pU'pO')p^)0G''(0`W(TW\dp!W0TDW01[[p+Z'W0\pTD[[pZD"t
X "tX X"KLD
 |\ &`7  HCJBL^Gd`HTCJTBLT^GdpaSC\ICKBM^GdpMITCKTBMT^Gdp0CTDC&Gd`GC^uB	GCTD0CKL%BTCTO_`"G$`$`$@p""T`NEO$t_T-%p0_ 0_T00%pu%%lm_0lmlmGdp!0Klm%p0LL%pu%%lmG	D :d`:lmG
:lm:plm i^ h k^ j m^ lu.@ ih&0hF^  FT~~ o$sr kj&0jF^  FT~~ o$ut ml&Gd
p"0lF:F4F 0&0lF^  FT~~ o$qp ,0@d2`qwpv.T?.wv0S..E]//.GdpG(0G')TCT`$`$p88F080G''Gd`Gd`	Gd	`{(0G')T:`"`%`-$`I$`$pPFT?u$:98>F0F0T80P~ ~  O$89F098890G''Gd`	Gd`(0G')T:` `!`+$`E$`$pJFT?u)9:F09-F0T80P~ ~  O$9F0990G''("G)T'TEE'")0GEE("PY"TX"bQ`H`f$`OYuUT #4 >TuQOPpubO Tp >TuQOPpJ0F7d"pyt~t
(p)p+p"(TT+TX0<*`TT<*`TE<TTubuUQ	PpubQb`QYb@b"0QY}@R``uRuUDXT`p(p)tp"+(DDDtX0 ttttHDDRU0	}A0"`-t.4pt.4pt.4p""""p*0Mp(p)p*b p(p)p*0Jp$D"""                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      D      @v Av201302052146____H  RH  H  H  H  H  H  H  H  H  H  H  
H  H  H  H   H    ::<dbdrd :o<F  X T   F X!F  X T   :odbdrd ::d   
d F  X  DA d$F  X  d G Y F  
X F 
X@LF  X PF X@LH + F ; AI%F  X @ L@F X/; :oF 'F X/F 'F X/:o :oF X0/FXF  X!@ @ D ` A  .2@4 N5 !F  X/66  z):u4"	@N <&F X@Ld	@F  X\/:o :oD`'@WD/Bps6 FF X@F X0/@ LD  @TNT F F  X\/ F Gd 1 4 :o:oF` Xc@3 rF X /3F X/:o :oPF Xp/2	2F X/F X/:o:oPF Xp/Qr'F X/F X/:o:oF  X TF X/Fp XspF` XcF  Xh&F  X TK Ps@FP XRF  X dF X/Fp XsF` Xc0F  Xh&F  X dK PsFP XR:o :oF0 CDPv@@	_ ABBF X/ F dF cF` XcD  F X8&D  F XH& F XX&F Xh&D  F Xx&F XtD  &F  X/F  X tF XD/F X/F0 X1tAa-P&HFX/F0X1 F 0 [@B:o:o< HqD2`+ 1 @%8q iDp PR P" 8s q PB  8# "F@@ 	XB TT19TDo1T1L@@1Do'@1D+F_T1XR@1@ !
T@0FXTa@3`FoXc@ 	F@1X@ @ :o :o 
\f*QFXF XFK( P F X(F!K(	DP L@ :o :oD0TBe$T D  CBdsF  X   FX/$Lp	FLq@ @A A(FpXs^' @#MPT P3 Q 	(H'?%H'(H'
)FF  XD/:o:oD0 Bb$F  X! D  CFX/F  $E  @ AP  FpXs^K  @P 8HP KP P 0HK:o:o UT D#L0EL1@p@*
08D0 L&:F 
XCFX/}L_@9 PT PHT@FX/RAT y@ @ L3@0 \FX/$ F` XctH?PFX/  ><IPSaF  X/ $:o 	 :o@U D  !F X/2s@2 @!PdfPTF X/*D  FX/M@P	GDP lF Xp/*D  FX/D 	GF X,/PTD  P QFX/F X(/l:o :oF  !D  _  r3N 4F  #F V? B@@v@	@ $6B 	X  6N vT D?A@ C Lq@Lr@  X% @L 	6D@2  X% N 5Y  N uX@5N ALq F  GD  V2 AAA P 	F X<HFX/N &#FXP <D   K(N P P 1D  K( S @* @N 
P AFFX/ P QD  FX/	FF XDF  X/:o :oFXP` [ P`D  ( D  PP (Pt D  ( B	(P	BFX/F  Lp CLq eLq&QP HPFX/F X
F X<HK$L 	
<HK$N j  A PA$*D  FXPPK$ 
D  FX/ u!T  Q L F XtD/=P|P#PO`F X,/!BL@F Xt|=P /P#PO LF Xp/P P`D  K$PPP`D  FX/`v7@2@1N6 W#LpN BLp@@ _uBUP M@v @@F  X!TP_p \F  X/\ Oq6@F  X TPFX/N Lp@	 _u@"	T! @wgF  X/`@ |:o:oF Xt 4="E<F  X/
F  'F X/iP 	HFXP(F 
X/F  X TF  X$/@OM&D  FX/f\&QF  X/PAFP(F X(FP(F XBP$( .   @ @ PNFX/P 
IFF X/,:o:oPo  "BFX/}BFX/T#0T T!$F  (F X/U MT1	'IF  X/:o:oD  L0 D  L1 	AL? H  (F X/H  PTFX&HK(@	P K(TB@s@$P1RP  TU @ PdFXP\PL/@>)*HP<)F 
E PODP4FX/PDHPT)
'H)PUHHP4PTNd@? 
E	FX/F X(/ d:o :o_FpXs D  `PhD%PK D  `PK D  @K\ A<FFX/PoQ
&HFX/xV 6L~PhFXT/FXPD  @K ?K PFXH/V!j# LnPFXT/FXPD  @PoK D  &K &FXH/F0X11
&D  
&IK:o :o_FpXs D  hPpD%PK D  hPK D  @K\ A<FFX/PoQ
&HFX/xV 6L~PpFXx/FX PD  @K ?K PFX/V!j# LnPFXx/FX PD  @PoK D  &K &FX/F0X15
&D  
&IK4:o F  X! PFP XR|@DCP"D0 @Q@2@QHaL"D0 "@A@ FP XRPF@ XB|DD1  eF  X!pD0 @Q@2@QHaL"D0 "@A@ F@ F 0pX!" "F  X!pD0 @Q@2@QHaL"D0 "D0 @Q@ @1@A@!@FP @"XRPF@ XB|DE@CP"DP @2@Q@2Hb"D0 "@A@;D  HbF X/; ;D  2HjF X/; ;F   T  	  F X/ F X/F  X!  "Y    B2	bF Xl/;:oHIL@QH  F X  GFp YIXspF X )!N 4%
!L%B1*L2iYiLd!K }F X/v F Xl/n!D  2!F  X!(b!D  bF X/W!F XL/OFP XRPF  X!|sj AD  G@`A 	A  '@c.!K FF  X F Xxa!K FF  X F XxcF  X/F  X DF   X!T"A(@NX :o:o%*.F X/FF  X F XxbF  X/F  X DF  XT/ F Xl/!F X/:o :oF `4a! T 	  F X/ F X/@C@F X /U O !F 8F0 a!:oIT @0	\ @L  :o<\ `\@`d@! H" :o I()@"@!FD F X@Q	 gIL FF  X@!X  @ :oB%U \NF  X dF  X$/AF  7T" T^ A@@F% r@O TA@ EP@? GT?)P@qFX/!    F  X t&F X/ :o :o	 !L F` Xct3 bF 
X</@'PSbF X,/:o :oF  X dF  X$/+F TSTO @2@dF%ABX! @a@D0    F  X tF X/ :o :oF  'XF`S@	F  7T "Fp  cF g#&F XD/c F` Xc
DK"KF  'H#Fp  caF g3&F XD/c!F` Xc
D K "K:o:oAA L@F K> F` XctF@B"`	B!d	F00 APhF  X/+B`@ #d# F X4/ F X(/PhD'F  XT/
\P @F  :o:o !L $"P3 FcF T 
F F F 75F '4NN P C Q 3 SQ < RFXP PPPFp Xst(P HHBd
T(?c@PD  @S<P3=&C>(*HP(P F  X|/ *&P`FpXstFPX	'P 
F')FF  X ('F(F  X  'F El:o:oITp@	.F XF X @ @ 	N 
@ 	@H K 
	@@	 H@K$
4 :o :oITpA	5F XlF Xp& @ @	N @ 	F HK$L@P	F(HK(L     4 :o:o@!@	N jPp G YpZ @ @ 	N  @	TT*@	F X/@*	Ff @!@Q@"<#$@ 	T T*@	F X/@*	&g@"A@/F Xl/`&G@P@AA  4 :o ;I$[ *%	Q1L8@F  X P@"A  dF XT11H/"F  X U  \ !#@T  F Xd/@P@	@|	F WF F X ;:o@P	 TD  L `15*L&LH  L A ,L2DP [9	EOFDLAneiknLQ|2vF X`/t2vF X/l2vTt?F X/b2vF X/Z2P F X/TsN2vF X/F2vF 
X,/>2vF X</62vF X/.@$@	v2T1 P/F X/u2vF X /2vF 	X/2vF Xt/2vF X/T N RF?X1@s@@AB_x	BR	FOB2T XB@q@ Go@SF  7YF @B@rTBS	BR	Ad@2Bq	T(@	@ 8Xp TS! v	&F X/ :o :oD   FX/p1~@@@Q0t17 3T! { T18(@p 	TS$@BX! TPX1@ p7r6:o :oD   FX/p1~@@@Q0t17 3T! { X! (@p 	TS$@BT18TP p7r6:o :oD` ` P` $ D  FX/  D@D TQX"X `3 3 qFXF XFP(K F X(FP.K yP4FK  qY@ 1B"	:o ; F  X tF X|/ ;:o`P$ D  CFX/(G	?_FX/@ C@B	"?P?/F X/F X/:o:o\ @ D  t FX/F@ XBt 2p	 qPB0F`D  PSP?/F Xp/ P/$P=OFXF 
XFK >,BK  ??P!P/F Xl/F X/ :o :o`T N  DP  o  TC LBF 7ZF  F` XctA3 L@1 
_P?POF X/(M #Q F X/F  F  GF0 X1F 'b@! HFF  L ?D  L V0E|@@@D F  7F  7F  IF Wd@/D@BB$QQ @/ YB"sN'  F 
X/:o :oF  F X\/F  LF  WNR &HU`O T 2Ta pF F  F  X  O A !F  X CF GbF X  F0 @R X1JF X/F  <D  V@DP|@@D F  7F  7F  IF Wd@/D@C$P!Q B/ sN'  F 
X/:o :o`\ 5.Z@C	F G$U O  Tc    
` @	TF X/F X/  :oPP@ F ST"@ @ M `8P 8@ b  :o<` I` ` @T2[%ZQ" @P	@!@"   TP@L `:o:o   B
@	%FpXsFKP FG YtKD $Ps $PQPoF X	 ,Q^~/ eMF XFFX/&?FP4PDPTK RAy@ @ $:o:oTT  D  FX/01T2 @UB@ 	T$@@p1'FFpXs4KF X(FP 
KP (FK:o:/<:o P FX@ bdC$K :o;F Xt/;F X A :o<F@F0F XB8X10X!
4 \c (FXs @ILP DPkFX @ L3Dp 2L#`LAvD@LF`Xc @F@F0F &XB8X10X!
4 F`@R\RI	LHD L1FX T" :@ L3D` 2L# `LC*D0L#FF`F@X0Xc
4XB8A& F F FPX 
4X!
0XR8B  :o:oF` Xc FpXs D  K D P~tK FF  X (K@bFp  XsP F XxK@P 0bF XHK F XtF  e f d:o ;F  X t  TP F GZP2F XdAJ	P B20  F  X  DF  XT/; :o F 
X/F  X TF  X$/LF0 X1$AF XX/@F Xt 0f0 S 1ST@B(T @TR@B 	@  dXB @R3 0S 1D0   f@fL f&g XF X8/:o ;F  AF XL@ KF  X  D'F  XT/; :o F Xl/F XD/F Xt  e` dF@  B_ 	R F  X 4`@F1#@ F@   F  X_ R  X 4`@F5g @F  X   B :o:o@	T N&T@ `TP NR T#@ TN U @O T 	T@   b@p @q 
XQ 
   @T	TC X @A N4 XPS t 
PP  
T   T!   
XP_ PD tC 
T!@  XTPD S 44FXF 
XFK 
4F 
XFK s S 
PQt 
BPFX/4 
# 
F '4TF  XD/&F X/APFX	F XBK 2	F XBK 'PFpXsF XBKF XBKtM
# 
F  X0/:o;F XF TF@  B_@	R F X/F  X 8``BBF X/F X</F  X/F Xp/;F@ XB8
FX PxA@A @20x z@ z;F X    x@F :hTF ;_A@	T TPF KD  QF JD  H@`	F  F R=TPF   F S3T F @ F T)T@F  F VTP F  F WT @F  F XT@`F YF  GY  xF  X t_ x!; :oD@ @FOOX aP` X qp qBNBsF X4PdP#PbK$F PP#X 	bK$F F XPP#X 	bK$F PX 	bK$a44s 	P F X/ qX  / q:o   -B@ -   -BD -   -X  -   -X  - :o<F X  P  @ C@2@	T1@d@\\Ta ` C C@D 	TB @r @SP D @X  Tt @	@tP  TU @Tc@c @RXs Xc @s@SFhXc@B`@R@s@s@B@ Dp EaF    x:o :o<F X  P  @ @@2@	T1@j@\bTa ` @ @@D 	TB @r @SP D @X (Tt @	@tP  TU @ Tc@t	@c Ts@@s@SXc Fx@c Xs@`@R@c@c @B@ A` BaF   x:o :o<P )0 **BN  0 @@   TcyPA$8
 p PPs PP "@8@tBB	JS RTB?.@@PRUTR X@W@8@tWX@WC R.@RTB UB	UDPHD_@AX" @QaTQ?
F@   P *QXB 0 *  ":o P +0 ,*B> 0 WTB5PQ&8

LQTB?n@1@QSU @dT?@0TUF P @ ,TX 0 ,P P:o F  Xh"T" 08#8
" 1 F  X TK >DO@Q +	 +# +S ,~AP&F  X dO:o :o F  XhT(8
8

K D@PXA@=# ) )C )S *dAF  X TP $O:o :oP  F@XB  ~  zF  X TP"@n LpUwUO P F  X$/T?< @> N -B89*A >Q/ _ F  Xh/8*
 D  FX/ X@7s@P	@RX"@r  Pu n :o:oP  F@XB  ~  RF  X dP @n T T_ O F  X$/T? 	@> N D1  79*@ >Y/ _ F  Xh/8*
 D  FX/ X@w3@R8	@RX"r  Pu n :o:o C#BGYG<D?@7  D  :o:o F X	 Dp@F0 X1T@ DP F  X d@A@@@@BF@XB'T4?&$F  X$/    wU? s@	@A   D  :o ;F X/F  iF  X  T2XF  X  T F X/; :oF` Xc F XK$FT @s  T_XBT K$fTNF X/:o:oF` Xc (F XF@3	ZU@ K TB@2 f!K FT&TK N
F X/:o:oF  iF` Xc   T_XBF X/fT!F	F` TX qF X/:o:oF X,/F X/F XL/F X/4:o:oF X,/F X/D  @c Fp Xs@ 	K0KF XL/F X/:o:oF` XcTF X,/&@	&8&&F` XcF X/K:o;F X,/F X/F X/; ;F X,/F X/F X/; F H  
 F @ZF0  ZX1 F XP @X"  F0 D  ND !F Z F  X D!`B@B)@2ZJF@ XB0@Q  F XhAd   N5:oPF Xp/2-+(3F W[A @P AsF  X lL@@@  3td`L3@s  C43F X/:o :ozPF Xp/2F0 ![F  X tF Xha[F w\9!  D !@ 7Q F [F 7\F  P[ `[L  \F XhF  X tA@"rF X/F 4 o F 7[@\:o :oPF Xp/F XDJ)@"rF X/ 4123:o ;F ZF '
N F  X/; F !B F    F 	 F "B F A F RV B :oFP F`XcFp Xs(X @D  'D  'D  'D  'fB	T &F  X F?X" @  X1P @/F  X BB	F?@X1A  P B"@AX :o:o<T! 8A@R`	@r 	@b@	CL1
`8q:o  	      D  IH  F  X!x"	* X( 	` :o TF X @ F X	K$  :o :oF   	N ! F iD   F X/T0 T@ 	FP Bo,	b !F hF  hGF` Xcx!&&D  &D  $"&D  *#&D  .#D  &D  5!D  &D  9!D  &D  v!&D  z!D  !&D  x!D  &&D  !D  $&D  !D  %&:o :oFF  X   X @  G YG <  yVs@ !:o ;F X/;;F F bF X/F X/;;F  eF F@F YT_ RX 8`B6PIMF HF DP \ 
4i81jL  I J."@F@-XB F X  8  X @ F X  XF X  xF X  F X  F X/F X/;;F  eLF 7L2F0AFPT" !CD	H  F WNS F   DP ;\ q
im%jL J:IeQU FPXRX? ` @ePA ~B	> ^X@ `HF X D0 D  q`Py@4F X D0 D  r`Py@'F X D0 D  s`Py@F X D0 D  t`Pz@F X D0 D  u`@Pz0 BO	`@F X/F X/; :oG YF XF X 0D @F X/ F X/(@<PcPs@K(K$Nd:o :oF  Wd@ LT@1F  X   D@ @`0 @ @ >0 ?@ E0 F@ L0 M@ S0 T@ Z0 [@ a0 b@ h0 i@ o0 p@ 0 F`  `D @F X/ H`D  (F X/F X/F X/ S`\A7F` XcKF  gLF  F  X!  `*  `D 6P  K@ bD  hF X/F X/F X/F0 X1 @A!!>A?!EAF!LAM!SAT!ZA[!aAb!hAi!oAp!A:o:oF  @ 	E$L44LF  `D F X/  @yF  `,F X/ D  QF  `*F X/ D  C F XL/_F  gh D  $/Fp Xs&P  'K &D  'KDP   \F  \D  D D  D $D  (@@ U@ @ &KF  `F X/ AF X/F X/:o ;F@dH  F X/F X/; ;  AF X</; ;F  b AF X</;;F  eDP PijDG_TBCDF  ^i\ :
0$jL IJ&F X  8F X  XF X  xF X  F X  FPXR%  B
F X/  BF X</; F0QF WeF f!B`@0@QF WF 0X@"@QF W @0`@@ @2F F 7A!F WUF 'c  F |F0DP CQD0 9F1XDP D0 pD  `P aAD 1 IL`@ $P !I@F D ? :oAF 'dGF@ XP_\*  	X18X! XXxX  X1X! XH D  CD`F&$@D   D?  *2 :#B J:o :oF`4F X/T# F@dH "F |F0 QBBATS F X,/Tc  F X/F :o :oPF Xp/F@DP RF  eF` @T  `D  #cL  IF  f,F X/F 
X8 "F X/3cF X/F@RF X/:o :oF X/FPT  f?X?EXD  &_"E%"D  F@ *XB :B J#D 9D  DD pD  `$P2 "DD  1CSJ#C#PP !iLD  ? F d TA @8F@ 2 F X X!D` 9E 1E 2D 3D 4D 5" c    @   P!I 'LL!F dF @F 'jF 'cF WVPF  7dF  hF  Gi@@ (@0X@,F@ @ F Wg" :o :oF` XcF X/KF @F X   0"G ?  A@ _ :o:oF` XcF X/KGF UFFX aF X/F @ @  :o :oF` Xc`0D @F X/F XT(F GX  `F X/hHF X/p @ :o:oF XFp XsTF X x@D @K$GQ'F D @K(F X F F X/4  @ d :o:oFp XsF X/KF " D @@ FpTXs G YF` XcTF X <1p@1y@@ hK(fT 	F Xl/F0 A @$A@ Q:o :oF  X f F` Xcj@D &L \ '5hLE	L{nLB_H \&L gGLBWH jkL5	L0LJH $E "LD #L D   LB<H D0 CLy\ D D@ 3L\ 4DP 'LE 2LB$H D 7L D  BL<D0 6LH D@ RL\ SDP FL<E GLBH FD VL D  WLD0 SLH F  X \ L 	LAvD L D  LAH  F X/F@ XBD X1 d ILDF  @!X @G Y TF X F?X_ X1@"1AL@F XAA F?X1@BF0 AF X@"AF? X1@_F0 A@!A X H  F X/F X/H jF X    X H  F X/	aF  X jH RFP 
XR(F X! F X/H @F X/F@XB`F X`/F XjF@ XBDD? @XPD FDX X1 dF X@"DaX H 	F  X TG Y\F0 /  "F  X TF  &F  X TF0 F` XcjH  F  X TF  X!\F0  K H  F  X TF   `F X/H  F  X TF0  F` Xcj}F  X TF  X X@@ H  F  X TG YXFP XR\>`F  X!XF  X T"@F` XcXF  X T&`F` XcjKEF  X TF@ XB\F0  F  X TF   F  X TF0  F` Xcj#F  X TFP XR\F0  HyF  X TF   H|F  X TF0  F` XcjK F X/F X/% F X/F X/F` XcjF  X!f  V \  F X|/0F X/F X/F Xj   :o:oF X/F  XH/F@b@S R
F X`F X/F0 CDPv@@	ACPO F XtF X</F` Xc<F X,KF XKF XKF  X xF X/ F  
X!D0 F  X 
F X/ F 
X|F X\/F@ R F XX/ :o;F H ;F  X!                  F  X TF X\ Hd Ld Cd    d B	@d d   :od Cd  F` XcT    # D T L d    :oPF Xp/F 7]@C@"F ']F X/:o :oPF Xp/F 7]@#F ']F X/:o :oF `F gaD  F X/D  F X/:o:oDP F` Xc\B`sCP q "rF X/P5@$ XD 
F:o  "A L@  F   T T F XF T FP XR8
F X a@A@;F0 X1 \F  :G F  X  "F W;T  F cH  T0 F d{TP  F esT  F akF `dT@ F b\@ 	U O F hPT0 F iHT@ F j@U O F k7T0 F l/T@  F m'TP @F nT  F o@@	`TF p	G ? /  ; :o<F0T X1 @8Tp? _TRh< B	 oD@@coD?@c$@c i oTc D dLU _TR _TR?
TR !DP d@ 	:o:oF0@! oTS DP d _D?AT@ Dl?@R8A@?T@?@o	@3/?F a@_F X/:oF X  ` _TB # _XR_! _TRDP d _TB _ DP dB  ;F0_!T_ DP d/OC_F X/;:oFF F  XX D@X!! @F` Xc!P/&dC!FF Xp/
  !_*Ts!F Xp/F0F X1X  :o !@D X@Q IHk(L;F `  _TDP db ?OW$_F X/; :oFp Xs"P/P'D P/L'D P/H'D P/D'D P/@'D P/<'D P/8'D P/4'F X  FX AFXjFXF`XcG F CY X   JG Yt<FPD0 XRD IfD P/0 'D P/, 'D P/( 'D P/$ '$P/  F Xp'D D   (D D   (D I (D D  Q ($D   (!A(<F BX  ?	D D  '(D D  (D D  (D D  (AD (F X?)F` Xc x
$&*D  & D  & &D 1D  &F $&@X1|PTTu AT AID +F X/D +TP @%F Xp/D IF X/{T1 @ D F Xp/!D  & D  & D  &D D  &  LIE,L  !D  & 	 I
L   D  &D D  &D D  &#@ 	N D/  E @@ID_  MB  $B s U Lp@jLKID +F X/D +T"@NDF Xp/ID ,F X/D ,T@^ EF Xp/ID -F X/D -T" @>CF Xp/L@D IF X/@T @0CD F Xp/AD  L~F` Xc x D  & D  & D  &D  !& 	 IL   D  F Xx/F` XcpD  &D  &
D  &	D  &$ &D &D &D &D &D &F@XB F0X1 F X!FXF X `\:o :oF@XB F D00X!  F bX D  @ F XP/4$Fp Xsp($D  ''P/0D (D D  'P/,D (D D  'P/(D (P/$D (FD 'D D   'P/ !(F!'P/D "(D "D  'P/D #(FD #'F XP/D /K$F X x$D  /(D D  (F Xt/P/D 1K$&D  (D #A'D D  ( ILDp <Lc D 1P/ F X/ @TD@B$D  +@ 6*@ 
@ xF` Xcp' Fp Xsx& D  '!D  ' D  '$&D &D &
D &	D &! &D " &D # &D  /'F FF X! XX b @'P/ F X/<:o:o! P/F0 X1F` XcpL #K@1	X1#C#K@S	mX2C#Fp XsK_D / K_D@1 XQ@%F` Xc xD  /K D  :K_D / K@"	X1 P#D  /K:o:o$@/ F X/D?A@La 	XXL F Xx/:o :oF` Xc xD  &D  !&fPG Y&D  #D  J<DP /F X xlD  K JD  F X/ K DP 7B3$@!6' ^sV:o :o,F@ 
XB:PG:$Fp Xsx&D  d@	4  \ P'&D  '&D  'U &D  'F XHD A)3HD B)3D D  'HD )3#D  G'HD )AF
CFXXRF0 F  @t3@@#D  D `F Xx/FPAG Y @epbA^_^B1h^_F @2 ^@3F Q2C F X!P/)!P/ ) P/)+P/)-P/)D P/)D P/)D P/)D P/)D P/)D P/)D P/)!G YpA<!D   < D  <+D  Q<-D  <<D D  $<D <D D  <D D  <D D  <D D  <AD <F` Xc xD & D  m&F D  n&U D D  &D @D  & D  &D 9D  A&D  D &Fp Xs D P/K3D dLdF` Xc x D  &"D  &*D  &#D  &D AD  &$D  & D  &Fp Xs $P/K@%P D  (P_8 D  B(2T X(D D  (!D  ( D  ( D  (!D  (D D  D  D (F Xt/P/ D F X/3T" DP d2( D  (!D  ( D  (!D  (D D  (D  GF X/%\!3\!N@% Q 
LF X/ AHn2Tq	XF Xx/F` Xc x$D  &$D  &/D  &%D  &%D  &/D  &&D  &&D  &/D  &'D  &'D  &D  /&Fp Xs0"D  &"D  &P/D K3@!	^_X! ^X! X! "F` Xc xD  &".#D  &#D  &D P/ K3@"	^_X! 
^X! X! #F` Xc xD  &#D  &3D  &L'F` Xc x"D  &"D  &D  /&H  #D  &#D  &D  /&~yF 
Xh
:P@@G Y x:$::$::$: : D  P <P@
&D  <D P/ F X/3P N D B$@@VP D  <DPF XxAL D  K$D  $K$^.D  D  D K$Fp Xsx D  KD  DKGo Fp Xsx2' D  'D  A'D  B'D D  'D  '1F` Xcp!&0! &/ &.+&--&,D &+D &*D &)D &(D &'D &&D &F #D  '	D  '
F@ACHf:o:oHT NsZ$P/@F` XcF X/#P/d&$P/`& P/\&'P/X&&P/T&'P/P&&D %Po(F)D  /Fp XsLD :P/H'D ;P/D'PlD P/L F X/ I'F XpX"  K !I'X!!K 	 
 GILDP d !H'E (Ln Ql^ F X/@` X#  PhF Xp/GD  F X/E@XD  	F Xx/D0 1D  '@d(@`(@"(@! 	Fp XsF` XcpN V(P/lK(T!KD P/h	F X/D  X F Xx/)	 LI $P/h F X/TF Xx/ 
 LI
L  D P/h X(P/lK(X!KD P/h F X/D  X F Xx/ 
 LIL  $P/h F X/TSXF Xx/ 
 LI
L  D  P/hF X/D  TF Xx/Fp XsF` XcpN zF GYD0 X!D b>P/lD 'D X. &D D  &D D   &D B&#P/l'D_@@X" ?#&$P/l'D?AX. ?$& D  1&D :P/l'D_@@DD :&D ;P/l'D?A\D ;&lFGYD XD P/l'D X!&D D  &HD &D D  &#P/l'D@Q X"4#&$P/l'D@2 X!4$&&P/l'D@Q E&&'P/l'DO@H'&
 
 LIL F` Xc x"D  KFp XsP/hD  KY@D  KD P/h KD  XK 
 LI
L  D P/h F X/D  TF Xx/ 
 LIL  Fp Xsx D  KD  D KFp Xs 
 ID0 dL P/h D KL  E Lo D 9D  F Xx/D  P/hF X/ hT^@Do@@Fp Xsx"D  KF0 X1D P/h KD  XKFp XspN *P/lD :F X/D :T@ @. KP/lD ;F X/D ;T1 @.  $&P/lF X/&Tb@$ K'P/lF X/T0@$ 'K 
 LIjL D P/h F X/D  X F Xx/ 
 LI
L  D P/h F X/D  TF Xx/ 	 LI F` Xc x D  KD  D K  LID0 dL P/h D F X/L" D  L` D 9D  F Xx/D  P/hF X/ hT^@D_@@@.(@$("-N N 	Fp Xs NF X GN F XJF0 X1 K^ ?
N Q HH$D  ?L @N N F X N &FP XR $N N 	G Y  F X !H&N 	F X\F0 X1 !L|F F X!XP/lD F X/F` XcpT  D &D H&D H&D H&#&$& &(&&&'&PDp %$'&DP /F XpD :K D ;K F` Xc x D  & D  &Ph"D  &F XHD  K$D  T&H$ K$T&D  &&Fp XsPlF` XcpO LH&'F XTR   &&H''  T@ $ '&HD :'F XTQ  D D :&HD ;'  T@D ;&(I&H'F XTP  &&'H' $ TI'&D :H'F XTR   D :&HD ;' $ T0 D ;&(D&t:o :o@F  (T F` 
Xc Fp XsppLT@D  'D  'D  ' D 'FP 
XRfFPDTt?@o@CBF 'F` Xc xRq 7'D  >K'D  ?K'D  @K$@/  F X/ XPE$F` Xc F Xp/2@2	TqF X0/Lr:H    T LF` Xc xJF` Xc xLDD D  E&D ^D  K&'D  [&(D  \&D #D  &D D  &D $D  &&D  &D D  &D D  &D D  &D D  &D D  &D ^H  D D  E&'D  [&D #D  &D D  &D $D  &&D  &D D  &D D  &D D  &D H  TL@4F` Xc xD D  E&(D  [&D #D  &D D  &D $D  &(D  &D D  &D D  &D D  &D HF` Xc xLED D  E&D \D  K&$D  [&#D  \&D #D  &D D  &D $D  &(D  &D D  &D D  &D D  &D D  &D D  &D [D  0D D  E&$D  [&D #D  &D D  &D $D  &(D  &D D  &D D  &D D  &D  D &@'F` XcxK' AK:o ;I86`YG P  F WbP  F 7P  F WPP F G  eF 7\ 7
BF X/ ;:oF` Xc xT TD  D K)D  KN D D  D  D K'D  F Xx/:o:oF` Xc xT D  D &D D  &D0 D@ @$@D  &'D  &D  !&  'L F` Xc x D  K D  KD  D KD  PoF X'D  eLq  F` Xc x D  K D  K IL   D FK$D0 LAF` Xc xD D  K*D  KFX|@@	N D/  JE @PxDO  B0$B0 sh:o :ol  H F0X1#GY^FpXsFX(D ^P/H$F X/F XxTK$G Y!P/|<"P/x<D #P/t<D *P/p<P/l<"P/h<D "P/d<#P/`<$P/\<D P/X<D P/T<D P/P<D P/L<F` Xcp!D  !&J"&D #@&D *D  &D  &"D  &D "D  &#D  0&$D  0&D D  &D D  &D D  &D   D &D  K$F0 X1DE  Gg L3FXDe ` GL5GYDU >` L?F Xx D  )D D  ) D  )D D  )*D  )D D  )D ?D  )D D  )D ?D  )D @D  )P/D  F X/"D  X#`")%D  ) D  )F@ XB "  F0 X1 F 
X: Fp 
Xs"P@8  D1 >@d: F@AXBQ8  F X xD  8 *D D  *D D  *D D  *D   *T N ;F.X?Dp G 
YF XpF X "8n FK(F$K(  P/K$ D !P/K$! ;#Fp XsxD D  KD   KD  `@??*cID  Tq ?'P/Ld@!F X /@_ T?(P/F X /! @V  @1@E@*% %!< Q F X/MP@ LA	V# <@_@P?I O ?PPt CD  4 L~F  X   Fp Xsx7D D  '*D  ' $  D TA ?D  '"D  ' 4 D Ta?D  '"D  'FP XRAF` Xc xL$E L F XIN F@XB dFP
XRD  &P/D F X/"D  Tt '&(D  &D  &D  &D  !& L F X xD  K F X!F X F` Xcp	"!&"&D #&D *&'&"&D "&#&$&D &D &D &D &K :o:o!D  F Xx/ 
 L IjL@F` Xc x D  K D  KD D  KD PoF X L"IJL @ D FK E L_@ F` Xc xD D  KD D  KF X  | @ 	N D?  DP @@IE  >B!$B sG:o :o|  H F@XB $F0
X1CFpXs'FXD   CP/D$F X/F XxTK$G Y!P/x<"P/t<D #P/p<D *P/l<P/h<"P/d<D "P/`<#P/\<$P/X<D P/T<D P/P<D P/L<D P/H<F` Xcp!D  !&J"&D #@&D *D  &D  &"D  &D "D  &D D  &D D  &D D  &D   D &D  K$F0 X1DE  Gg L3FXDe ` GL5GYDU >` L2F Xx$D  )D D  )D D  )D 1D  )D D  )D D  )F XP/@D  K D  X `")%D  )$D  )#D  )P/|D  K D  X`)Fp Xsp#D  <KD  <$KD (D  )D   )F0 X1 "A ND BD@ >F@ 
XB8" F Xp/"T  G 
Y8/ $F Xp/D )D  )D !D  )<D )D  ) D  )<@$C!  $  FXF X F XxP<G YPo8"$  #S@%E   Fp Xs8P/8P_<*H  aL^ N F X   	TV@@	Td?V3  \9@tN D (D  TqF Xx/D  D )Tq?F Xx/'D  F Xx/F X/@@A$ T? N D (D  TaF Xx/D  D )Ta?F Xx/&D  F Xx/F X/N 	|@ 
|'&N D (D  F Xx/D  D )F Xx/D  )F Xx/N 
F` Xc  AT L	A O @0	VO V \ \c@H D  'F Xx/F  X!PUT2O PB1^xU  T> ?O PQD  B1^D?Y;P/<_F Xx/*D  F Xx/D )D  F Xx/&D  F Xx/F X/	L  		T?  @ Q  Tt @>x D (D  Tc?@)9A 	@_ %T @F@ XBI&F  X!F` Xc xD (D  &FP XR(D  T &D )D  &F  X D  T?& D  & D  & D  &D  !&` 'L0Fp XsxD   'n
F0X1 FPXR%F X!F@XBD D    F` Xcp'D  'D  '!&"&D #&D *&&"&D "&#&$&D &D &D &D &':o :oF` 
Xc@: P_,e:$@A@	O6@H FpXsFX  G YP/d<D P/`<D P/\<D P/X<D P/T<D P/P<#P/L<$P/H<F XpD  *D D  $*D D  *D D  *D D  `*D *#D  <*$D  <*F XD P/@K$P/D$K$F` Xc xKD  KG F F X8X H' F0F X1X0#` GL1FpF XsX 8` L0F Xx"D  )D D  )D D  )D 1D  )%D  ) D  )@#D  )D  D `)P_8&Q,8$ #HF Xp/H$F Xp/Fp Xsx D  KE D  D KF` Xc LIjL  D P/<KD L  F X xD@ D D  *<D  *D "D  *F  
X!D HF X/D !D  @*F@ 
XBGD F X/D  D  *FP 
XR?AD F X/D D  @s@@a *F0 
X1DD F X/@ T> @P  bF @FXF @a 7L?@@0!L0@ L3@@0	L3@0	AQ eMYBu\8\eP	-\P'\P!\P\wP\P\1P	\PPT +ND dB` uFp Xs\B $KBuB $KPS|`\H0^ qD^AQ  \ A;P@ \ A5DpB!$DPYBu@B$BA$FP XRF0 X1Q|@$Pp@o @CP E9 %o F` XcFP XRF@ XB   F` Xc x#D  &P/<D  F X/D  X&D 7D  &F  X D  T ?&D 5D  &F XaD  T?& D  &D   &N# F`G XcY    GILF0F X1X#  LF FP X   LF` Xc xD  && D  &D P/< F X/D  X!"& 
 IL*L  D  T!"F Xx/F@XB $FP	XRF` Xcp&D &D &D &D &D &#&$&l:o;I$a ,&	$L@UGL ;"&>EIF X/CF X/=D T F XL/2CF X/)   @P	T hB"@F Xx/F X8/dF 	X/F X/ ;:oF@ XB:`F  X ;`F` Xc  E@xFFp Xs'Do@F0 X1XFXsG T@@@LAdGG-F Y X  YF  XFP XR
F` Xc	F  X F0 X1xFO F   FG X <D@ D  Y   G YxFp Xs@
'F-X)F(  EF X  F`Xc 
'
'F@X(
'F @X! H
'F  X   	F? @`B| d    F@ XB:F X; F0   X1#G XP YFFp@X <X# Xs^D Fp Xs@KF@XB 
KF FPFX  XR XF %X  F0 AO 
KDL`FpF`Xs XcFp Xs F X@gF  @O	K D L` FpXs< 'FX   F`
Xc FP	XRF@XBF0X1  F X! xbF X  FP XRx%H 4QT $N-F@ XB dF` Xc 8F1  &D @@@N XB XB 'F X 8Fp Xs E7@x'CFP XRD@3eF X@/G F` Y Xc <=@CA  F X@/F@1xfF X@sF  X!XB<FoXcG @B@pF0 X1F @bG  A @xG Y <FP X0@|XR@C F0 X1 #F  XP X  <F  XC  `@1LL L	DpE~D@D`F X<FP XR8 a(d   D`@!wFP XRhF@ XBG Ye$X  X"\C	G Y X G Y F  X <X! |F XQ"X DO@0aF  F D_X! <@X`b`F  X :F X;F@ XB  X"@D<:o:oFp XsD0gHF 	X/F  )Fp Xsp$JK%D   K$@/ F X/XBD$KF X/:o :oI(|`D@ 0#L"@H@=DP 2@F 9P0 P  bL dD  L V`E|@@D G/ IDPC$VP" P?|B!sN' 8HD  2F 
X/.D 3L  F  X 9#DP 4P@ CQ dP FP XR(F` I
J F  X @ :o :oPF Xp/F TpB	F` Xct -F X/F X,/:o :oF` XctPF Xp/s -F X/F X/:o:oF` XctPF Xp/3 -@# -F X/?F X/TB
F  X tF X,/A<A|	O F  X tF X/@!_
F  X tF X$/:o:oD  F X/F0 CDPv@@	SABB#F  cLF X/F  F |MF  @F 
X/F Xx/F 
X/F  X$F X/F X0Fp  XshF X @ K(   F  X tK &F  X d

K$&F  X TKF WF  X ,F D @ O F 0F @^PF O 	D  F X/:o                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               K  lF  A  xE  A  tC  I  A  K  <E  tK  $E  A      	PFD
P
PPFDQQ	QFD
Q	
Q
QFDRR	R33R                          































 048<@D`dhlptx| $%&'(,-./0189:;<=>?       !"89:;<=>?                                 @v 
    @     	J  P	                 	  	  @      @  @  	M e d i a T e k 8 0 2 . 1 1   n   W L A N 1 . 0 Z  Z   Z  $Z  (Z  ,Z  0Z  4Z  8Z  <Z  @Z  DZ  HZ  LZ  PZ  TZ  Vers   @v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Package: firmware-realtek
Status: install reinstreq half-installed
Priority: optional
Section: non-free/kernel
Installed-Size: 702
Maintainer: Debian Kernel Team <debian-kernel@lists.debian.org>
Architecture: all
Multi-Arch: foreign
Source: firmware-nonfree
Version: 0.43+rpi5
Config-Version: 0.43+rpi5
Suggests: initramfs-tools
Description: Binary firmware for Realtek wired and wireless network adapters
 This package contains the binary firmware for some Ethernet adapters with
 the RTL8111/RTL8168 chips supported by the r8169 driver; and wireless
 network cards with the RTL8188, RTL8192, RTL8712, RTL8723 and RTL8821
 chips supported by the r8192_pci, r8192s_usb, r8712u, rtl8188eu,
 rtl8192ce, rtl8192cu, rtl8192de, rtl8192se, rtl8723ae, rtl8723au,
 rtl8723be and rtl8821ae drivers.
 .
 Contents:
  * Realtek RTL8192E boot code (RTL8192E/boot.img)
  * Realtek RTL8192E init data (RTL8192E/data.img)
  * Realtek RTL8192E main code (RTL8192E/main.img)
  * Realtek RTL8192SU firmware, version 902B (RTL8192SU/rtl8192sfw.bin)
  * Realtek RTL8105E-1 firmware (rtl_nic/rtl8105e-1.fw)
  * Realtek RTL8106E-1 firmware, version 0.0.1 (rtl_nic/rtl8106e-1.fw)
  * Realtek RTL8106E-2 firmware, version 0.0.1 (rtl_nic/rtl8106e-2.fw)
  * Realtek RTL8111D-1/RTL8168D-1 firmware (rtl_nic/rtl8168d-1.fw)
  * Realtek RTL8111D-2/RTL8168D-2 firmware (rtl_nic/rtl8168d-2.fw)
  * Realtek RTL8168E-1 firmware (rtl_nic/rtl8168e-1.fw)
  * Realtek RTL8168E-2 firmware (rtl_nic/rtl8168e-2.fw)
  * Realtek RTL8168E-3 firmware, version 0.0.4 (rtl_nic/rtl8168e-3.fw)
  * Realtek RTL8168F-1 firmware, version 0.0.5 (rtl_nic/rtl8168f-1.fw)
  * Realtek RTL8168F-2 firmware, version 0.0.4 (rtl_nic/rtl8168f-2.fw)
  * Realtek RTL8168G-1 firmware, version 0.0.3 (rtl_nic/rtl8168g-1.fw)
  * Realtek RTL8168G-2 firmware, version 0.0.1 (rtl_nic/rtl8168g-2.fw)
  * Realtek RTL8168G-3 firmware, version 0.0.1 (rtl_nic/rtl8168g-3.fw)
  * Realtek RTL8402-1 firmware, version 0.0.1 (rtl_nic/rtl8402-1.fw)
  * Realtek RTL8411-1 firmware, version 0.0.3 (rtl_nic/rtl8411-1.fw)
  * Realtek RTL8411-2 firmware, version 0.0.1 (rtl_nic/rtl8411-2.fw)
  * Realtek RTL8188EE firmware (rtlwifi/rtl8188efw.bin)
  * Realtek RTL8188EU firmware (rtlwifi/rtl8188eufw.bin)
  * Realtek RTL8192CE/RTL8188CE firmware, version 4.816.2011
    (rtlwifi/rtl8192cfw.bin)
  * Realtek RTL8192CE/RTL8188CE B-cut firmware, version 4.816.2011
    (rtlwifi/rtl8192cfwU_B.bin)
  * Realtek RTL8188CE A-cut firmware, version 4.816.2011
    (rtlwifi/rtl8192cfwU.bin)
  * Realtek RTL8192CU/RTL8188CU UMC A-cut firmware
    (rtlwifi/rtl8192cufw_A.bin)
  * Realtek RTL8192CU/RTL8188CU UMC B-cut firmware
    (rtlwifi/rtl8192cufw_B.bin)
  * Realtek RTL8192CU/RTL8188CU TMSC firmware
    (rtlwifi/rtl8192cufw_TMSC.bin)
  * Realtek RTL8192CU/RTL8188CU fallback firmware
    (rtlwifi/rtl8192cufw.bin)
  * Realtek RTL8192DE firmware, version 4.816.2011
    (rtlwifi/rtl8192defw.bin)
  * Realtek RTL8192SE/RTL8191SE firmware, version 4.816.2011
    (rtlwifi/rtl8192sefw.bin)
  * Realtek RTL8192SU/RTL8712U firmware (rtlwifi/rtl8712u.bin)
  * Realtek RTL8723AU rev B with-Bluetooth firmware
    (rtlwifi/rtl8723aufw_B.bin)
  * Realtek RTL8723AU rev B no-Bluetooth firmware
    (rtlwifi/rtl8723aufw_B_NoBT.bin)
  * Realtek RTL8723BE firmware (rtlwifi/rtl8723befw.bin)
  * Realtek RTL8723AE rev B firmware (rtlwifi/rtl8723fw_B.bin)
  * Realtek RTL8723AE rev A firmware (rtlwifi/rtl8723fw.bin)
  * Realtek RTL8821AE firmware (rtlwifi/rtl8821aefw.bin)
Homepage: http://git.kernel.org/?p=linux/kernel/git/firmware/linux-firmware.git
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          rtl8168g-2_0.0.1 02/06/13             RL6223A_ram_code_patch_120822_misc/6223_patch_code_0829.bin 17:12:46 $          @    
               "%
1MIlvI

w pH"$&(*l,. 02v 4l68 : <> @  BvDF HJvLN PZRtTxVFX Z\t^H`Hbddfh jltnIprItvHxHz|H~HHHHI
H IH 4IdtI`d`tIbtHbAHb
`` 40 u Y     @          p     @   @ d    0C
F # C
   ,,e,-@0p _'Z	`k%,%,r@7,v@7,q@7,p@7,[	32\G,[a	_@B`[s`_F,&A 	Bm`P,3;Vu2W|@;&`@;&1`|@;&@;&E@0Y@C@`33A{,!pf`,p fD`, C@,`@,a@,`, ?@`(`,} ?@&)'               D` `, `, 0-`` 	,c0H()?00=L*`*`* `* g--> @F`-? !1>0=L*@@h  @! @ :@00
*0$A a(1o=i-e- @ @F`-?( @  @0
0=L*DB(1=_	1=-- @ `*   
  C
	a |!"bH<iiYB"RB
J| DD f E"Ez3=i/)$!"W!$DYBL)/$!$/*$"&eDYB/*/$"$1 fi!\CB(CB(CB( V&%YEBs!7/!t!7!+Qfi3'CB(	CB!(EYB E'BYBYi BYBYFiA Zi)!)"v'!'CB!CB!CB!C
 ')'BD!DF%CB!CB!CB!(CB!DB!BAiF i) )!T' 'BB("CBG( CBYF '('!CBYCBYD DFFi$B( 6H0&0E"EFiFP/BY BYE"EF YB 0&0i YB?  E }E \C O 	 	       pP>>3"B Zf<  .C
           C
F         @
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            rtl8168e-3_0.0.4 03/27/12       `      RL6210_patch_code_20120214 16:45:46 $    $                H  /    p         d    0     #    p              0   #  `@  x  ~ r   s  00 | l l o o 	o  o    0$2x@ xX U$2@ xX@U@|@h$2@ $2!"@|#@h$ x%12        `! @  	 @	 	 
 @
 $
 t
 $ }d t   }  @   @ $ 4 @D     ! @        H "?Y 7#7#
`  s   7#7#  &'#&'  xZ	{12  \+-)d.o!! ""##1$$%%&&-''zi e /6!/6!/6!/6!6!6!"10X60Z /#7iU6(6(Id6[( `!"N^de\ F #7  7#Z &! #$8|}89.9!#78`&"(!#) *#+$,&!	! # 	!	#"$	#&%(
!
') !*# +$,  !#7 $  i+	 a                		iy  "/7#6YEi yE/7#6'x
. y+#77# 7#%H|  5  6     i '2@ @16!( ! @ @; i"'D6DD)( #7 @w@"2tPDRL *B       @             p            0 B  #                                                                                                                                                                                                                                            rtl8168g-3_0.0.1 04/23/13       P      t RL6303_patch_ram_code 19:30:33 I           p     @   @ d    0C
F . C
   ,,,,~    | C
           C
F                D
       C
             C
       `C
             : :                 n n        h h        | |                      C
                               a a                          | |        Z Z    C
                                           @
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        rtl8402-1_0.0.1 10/26/11        `      nctl_pcspsm_8402_0704_driver 20:26:52 $          pp   } i } hH| L|L  L@ D H| LS ` h6g    W_X[0d[ k k | X| \0|X|\0y001`Lh d    `@0`WXX_  'H| L|L 0| `H| L|L L | \H| L|LS0 M2H| L|L| ` M ~ b0M     M|`Sh g    | `lH| L|L ~ bW_X[0d[xvkt 00L2H| L|L|` y0a0M d    WY_    L|`|T_| XX[0| Xd[$H| L|L 'H| L|L | `L_$H| L|L | T g     ~ j$H| L|L  ~ h0 N@ DS h6g    W_[X 1gX ~ b- + k) ) h6g    $ N|P| Phvg    |  @N7HDA@N@| T|L|LL C+100`NH(F`N(~(F@| T| X| \A|L|LA*F1N|DHDH|L|L$H|LAAH|L|L A a1|Da10N@| TDA0NH|L|	LEA1N2H|L|L(D@|@T|X|\A1 O h6g    W_[X1gX0  0p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          rtl8168g-1_0.0.3 10/23/12       `      RL6223A_ram_code_patch_120822_misc 14:46:51               p     @   @ d    0C
F # C
   ,,e,-@0p _'Z	`k%,%,r@7,v@7,q@7,p@7,[	32\G,[a	_@B`[s`_F,&A 	Bm`P,3;Vu2W|@;&`@;&1`|@;&@;&E@0Y@C@`33A{,!pf`,p fD`, C@,`@,a@,`, ?@`(`,} ?@&)'               D` `, `, 0-`` 	,c0H()?00=L*`*`* `* g--> @F`-? !1>0=L*@@h  @! @ :@00
*0$A a(1o=i-e- @ @F`-?( @  @0
0=L*DB(1=_	1=-- @ `*   
  C
	a |!"bH<iiYB"RB
J| DD f E"Ez3=i/)$!"W!$DYBL)/$!$/*$"&eDYB/*/$"$1 fi!\CB(CB(CB( V&%YEBs!7/!t!7!+Qfi3'CB(	CB!(EYB E'BYBYi BYBYFiA Zi)!)"v'!'CB!CB!CB!C
 ')'BD!DF%CB!CB!CB!(CB!DB!BAiF i) )!T' 'BB("CBG( CBYF '('!CBYCBYD DFFi$B( 6H0&0E"EFiFP/BY BYE"EF YB 0&0i YB?  E }E \C O 	 	       pP>>3"B Zf<  .C
           C
F         @
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            rtl8411-1_0.0.3 06/18/12        P      RL6208_20120608.2 13:53:19 $                H  /    p         d    0     #    p              0   #  | l l o o 	o  o    0        H +wHb Z.   <!:?!:   &'&#'  Zx	(2&! #$8|}89.9"!:"8"M"  +}.o{/!!""5##1$$%%&&-''i '2@ @29!( ! @ @; iU^9([9(Id[9[( b!"N^de\ F [!:  [:!Z i'"G9DD)( B:!&067?#? !%',,,i&G-:!'/&8Xx$232(),(),() w@@ *B       @             p            0 #                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |}@DDDDMG NML O QJK01X23YMZ$OON x
ONxNNxxNNxR H IQXQ fZ |2[}}XUeHIVVHIfHIeJKVVJKMLM MMMxNNxN23YMZ$0h17NLMNO OxN@UT `ha`aHXIHI 
PF
&`aX`a@PHhIHXIHIM  N "MNy"X	muO   O                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  #  ,  P  A   p          0    p             0       
       /                        #  
    H h f       !   "   #   $   % d& @' E(  ) 1* + ,0, H- X. @/ D0  1 c2 d3   4   5   6   7   8   9   :   ; c<  }= Y> c@ dA 0D HE  hF fG |H cI   J   K   L   M   N   O @P EQ XR cS cT fU  V  0n  D0  X ^  
  0 D H  ^ _@ HD  @ hD  X         z0!d|c@D add  P|QadR@S@ET U V@|W!dX|YdZ0T% T=P@l#2H @#HE:}24Hl @$H E@`EH  DH} h+ U 3I } MhO@D O! "|#$HM%'3&@M'( ) |* L+, -./ 01 2393:d@@A|BCHMDF3E@MFG HIJM3K,L3MNO P3Q  dghw3i2j  wKxhyKz@{ED|N@}aD~	c@TK`| LKc3O 3O  lll3h|M3 M3V@D^@DO7 79 |L | L|RLpD|@L3G@iD+IyD	|HM3@MO  | L( |RLpD|@L33   y! @ E U   % 5 @E U e  u    p        ) @) $) 4)  D)  T) Fd) t)  ) P) ) ) @) )  )  )  * * $*  4* PD* T* d* t* * * * t* @* * * *  + D+ $+  4+ @D+ T+ d+ @t+ +  + +  + + +  + @+ , , $,  4, D, T, d, t,     !           A  @A/(@A 0@l   'I  g""+*$*%%&+[$D"#;" (B(:%2)*)"))     *g"#X--M  $D%:4II*     Y9 Z,-[0,-ZPj<=dXZ,-Y[,-XZFi"X#nXn""'U&;-;-;-0;- ;- -;-;-;- ;-+Y  ;- !-p&i-NO-";D!-NO-O-!iE ';- !  ;-;!-iL  X   X X6 "X# d"d24X5Z >-%""#6Z7X 1`:>&g77aQ A- C'6tt.tG  9A-  4  %
,

m

-
Ud                       p            0 #  (   A !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Y  |Y}99* |X}@9FO	O  |}@DDDDMGN MLO Q JK0X12Y3M$ZOOxN 
ONNxxNNxxNH I QQX fZ |[2}}XUeHIVVHIfHIeJKVVJKMLM MMMNxxNN2Y3M$Z01h7NLMN OxON@TU `ah`aHIXHI [PF[w`Xa`a@PHIhHIXHI M "N MNy"X	O Q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           #  ,  P  A   p          0    p             0       
       /                        #  
    H h f       !   "   #   $   % d& @' E(  ) 1* + ,0, H- X. @/ D0  1 c2 d3   4   5   6   7   8   9   :   ; c<  }= Y> c@ dA 0D HE  hF fG |H cI   J   K   L   M   N   O @P EQ XR cS cT fU  V  0 D0  X ^  
  0 D H  ^ _@ HD  @ hD  X        !d|c@D add  P|QadR@S@ET U V@|W!dX|YdZ0  ) |@|^@ | |    H  $4   1  @A/(@A  A(  '   ,r<"",F*) +%%Z:Y+i '/P !  P/=9.5i-NO-"6.NO-.i L  X X  6X "#X "24X5Z /P&!$k  |}`ffUDff82|}89!.?hU>.&!(!")$*.&!4!	. K	$.!0.&%(!

')$ *. !  :$X|} \< LMXLM<i$Y%\%i
 3
$$&m&. 
5R  2 :$eVV		 
b$$&H!	$$
 b4|
#	
 %""#6Z7X 1`:>&g7aQ /P C'6tt.tG  9P/ %

,m



- U4                  y! t B   t   @ t@    t  I!    p            0 #    #   @          A (                                                                                                                                                                                                rtl8411-2_0.0.1 07/08/13        `       RL6301_patch_20121226.CFG 15:59:03 $    $      @    
                 

    L 
 " $  &( *  ,. 0  24 6  8: <  >    @          p     @   @ d    0C
F . C
   ,,,,~    | C
           C
F                D
       C
             C
       `C
             : :                 n n        h h        | |                      C
                               a a                          | |        Z Z    C
                                           @
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        rtl8106e-1_0.0.1 06/29/12       `      nctl_8106_20120615_driver 17:04:47 $    $      pp   L@ D H| LS ` h>g    W_X[ a0d[` k k | X| \0|X|\0~001`Lh } i e    a:0`WXX_'H| L|L 0| `H| L|LS0|h    |h L| h| h    #|#\H| L|LS0 M2H| L|L| `  M ~ b0M M|`h(g    | `lH| L|L ~ bW_X[} a0d[}`X V kT   00L2H| L|L|` ~0h0M(f    VY_  L|d     } h|`}U_| XX[0| Xd['H| L|L | `L } d    _$H| L|L | T } e    00 N@ DS h>g    W_[X} a1gX}` ~ b  k  h>g     N|P| Ph~g    |   @N7HDA@N@| T|L|LK B210`NH(F`N(~(F@| T| X| \A|L|LA*L1N|DHDH|L|L$H|LAAH|L|L A  g1|Dg1  0N@| TDA0NH|L|	LEA  1N2H|L|L(D@|@T|X|\A1 O h>g    W_[X a1gX`0  0p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          rtl8168f-2_0.0.4 03/27/12       P      RL6220B_20120321 16:46:32 $                  /    p         d    0     #  | l l o o 	o  o    0        H (5E_k    99  xZ	2&! #$8|}89.9"9!8-""r  *,\gO.z/!!E""5##1$$%%&&-j''i'"G9DD)( 9 w@@ *B       @          #                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               rtl8106e-2_0.0.1 04/23/13       P      } RL6303_patch_ram_code 19:30:44 I           p     @   @ d    0C
F . C
   ,,,,~    | C
           C
F                D
       C
             C
       `C
             : :                 n n        h h        | |                      C
                               a a                          | |        Z Z    C
                                           @
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        rtl8168f-1_0.0.5 06/18/12       P   B  l RL6220A_20120608.2 13:53:01                 H  /    p         d    0     #    p              0   # }@ | l l o o 	o  o    0        H %B\ <`  s   8}8}  K &'#&'  xZ	Ol2  /	*-u!!""5c##1W$$%%&&-''&! #$8|}89.9"z}88.&(!") *#+$, &	! "} 	!	#"$	#&(
!') !*# +$,  "z}8 $  i iy  "$08}8PYEi yE$08}8P'x. y+}88} 8}%H|  5  7t                                      i '2@ @028P!( ! @ @; iU8P(P8(Id8P[( !"N^de\ F }8  8}Z i'"F8PDD)( 8}&067?#? !%'G,Oi,,|il&,8}'/6Xx$232(),(),() w@@RL *B       @             p            0 #           	   2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 pp   } i } hH| L|L  L@ D H| LS ` h6g    W_X[0d[  k k | X| \0|X|\0M11 L`S3H| L|L  h f    0M| ` h6g    S0`Lh e    `Y0`WXX_'H| L|L 0| `H| L|L	|\           D, L | \H| L|L
|\           DSD1 M2H| L|L| ` M ~ bE0@M@| `DR3H| L|L _Uo @|@``MWH| L|L |\           D 0x0M0g     Mh f    | `lH| L|L ~ bW_X[0d[[YkW 0	1L0}0e    | T2H| L|L|` 00MWY_    L|`|T_|\| XX[(1| Xd['H| L|L | `$H| L|L L } d_$H| L|L  ~ j$H| L|L  ~ h0 N@ DS h6g    W_[X\1gX b  k  h6g N|P| Phvg    |  @N7HDA@N@| T|L|LJ A1`NH(F`N(~(F@| T| X| \A|L|LA*1N|DHDH|L|L$H|LAAH|L|L A 1|D1M1N@| TDAM1NH|L|	LEA$" 1N2H|L|L(D@|@T|X|\A1 h6g    W_[X1gX00M1  0p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           H   S9 c             C                PD                                             V     Kj      
	 
	 
	 
	    "!   "!   "!   "!  "!  "   10  010  01/ 01, 01(  01   01  0
			


		
				         $&*!')*   #(*,      $ 0 H `    P x  @0,@@        $ 0 H ` l ( < P d    d  hX 

$<	
             ):"P%"%"):""P""):"P%"%"(p8"
"P	"	"t"):"P	%"
%"*"
"P	"	"):"P	%"	%"KJIH""%5""%p8""ptptsth`CH/@)T$3TD @VF @D=~`T?0	T`T%`@A A AkA  "#`~]q]qk Q$ :]qk q$b`(#]qk Qe%p$e`]qk QS]qk$be#`X" C_"&`"	}at""WrWy`abqcdeqff`uqt$buqtQM`ab"`u#$%m[''`DE}`~0bcbPNpbt3 G_bt3 GObt3 FYb$pbt3T C_bt3T CObt3 C_"}j`Ny0	t`"T`tTo"%`$4Dt/4D$4t	-4Tt!/4T" ETEu "`0`e$`8t HDH  GDG  EDEo84qS%~+ EDE  ETE  FDF78t>qS%~+ ED E  EDE  FDF " ITDI DI u(3)u*+0()*+"u0u128012"Oul T`tt 0t 0}tt3
}tt/Wjo_.mWG 0AtZdtuDE}P~0bEwHQP D@DuCOd$/tHW0
SWWW0SWad<`1`<pw134`&p{zy5~l	5T l4"3PA3d`ABp%EpCpFpDpGpTBDCEDFEHFIGJ. /013.B`RaSbTcUKUPK@9=Qb"`HaIbJcKtI@/"KJ"I/":d`ai FDFG Lp22`>CS%~+"t9QbLtG@Ldp8=QbL EDEG 2`4CS%~+"dHIJK"u  tjtKS<U04U15U26U3740<t40<t402<t0uDuE X~0b[ttv402<t0uDuE \~0b_ttu40	<tmw40<t Q50=t ytjtK 2y}}ghgTwTo`qg0-w w0	g NQw Jg0Eh?wTg %`+NwTg V1`wT`	`wTyTop#0wTkO/dkyT"D@iHwTD"dp.}}1,}1,W<tyT
T"6t}t}}1}1D
DrXi0opwTP}o"_$bj```/$p@: B S' B S B Sj"$`pxtxptxm"`	o"7t"tn_pt}1j`yowTD"wTD`G`wTD"n`"wTD"T`	iHwTD"SvpupyTP" "kF]k`t!/4Dt!/4Tt"}1,j$P!z`}wTP}y"{`TTp'#n|Tn@i
p""08PG QG RG SG <t4TG }UG }VG }WG u  tDtP4U(,6U*.U+/, !4tMNOPQRSTTT@ST op!T0!RTMT?	QT%$4BST%$4B	@u	u
 C_u	C_ST/>u
 C_u	C_T #ST%$c4BO04.ST%$4BO0OTST	j$P@z`2[<tqdp(uDEX~0b[ttvqL,0&4ttXYZ[\]^_,04t,0	4tCW,0&0T4t u u O TD,04t@.0<6tCW@Tdp)70
t
@0D.06te.0q6tidpej`ajd`jdp'mxmpxmmo`nW<t|TTj$P.016tidp%j`!W<tuDuE T~0bWt.0/6tidp#j`W<t{|TTpL.06t ij`zd`x.06t@ij`|TTpL/0	7tOytDtP 2Td` "MTDTD{ z yXCzyMCd`l`	Ck B_Ckcdeuf{zyE	CkcdeCk$bTf{zyE	td"Tt/4uu@%At@/4t/4"/4"
Tp|TTL
0|Dzd`x|T
|0 DuDET~0bWt{t"T"Fat"_<tuDE\~0b_ttuwTPL"u	'C_t-4T@%$4At%$f4At/>%$4t-4"qdp*|Tp"yTP| | 	op" "Mj`qidpkj`)$`%$$P#m``mp
xm MtM`1|DtDET~0bWtwTP}L"u  ttVS Q U_==0t@;T8`G5=0 Ut;TG5ttV 2" !""TRRpXt~ 33]pXuC_SucudueSuf{zyTE	TT0Yu C_Uu C_VuC_WuC_XuC_Y3uC_UuC_VuC_WT{zyURt3_Rt3TWDW"ZCCXXYYYYFY	Y%Y.Y6  Y?ZCkZCkZCkdZCkZCk+ZCkDaZCkxZCk1ZCkvpD" B TT T]C_Ck B TTb B T@Tc]u	%C_du	$#t5{C_Ck B TfCkBM_Ck B fCk B__Ck B d$bb]$4^u	)C_u	*C_tcu	+C_%$4u$t5uu	%C_u	$#t5ut%4CZ ZZ[[=[R[g[[[\  \H%$4tt<%$4tt'%$4tt%$4t%$4ttH%$4tt'%$4tt%$4t%$4HGBMF B_ED?KBMJ B_IHXOBMN B_ML+SBMR B_QP$b$b_BM$5$b B _BM^^%$4N`;ut~ 33%$4^_N`$] PV%$4N`=ut~ 33%$4^_N`i Pi%$4N`;t~ 33%$4^_N`j[R%$4N`9t~ 33%$4^_N`$
jiu	'C_ju	(C_t%4@it%4t%4t%4Pjt%4t%4i@"t!@"t@"t"""$bi" B z B l$bej`M"$b P B t#%4" 
 B !" B <`p!3 GTGG }@1f$"	$b. B / B / B / B /"i|jytwzvuxm{ottnrtql"{n|"Wp7yTP,p&}`p	q`" " +D~2 DG  	T	G  (T(G   T G  %D@%G  	T	G  %T%G   D G  (D(G  0 	D	G  TG  +T+G ~2lF]l`t!/4Dt!/4Tt" P90T$4T$4Tt.4M"u	*C_d`a%$4  Pau
$ t5u%$4V%$c4Xt%4T?RTu	'C_[td%4@;[S@[ST@RNdp)SAJt#%4@@0S@'SAJt#%4@ASA.ZZu$Pt@5uRAYX @	iZ%$4$b~ B${%5 B ~  B${%5 B ~  B${%5 B ~  B${%5 B ~  B${%5 B ~ V${@%$4R%$f4AtPmR%$4AtP}iZtd%4d`"S@=.S@."S
@pS@CtCtC%4t#%40PCd`tD%4d
`Q$3t!%4dtP2$3t#%4dtPt%4So`=t#%4B@u9@uut!%4tD%4)td%4tD%4td%4St%4tC%4u	+C_td%4d`B~ V${TtC%4uBB~ ${%5UT@pFpu9u/*(puuuYX @YX @tC%41$td%4tdP%4%4B C C C C%$4%$c4%$4 P!g"t)4TTu	'C_\%$4]%$4_%$f4At%$4@hpt)4\@@!$t~ 33]^_Np#P9t~ 33_^_N`d`d`	]0|4\mpit)4u	)C_ D@"%$4At%$f4At/>%$4[@V\t)4%$4At%$f4At/>%$4"t)4Dt)4"t*4TT^u	(C_`u	'C_a%$4b%$4d@	a^pA_0	^_pA^ PA]\`\@r@%$t~ 33d^_Np+\P6t~ 33b^_N`\_]o`\_]P\`%$4At%$f4At/>%$4t*4"Dtttt-4u
 C_u
C_u
C_u
C_u
C_t-4ttD-4tC-4%$4%$c4%$4%$4%$d4%$4tD-4t$-4td-4AtAt/>%$4u	*C_tu	)C_tt-4tu	%C_tu	#C_tu	'C_tu	(C_t-4td `a"4t""3S  2+2+Rd$tl0t DDS$"R 1DT 2TOD 3TD 3 RdPRdP 0BM" "&"e&`&&u&" "#dp@[D FDFG  DTDG  FTFG ''G"PGt3 F_Dt~ 33 D[D$t3Dt~ 33 B["pppp"@ "2~ 2uB D	DCS%x~+!CS%~+%CS% ~+)CS%p~+h% -0,h% -0,"x~"e%~"e!% ~"e%%CSTTCST%x~+!CST%~+%CSD% ~+p~"e)%% %p~+h%    0,h%    0, TD-"p!-`|CS%~+CS%D~+CS%\~+CS%l~+CS%p~+CS%t~+CS%x~+CS%|~+CS%~+CS%~+CS%~+CS%~+CS%~+CS%~+CS%~+CS%~+CS%~+CS%~+	CS%~+CS%~+CS%~	+CS%~+-t"-d`|~"e%D~"e%\~"e%l~"e%p~"e%t~"e%x~"e%|~"e%~"e%~"e%~"e%~"e%~"e%~"e%~"e%~"e%~"e%~"e%~"e	%~"e%~	"e%~"e%~"e%CSD%CS%~+%   D~+% %\~+% %l~+% %p~+%%t~+%%x~+%%|~+%%~+%c%~+%%~+% %~+% %~+% %~+% %~+% %~+% %~+%$%~+~"e%CS%CSD%CS%~+~"e%CST%CSD%CS%~+~	"e%CS%CSD%CS%~	+~	"e%CSTT%CSDD%CS%~	+~"e%CST%CSD%CS%~+-"Pet3 G_Dt3 FOD`t3 Eht3 Em$t3TDt3 COD`t3T BOt3T B_D" B ;0K2t~"e4% B x$4CSTCF>%"-2~"eTD4%4CS%~+;0}GG  HDHG  FD GTGG  HTHG  FTFG 8"EG <BECFDG.38:L=92 QDQG Ld`	:`x~.P;/P(0P
/1P0/. DT`v02BP$CPDPCB D02EP$FPGPFED" B : B %%9$b%%=`HaIbJcK3]9Jb]$:p!9p!=p!3]Lt]$G FDFG 2`>CS%~+"t ETEG dHIJK3]<D } 1-:p/LG FTFG "3]} 1I]$"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  !'06  -              EN                o                                                    V                                                                                                                                                                                                                                                                                                                                                                                                                                                  2Bu$g4y$t@ @yxp0D"#$ x0 P t%tm`@'$tm`$#$0 00TT|TB"xt`vxxv0EtCu`uy"@"t// D0P!t.ti`				@@"t.i`			$/E/ "@"#$0T
t/BMP.t/tt/l` "t/t/l`	 "@"#$00 0BL#$0`-`0P.0`%~0#0TNBMDVTO"(p8"[ZYX"KJIH"""""%5"""ptptsth`EB@)T$3TD @VF @E~`T?0	T`T%`@ A	 A
 A Y\$^]_u  ttE5ttE 2 TU59U6:U7;U8<9T2:U2;V2<W2S"u  totFlxA0'A0lC0QC0MC0LC0lC0mC0m3C0D0QtotF 2'`+TTp*")0t}*$T0HT0HopHpH$pHP$`Q$pH$`HI^pII4`suf&d`HsHpII4	HI^d`d`1^14dp\rdpT1P1^14p1s%T?01"d`t=$T0t(T0t)@t"t "dp1%T"to$D*t#"t"% D@*tT*t#""% *tD@D*t'D#t""Te`"*t#"1*t#""t:7tQW1*#""t:  ~.    p~.     U|~-\D D |~. t?TSD "4t@t=/Mt0/4"TTNTTOTTMTTNTTMT TN a^0mt!T?0QND }@&T0DT0DT0D'"`t'"d`S at1T?0QND}@&T0DT0D'#dpG=Qs	)}G=A*#'D@0t'#}#}G=4)G9Z"}&}t=/^t0/4"p7}x&}&}qW<t}G=$TT
T"6txt}xQW}QW
D2X%T* }G=%D"0#d`:'p0
*d`(%T0-op
."0!t'`E%T0;0-suDd@TDu?0Wt"d`#'p#&Tdp".-p- .%D02XW<t+TT&T$P0mn%T0-" %D"p<"'dpf&T`Q*p1*d`f&[<td`8:TX~P[tt$D"*p}G="` "Td` "P`-s}QWB0-&
DDC"S`"Vt:t"Vtt "pppp"@
D  "2~ 2uDt-4T?`t!-4Dt-4D"t!-4Tt-4D@"s?ttE/Mt8/4"D9T~T3TT3TTOT3TTOt"t"M'`XdpPM.0#M1spMM`$+D/OWt* }G="L'p!rd`!r&T`"$`p!.`0`p- Lt0#L1spLL`C+D0`	00u$//OWt* }G="C 0"'p001sA[N<"1sq"K`SD0t01?0e""0=#~ ~"} }Np#0!QE#	#pG="#d`}G='d`&T`NpG="0?#~ ~"} }Np%0!t#
#G="EE d`!E d` q1""op`>`bpapa$`APTd`CXp}+yt`m!btqVpPLtL?47/p)2%t{p	"+"to'T"t"+I"t""t"+"t"t"'T""Xe"""D tt	t|~-\T D |~.  ~.   p~.  >`"e"t"""""'D@"t"e"to'T"t"D `"EE(Uq UzUUUU U!U#U$U%U&U  UEjEeEAEuEDEKEjEEJlEk>E>EkND"ZKTETN0 F G"T?TN T@ e"?T@"T'T TT&TN T%$TNTT&TO )t')&T"Er'L>'`E T r"u  ttVlI0oyI0I0oJ0oJ0p"K0QxK01K0L0D'L0NL0p8L0pttV 2'`40#:TX~[tt"$TG*""1"{zyQ+'	Qd`"VV@t {zyR+'dpwRT`TpRT0`gT`bStSSRpT?TTT?T0TTTd0pTdpN T@WpAtXtVttWXRS2"  	 " 0"<1dt-111@1_56785P26Q27R28S2u=>u?u@0=>?@"uEuFCFuGuHb8EFGH"08P2Q2R2S24t<T2}U2}V2}W2 D2 TWQw2wQQ^CAtCACA1Q? D@2u QhQQCQbQoQqOQQETt"M""uu""D"tt"?T"BTTt
"TTTTTTt"Dt~ttt$tIt"Q 0d`>RQ@D"QuD~ 2R2Q @0"'&TT$TTT-t$TT0/t2t+$T)t$T*t$TTTTT4     <1t<1tt@8ttTD(tTTTTTT"YYd$$t\*)o`G*_2gBM$0$00
#`"""*p/" T2PZ	 0eP`>[Z@D"ZuD~ 2[2Z @0"12(`/0t/t D2 D2~ 2-R2`scRR$gt] PQT`P0 )SQ?P0 pCQ SQ$P0 gSQP0 	anpCQSQQ2""  ""d` "AP%$0t ""`t t"t "DN`qTp	t~ 33]p	uE
uuuu{zy+	uE
	uE
	uE
	uE
	uE
	uE
	uE
	t3_	t3{zyU?	TD"DN`l     $~-\ pDu$b4-\ x DTTDD DT $~.u$b4D .DD $~.p 	(~-\x T`u$f4u$d4-\T D     x DTDT u$`4D ._"xt	x t 0$x$ 4xd`d`d`axxP--Z$ 4t-xxxxxxxxxxx3x	x4x
x5xx6xx7xx8xx9xx:x$`u$`l$`ax)axaxaxxx2axxx2ax`aaxtxd`ax4x x3 Dx5x  DxDxpa1_xDx8x x7 Dx9x  Dx Dx D xDDxDx DD DxDxD xUxxxqxtxP`
x/!" "x$x'tx'ttx% Pcx&x'@t3.x(`-t7.x2x%/4 x)x2x)^]Nx$/x(2x&x%Pix&x'@t3.x(`-x&-4 x)t7/x2x)^]Nx(x&-4 x&`x$-\x.Dx&x'P]t3.x(`+x.Dx&u x)t7+x2_x(]Ox(x&t {t*-t<x*D x$.""E 0E P8ETt/4t/4p%p$*pI*d`&$TTTT""T"*t"t9tfT?@$`4$`$<pA333Ttit,TttTtt "`BCCBB_o`t9tfC"j_ivff@Pty/4tffif@ht.4uu
{zy[+\/'v[1$xu\TweggPWw >g%x/$y4{eu$]t5u+egvf/g@jj@@A$y4lTTkTtz/4mrE(h hisjiiiiij3	ji
  jj$|4t{-4tm/htAj$|4x j${4Dj$}4x  Dj$~4x  Dn nD r.htAmj${40mj${40jhtAhtj$|4x j${4Dlx  Dn k$nD mUmhtj${4uu{zy3+ml{4htj${4uu{zy3+ml{ch$j/"	.= /> /? /@ /A" 0&8 9TTO ;"8ttTD(t">>"J K"`- @D uD
~ 2"E
 ~q``:E ${zy+E td"~~ d`2pu$Bt5{q` 
`""""4U=AU>BU?CU@D4ABCD"<UEIUFJUGKUHL<IJKLS"0"dp'`W<tOWt"dp&'` W<t$T+TTpG*"'`&Td`"p>iNOt "7| %`t/4Dt/4t	/4Tt!-4T"NK@}iNOt "LTp	+Tr0K'dp*$ 	+D(&Tdp-+D +D&Td`O+TL+0OWt$D"T"_<t:T\~P_tt$D*d`G=O"LLTp+TTG*L0!'dp +D&Td`O+TL+0OWt$D"T"0~"`"T`D0 "'`s?0I"'`50$:T\~P_tt"$TG*"qHM$0DTM0/0/t$02t2XT"D""J`SD"$T0'T%0DTttG*E0HI`At~ 33[`I"GPtET"OI"<d`D"$T0,T%0DTt'`G*n@
/"@$mptw/"N N N"PdO @D@N"OuDtE/^t8/4"Ppt3 G_G2t3 FOF2`t3 EOt3 E_E~$$t3 C_C2t3 COC2`$t3 BOB$t3 B_B2"$T0+"$`p(-t"p
;---%D"Nd`tg+T`tV)PtD0t8+0t)%T? t >`t"t "`Bdp:%T"tTO$D@*t#"tt""to'T*t#"Te*t#"$T?0T+TTpB=0+T0X80@%T"G*""+ 0""t'D@"t"'D@I"t"I"t""to'T"t"Qs#d`
}G=" "W`H<t$T?0T+T"0+T80@%T"?}miTUUTSOUTTt,4Dt,4Tt,4Dt,4Dt,4DSRQtPtt,4TMt/4"+:P$4 t /4"TBTN0
 C"E0-HFTpOItH"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  P   > %             C                Hy                                             ^            
	 
	 
	 
	    "!   "!   "!   "!  "!  "   10  010  01/ 01, 01(  01   01  0
			


		
				         $&*!')*   #(*,      $ 0 H `    P x  @0,@@        $ 0 H ` l ( < P d    d  hX 

$<	
             ):"P%"%"):""P""):"P%"%"(p8"
"P	"	"t"):"P	%"
%"*"
"P	"	"):"P	%"	%"KJIH""%5""%p8""ptptsth`CP.@)T$3TD @VF @D=~`T?0	T`T%`@AO A AaAbA  kT~DE5"_<ti\~b_ttp#TP+""q`~}$/Qt "S#C#S#C#"""""  __q q!!`uqt)uqtQM"/TpS&S&/0C&sd`S&/0C&RWttt"S&"`"T`D@0 "u  ttES<U04U15U26U3740<t40	<te408<t0$iX~b[ttq408<t0$i\~b_ttp40	<tsS40	<t Rd50=t/D $d50=t60>t60>tttE 2}T#To`p0*# c#0	 R# L0E^#T b`*#T 	c`a:#Tcz`"D@"^\S#C#"}%`a0	t%`$4Dt/4D$4t	-4Tt!/4T"E	}Gt "u  tytH4U(,6U*.U+/, A4t	
T@T op!0!T?MT?NTM%$4BTM%$4BN@uNu
M C_uNC_T/>u
M C_uNC_ $TM%$4B
06M[h/TM%$D4B
0
TTSNM[%$PEs`7[<tqdp-iDuE X~5[ttqqD,0!4t\F,04t,0	4tC,0$0T4t u u  Tq,04t@.0_t6e_.0;6tC@Tdp(70
tOO
@0b.0	6te(.0(6t"dp%`W<tDRWt.0+6t" %`W<ttS&&TpD.06t "%`sd`DD.06t@"%`S&&TpD/0	7tatytH 2Td` " C_"Pct3 G_qt3 FOq`t3 Eft3 Ek$t3Tqt3 COq`t3T BOt3T B_q" ETEu q"`0`f$`t HDH GDG EDEqCS*~/ EDE ETE FDF8t CS*~/ ED E EDE FDF" B  B %%)%%`*a+b,c-3?R?$ppp3?.t?$ FDF` CS*~/"t ETEd*+,-3?<D } 7 +p-. FTF"3?} 6?$"08PQRSYZ[ B 0Kt~'*YZ[ B x*lCSTCF *"-~'TD*CS*~/0}G HDH FD GTG HTH FTF" ITDIDIu(3)u*+0()*+"u0u128012"1uwQ^^^`nw_2=wO 0AtZ^D}3^ D@KuC1d$.tP0	Sq0Shz`1p}4`&p{zy5~wb	5T wC4"P!d`!$p%'p%p(p&p)pT$D%E&F'H(I)JLMNO$`4a5b6c7-7P-@Q"`*a+b,c-t+@/"-,"+/"d`a FDFL.p2` CS*~/"tQ.tL@.dp8Q. EDEL`CS*~/"d*+,-"T44p[t~ 33]pTuC_5uuu 5u!{zy6E	6T0Yu C_7u C_8uC_9uC_:uC_;3uC_7uC_8uC_9T{zy7\4t3_4t3Ta$D"<CCTTTTTUT	TTTTUU,T-T.  U<Ckai<Ckp<Ckp<Ckq=<Ckqk<Ckp<CkG<Ckq<CkM<Ck}U<CkO<Ckp<Ckp<Ckv#D" B TT T?CACk B TTD B T@TE?u	FC_Fu	$Dt5{CACk B THCkBMACk B HCk B_ACk B F)D?$4@u	JC_u	KC_tEu	LC_Y%$4[\Yu$t5u]^_u	YFC_`aYu	$Dt5ubcdt%Y4CV VVVWW(W=WdWWW  X Y%$4tt<Y%$4tt'Y%$4ttY%$4tY%$4ttX Y%$4tt'Y%$4ttY%$4tY%$4X G]^_BMF]^_ B_E\[DXK]^_BMJ]^_ B_I\[HXO]^_BMN]^_ B_M\[L+S]^_BMR]^_ B_Q\[P\[]^_)bcd)_BM]_$5^)bcd B _BM\[a`^\[a`^Y%$4N`;uZt~ Z33Y%$4^_N`Z$]ZZ PVY%$4N`=uZt~ Z33Y%$4^_N`KZZZ PKY%$4N`;Zt~ Z33Y%$4^_N`LZ[ZZRY%$4N`9Zt~ Z33Y%$4^_N`Z$
ZZLKu	YHC_Lu	YIC_t%Y4@KQot%Y4LPQoK@Ct"@Ct"@Ct"C"t&%Y4Y Pt/4)t/4u$4v{zyu}Q"CTDTTTNCkC{zyq"PQQTVt/4TuWuWW@P3T%SUVAUt@%P4QPA%P4U"u	HC_tg-4TX@XX%$4AtX%$f4At/>%$4XQX"C B_~g`ICk u!{zyE	Ck Ck)T!{zyE	td"/TDTD{ z yCzy/a`-@D uB
~ 7T" Pt,4t,4TddT@u	IC_Bu	HC_C%$4D%$4F@
C@dpAd0
@dAp@ P?>B>@k@!$t~ 33F^_Np'>P3t~ 33D^_N`>dA?o`>A?P>Bdd%$4Atd%$f4At/>%$4dQd"wEdp.RGw`t!/4Dt!/4Tt "T`	"\S#C#"<t4TL}UL}VL}WL T` "  0""dt"u  tt^S Q U_==0t@T`L=0 UtTLtt^ 2klm"nop""&%u$u#sqprdtfnteltjtitothc_"te&"YZ[ YZ[)%```/$p@:YZ[ B m'YZ[ B mYZ[ B m"$`p"rtp
orrrd"dp/}|6u}6uW<tG+1T
T"6t|t}|6}6D
DlX"0fp#TP}G/f"``	`w"7t"t1pt}6%`1QS#C#" B s B c)e%`"}6u%$P s`}#TP}G/1"pppp"@ "2~ 7TuBx~'*~'* ~'*`CSTTCST*x~/CST*~/CSD* ~/p~'** %p~/Y*    4`Y*    4"Kd`t0q`t"p`t$T@t"t "Kd`tJ&T`t<$T@t+&0t&0tf`t "t "`t[$T@tJ`t<^M`%^p`thpt"t "`"S#C#"CS*x~/CS*~/CS* ~/CS*p~/Y* -4`Y* -4"'	 0e'`>@D"uB~ 7T2 @0"$0$TbO/dbS$"vEdp.SGv`t!/4Dt!/4Tt ""dpa%`]%d`%dp'drdprddf`eW<tS&S&%$PES"%`_"dpY%`+$`'$$P!d``dprd`$C&nDVWt#TP}G/"%`9t`S&&Tp(#eS&je@"p"D" P90T$4T$4Tt.4M" Pt-4t-4TddTu	HC_>%$4?%$4A%$f4At%$4@tg-4>@@!$t~ 33?^_Np#P@t~ 33A^_N`#	@0{d`	?0{d4>lpitg-4u	JC_d D@dd"%$4At%$f4At/>%$4[@V>tg-4d%$4At%$f4At/>%$4d"t-4dDZdD"YY u	YKC_d`Y%$4  PY @`Yu
$ t5u^_`Y%$48Y%$4:Y Pt%Y4T?4t%Y4T?44Tu	YHC_=t%Y4@a=5@=5T@4NTdp)5AJtD%Y4@@05@'5AJtD%Y4@A5A.<<u$Pt@5u[\]4A;: @	Y\WY%$4ab[\])~ ^_`B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ 8)ba@bbaaabY%$4ab4%$f4AtbaPYft+4%$4AtbaP+}Y\+t%Y4d`4C5@=.5@.C5
@p5@tt%Y4ctD%Y40Pd`t%Y4d
`Q$3tA%Y4dtP2$3tD%Y4dtPt&%Y45o`=tD%Y4B@uc9@ucuctA%Y4t%Y4)t%Y4t%Y4ct%Y45t&%Y4t%Y4cu	YLC_ct%Y4c&d`+abB~ 8)6t%Y4cZ^_`uZBZB~ )%bb5aa7b6a@ZZZZcZpFcZpuc9Zuc/*c(ZpucZucuc;: @c;: @ct%Y4cYf4t%Y4tP%Y4%Y4^_`B^_` C C C CY%$4Y%$4Y%$D4YY@P}"Dtttt-4u
 C_u
C_u
C_u
C_u
C_t&-4tt-4t-4%$4%$4%$4%$D4%$4%$F4t-4tF-4t-4AtAt/>%$4u	KC_tu	JC_tt-4tu	FC_tu	DC_tu	HC_tu	IC_ Pt-4tt-4td@`n")Y@P B tD%Y4"Y@
 B B" B T?TTU0)")"" B 0%)j B kTi B o"jtktitot")0Tn B l"ntlt"	).P B /Q B /R B /S B /T"?C?Ck B$ :?Ck C)`,q?Ck Bespre`#?Ck BQ+?Ck)eq`D"BuqrsQmQmq7quuBDE}`~5EDPOpDt3 G_Dt3 GOKDt3 FZD$pDt3T C_Dt3T COKDt3 C_K"qet`ttut" "qdp?q7q FDFL DTDL FTFLquuO"t`O"PGt3 F_Kt~ 33 D[D$t3Kt~ 33 B["V@WdeatY%a4tf%aaa@Ct utttuuuu  ui@?t?ttdPIa?a@dPa%eta$fLta$fa| %e5dad@@d`gx*lfx*l CFhx*l CFiCF*ACS*ed/0h %ic>bc7Th %ic>bc6 "jEjEP4Ej}4EjEP4Ej4[u\]_`	).^0uY uZYZ^t %[[Z[-$4Vt/4[-$4$ >W[%Z/$ 4tU/4Gp?`%`_@	Dc``p_
~ 7T0tCt>[x#[^ZdEYpYZuY uZ^t%[[]]p\]E\`a"4t"] DLYZ[\]4 1KYT 2TOK 3TK 3 4dP4dP 0[\]BM" "t"`"py`}TCS*~/CS*D~/CS*\~/CS*l~/CS*p~/CS*t~/CS*x~/CS*|~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~	/CS*~/t"d`T~'*D~'*\~'*l~'*p~'*t~'*x~'*|~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~	'*~'*~'*CSD*CS*~/*   D~/* %\~/* %l~/* %p~/*%t~/*%x~/*%|~/*%~/*c%~/*%~/* %~/* %~/* %~/* %~/* %~/* %~/*$%~/~'*CS*CSD*CS*~/~'*CST*CSD*CS*~/~	'*CS*CSD*CS*~	/~	'*CSTT*CSDD*CS*~	/~'*CST*CSD*CS*~/" B `p!3Y GTGL}@6Y$"EL$'%(&). QDQL.d``P;P(P
P DT`v02$P$%P&P%$ D02'P$(P)P('D"                                                                                                                                                                                                                                                                                                #     BY @             C                J3                                             Q     R6     W    
	 
	 
	 
	    "!   "!   "!   "!  "!  "   10  010  01/ 01, 01(  01   01  0
			


		
				         $&*!')*   #(*,      $ 0 H `    P x  @0,@@        $ 0 H ` l ( < P d    d  hX 

$<	
       "P""):"P%"%"(p8"
"P	"	"t"):"P	%"
%"*"
"P	"	"):"P	%"	%"[ZYX"KJIH""BBE"""%5""%p8""ptptsth`DH.@)T$3TD @VF @DG~`T?0	T`T%`@H        H        A A A] AA A A AP A`  "`ab qcde#qff`#uq~ uq~Q `ab"		}t "}iOi"QTNX  EEt	tE`"T`D@0 "&q Q2~wp&qucdeuf{zy)qucde&quTf{zytdpE&qucdeuf{zy )qucde&quTf{zy"td" `5p/t ~,n'&%$$D'&%$W ~400.`"#tixj"#	dpxj	xt "}!""! `+t!/4DT09t/4D@"t!/4TT0t/4T"0{%`t+4Dt/4t	/4Tt!+4T"0p#	dp	opnt ""!t-4Dt-4TTt,4Dt,4Dt,4DSRQtPtt,4TMt/4"u(3)u*+0()*+"u0u1C12C2 8012"vuiPNPaPmW{f7GPDPDx1 D@Q#uC#~Pvd$.tHW0
SWW0
SW[W0
SWtW0
SW~iTtD08P12Q12R12Su Q#"}p}12 )T?)12 (T(12 D12  D 12  T 12 D12~ ;	  D 12~;	  T12 (D(12 T12d~ ;	 )D)!2<t4T12}U12}V12}W!2"u  t3tJ4U(,U)-U*.U+/, a4tMOPQRSTNx|{ z yM~ TTnpaT0aTT?	T%$4BT	@u	u
 Ciu	CiT/>u
 Ciu	CiT (T%$4BT06e/T%$D4BT0T	epj$PD`6[<tdp,HIX~9w[ttD,0|4ttTU~TVeU`\uU/5$4tX/x|}{ z yX~ T0WLU$TUV,04t,0	4tCW,0$0T4t u u 1 TQ#,04t@.0-t6`SDUl1.026tCW@Q `;0}:"}:"s.0I6tl{`4op(s?t:}:"}:".046tgdp(j`$W<tuH IT~9wWt.0+6tg j`W<tSkkTpD.0%6t gj`d`hd`G9l;.06t@gj`SkkTpD/0	7tot3tJ 2SQTt
" D!2ShCh1G1ShCh"` "Td` "qW	 0eq`>XW@D"WuBT~ ;	X2W @0"0T0t ?d`t0`t"`tiT@t"t "TmnmThTo`jm0+h jh0m `Lih Dm0?nihTm `(ihTm 	h`ihT`y"dt "D" d`t <W`t0iT@t`tpt"t "  	 " "  0" 0~3"~/" 0AtZ"y 0d`>zy@D"yuBT~ ;	z2y @0"Dt~ttt$tIt"TTT?d`Rtt7yd`dp<Rtt=y@RY`"
@0D"u }tQS Q U^= R V^>=0 Ut=0 Ut =0 Ut@=0 Ut>0 Vt>0 Vt>0 Vt>0 Vt2u  u t6tRS<U04U15U26U3740<t40<t o406<t0!uH IX~9w[ttD406<t0!uH I\~9w_ttD40	<tY40<t 50D=t/D T   ii-D50=t50=t`SD60>t60>t60>t60>t60q>t0ttD0t@|0t DD0tT0t60>t 60>t@60>t70	?tCW70?tns}:1t6tR 2C0{zyJzyF~"WTDTDY{zyY/CzyW,C}:pd	`~w`r~?tu$t5},Cu~ u$t5{/Cucde,CuTfD
" T0T?x0"%T0xtx0tt	T !7`	    {zy7T70	     {zy7p~tT0"!T"0D@}OiT0T;{zy;!T0"{zyW`~TD   t@-"T00DT"i0iTO/dSi"RTDTD{ z yX/CzyR mTDTDo{zyo/Czym mTD	TDo{zyo/Czym CTDTDCu/C{zy u  Sh !`d`CT bTT?Ncdet CCT?0x1C0HD@?C0TDDxCT?x01DD T`
bQ`dpdbkb0kT?NT?NT?kT?/jjT0T%%Nl .jTOTO -`bWm`!bW`"Q`#q#`$Q`%b`Dt`&q}hD 2TcT?%%bTOhdT?%%cTOihmE	d`A}Fm`t!/4Dt!/4Tt-4Dt-4Tt-4Dt-4Tnt",4ot#,4t$,4t " uD~ :xt~ :x uT"mTDTDbo{zyo/CzymU mTDTD o{zyo/CzymU mTDTTD 	mTD@bocpdqer{zyo/CzymU mTDTb	mTDbocpdqerfsgt{zyo/CzymU Tyyp]t~ 33]p]uCizucuduezuf{zy{D{T]0Yu Ci|]u Ci}]uCi~]uCi]uCi3uCi|]uCi}]uCi~T{zy|y]t3_y]t3]TaD"CC]]^^^_t^&^/^8^A^J^S^\^e^o^y^_K_S^^^!^"^#^$^%^&^'^(^)]-].^/_\0_2^3]4_6_7_8_':];_0>_9?_BA]G^H]I_eK  _mCuuCu8CuCuCu
Cu{CuCuCuCuQCu}VCuCu}CuCuCuCu&Cu@CuCu/Cu%CuCuCuCuCuCu6Cu]CuCuCuCuCu0CuWCuCuCuCuCuCuCuCuCuCuCu.Cu}CugCuGD"g"C""`TD"`D"T" " TT TCCu TT T@Tu	FCiu	$Dt5{CCu TCuB Cu Cu B2Cu $4u	JCiu	KCitu	LCi%$4u$t5uu	FCiu	$Dt5ut%4CaT aia~aaaabb9bfb  b%$4tt<%$4tt'%$4tt%$4t%$4ttA%$4tt'%$4tt%$4t%$4AGB F B2EDAKB J B2IHXOB N B2ML+SB R B2QP_B $5 _B ^^%$4N`;ut~ 33%$4^_N`$] PV%$4N`=ut~ 33%$4^_N` P%$4N`;t~ 33%$4^_N`[R%$4N`9t~ 33%$4^_N`$
u	HCiu	ICit%4@t%4P@Ct"@Ct"@Ct"C"t&%4 Pt/4)t/4$4{zy}?"
Tt/4uu@
3%At@%
4
'%
4"u	HCitg-4T@%$4At%$l4At/>%$4'"2C5TDTTTN2Cu/C{zy5U "}Ft.4Dt.4TDt.4SRQtPt"gkjuiuhttt
ttt TTT"k"kj```1$pC= h) h h"dpB}x:"}:"6t:}:?W<t}OiT
T"6t{t}{:}:}:?D
D[g " j0"0 0 `0 `0 PX"`	`$p2
t"p
t"0!`t@{iT@/`g]Nd`tXkT`tJiT@t9k0t,k0t`t `t"t "T`
gEShCh"D@gEShCh"7t"t1pt}:QShCh"[pppp"\[@ "2~ ;	[uBTL     TJ# DJ# T t?TSD `4~,nLLCQTLLCQW ~40`2L`	    LCQW`~40xt"^Q^`"ShCh"H    D t`GNT06t ~,nHHCQDHHCQW ~40`,H`	    HCQW`~40 DJ#S    RTpSkSk GDB`<p6t ~,nSSCQDSSCQW ~40R0Ckd`G9;SkR0*CkHIT~9wWttD"Sk"_<tHI\~9w_tthTP}Oi"gdpkj`gjd`jdp'p`XtW<tSkSkj$Pq}"<    jpgd`j`+$`'$$P!``p{{pCkT0DTPH-TT/3dtPHH-d`pH/Hu/IT~9wWthTP}Oi`-`Tx0t"Tx0t"t	"W    jpgd`pCkT0:TPHIVHTu/I5d`pH/IHu/IT~9wWthTP}Oi`/`Tx0tTx0tt	""@    j$P0T st}:`<p6t ~,n@@CQD@@CQW ~40`/`Tx0tTx0tt	`}hTP}Oi"Wjpp`SkkT`ppSkT0;T
XUTT/3opp;Xt2W~ $3$>
XT0WtZW/3dt@gp"D" P90T$4T$4Tt.4M" Pt-4t-4TTu	HCi%$4%$4%$l4At%$4@A$tg-4@AU@!$t~ 33^_Np#P@t~ 33^_N`#	0{d`	0{4lpitg-4u	JCi D@"%$4At%$l4At/>%$4[@Vtg-4%$4At%$l4At/>%$4"t-4De'D" Pt,4t,4TTu	ICiu	HCi%$4%$4@
pb0
pb Pb@k@!$t~ 33^_Np'P3t~ 33^_N`o`P%$4At%$l4At/>%$4e'" u	KCid`{w%$4  P{w @	`{u
$ t5u%$4{%$4} Pt%4T?yt%4T?yyTu	HCit%4@z@zT@yNTdp)zAPtD%4@@0z@'zAPtD%4@AzA4u$Vt@5{%$4~ Bj<%5 ~  B<%5 ~  B<%5 ~  B<%5 ~  B<%5 ~ {<@%$4y%$l4AtP1z>y%$4AtPz>}qz>t%4d`yGCz@=.z@.Cz
@pz@tt%4tD%40Pd`t%4d
`Q$3tA%4dtP2$3tD%4dtPt&%4zo`=tD%4B@u9@uutA%4t%4)t%4t%4t%4zt&%4t%4u	LCit%4A9d`A>B~ {<t%4uBB~ <%5@pFpu9u/*(puuu~} @~} @t%4pt%4tP%4%4}tt%$4P%$4BT%$4t%$D4tt%$F4P%$F4BT%$F4tB B B B B%$4%$4%$D4@Pt"Dtttt-4u
 Ciu
Ciu
Ciu
Ciu
Cit&-4tt-4t-4%$4%$4%$4%$D4%$4%$F4t-4tF-4t-4AtAt/>%$4u	KCitu	JCitt-4tu	FCitu	DCitu	HCitu	ICi Pt-4tt-4td@`a"@P tD%4"@
 B" T?TT_  @@@@%$4%$F4t%$4%$F4t%$4%$F4%$4%$F4{zyW~DD`-GF@D FuBT
~ ;	""u$t5{u$t5)CEA
}:?"CCuC    Cu   TT Tp8`	    CQW`~40  6`	    CQW`~40   CQWp~40p6t ~,nCQDCQW ~40CugwjCu " 0% T "t
ttt"0T ttX"    `i cOe`<p6t ~,nCQDCQW ~40`x`t
t	"TTNTTOTpTO    pePtW8PtIXPt;xPt-PtPtPtt"	. / / / /"X ?PttR S T U VXt"X PttRX"X PttRXt"0xTPt"P"xD0uX PttXCD0DxTxD0CD&D@xTD@xD0cCD&D"X PttXCTTTTxTT?&T?JCQW~40"0KxDDxDTX Ptt0_CDD"CTxT?TTJCQW~40X Ptt"p!0 @D T?xDxTdpj 0.   T,   DD  dp0DTo0D"CX 7PttCuR S TCWx|}Cu~ Cu`Qt"Q"X PttR"X PttR"X PttR"X PttR"X PttR"X PttR"X /PttR S T"X PttR"xJCQTC&FX ;Pt R S T U"X !PttTR"X !Pt tTR"T0\X NPt
t R SU0ttVttPt
tXtD  | $ >t />D	PCp} P1uteP1 DI2D"X0u$ 4Pu$4Qu$4Ru$4Su$4Tu$4Uu$4Vu$4Wt"X  Pt#tR"C"CTTNTTOTTNTTOT TNT@TOTTO TTOTTO TTOTTO T TNT@TO TTO T@TNTTO TTOT gCu T%%TOTT0  a *PPt
t* *PPt
t*T0=uu>t:PCuT0``	    {zyVT0
 ttXtt+tttCuT0	     T0{zy}% @t Cu Tx0tt{zyp~V" ttCTT0	CDTCT"{zy}TCX FPPTCuu tR.4PtR.4Xt"TttTTTTTTTTTTTTTTTTtTTTTTTT"uhtCTTTT    ~,nJ .N -O&Dxtd}:X !Pt$tTR"TTNTTOTTNTTO "X 0Pt&tR S T"C"YT`CZY@
D "YuBT~ ;	ZdY @0 ""    C]C@PACQCQT{C@`CQ$>=<CQtC]C@`hCQ,nCQCQC3C]CCQCQ C&CQ
CQCQW40_PGt3 F_J#_t~ 33 D[L_$t3 b_J#_t~ 33 `["Q0.g)P
SPSRDS"CTQTO0DCu0
 R"X -PttRSTt(Xt" j0`d`CW"`"TD
`bcde`0TDPTDpfg{zy/CzyU T adp+0ta"dp,0tat"d`a|T?0ETT0a/3| }</>2d@at"pEHuI`~9wct/3| }</>2d@Fxt"dp7T?0TpEHuI`~9wct"R XT0*HI`~9wtt HRI`~9wtctt`"to""T T?0G9"c QWd`00
T0cHc$I`~9wctT0tT ;T0+O^T0DTt "to d`KTx0tt00
T0cTH$c/d/I`~9wctT W`	    VW0	     {zyWp~VT0"toT0j`iOi"t0"T0T Fd`IT0Tx0%t(T0xtx0tt	T .@Mu$3dt@ggtHgI`~9w$HI`~9wtt HeI`~9wctT W`	    VT[0	     tzy[p~VT 1T0T D@"}j`Oi"`"toT T?0G9T0Tf{zyf!T !TdpuHuI`~9wctT AT01T -O^T0DTt "to !""d`!Tx0ttT W`	    V_0	     {zy_p~VT0"toT0j`iOi"t0"T0T0TT0s"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             P   R>  %             C                Hy                                             ^            
	 
	 
	 
	    "!   "!   "!   "!  "!  "   10  010  01/ 01, 01(  01   01  0
			


		
				         $&*!')*   #(*,      $ 0 H `    P x  @0,@@        $ 0 H ` l ( < P d    d  hX 

$<	
             ):"P%"%"):""P""):"P%"%"(p8"
"P	"	"t"):"P	%"
%"*"
"P	"	"):"P	%"	%"KJIH""%5""%p8""ptptsth`CP.@)T$3TD @VF @D=~`T?0	T`T%`@AO A AaAbA  kT~DE5"_<ti\~b_ttp#TP+""q`~}$/Qt "S#C#S#C#"""""  __q q!!`uqt)uqtQM"/TpS&S&/0C&sd`S&/0C&RWttt"S&"`"T`D@0 "u  ttES<U04U15U26U3740<t40	<tf	408<t0$iX~b[ttq408<t0$i\~b_ttp40	<tsf40	<t Rd50=t/D $d50=t60>t60>tttE 2}T#To`p0*# c#0	 R# L0E^#T b`*#T 	c `a:#Tc`"D@"^\S#C#"}%`a0	t%`$4Dt/4D$4t	-4Tt!/4T"E	}Gt "u  tytH4U(,6U*.U+/, A4t	
T@T op!0!T?MT?NTM%$4BTM%$4BN@uNu
M C_uNC_T/>u
M C_uNC_ $TM%$4B
06M[h/TM%$D4B
0
TTSNM[%$PEs`7[<tqdp-iDuE X~5[ttqqD,0!4t\F,04t,0	4tC,0$0T4t u u  Tq,04t@.0_t6e_.0;6tC@Tdp(70
tOO
@0b.0	6te;.0(6t"dp%`W<tDRWt.0+6t" %`W<ttS&&TpD.06t "%`sd`DD.06t@"%`S&&TpD/0	7tatytH 2Td` " C_"Pct3 G_qt3 FOq`t3 Eft3 Ek$t3Tqt3 COq`t3T BOt3T B_q" ETEu q"`0`f$`t HDH GDG EDEqCS*~/ EDE ETE FDF8t CS*~/ ED E EDE FDF" B  B %%)%%`*a+b,c-3?R?$ppp3?.t?$ FDF` CS*~/"t ETEd*+,-3?<D } 7 +p-. FTF"3?} 6?$"08PQRSYZ[ B 0Kt~'*YZ[ B x*lCSTCF *"-~'TD*CS*~/0}G HDH FD GTG HTH FTF" ITDIDIu(3)u*+0()*+"u0u128012"1uwd^^^`nw_2=wO 0AtZ^D}3^ D@KuC1d$.tP0	Sq0Sh`1p}4`&p{zy5~wu	5T wV4"P!d`!$p%'p%p(p&p)pT$D%E&F'H(I)JLMNO$`4a5b6c7-7P-@Q"`*a+b,c-t+@/"-,"+/"d`a FDFL.p2` CS*~/"tQ.tL@.dp8Q. EDEL`CS*~/"d*+,-"T44p[t~ 33]pTuC_5uuu 5u!{zy6E	6T0Yu C_7u C_8uC_9uC_:uC_;3uC_7uC_8uC_9T{zy7\4t3_4t3Ta$D"<CCTTTTTUT	TTTTUU,T-T.  U<Ckai<Ckq<Ckq<CkqP<Ckq~<Ckp<CkG<Ckq<CkM<Ck}h<CkO<Ckp<Ckp<Ckv6D" B TT T?CACk B TTD B T@TE?u	FC_Fu	$Dt5{CACk B THCkBMACk B HCk B_ACk B F)D?$4@u	JC_u	KC_tEu	LC_Y%$4[\Yu$t5u]^_u	YFC_`aYu	$Dt5ubcdt%Y4CV VVVWW(W=WdWWW  X Y%$4tt<Y%$4tt'Y%$4ttY%$4tY%$4ttX Y%$4tt'Y%$4ttY%$4tY%$4X G]^_BMF]^_ B_E\[DXK]^_BMJ]^_ B_I\[HXO]^_BMN]^_ B_M\[L+S]^_BMR]^_ B_Q\[P\[]^_)bcd)_BM]_$5^)bcd B _BM\[a`^\[a`^Y%$4N`;uZt~ Z33Y%$4^_N`Z$]ZZ PVY%$4N`=uZt~ Z33Y%$4^_N`KZZZ PKY%$4N`;Zt~ Z33Y%$4^_N`LZ[ZZRY%$4N`9Zt~ Z33Y%$4^_N`Z$
ZZLKu	YHC_Lu	YIC_t%Y4@KQot%Y4LPQoK@Ct"@Ct"@Ct"C"t&%Y4Y Pt/4)t/4u$4v{zyu}Q"CTDTTTNCkC{zyq"PQQTVt/4TuWuWW@P3T%SUVAUt@%P4QPA%P4U"u	HC_tg-4TX@XX%$4AtX%$f4At/>%$4XQX"C B_~g`ICk u!{zyE	Ck Ck)T!{zyE	td"/TDTD{ z yCzy/a`-@D uB
~ 7T" Pt,4t,4TddT@u	IC_Bu	HC_C%$4D%$4F@
C@dpAd0
@dAp@ P?>B>@k@!$t~ 33F^_Np'>P3t~ 33D^_N`>dA?o`>A?P>Bdd%$4Atd%$f4At/>%$4dQd"wEdp.RGw`t!/4Dt!/4Tt "T`	"\S#C#"<t4TL}UL}VL}WL T` "  0""dt"u  tt^S Q U_==0t@T`L=0 UtTLtt^ 2klm"nop""&%u$u#sqprdtfnteltjtitothc_"te&"YZ[ YZ[)%```/$p@:YZ[ B m'YZ[ B mYZ[ B m"$`p"rtp
orrrd"dp/}|6u}6uW<tG+1T
T"6t|t}|6}6D
DlX"0fp#TP}G/f"``	`w"7t"t1pt}6%`1QS#C#" B s B c)e%`"}6u%$P s`}#TP}G/1"pppp"@ "2~ 7TuBx~'*~'* ~'*`CSTTCST*x~/CST*~/CSD* ~/p~'** %p~/Y*    4`Y*    4 TKKd`t0q`t"p`t$T@t"t "Kd`tJ&T`t<$T@t+&0t&0tf`t "t "`t[$T@tJ`t<^M`%^p`thpt"t "`"S#C#" D	KCS*x~/CS*~/CS* ~/CS*p~/Y* -4`Y* -4"'	 0e'`>@D"uB~ 7T2 @0"$0$TbO/dbS$"vEdp.SGv`t!/4Dt!/4Tt ""dpa%`]%d`%dp'drdprddf`eW<tS&S&%$PES"%`_"dpY%`+$`'$$P!d``dprd`$C&nDVWt#TP}G/"%`9t`S&&Tp(#eS&je@"p"D" P90T$4T$4Tt.4M" Pt-4t-4TddTu	HC_>%$4?%$4A%$f4At%$4@tg-4>@@!$t~ 33?^_Np#P@t~ 33A^_N`#	@0{d`	?0{d4>lpitg-4u	JC_d D@dd"%$4At%$f4At/>%$4[@V>tg-4d%$4At%$f4At/>%$4d"t-4dDZdD"YY u	YKC_d`Y%$4  PY @`Yu
$ t5u^_`Y%$48Y%$4:Y Pt%Y4T?4t%Y4T?44Tu	YHC_=t%Y4@a=5@=5T@4NTdp)5AJtD%Y4@@05@'5AJtD%Y4@A5A.<<u$Pt@5u[\]4A;: @	Y\jY%$4ab[\])~ ^_`B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ ^_` B)%bb5aa[\] B ~ 8)ba@bbaaabY%$4ab4%$f4AtbaPYf>4%$4AtbaP>}Y\>t%Y4d`GC5@=.5@.C5
@p5@tt%Y4ctD%Y40Pd`t%Y4d
`Q$3tA%Y4dtP2$3tD%Y4dtPt&%Y45o`=tD%Y4B@uc9@ucuctA%Y4t%Y4)t%Y4t%Y4ct%Y45t&%Y4t%Y4cu	YLC_ct%Y4c9d`>abB~ 8)6t%Y4cZ^_`uZBZB~ )%bb5aa7b6a@ZZZZcZpFcZpuc9Zuc/*c(ZpucZucuc;: @c;: @ct%Y4cYfGt%Y4tP%Y4%Y4^_`B^_` C C C CY%$4Y%$4Y%$D4YY@P"Dtttt-4u
 C_u
C_u
C_u
C_u
C_t&-4tt-4t-4%$4%$4%$4%$D4%$4%$F4t-4tF-4t-4AtAt/>%$4u	KC_tu	JC_tt-4tu	FC_tu	DC_tu	HC_tu	IC_ Pt-4tt-4td@`o")Y@P B tD%Y4"Y@
 B B" B T?TTU0)")"" B 0%)j B kTi B o"jtktitot")0Tn B l"ntlt"	).P B /Q B /R B /S B /T"?C?Ck B$ :?Ck C)`,q?Ck Bespre`#?Ck BQ>?Ck)eq`D"BuqrsQQqJquuBDE}`~5EDPOpDt3 G_Dt3 GOKDt3 FZD$pDt3T C_Dt3T COKDt3 C_K"qet`ttut" "qdp?qJq FDFL DTDL FTFLquuO"t`O"PGt3 F_Kt~ 33 D[D$t3Kt~ 33 B["V@WdeatY%a4tf%aaa@Ct utttuuuu  ui@?t?ttdPIa?a@dPa%eta$fLta$fa| %e5dad@@d`gx*lfx*l CFhx*l CFiCF*ACS*ed/0h %ic>bc7Th %ic>bc6 "jEjEP4Ej}4EjEP4Ej4[u\]_`	).^0uY uZYZ^t %[[Z[-$4Vt/4[-$4$ >W[%Z/$ 4tU/4Zp?`%`_@	Dc``p_
~ 7T0tCt>[x#[^ZdEYpYZuY uZ^t%[[]]p\]E\`t"4t"] DLYZ[\]4 1KYT 2TOK 3TK 3 4dP4dP 0[\]BM" "t"`"py`}gCS*~/CS*D~/CS*\~/CS*l~/CS*p~/CS*t~/CS*x~/CS*|~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~/CS*~	/CS*~/t"d`g~'*D~'*\~'*l~'*p~'*t~'*x~'*|~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~'*~	'*~'*~'*CSD*CS*~/*   D~/* %\~/* %l~/* %p~/*%t~/*%x~/*%|~/*%~/*c%~/*%~/* %~/* %~/* %~/* %~/* %~/* %~/*$%~/~'*CS*CSD*CS*~/~'*CST*CSD*CS*~/~	'*CS*CSD*CS*~	/~	'*CSTT*CSDD*CS*~	/~'*CST*CSD*CS*~/" B `p!3Y GTGL}@6Y$"EL$'%(&). QDQL.d``P;P(P
P DT`v02$P$%P&P%$ D02'P$(P)P('D"                                                                                                                                                                                                                                                                             #    J !             J                Yc                                             a3     a      
	 
	 
	 
	    "!   "!   "!   "!  "!  "   10  010  01/ 01, 01(  01   01  0

			
				         $&*!')*   #(*,      $ 0 H `    P x  @0,@@        $ 0 H ` l ( < P d    d  hX 
$<	
                                                                     ):("P	)&"	)%"%(""P""):"P%"%"(p8"
"P	"	"t"):"P	%"
%"*"
"P	"	"):"P	%"	%"[ZYX"KJIH""BBE"""%5""%p8""ptptsth`ptptstth`epDQ`SffT`DD8SfO-T0:O-T
0X"-TT/3OXt-T0tZ?/38dt@bp"Q"`t!-4D"t!-4T"U"EE    epFbd`Fe`)$`%$$P#7``7p
N7 t0^ppFCf-T0DTOPH.--TT/3OdtPH1H.-Od`pHOF/HOuF/IT~9wWtcTP}Hcd`o+O@,,O+@F4`	MpOcPdp!HH<IX~9w[tL	CfQ+HtQL0	gJ"t"    epGbd`G70^ppGCf-T02TOP	H.JH-TOu./-Od`pHOF/HOuF/IT~9wWtcTP}HQL"0	gJ"t"feuducPLIN7Q9Ft8Dt?Bt<tGt:3qCSO4M>;HA=R@p -TTT10"ijjihDjiTt,4Dt,4Tt,4Dt,4Dt,4DSRQtPtt,4TMt/4"}lmlTcTo`rl00c Qic0l M`SQNc Il0DmP=cTl 	M`*QcTl 	K`PcT	Lr`Q"TpHpSfSfQ4`	MpOc0CfPd`Q+O	HpSfH0#CfHBIT~9wWtQt"Sf"dpH}x:"}:"6t:}:?W<tH0gJT
T"6t{t}{:}:}:?D
DN>b 9"JR@)T$3TD @VF @O~`T?0	T`T%`@Qd`tafT`tSdT@tBf0t5f0t(9`t C`t"t "bdpke`ged`edp'7N7pN779`8OXtW<tSfSfe$PI"p}pp}}@S )T?)S (T(S DSME  D S  T S DS~ ;	Qd`t T`tHdT@t7`t) t:pt"t "!CQ!Ce```1$pD=!C O)!C O!C OJ"p	 0ep`>@D"uB~ ;	2 @0"Qd`t9L`t+I`tdT@t"t "  D S~;	  TS (D(S TSMEd~ ;	 )D)S j0"0 0 `0 `0ED PDX"h`$"ktei}XH["ki}XH[t "e$P=P`'HH<IX~9w[ttL"cTP}H"_<tH<I\~9w_ttIcTPH0gJ"Mt ~,nCDCW ~40"`	`$p2
Nt7S"p
GNNN7St"H_        HV        A^ Am A A+ A, Ai Aj Ah A  | $ >5Tt@~ 33KJ"po`o`	    {zy`~VT`
bNScCc0'T"7t"tept}:TScCc"d0dT/TOdSd0
 0ud"D@bNScCc0'D"=pphXnot ">`Ap;x`t"t	"V`"ScCc"` "Td` "0d_r}dH"ScCcLMScCc"Q8f"t"CQ @R" RM Ra Ry   RT?p~ @-<xx33&Tp~ -<xx33Ip~ -<} 5TMp~ -<} TMp~ -<T?} %%"t"`u`Rp`er`qTbo T~XG7q````4Ea D@quCQ`d$tR0
Sg0
SvT0
SadT:t1:cP<t4Tq}Uq}Vq}Wu q"08PqQqRqS D""t         Tqq T t?TSD A`xt4`4M~,nCTCW ~40>`"VR`   {zyxtH`"TTt
"l Da"teptt"op`;`_p$` dp|x5ldXpUQ%F;0p*&Dp""to'Tt">t:t"        D tA`xt4`
1d`Oc>`VR`  {zyq"`""p~TD   t@l"5}:?'T"""t"""'D@t""'D@t"PFt3 F_qt~ 33 D[K$t3 b_qt~ 33 `[""!"#C$%&C''`uCuCBS!"#"tHtX`"T`D@0 "H	}t "0{%`t+4Dt/4t	/4Tt!+4T"TTT?d`tt7yd`dp;tt=y@Y`^"^
@0"u  tctY4U(,U)-U*.U+/, aW4tu$ u% u&u'zy_W`TTnpa`T0aTMaT?NcTM%$4BN@uNu
M CuNCcT/>u
M CuNC`T0/cTM%$4BbT0gMq``T0ScTM%$4BbT0TUNMpTd`0
e$PFP`7[<tQdp-H<IX~9w[ttL	QQ, a4tt&0uOuPuQ	uOuPuQUQ~UQe``u%O/$ 4t/u$ u% u&u'{zyVWVT0$3P| N,04t,0	4tC,0&0T4t u u S TS,04t@.0Rqt6n`SD0T?0t0T?0tE	q.0}6tba| $ 
>	""C@0`"S`;0}:"}:"Ns@TD.0{6tba| $ >
	@09d`=KS`4N7op(Ns?t:}:"}:"7.046tbdp(e`$W<tuH BIT~9wWt.0+6tb e`W<tQSffTpQ.06t be`Pd`Q+O.06t@be`SffTpQ/07t0tNtctY 2qC 0"TDTD{ z yCzyCji}:ipd	`iQ`ra?tju$kt5}C~ ju$mt5{C$%&CT'Wj
"`T }HgJ" "&C)TDTD&CC{zy)0/b*
P"0}"u(3)u*+0()*+"u0u1C12C2 8012"  	 " "  0"r 0~3"~/" 0AtZ"dt " 0d`>@D"uB~ ;	2 @0"D"Dt~ttt$tIt"u }3taS Q U^= R V^>=0 Ut=0 Ut =0 Ut@=0 Ut>0 Vt>0 Vt>0 Vt>0 Vt2u  uV ttaS<U04U15U26U3740<t0^`"40	<tD$406<t0!uH <IX~9w[ttLQ406<t0!uH <I\~9w_ttIQ40<t40<t 50=t ddPQ50=t50=tm`SD6 a>t0d`^`U0_^`;d`0	}dHJ"tuH uIP~9wSt60<>t0d`^pU0d`
^p60>t60>t60>t60>t 60>t@60>t70	?tC70?tFNs}:_tta 2T0
d`d`)"9`pdpp"opCe eCeeef7fs  fV	V	pd`V	pV	p		u	V9V	p	6"Qit"""""'D@`"t"Qt"P"Tt"Pt""tt""tt"N"'T"tot"d`<cT`.`$`$p*""t""t"t"D"Tpht~ 33]phuCu$u%u&u'{zyWT0Yu Cu CuCuCuC3uCuCuCT{zyt3_t3TgD"CCi.i&isi|iiiiiii7-i@.i0iR4iI;iZGikHicIiK  iCCCCC)CCTCCCCTC<C\CCCCCZD" TT TCC TT T@T u	C!u	$t5{CC T#CBSC #C BeC !$4u	Cu	Ct u	CW%$G4XYWu$t5uZ[\u	WC]^Wu	$t5u_`at%W4CkW klkkkkkll<lil  lW%$G4tt<W%$G4tt'W%$G4ttW%$G4tW%$4ttW%$G4tt'W%$G4ttW%$G4tW%$4GZ[\BSFZ[\ BeEYXDKZ[\BSJZ[\ BeIYXHXOZ[\BSNZ[\ BeMYXL+SZ[\BSRZ[\ BeQYXPYXZ[\_`a_BSZ\$5[_`a _BSYX^]^YX^]^W%$4N`K&t& Pt~ 33W%$4^_N`
&$h&W%$G4N`G&t& @<t~ 33W%$G4^_N`&&'W%$G4N`F&&@t~ 33W%$G4^_N`&c&W%$4N`F&&P<t~ 33W%$4^_N`&$	&('u	WC(u	WCW P,t%W4@Gt%W4P(7-t'%W4'@)(P'))Wpc)t%W4'@t"@t"@t"" T?TT!b"C"o"`TD"CTDTTTNCC{zy^" P90T$4T$4Tt.4M" Pt/4*t'/4$'4{zy}o"RSSTt/4t@;%UA@t%R4SRct%R4"u	Ct(-4Tt-4t-4@]t-4t-4t-4t-4%%t-4t-4@t-4t@%$f4At%$.4At+:%$4cTd`0p" Pt,4Tt',4TT"u	C$u	C%%$G4&%$4(t,4@%"pa#0"##pa" Pa! $ @o@!$t~ 33(^_Np' P7t~ 33&^_N` !#!o` #!P $%$f4At%$.4At+:%$4c" Pt-4Tt'-4TTu	C"%$4#%$G4% %$.4At%$4@Q t(-4!"!@@!$t~ 33#^_Np'!PYt~ 33%^_N`<!$0!t!d`#0!t! B!" lpqt(-4u	C  D@" %$f4At%$.4At+:%$4f @^"t(-4 %$f4At%$.4At+:%$4"t-4DcD"@@~W FFu	Cd`~N%$4  P~N @	F`~Wu
$ t5uZ[\%$4%$4 Pt/4T?$'4T?Tu	Ctg/4@y@T@NA$4@@@u$Pt@5{WXY%$4~ Z[\B<BWXY ~ Z[\ B<BWXY ~ Z[\ B<BWXY ~ Z[\ B<BWXY ~ Z[\ B<BWXY ~ <@%$4%$.4AtP!$4t/4@$4t/4@#$4@t/4$4$4`s%$f4At@}r)$g4d`a@=.@.
@p@t$4t.40P
tg/aud`aj$4d
`[$3tA/4dtP8$3t.4dtP$4o`V$4B@t9@tt$4tA/4$4/$g4t/4$g4$4t/4u	Ctg/4d`A~ <$4PGZ[\uBA~ <BPp][ptHt<5dp2pttt @ @$4p#$g4Ptg/4$g4tt%$G4P%$G4B%$G4t%$4tt%$4P%$4B%$4tZ[\C Z[\ C C C C%$4%$4%$4vY"DtttPt/4F@@Su
 Cu
Cu
Cu
Cu
Ct/4tt/4t/4%$4%$4%$4%$4%$G4%$4t/4t/4tg/4AtATt/>%$4u	Ctu	Ctt-4tu	Ctu	Ctu	Ctu	C Pt-4tt'-4t~"@P t/4"@
 "  @@@@%$G4%$4t%$G4 %$4"t%$G4%$4%$G4%$4{zy_~`,@
D "uB
~ ;	"Ch Be1QpA\C$%&u'{zyWC$%&CT'{zyWtpdpJC$%&u'{zy WC$%&CT'{zy"WTtd"iu$kt5{u$mt5C1i
ji}:?"i"C    C P 3 T4T> T;TA T=TR T@p8>pPV  PV   CWp~404pOcCLP" 0%? BT< G"?tBt<tGt"0TF DFtDtDX"C`H4`	MpOcQLC"T-TNTTOTp-TO / 0 1 tB   P.tW@P.tI`P.t;P.t-P.tP.t.Ptt.2"	.g /h /i /j /k"C CTTNTTOTTMTTNT TMT@TN t!CTTn`1TTOT?04t@:D}@:"T0DT0DT0DT D@'pUT0^`Ut'UCTTNTTOTTMTTNT@TMTTN t1T?04t@:D}@:"T0DT0DT`>t:'T0d`3d,'D@d^`	}dHdgJMt'}:?	dg)Q"d`TTd`TT"m n"T`C@
D "uB~ ;	d @0 ""    CCsPACCT{Cs`C$>=<CstwCCss`gC,nwCwCCfCCLC{C CYsC
C{CW40"tt"V"t'D@t"Vt"W`<W<tQ`Sf$8Sf?8@b	9p[`[<tL_`_<tI"pppp"@ "2~ ;	uBNCTTO0QC0
 "~                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #!/bin/sh
OPTIONS_KEEPDASHDASH=
OPTIONS_STUCKLONG=
OPTIONS_SPEC="\
git quiltimport [options]
--
n,dry-run     dry run
author=       author name and email address for patches without any
patches=      path to the quilt series and patches
"
SUBDIRECTORY_ON=Yes
. git-sh-setup

dry_run=""
quilt_author=""
while test $# != 0
do
	case "$1" in
	--author)
		shift
		quilt_author="$1"
		;;
	-n|--dry-run)
		dry_run=1
		;;
	--patches)
		shift
		QUILT_PATCHES="$1"
		;;
	--)
		shift
		break;;
	*)
		usage
		;;
	esac
	shift
done

# Quilt Author
if [ -n "$quilt_author" ] ; then
	quilt_author_name=$(expr "z$quilt_author" : 'z\(.*[^ ]\) *<.*') &&
	quilt_author_email=$(expr "z$quilt_author" : '.*<\([^>]*\)') &&
	test '' != "$quilt_author_name" &&
	test '' != "$quilt_author_email" ||
	die "malformed --author parameter"
fi

# Quilt patch directory
: ${QUILT_PATCHES:=patches}
if ! [ -d "$QUILT_PATCHES" ] ; then
	echo "The \"$QUILT_PATCHES\" directory does not exist."
	exit 1
fi

# Temporary directories
tmp_dir="$GIT_DIR"/rebase-apply
tmp_msg="$tmp_dir/msg"
tmp_patch="$tmp_dir/patch"
tmp_info="$tmp_dir/info"


# Find the initial commit
commit=$(git rev-parse HEAD)

mkdir $tmp_dir || exit 2
while read patch_name level garbage <&3
do
	case "$patch_name" in ''|'#'*) continue;; esac
	case "$level" in
	-p*)	;;
	''|'#'*)
		level=;;
	*)
		echo "unable to parse patch level, ignoring it."
		level=;;
	esac
	case "$garbage" in
	''|'#'*);;
	*)
		echo "trailing garbage found in series file: $garbage"
		exit 1;;
	esac
	if ! [ -f "$QUILT_PATCHES/$patch_name" ] ; then
		echo "$patch_name doesn't exist. Skipping."
		continue
	fi
	echo $patch_name
	git mailinfo "$tmp_msg" "$tmp_patch" \
		<"$QUILT_PATCHES/$patch_name" >"$tmp_info" || exit 3
	test -s "$tmp_patch" || {
		echo "Patch is empty.  Was it split wrong?"
		exit 1
	}

	# Parse the author information
	GIT_AUTHOR_NAME=$(sed -ne 's/Author: //p' "$tmp_info")
	GIT_AUTHOR_EMAIL=$(sed -ne 's/Email: //p' "$tmp_info")
	export GIT_AUTHOR_NAME GIT_AUTHOR_EMAIL
	while test -z "$GIT_AUTHOR_EMAIL" && test -z "$GIT_AUTHOR_NAME" ; do
		if [ -n "$quilt_author" ] ; then
			GIT_AUTHOR_NAME="$quilt_author_name";
			GIT_AUTHOR_EMAIL="$quilt_author_email";
		elif [ -n "$dry_run" ]; then
			echo "No author found in $patch_name" >&2;
			GIT_AUTHOR_NAME="dry-run-not-found";
			GIT_AUTHOR_EMAIL="dry-run-not-found";
		else
			echo "No author found in $patch_name" >&2;
			echo "---"
			cat $tmp_msg
			printf "Author: ";
			read patch_author

			echo "$patch_author"

			patch_author_name=$(expr "z$patch_author" : 'z\(.*[^ ]\) *<.*') &&
			patch_author_email=$(expr "z$patch_author" : '.*<\([^>]*\)') &&
			test '' != "$patch_author_name" &&
			test '' != "$patch_author_email" &&
			GIT_AUTHOR_NAME="$patch_author_name" &&
			GIT_AUTHOR_EMAIL="$patch_author_email"
		fi
	done
	GIT_AUTHOR_DATE=$(sed -ne 's/Date: //p' "$tmp_info")
	SUBJECT=$(sed -ne 's/Subject: //p' "$tmp_info")
	export GIT_AUTHOR_DATE SUBJECT
	if [ -z "$SUBJECT" ] ; then
		SUBJECT=$(echo $patch_name | sed -e 's/.patch$//')
	fi

	if [ -z "$dry_run" ] ; then
		git apply --index -C1 ${level:+"$level"} "$tmp_patch" &&
		tree=$(git write-tree) &&
		commit=$( (echo "$SUBJECT"; echo; cat "$tmp_msg") | git commit-tree $tree -p $commit) &&
		git update-ref -m "quiltimport: $patch_name" HEAD $commit || exit 4
	fi
done 3<"$QUILT_PATCHES/series"
rm -rf $tmp_dir || exit 5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #!/bin/sh
# Copyright 2005, Ryan Anderson <ryan@michonline.com>
#
# This file is licensed under the GPL v2, or a later version
# at the discretion of Linus Torvalds.

USAGE='<start> <url> [<end>]'
LONG_USAGE='Summarizes the changes between two commits to the standard output,
and includes the given URL in the generated summary.'
SUBDIRECTORY_OK='Yes'
OPTIONS_KEEPDASHDASH=
OPTIONS_STUCKLONG=
OPTIONS_SPEC='git request-pull [options] start url [end]
--
p    show patch text as well
'

. git-sh-setup

GIT_PAGER=
export GIT_PAGER

patch=
while	case "$#" in 0) break ;; esac
do
	case "$1" in
	-p)
		patch=-p ;;
	--)
		shift; break ;;
	-*)
		usage ;;
	*)
		break ;;
	esac
	shift
done

base=$1 url=$2 status=0

test -n "$base" && test -n "$url" || usage

baserev=$(git rev-parse --verify --quiet "$base"^0)
if test -z "$baserev"
then
    die "fatal: Not a valid revision: $base"
fi

#
# $3 must be a symbolic ref, a unique ref, or
# a SHA object expression. It can also be of
# the format 'local-name:remote-name'.
#
local=${3%:*}
local=${local:-HEAD}
remote=${3#*:}
pretty_remote=${remote#refs/}
pretty_remote=${pretty_remote#heads/}
head=$(git symbolic-ref -q "$local")
head=${head:-$(git show-ref --heads --tags "$local" | cut -d' ' -f2)}
head=${head:-$(git rev-parse --quiet --verify "$local")}

# None of the above? Bad.
test -z "$head" && die "fatal: Not a valid revision: $local"

# This also verifies that the resulting head is unique:
# "git show-ref" could have shown multiple matching refs..
headrev=$(git rev-parse --verify --quiet "$head"^0)
test -z "$headrev" && die "fatal: Ambiguous revision: $local"

# Was it a branch with a description?
branch_name=${head#refs/heads/}
if test "z$branch_name" = "z$headref" ||
	! git config "branch.$branch_name.description" >/dev/null
then
	branch_name=
fi

merge_base=$(git merge-base $baserev $headrev) ||
die "fatal: No commits in common between $base and $head"

# $head is the refname from the command line.
# If a ref with the same name as $head exists at the remote
# and their values match, use that.
#
# Otherwise find a random ref that matches $headrev.
find_matching_ref='
	my ($head,$headrev) = (@ARGV);
	my ($found);

	while (<STDIN>) {
		chomp;
		my ($sha1, $ref, $deref) = /^(\S+)\s+([^^]+)(\S*)$/;
		my ($pattern);
		next unless ($sha1 eq $headrev);

		$pattern="/$head\$";
		if ($ref eq $head) {
			$found = $ref;
		}
		if ($ref =~ /$pattern/) {
			$found = $ref;
		}
		if ($sha1 eq $head) {
			$found = $sha1;
		}
	}
	if ($found) {
		print "$found\n";
	}
'

ref=$(git ls-remote "$url" | /usr/bin/perl -e "$find_matching_ref" "${remote:-HEAD}" "$headrev")

if test -z "$ref"
then
	echo "warn: No match for commit $headrev found at $url" >&2
	echo "warn: Are you sure you pushed '${remote:-HEAD}' there?" >&2
	status=1
fi

# Special case: turn "for_linus" to "tags/for_linus" when it is correct
if test "$ref" = "refs/tags/$pretty_remote"
then
	pretty_remote=tags/$pretty_remote
fi

url=$(git ls-remote --get-url "$url")

git show -s --format='The following changes since commit %H:

  %s (%ci)

are available in the git repository at:
' $merge_base &&
echo "  $url $pretty_remote" &&
git show -s --format='
for you to fetch changes up to %H:

  %s (%ci)

----------------------------------------------------------------' $headrev &&

if test $(git cat-file -t "$head") = tag
then
	git cat-file tag "$head" |
	sed -n -e '1,/^$/d' -e '/^-----BEGIN PGP /q' -e p
	echo
	echo "----------------------------------------------------------------"
fi &&

if test -n "$branch_name"
then
	echo "(from the branch description for $branch_name local branch)"
	echo
	git config "branch.$branch_name.description"
	echo "----------------------------------------------------------------"
fi &&

git shortlog ^$baserev $headrev &&
git diff -M --stat --summary $patch $merge_base..$headrev || status=1

exit $status
                                                                                                                                                                                                                                           